
<!DOCTYPE html><html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.33.1" theme-name="Stellar" theme-version="1.33.1">
  
  
  <meta name="generator" content="Hexo 7.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  <meta name="theme-color" content="#f9fafb">
  <title>G-code - RepRap - LemonCyan</title>

  
    <meta name="description" content="有几种不同的方法可以为打印机准备 G-code。一种方法是使用切片程序，例如 Slic3r、Skeinforge 或 Cura。这些程序导入 CAD 模型，将其切片成层，并输出打印每一层所需的 G-code。切片器是从 3D 模型到打印部件的最简单方法，但使用它们时用户会牺牲一些灵活性。另一种 G-code 生成选项是使用像 mecode 这样的低级库。像 mecode 这样的库可以让您精确控制工">
<meta property="og:type" content="article">
<meta property="og:title" content="G-code - RepRap">
<meta property="og:url" content="https://lemoncyan.github.io/2025/02/24/4-Others-3D%E6%89%93%E5%8D%B0-G-code-RepRap/">
<meta property="og:site_name" content="LemonCyan">
<meta property="og:description" content="有几种不同的方法可以为打印机准备 G-code。一种方法是使用切片程序，例如 Slic3r、Skeinforge 或 Cura。这些程序导入 CAD 模型，将其切片成层，并输出打印每一层所需的 G-code。切片器是从 3D 模型到打印部件的最简单方法，但使用它们时用户会牺牲一些灵活性。另一种 G-code 生成选项是使用像 mecode 这样的低级库。像 mecode 这样的库可以让您精确控制工">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg">
<meta property="article:published_time" content="2025-02-24T00:00:00.000Z">
<meta property="article:modified_time" content="2025-02-24T00:00:00.000Z">
<meta property="article:author" content="liuluhua">
<meta property="article:tag" content="clippings">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg">
  
  
  
  <meta name="keywords" content="clippings">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.33.1">


  

  

  <script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"liuluhua","sameAs":[],"image":"https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg"},"dateCreated":"2025-02-24T00:00:00+00:00","dateModified":"2025-02-24T00:00:00+00:00","datePublished":"2025-02-24T00:00:00+00:00","description":"","headline":"G-code - RepRap","mainEntityOfPage":{"@type":"WebPage","@id":"https://lemoncyan.github.io/2025/02/24/4-Others-3D%E6%89%93%E5%8D%B0-G-code-RepRap/"},"publisher":{"@type":"Organization","name":"liuluhua","sameAs":[],"image":"https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg","logo":{"@type":"ImageObject","url":"https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg"}},"url":"https://lemoncyan.github.io/2025/02/24/4-Others-3D%E6%89%93%E5%8D%B0-G-code-RepRap/","keywords":"clippings","image":[]}</script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/satouriko/LxgwWenKai_Webfonts@v1.101/dist/LXGWWenKaiMono-Bold.css" />
</head>
<body>

<div class="l_body content" id="start" layout="post" type="tech" ><aside class="l_left"><div class="sidebg"></div><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="https://raw.staticdn.net/liuluhua/liuluhua.github.io/ImageBed/BlogRes/avatar.jpg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main">LemonCyan</div><div class="sub cap">LemonCyan`s Charging</div></a></div></header>

<div class="nav-area">

<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="探索" href="/explore/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="社交" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a></nav>
</div>
<div class="widgets">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="Search"></form><div id="search-result"></div><div class="search-no-result">No Results!</div></div>



<widget class="widget-wrapper recent post-list"><div class="widget-header dis-select"><span class="name">Recent Update</span></div><div class="widget-body fs14"><a class="item title" href="/2025/05/10/4-Others-AI-%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A5/"><span class="title">大模型接入</span></a><a class="item title" href="/2025/12/30/1-%E5%B9%B3%E5%8F%B0-%E6%9C%8D%E5%8A%A1%E5%99%A8-Clash%E6%9A%B4%E9%9C%B2%E5%85%AC%E7%BD%91%E5%AF%BC%E8%87%B4%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%82%E5%B8%B8%E6%8E%92%E6%9F%A5%E8%AE%B0%E5%BD%95/"><span class="title">Clash暴露公网导致服务器异常排查记录</span></a><a class="item title" href="/2025/12/30/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-qmake%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/"><span class="title">qmake完全指南</span></a><a class="item title" href="/2024/12/20/1-%E5%B9%B3%E5%8F%B0-Docker-Docker%E9%83%A8%E7%BD%B2/"><span class="title">Docker部署</span></a><a class="item title" href="/2025/12/22/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-VibeCoding-ChatGPT-%E5%B7%A5%E7%A8%8B%E7%BA%A7%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"><span class="title">ChatGPT-工程级系统设计</span></a><a class="item title" href="/2025/12/19/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-VibeCoding-%E8%AE%BE%E8%AE%A1/"><span class="title">设计</span></a><a class="item title" href="/2025/12/18/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-VibeCoding-3-VibePrompt/"><span class="title">3.VibePrompt</span></a><a class="item title" href="/2025/12/22/1-%E5%B9%B3%E5%8F%B0-WSL-%E5%A6%82%E4%BD%95%E5%9C%A8windows%E7%8E%AF%E5%A2%83%E4%B8%AD%E8%AE%BF%E9%97%AEwsl%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9/"><span class="title">如何在windows环境中访问wsl的文件夹</span></a><a class="item title" href="/2025/12/18/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-VibeCoding-4-VibeCode/"><span class="title">4.VibeCode</span></a><a class="item title" href="/2025/12/18/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-VibeCoding-5-%E6%8C%81%E7%BB%AD%E6%BC%94%E5%8C%96/"><span class="title">5. 持续演化</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="/" rel="noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/08a41b181ce68.svg"/></a><a class="social" href="/" rel="noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/3845874.svg"/></a><a class="social" href="/" rel="noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/3616429.svg"/></a><a class="social" href="/about/#comments" rel="noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/942ebbf1a4b91.svg"/></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">Home</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">Blog</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/4-Others/">4.Others</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/4-Others/3D%E6%89%93%E5%8D%B0/">3D打印</a></div>
<div class="flex-row" id="post-meta"><span class="text created">Posted on: <time datetime="2025-02-24T00:00:00.000Z">2025-02-24</time></span><span class="sep updated"></span><span class="text updated">Updated on: <time datetime="2025-02-24T00:00:00.000Z">2025-02-24</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>G-code - RepRap</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><p>有几种不同的方法可以为打印机准备 G-code。<br>一种方法是使用切片程序，例如 <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Slic3r" title="Slic3r">Slic3r</a>、<a target="_blank" rel="noopener" href="https://reprap.org/wiki/Skeinforge" title="Skeinforge">Skeinforge</a> 或 <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Cura" title="Cura">Cura</a>。这些程序导入 CAD 模型，将其切片成层，并输出打印每一层所需的 G-code。切片器是从 3D 模型到打印部件的最简单方法，但使用它们时用户会牺牲一些灵活性。<br>另一种 G-code 生成选项是使用像 <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Mecode" title="Mecode">mecode</a> 这样的低级库。像 mecode 这样的库可以让您精确控制工具路径，因此如果您有一个不适合简单切片的复杂打印，它们会很有用。<br>最后一个选项是自己编写 G-code。如果您只需要在校准打印机时运行几行测试代码，这可能是最佳选择。</p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>A typical piece of G-code as sent to a RepRap machine might look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">N3 T0*57</span><br><span class="line">N4 G92 E0*67</span><br><span class="line">N5 G28*22</span><br><span class="line">N6 G1 F1500.0*82</span><br><span class="line">N7 G1 X2.0 Y2.0 F3000.0*85</span><br><span class="line">N8 G1 X3.0 Y3.0*33</span><br></pre></td></tr></table></figure>

<p>G-code can also be stored in files on SD cards. A file containing RepRap G-code usually has the extension <code>.g</code>, <code>.gco</code> or <code>.gcode</code>. Files for BFB&#x2F;RapMan have the extension <code>.bfb</code>. G-code stored in file or produced by a slicer might look like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">G92 E0</span><br><span class="line">G28</span><br><span class="line">G1 F1500</span><br><span class="line">G1 X2.0 Y2.0 F3000</span><br><span class="line">G1 X3.0 Y3.0</span><br></pre></td></tr></table></figure>

<p>The meaning of all those symbols and numbers (and more) is explained below.</p>
<p>Slicers will (optionally?) add G-code scripts to the beginning and end of their output file to perform specified actions before and&#x2F;or after a print such as z-probing the build-area, heating&#x2F;cooling the bed and hotend, performing ooze free “nozzle wipe” startup routine, switching system power on&#x2F;off, and even “ejecting” parts. More info on the <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Start_GCode_routines" title="Start GCode routines">Start GCode routines</a> and <a target="_blank" rel="noopener" href="https://reprap.org/wiki/End_GCode_routines" title="End GCode routines">End GCode routines</a> pages.</p>
<p>To find out which specific G-code(s) are implemented in any given firmware, there are little tables attached to the command descriptions, like this one:</p>
<p>Here means:</p>
<table>
<thead>
<tr>
<th>???</th>
<th>Unknown if the firmware supports this G-code. You may want to test this yourself before using it in production.</th>
</tr>
</thead>
<tbody><tr>
<td>Yes</td>
<td>The G-code is fully supported by the firmware.</td>
</tr>
<tr>
<td>1.23+</td>
<td>The G-code is supported by version 1.23 and above.</td>
</tr>
<tr>
<td>No</td>
<td>The firmware does not support the G-code at all.</td>
</tr>
<tr>
<td>Partial</td>
<td>There is only partial support for the full G-code specification. It may be required to rebuild the source code with extra options or flip configuration switches on the mainboard.</td>
</tr>
<tr>
<td>Experimental</td>
<td>The G-code is experimental and may change or be removed.</td>
</tr>
<tr>
<td>Automatic</td>
<td>The firmware handles this G-code automatically, so there’s no need to send the command. An example is power supply on&#x2F;off G-code (<code>M80</code>&#x2F;<code>M81</code>) in the Teacup firmware.</td>
</tr>
</tbody></table>
<p>For the technically-minded, G-code line endings are Unix Line Endings (<code>\n</code>), but will accept Windows Line Endings (<code>\r\n</code>), so you should not need to worry about converting between the two, but it is best practice to use Unix Line Endings where possible.</p>
<h2 id="Fields"><a href="#Fields" class="headerlink" title="Fields"></a>Fields</h2><p>A RepRap G-code is a list of fields that are separated by white spaces or line breaks. A field can be interpreted as a command, parameter, or for any other special purpose. It consists of one letter directly followed by a number, or can be only a stand-alone letter (Flag). The letter gives information about the meaning of the field (see the list below in this section). Numbers can be <em>integers</em> (128) or <em>fractional</em> numbers (12.42), depending on context. For example, an X coordinate can take integers (<code>X175</code>) or fractionals (<code>X17.62</code>), but selecting extruder number 2.76 would make no sense. In this description, the numbers in the fields are represented by <code>nnn</code> as a placeholder.</p>
<p>In RepRapFirmware, some parameters can be followed by more than one number, with colon used to separate them. Typically this is used to specify extruder parameters, with one value provided per extruder. If only one value is provided where a value is needed for each extruder, then that value is applied to all extruders.</p>
<table>
<thead>
<tr>
<th>Letter</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>Gnnn</td>
<td>Standard G-code command, such as move to a point</td>
</tr>
<tr>
<td>Mnnn</td>
<td>RepRap-defined command, such as turn on a cooling fan</td>
</tr>
<tr>
<td>Tnnn</td>
<td>Select tool nnn. In RepRap, a tool is typically associated with a nozzle, which may be fed by one or more extruders.</td>
</tr>
<tr>
<td>Snnn</td>
<td>Command parameter, such as time in seconds; temperatures; voltage to send to a motor</td>
</tr>
<tr>
<td>Pnnn</td>
<td>Command parameter, such as time in milliseconds; proportional (Kp) in PID Tuning</td>
</tr>
<tr>
<td>Xnnn</td>
<td>A X coordinate, usually to move to. This can be an Integer or Fractional number.</td>
</tr>
<tr>
<td>Ynnn</td>
<td>A Y coordinate, usually to move to. This can be an Integer or Fractional number.</td>
</tr>
<tr>
<td>Znnn</td>
<td>A Z coordinate, usually to move to. This can be an Integer or Fractional number.</td>
</tr>
<tr>
<td>U,V,W</td>
<td>Additional axis coordinates (RepRapFirmware)</td>
</tr>
<tr>
<td>Innn</td>
<td>Parameter - X-offset in arc move; integral (Ki) in PID Tuning</td>
</tr>
<tr>
<td>Jnnn</td>
<td>Parameter - Y-offset in arc move</td>
</tr>
<tr>
<td>Dnnn</td>
<td>Parameter - used for diameter; derivative (Kd) in PID Tuning</td>
</tr>
<tr>
<td>Hnnn</td>
<td>Parameter - used for heater number in PID Tuning</td>
</tr>
<tr>
<td>Fnnn</td>
<td>Feedrate in mm per minute. (Speed of print head movement)</td>
</tr>
<tr>
<td>Rnnn</td>
<td>Parameter - used for temperatures</td>
</tr>
<tr>
<td>Qnnn</td>
<td>Parameter - not currently used</td>
</tr>
<tr>
<td>Ennn</td>
<td>Length of extrudate. This is exactly like X, Y and Z, but for the length of filament to consume.</td>
</tr>
<tr>
<td>Nnnn</td>
<td>Line number. Used to request repeat transmission in the case of communications errors.</td>
</tr>
<tr>
<td>*nnn</td>
<td>Checksum. Used to check for communications errors.</td>
</tr>
</tbody></table>
<h2 id="Case-sensitivity"><a href="#Case-sensitivity" class="headerlink" title="Case sensitivity"></a>Case sensitivity</h2><p>The original NIST G-code standard requires gcode interpreters to be case-insensitive, except for characters in comments. However, not all 3D printer firmwares conform to this and some recognise uppercase command letters and parameters only.</p>
<p>Firmwares that are known to be case-insensitive</p>
<p>RepRapFirmware version 1.19 and later (except within quoted strings)</p>
<p>Druid Firmware version 1.00 by default is case-insensitive: ( M544 S0 &#x3D; case-sensitive &#x2F; M544 S1 &#x3D; case-insensitive )</p>
<p>Firmwares that are known to be case-sensitive</p>
<p>RepRapFirmware version 1.18 and earlier</p>
<p>Druid Firmware version 1.00 for case-sensitive: M544 S0 &#x3D; case-sensitive</p>
<h2 id="Quoted-strings"><a href="#Quoted-strings" class="headerlink" title="Quoted strings"></a>Quoted strings</h2><p>In RepRapFirmware, some commands support quoted strings when providing file names and other string parameters. This allows file names, WiFi passwords etc. to contain spaces, semicolons and other characters that would otherwise not be permitted. Double-quote characters are used to delimit the string, and any double-quote character within the string must be repeated.</p>
<p>Unfortunately, some gcode sender programs convert all characters to uppercase and don’t provide any means to disable this feature. Therefore, within a quoted-string, the single-quote character is used as a flag to force the following character to lowercase. If you want to include a single quote character in the string, use two single quote characters to represent one single quote character.</p>
<p>Example: to add SSID MYROUTER with password <code>ABCxyz;&quot; 123</code> to the WiFi network list, use command:</p>
<p><code>M587 S&quot;MYROUTER&quot; P&quot;ABCxyz;&quot;&quot; 123&quot;</code></p>
<p>or if you can’t send lowercase characters:</p>
<p><code>M587 S&quot;MYROUTER&quot; P&quot;ABC&#39;X&#39;Y&#39;Z;&quot;&quot; 123&quot;</code></p>
<h2 id="Using-expressions-in-parameters"><a href="#Using-expressions-in-parameters" class="headerlink" title="Using expressions in parameters"></a>Using expressions in parameters</h2><p>RepRapFirmware 3.1 and later allow parameter values to be computed from an expression enclosed in { }. Such an expression may include constants, values from the machine object model, operators and functions. Example:</p>
<p><code>G1 X&#123;move.axes[0].max-5&#125; Y&#123;move.axes[1].min+5&#125; F6000 ; move to 5mm short of the X and Y axis limits</code></p>
<p>See <a target="_blank" rel="noopener" href="https://docs.duet3d.com/en/User_manual/Reference/Gcode_meta_commands">https://docs.duet3d.com/en/User_manual&#x2F;Reference&#x2F;Gcode_meta_commands</a> for more details.</p>
<p>G-code comments begin at a semicolon, and end at the end of the line:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">N3 T0*57 ; This is a comment</span><br><span class="line">N4 G92 E0*67</span><br><span class="line">; So is this</span><br><span class="line">N5 G28*22</span><br></pre></td></tr></table></figure>

<p>Some firmwares also obey the CNC G-code standard, which is to enclose comments in round brackets. Comments of this form must start and end on the same line:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Home some axes)</span><br><span class="line">G28 (here come the axes to be homed) X Y</span><br></pre></td></tr></table></figure>

<p>Comments and white space will be ignored by your RepRap Printer. It’s better to strip these out on the host computer before sending the G-code to your printer, as this saves bandwidth.</p>
<h2 id="Special-fields"><a href="#Special-fields" class="headerlink" title="Special fields"></a>Special fields</h2><h4 id="N-Line-number"><a href="#N-Line-number" class="headerlink" title="N: Line number"></a>N: Line number</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">N123</span><br></pre></td></tr></table></figure>

<p>If present, the line number should be the first field in a line. For G-code stored in files on SD cards the line number is usually omitted.</p>
<p>If checking is supported, the RepRap firmware expects line numbers to increase by 1 each line, and if that doesn’t happen it is flagged as an error. But you can reset the count using <code>M110</code> (see below).</p>
<p>Although supported, usage of N in Machinekit is discouraged as it serves no purpose.</p>
<h4 id="Checksum"><a href="#Checksum" class="headerlink" title="*: Checksum"></a>*: Checksum</h4><p>Example: <code>*71</code></p>
<p>If present, the checksum should be the last field in a line, but before a comment. For G-code stored in files on SD cards the checksum is usually omitted.</p>
<p>The firmware compares the checksum against a locally-computed value. If they differ, it requests a repeat transmission of the line.</p>
<h4 id="CRC"><a href="#CRC" class="headerlink" title="*: CRC"></a>*: CRC</h4><p>Example: <code>*37428</code></p>
<p>The 8-bit checksum provides insufficient protection against noise on the received data connection in some situations, for example where the cable from a display device runs close to an extruder cable. Therefore RepRapFirmware allows a CRC to be used in place of a checksum. If present, the CRC should be the last field in a line, but before the semicolon and comment if present. RepRapFirmware assumes that * followed by 5 digits is a CRC, whereas * followed by 1, 2 or 3 digits is a checksum. The polynomial used is 0x1021 as for CCITT CRC16.</p>
<h2 id="Checking"><a href="#Checking" class="headerlink" title="Checking"></a>Checking</h2><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">N123 [...G Code in here...] *71</span><br></pre></td></tr></table></figure>

<p>The RepRap firmware checks the line number and the checksum (or CRC if supported). You can leave both of these out - RepRap will still work, but it won’t do checking. You have to have both or neither though. If only one appears, it produces an error.</p>
<p>The checksum “cs” for a G-code string “cmd” (including its line number) is computed by exor-ing the bytes in the string up to and not including the * character as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int cs = 0;</span><br><span class="line">for(i = 0; cmd[i] != &#x27;*&#x27; &amp;&amp; cmd[i] != NULL; i++)</span><br><span class="line">   cs = cs ^ cmd[i];</span><br><span class="line">cs &amp;= 0xff;  // Defensive programming...</span><br></pre></td></tr></table></figure>

<p>and the value is appended as a decimal integer to the command after the * character.</p>
<h2 id="Conditional-Execution-and-Loops"><a href="#Conditional-Execution-and-Loops" class="headerlink" title="Conditional Execution and Loops"></a>Conditional Execution and Loops</h2><p>RepRapFirmware 3.01 and later supports conditions and loops in GCode. Properties from the firmware object model (e.g. current position, current tool) can be included in controlling expressions. See <a target="_blank" rel="noopener" href="https://docs.duet3d.com/en/User_manual/Reference/Gcode_meta_commands">https://docs.duet3d.com/en/User_manual&#x2F;Reference&#x2F;Gcode_meta_commands</a> for details.</p>
<h2 id="Buffering"><a href="#Buffering" class="headerlink" title="Buffering"></a>Buffering</h2><p>If buffering is supported, the RepRap firmware stores some commands in a ring buffer internally for execution. This means that there is no (appreciable) delay while a command is acknowledged and the next transmitted. In turn, this means that sequences of line segments can be plotted without a dwell between one and the next. As soon as one of these buffered commands is received it is acknowledged and stored locally. If the local buffer is full, then the acknowledgment is delayed until space for storage in the buffer is available. This is how flow control is achieved.</p>
<p>Typically, the following moving commands are buffered: <code>G0</code>-<code>G3</code> and <code>G28</code>-<code>G32</code>. The <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Teacup_Firmware" title="Teacup Firmware">Teacup Firmware</a> buffers also some setting commands: <code>G20</code>, <code>G21</code>, <code>G90</code> and <code>G91</code>. All other <code>G</code>, <code>M</code> or <code>T</code> commands are not buffered.</p>
<p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/RepRapFirmware" title="RepRapFirmware">RepRapFirmware</a> also implements an internal queue to ensure that certain codes (like <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M106:_Fan_On" title="G-code">M106</a>) are executed in the right order and not when the last move has been added to the look-ahead queue.</p>
<p>When an unbuffered command is received it is stored, but it is not acknowledged to the host until the buffer is exhausted and then the command has been executed. Thus the host will pause at one of these commands until it has been done. Short pauses between these commands and any that might follow them do not affect the performance of the machine.</p>
<h2 id="G-commands"><a href="#G-commands" class="headerlink" title="G-commands"></a>G-commands</h2><h4 id="G0-G1-Move"><a href="#G0-G1-Move" class="headerlink" title="G0 &amp; G1: Move"></a>G0 &amp; G1: Move</h4><ul>
<li><code>G0</code> : Rapid Move</li>
<li><code>G1</code> : Linear Move</li>
</ul>
<p>Usage</p>
<p><code>G0 Xnnn Ynnn Znnn Ennn Fnnn Snnn</code></p>
<p><code>G1 Xnnn Ynnn Znnn Ennn Fnnn Snnn</code></p>
<p>Parameters</p>
<p><em>Not all parameters need to be used, but at least <strong>one</strong> has to be used</em></p>
<p><code>Xnnn</code> The position to move to on the X axis</p>
<p><code>Ynnn</code> The position to move to on the Y axis</p>
<p><code>Znnn</code> The position to move to on the Z axis</p>
<p><code>Ennn</code> The amount to extrude between the starting point and ending point</p>
<p><code>Fnnn</code> The feedrate per minute of the move between the starting point and ending point (if supplied)</p>
<p><code>Hnnn</code> (RepRapFirmware) Flag to check if an endstop was hit <em>(<code>H1</code> to check, <code>H0</code> to ignore, other <code>Hnnn</code> see note, default is <code>H0</code>)</em><sup>1</sup></p>
<p><code>Rnnn</code> (RepRapFirmware) Restore point number <sup>4</sup></p>
<p><code>Snnn</code> Laser cutter&#x2F;engraver power. In RepRapFirmware, when not in laser mode S in interpreted the same as H.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G0 X12               ; move to 12mm on the X axis</span><br><span class="line">G0 F1500             ; Set the feedrate to 1500mm/min</span><br><span class="line">G1 X90.6 Y13.8 E22.4 ; Move to 90.6mm on the X axis and 13.8mm on the Y axis while extruding 22.4mm of material</span><br></pre></td></tr></table></figure>

<p>The RepRap firmware spec treats <code>G0</code> and <code>G1</code> as the same command, since it’s just as efficient as not doing so.<sup>2</sup></p>
<p>Most RepRap firmwares do subtle things with feedrates.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G1 F1500           ; Set feedrate to 1500mm/min</span><br><span class="line">G1 X50 Y25.3 E22.4 ; Move and extrude</span><br></pre></td></tr></table></figure>

<p>In the above example, we first set the feedrate to 1500mm&#x2F;min, then move to 50mm on X and 25.3mm on Y while extruding 22.4mm of filament between the two points.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G1 F1500                 ; Feedrate 1500mm/min</span><br><span class="line">G1 X50 Y25.3 E22.4 F3000 ; Accelerate to 3000mm/min</span><br></pre></td></tr></table></figure>

<p>However, in the above example, we set a feedrate of 1500 mm&#x2F;min, then do the same move, but accelerating to 3000 mm&#x2F;min. Everything stays synchronized, so extrusion accelerates right along with X and Y movement.</p>
<p>The RepRap spec treats the feedrate as simply another variable (like X, Y, Z, and E) to be linearly interpolated. This gives complete control over the acceleration and deceleration of the printer head in a way that ensures everything moves smoothly together and the right volume of material is extruded at all points.<sup>3</sup></p>
<p>To reverse the extruder by a given amount (for example to reduce its internal pressure while it does an in-air movement so that it doesn’t dribble) simply use <code>G0</code> or <code>G1</code> to send an <code>E</code> value that is less than the currently extruded length.</p>
<p>Notes</p>
<p><sup>1</sup>Some firmwares allow for the RepRap to enable or disable the “sensing” of endstops during a move. Please check with whatever firmware you are using to see if they support the <code>H</code> parameter in this way, as damage may occur if you assume incorrectly. In RepRapFirmware, using the <code>H1</code> or <code>H2</code> parameter on a delta printer causes the <code>XYZ</code> parameters to refer to the individual tower motor positions instead of the head position, and to enable endstop detection as well if the parameter is H1. H3 may be used to measure axis lengths and H4 can be used to stop when an endstop is hit while updating the position only (H4 is supported in 3.2-b4 and later).</p>
<p><sup>2</sup>In the RS274NGC Spec, <code>G0</code> is <em>Rapid Move</em>, which was used to move between the current point in space and the new point as quickly and efficiently as possible, and <code>G1</code> is <em>Controlled Move</em>, which was used to move between the current point in space and the new point as precise as possible. In RepRapFirmware, G1 is always a linear move but G0 may not be linear (e.g. on a SCARA machine); however a G0 move will never go below the lower of the initial and final Z height of the move.</p>
<p><sup>3</sup>Some firmwares may not support setting the feedrate inline with a move.</p>
<p><sup>4</sup>RepRapFirmware provides an additional ‘R’ parameter to tell the machine to add the coordinates of the specified restore point to all axis coordinates mentioned in the G0 or G1 command. Axes that are not mentioned in the G0 or G1 command are not moved. When a print is paused, the coordinates are saved in restore point #1. When a tool change is commenced, the coordinates are saved in restore point #2. Coordinates can also be saved in restore points explicity using the G60 command.</p>
<p>Some older machines, CNC or otherwise, used to move faster if they did not move in a straight line. This is also true for some non-Cartesian printers, like delta or polar printers, which move easier and faster in a curve.</p>
<h4 id="G2-G3-Controlled-Arc-Move"><a href="#G2-G3-Controlled-Arc-Move" class="headerlink" title="G2 &amp; G3: Controlled Arc Move"></a>G2 &amp; G3: Controlled Arc Move</h4><p>Usage</p>
<p><code>G2 Xnnn Ynnn Innn Jnnn Ennn Fnnn</code> <em>(Clockwise Arc)</em></p>
<p><code>G3 Xnnn Ynnn Innn Jnnn Ennn Fnnn</code> <em>(Counter-Clockwise Arc)</em></p>
<p>Parameters</p>
<p><code>Xnnn</code> The position to move to on the X axis</p>
<p><code>Ynnn</code> The position to move to on the Y axis</p>
<p><code>Znnn</code> The position to move to on the Z axis (optional, may not be supported in some firmwares)</p>
<p><code>Innn</code> The point in X space from the current X position to maintain a constant distance from</p>
<p><code>Jnnn</code> The point in Y space from the current Y position to maintain a constant distance from</p>
<p><code>Ennn</code> The amount to extrude between the starting point and ending point</p>
<p><code>Fnnn</code> The feedrate per minute of the move between the starting point and ending point (if supplied)</p>
<p><code>Knnn</code> The point in Z space from the current Z position to maintain a constant distance from (used only when the current plane is YZ or ZX - see G18 and G19)</p>
<p><code>Rnnn</code> The radius of the arc (can be used in place of I and J, may not be supported in some firmwares)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G2 X90.6 Y13.8 I5 J10 E22.4</span><br></pre></td></tr></table></figure>

<p>(Move in a Clockwise arc from the current point to point (X&#x3D;90.6,Y&#x3D;13.8), with a center point at (X&#x3D;current_X+5, Y&#x3D;current_Y+10), extruding 22.4mm of material between starting and stopping)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G3 X90.6 Y13.8 I5 J10 E22.4</span><br></pre></td></tr></table></figure>

<p>(Move in a Counter-Clockwise arc from the current point to point (X&#x3D;90.6,Y&#x3D;13.8), with a center point at (X&#x3D;current_X+5, Y&#x3D;current_Y+10), extruding 22.4mm of material between starting and stopping)</p>
<p>Notes</p>
<p><sup>1</sup>In Marlin Firmware not implemented for <strong>DELTA</strong> printers.</p>
<p><sup>2</sup>Prusa Firmware implements arcs only in Cartesian XY.</p>
<p><sup>3</sup>On Klipper, a <code>gcode_arcs</code> section must be enabled in the configuration file.</p>
<h4 id="G4-Dwell"><a href="#G4-Dwell" class="headerlink" title="G4: Dwell"></a>G4: Dwell</h4><p>Pause the machine for a period of time.</p>
<p>Parameters</p>
<p><code>Pnnn</code> Time to wait, in milliseconds (In Teacup, P0, wait until all previous moves are finished)</p>
<p><code>Snnn</code> Time to wait, in seconds (Only on Repetier, Marlin, Prusa, Smoothieware, and RepRapFirmware 1.16 and later)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G4 P200</span><br></pre></td></tr></table></figure>

<p>In this case sit still doing nothing for 200 milliseconds. During delays the state of the machine (for example the temperatures of its extruders) will still be preserved and controlled.</p>
<p>On Marlin, Smoothie and RepRapFirmware, the “S” parameter will wait for seconds, while the “P” parameter will wait for milliseconds. “G4 S2” and “G4 P2000” are equivalent.</p>
<h4 id="G6-External-Motion-Control-Marlin"><a href="#G6-External-Motion-Control-Marlin" class="headerlink" title="G6: External Motion Control (Marlin)"></a>G6: External Motion Control (Marlin)</h4><p>With <code>DIRECT_STEPPING</code> enabled Marlin can receive low-level stepper movement commands from a host device (e.g., OctoPrint with a plugin) in a compact binary format, so all acceleration and other motion tuning can be done on the host side.</p>
<p>The commands are routed directly to page storage on the printer by a “page manager” system on the host side. The page manager operates in parallel with the usual G-code commands over the USB serial connection. The host is thus able to load data onto the machine quickly alongside regular G-code processing.</p>
<p>The <strong>G6</strong> command triggers the movements stored in the pages by referencing the corresponding page. Depending on the format, direction arguments may also be needed in the <strong>G6</strong> command.</p>
<p>Requires <a target="_blank" rel="noopener" href="https://github.com/colinrgodsey/step-daemon">Step Daemon</a> by <a target="_blank" rel="noopener" href="https://github.com/colinrgodsey">@ColinRGodsey</a>. See the <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Direct_Stepping" title="Direct Stepping">Direct Stepping</a> article for more information.</p>
<p>Parameters</p>
<p><code>I(index)</code> Set page index</p>
<p><code>R(rate)</code> Step rate per second. Last value is cached for future invocations.</p>
<p><code>S(rate)</code> Number of steps to take. Defaults to max steps.</p>
<p><code>X(direction)</code> 1 for positive, 0 for negative. Last value is cached for future invocations. Not used for directional formats.</p>
<p><code>Y(direction)</code> 1 for positive, 0 for negative. Last value is cached for future invocations. Not used for directional formats.</p>
<p><code>Z(direction)</code> 1 for positive, 0 for negative. Last value is cached for future invocations. Not used for directional formats.</p>
<p><code>E(direction)</code> 1 for positive, 0 for negative. Last value is cached for future invocations. Not used for directional formats.</p>
<h4 id="G6-Direct-Stepper-Move-Druid"><a href="#G6-Direct-Stepper-Move-Druid" class="headerlink" title="G6: Direct Stepper Move (Druid)"></a>G6: Direct Stepper Move (Druid)</h4><p>Perform a direct, uninterpolated, and non-kinematic synchronized move of one or more steppers directly. Units may be linear (e.g., mm or inches on <code>DELTA</code>) or specified in degrees (SCARA). This command is useful for initialization, diagnostics, and calibration, and should be disabled on production equipment. This type of move can be potentially dangerous, especially for deltabots, so implementations should do their best to limit movement to prevent twerking and damaging the carriage assembly.</p>
<p>Parameters</p>
<p><code>Annn</code> Stepper A position or angle</p>
<p><code>Bnnn</code> Stepper B position or angle</p>
<p><code>Cnnn</code> Stepper C position or angle</p>
<p><code>R</code> Relative move flag</p>
<p>SCARA Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G6 A45     ; Move SCARA A stepper to the 45° position</span><br><span class="line">G6 B20 R   ; Move SCARA B stepper 20° counter-clockwise</span><br></pre></td></tr></table></figure>

<p>DELTA Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G6 C10 R   ; Move DELTA C carriage up by 10mm</span><br></pre></td></tr></table></figure>

<h4 id="G10-Set-tool-Offset-and-or-workplace-coordinates-and-or-tool-temperatures"><a href="#G10-Set-tool-Offset-and-or-workplace-coordinates-and-or-tool-temperatures" class="headerlink" title="G10: Set tool Offset and&#x2F;or workplace coordinates and&#x2F;or tool temperatures"></a>G10: Set tool Offset and&#x2F;or workplace coordinates and&#x2F;or tool temperatures</h4><p>Usage</p>
<p><code>G10 Lnnn Pnnn Xnnn Ynnn Znnn Rnnn Snnn</code><sup>1</sup></p>
<p>Parameters</p>
<p><code>Pnnn</code> Tool number</p>
<p><code>Lnnn</code> Offset mode <sup>5</sup></p>
<p><code>Xnnn</code> X offset</p>
<p><code>Ynnn</code> Y offset</p>
<p><code>Znnn</code> Z offset<sup>2</sup></p>
<p><code>U,V,W,A,B,Cnnn</code> other axis offsets<sup>4</sup></p>
<p><code>Rnnn</code> Standby temperature(s) (RepRapFirmware)</p>
<p><code>Snnn</code> Active temperature(s) (RepRapFirmware)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G10 L1 P2 X17.8 Y-19.3 Z0.0</span><br></pre></td></tr></table></figure>

<p>(sets the offset for tool 2 to the X, Y, and Z values specified)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G10 P1 R140 S205</span><br></pre></td></tr></table></figure>

<p>(RepRapFirmware only - set standby and active temperatures<sup>3</sup> for tool 1)</p>
<p>Remember that any parameter that you don’t specify will automatically be set to the last value for that parameter. That usually means that you want explicitly to set Z0.0. RepRapFirmware will report the tool parameters if only the tool number is specified.</p>
<p>The precise meaning of the X, Y (and other offset) values is: <em>with no offset this tool is at this position relative to where a tool with offset (0, 0, 0) would be</em>. So if the tool is 10mm to the left of a zero-offset tool the X value would be -10, and so on.</p>
<p>The <code>R</code> value is the standby temperature in <sup>o</sup>C that will be used for the tool, and the <code>S</code> value is its operating temperature. If you don’t want the tool to be at a different temperature when not in use, set both values the same. See the <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#T:_Select_Tool" title="G-code">T code (select tool)</a> below. In tools with multiple heaters the temperatures for them all are specified thus: R100.0:90.0:20.0 S185.0:200.0:150.0 .</p>
<p>See also <code>M585</code>.</p>
<p>Notes</p>
<p><sup>1</sup>Marlin uses <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G10:_Retract" title="G-code">G10</a>&#x2F;<a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G11:_Unretract" title="G-code">G11</a> for executing a retraction&#x2F;unretraction move. Smoothie uses <code>G10</code> for retract and <code>G10 Ln</code> for setting workspace coordinates. RepRapFirmware interprets a G10 command with no P or L parameter as a retraction command.</p>
<p><sup>2</sup>It’s usually a bad idea to put a non-zero <code>Z</code> value in as well unless the tools are loaded and unloaded by some sort of tool changer or are on indepedent carriages. When all the tools are in the machine at once they should all be set to the same Z height.</p>
<p><sup>3</sup>If the absolute zero temperature (-273.15) is passed as active and standby temperatures, RepRapFirmware will only switch off the tool heater(s) without changing their preset active or standby temperatures. RepRapFirmware-dc42 does not support this setting.</p>
<p><sup>4</sup>Tool offsets are applied after any X axis mapping has been performed. Therefore if for example you map X to U in your <code>M563</code> command to create the tool, you should specify a U offset not an X offset. If you map X to both X and U, you can specify both offsets. (Not supported on all firmwares).</p>
<p><sup>5</sup>L1 sets the offsets of the specified tool relative to the head reference point to the specified values. L2 sets the current workplace coordinate offsets to the specified values. L20 adjusts the current workplace coordinate offsets so that the current tool head position has the specified coordinates. NOTE on some firmwares L is required (and is required by NIST standard). P is also required to specify either the tool to update or the WCS to update.</p>
<h4 id="G10-Retract"><a href="#G10-Retract" class="headerlink" title="G10: Retract"></a>G10: Retract</h4><p>Parameters</p>
<p><code>Snnn</code> retract length (S1 &#x3D; long retract, S0 &#x3D; short retract &#x3D; default) (Repetier only)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G10</span><br></pre></td></tr></table></figure>

<p>Retracts filament according to settings of <code>M207</code> (Marlin, RepRapFirmware) or according to the <code>S</code> value (Repetier).</p>
<p>RepRapFirmware recognizes <code>G10</code> as a command to set tool offsets and&#x2F;or temperatures if the <code>P</code> parameter is present, and as a retraction command if it is absent.</p>
<h4 id="G11-Unretract"><a href="#G11-Unretract" class="headerlink" title="G11: Unretract"></a>G11: Unretract</h4><p>Parameters</p>
<p><code>Snnn</code> retract length (S1 &#x3D; long retract, S0 &#x3D; short retract &#x3D; default) (Repetier only)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G11</span><br></pre></td></tr></table></figure>

<p>Unretracts&#x2F;recovers filament according to settings of <code>M208</code> (Marlin, RepRapFirmware) or according to the <code>S</code> value (Repetier).</p>
<h4 id="G12-Clean-Tool"><a href="#G12-Clean-Tool" class="headerlink" title="G12: Clean Tool"></a>G12: Clean Tool</h4><p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[P&lt;0|1&gt;] [S&lt;count&gt;] [T&lt;count&gt;]</span><br></pre></td></tr></table></figure>

<p><code>G12 Pnnn Snnn Tnnn </code></p>
<p>Parameters</p>
<p><code>Pnnn</code><sup>1</sup> Pattern style selection</p>
<p><code>Snnn</code> Number of strokes (i.e. back-and-forth movements)</p>
<p><code>Tnnn</code> Number of repetitions</p>
<p><code>Ennn</code> 0&#x3D;Never 1&#x3D;Always apply software endstops (Marlin 2.0.6+)</p>
<p>Examples</p>
<p>G12 ; stroke pattern (default)</p>
<p>To generate a three triangle zig-zag pattern which will be stroked three times time use the following command. G12 P1 S3 T2 ; zig-zag pattern with 2 triangles</p>
<p>Notes</p>
<p><sup>1</sup>In Marlin firmware and Derivatives Mk4duo this is implemented by hard-coded firmware behaviours As defined for variables NOZZLE_CLEAN_STROKES, NOZZLE_CLEAN_START_POINT, NOZZLE_CLEAN_END_POINT and NOZZLE_CLEAN_PARK.</p>
<p>With NOZZLE_CLEAN_PARK enabled, the nozzle will automatically return to the XYZ position after G12 is run.</p>
<p>More on this behaviour is documented inside of the code base.</p>
<p>The use of G12 for tool cleaning clashes with the established use of G12 for circular pocket milling on CNC machines. For this reason, RepRapFirmware does not support G12.</p>
<h4 id="G17-19-Plane-Selection-CNC-specific"><a href="#G17-19-Plane-Selection-CNC-specific" class="headerlink" title="G17..19: Plane Selection (CNC specific)"></a>G17..19: Plane Selection (CNC specific)</h4><p>These codes set the current plane as follows:</p>
<ul>
<li><code>G17</code> : XY (default)</li>
<li><code>G18</code> : ZX</li>
<li><code>G19</code> : YZ</li>
</ul>
<p>This mode applies to <code>G2</code>&#x2F;<code>G3</code> arc moves. Normal arc moves are in the XY plane, and for most applications that’s all you need. For CNC routing it can be useful to do small “digging” moves while making cuts, so to keep the G-code compact it uses <code>G2</code>&#x2F;<code>G3</code> arcs involving the Z plane.</p>
<p>These commands are supported in Marlin 1.1.4 and later with <code>ARC_SUPPORT</code> and <code>CNC_WORKSPACE_PLANES</code> enabled.</p>
<h4 id="G20-Set-Units-to-Inches"><a href="#G20-Set-Units-to-Inches" class="headerlink" title="G20: Set Units to Inches"></a>G20: Set Units to Inches</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G20</span><br></pre></td></tr></table></figure>

<p>Units from now on are in inches. In RepRapFirmware, the inches&#x2F;mm setting applies to regular printing and travel moves (G0, G1, G2 etc.) but not to configuration commands. Therefore configuration should be done in mm.</p>
<p>When executing a macro file, RepRapFirmware remembers the initial inches&#x2F;mm setting and restores it after execution of the macro has completed.</p>
<h4 id="G21-Set-Units-to-Millimeters"><a href="#G21-Set-Units-to-Millimeters" class="headerlink" title="G21: Set Units to Millimeters"></a>G21: Set Units to Millimeters</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G21</span><br></pre></td></tr></table></figure>

<p>Units from now on are in millimeters. (This is the RepRap default.)</p>
<p>In RepRapFirmware, the inches&#x2F;mm setting applies to regular printing and travel moves (G0, G1, G2 etc.) but not to configuration commands. Therefore configuration should be done in mm.</p>
<p>When executing a macro file, RepRapFirmware remembers the initial inches&#x2F;mm setting and restores it after execution of the macro has completed. So a macro file such as pause.g (executed when a pause command is received) can safely use G21 at the start to switch the units to mm without affecting the job after the macro completes, regardless of whether the job was using inches or mm.</p>
<h4 id="G22-Firmware-Retract"><a href="#G22-Firmware-Retract" class="headerlink" title="G22: Firmware Retract"></a>G22: Firmware Retract</h4><p>Usage</p>
<p><code>G22 ; Do a retract move</code></p>
<p>Use this command (along with <code>G23</code>) to have the firmware to do retraction moves (in contrast to generating an E axis <code>G1</code> move). The retract length and speed are set in the firmware.</p>
<h4 id="G23-Firmware-Recover"><a href="#G23-Firmware-Recover" class="headerlink" title="G23: Firmware Recover"></a>G23: Firmware Recover</h4><p>Usage</p>
<p><code>G23 ; Do a recover move</code></p>
<p>Use this command (along with <code>G22</code>) to have the firmware to do a recover move. The recover length and speed are set in the firmware.</p>
<h4 id="G26-Mesh-Validation-Pattern"><a href="#G26-Mesh-Validation-Pattern" class="headerlink" title="G26: Mesh Validation Pattern"></a>G26: Mesh Validation Pattern</h4><p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G26 C P O2.25 ; Do a typical test sequence</span><br></pre></td></tr></table></figure>

<p>The <code>G26</code> Mesh Validation Pattern is designed to be used in conjunction with various Mesh Bed Leveling systems – those that adjust for an uneven —rather than just tilted— bed. The <code>G26</code> command prints a single layer pattern over the entire print bed, giving a clear indication of how accurately every mesh point is defined. <code>G26</code> can be used to determine which areas of the mesh are less-than-perfect and how much to adjust each mesh point.</p>
<p><code>G26</code> has large feature list, including a built-in test that extrudes material onto the bed. By default this is configured for PLA temperatures and a nozzle size of 0.4mm. (This will be adjustable in an upcoming version of Marlin.)</p>
<p>See the <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/MarlinFirmware/Marlin/1.1.x/Marlin/G26_Mesh_Validation_Tool.cpp"><code>G26_Mesh_Validation_Tool.cpp</code> file</a> in the Marlin source code for full documentation of the <code>G26</code> parameter list.</p>
<h4 id="G27-Park-toolhead"><a href="#G27-Park-toolhead" class="headerlink" title="G27: Park toolhead"></a>G27: Park toolhead</h4><p>Park the toolhead (i.e., nozzle) at a predefined XY position, with a Z raise value that applies over 0 or over the current position depending on the <code>P</code> parameter.</p>
<p>In Marlin this G-code is enabled by <code>NOZZLE_PARK_FEATURE</code> and the park position is defined by <code>NOZZLE_PARK_POINT</code>. See <a target="_blank" rel="noopener" href="https://marlinfw.org/docs/gcode/G027.html">G27 Park Toolhead</a> for details.</p>
<p>Usage</p>
<p><code>G27 Xnnn Ynnn Znnn Pn</code></p>
<p>Parameters</p>
<p><em>Not all parameters need to be used, but at least <strong>one</strong> has to be used</em></p>
<p><code>Xnnn</code> X park position <sup>1</sup></p>
<p><code>Ynnn</code> Y park position <sup>1</sup></p>
<p><code>Znnn</code> Z park position <sup>1</sup></p>
<p><code>Pn</code> [value] Z action</p>
<p><code>0</code> (Default) Relative raise by NOZZLE_PARK_Z_RAISE_MIN before XY parking</p>
<p><code>1</code> (Default) Absolute move to NOZZLE_PARK_POINT.z before XY parking. This may move the nozzle down, so use with caution!</p>
<p><code>2</code> Relative raise by NOZZLE_PARK_POINT.z before XY parking.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G27 P0 ; Park, raising Z by NOZZLE_PARK_Z_RAISE_MIN, using NOZZLE_PARK_POINT.z as a safe height over 0</span><br><span class="line">G27 P1 ; Park, raising Z to at least NOZZLE_PARK_POINT.z over 0</span><br><span class="line">G27 P2 ; Park, raising Z by NOZZLE_PARK_POINT.z over the current Z</span><br></pre></td></tr></table></figure>

<h4 id="G28-Move-to-Origin-Home"><a href="#G28-Move-to-Origin-Home" class="headerlink" title="G28: Move to Origin (Home)"></a>G28: Move to Origin (Home)</h4><p>Usage</p>
<p><code>G28 Xnnn Ynnn Znnn I N O P Rnnn S W C</code></p>
<p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>X</code> Flag to go back to the X axis origin</p>
<p><code>Y</code> Flag to go back to the Y axis origin</p>
<p><code>Z</code> Flag to go back to the Z axis origin</p>
<p><code>I</code> imprecise: do not perform precise refinement <sup>3</sup></p>
<p><code>L</code> Force leveling state ON (if possible) or OFF after homing (Requires RESTORE_LEVELING_AFTER_G28 or ENABLE_LEVELING_AFTER_G28) <sup>3</sup></p>
<p><code>N</code> No-change mode (do not change any motion setting such as feedrate) <sup>3</sup></p>
<p><code>O</code> Home only if the position is not known and trusted <sup>3</sup></p>
<p><code>P</code> Do not check print sheet presence <sup>3</sup></p>
<p><code>R</code> <linear> Raise by n mm&#x2F;inches before homing <sup>3</sup></p>
<p><code>S</code> Simulated homing only in MARLIN_DEV_MODE <sup>3</sup></p>
<p><code>W</code> Suppress mesh bed leveling if `X`, `Y` or `Z` are not provided <sup>2</sup></p>
<p><code>C</code> Calibrate X and Y origin (home) - Only on MK3&#x2F;s <sup>2</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G28     ; Home all axes (On Prusa i3 MK2/s,MK2.5/s,MK3/s it will also perform mesh bed leveling)2</span><br><span class="line">G28 X Z ; Home the X and Z axes</span><br></pre></td></tr></table></figure>

<p>When the firmware receives this command, it quickly moves the specified axes (or all axes if none are given) to the endstops, backs away from each endstop by a short distance, and slowly bumps the endstop again to increase positional accuracy. This process, known as “<em>Homing</em>“, is required to determine the position of the print carriage(s). Some firmware may even forbid movement away from endstops and other operations until the axes have been homed.</p>
<p>The <code>X</code>, <code>Y</code>, and <code>Z</code> parameters act only as flags. Any coordinates given are ignored. For example, <code>G28 Z10</code> results in the same behavior as <code>G28 Z</code>. Delta printers cannot home individual axes, but must always home all three towers, so the <code>X Y Z</code> parameters are simply ignored on these machines.</p>
<p>Marlin firmware (version 1.1.0 and later) provides an option called <code>Z_SAFE_HOMING</code> for printers that use a Z probe to home Z instead of an endstop. With this option, the XY axes are homed first, then the carriage moves to a position –usually the middle of the bed– where it can safely probe downward to home Z.</p>
<p>RepRapFirmware uses macro files to home either all axes or individual axes. If all axes are homed, the file <code>homeall.g</code> is processed. For individual axes the <code>homex.g</code>, <code>homey.g</code>, or <code>homez.g</code> file will be used. On Delta printers, <code>G28</code> command will always home all three towers by processing the <code>homedelta.g</code> file, regardless of any <code>X</code> <code>Y</code> <code>Z</code> parameters.</p>
<p>Because the behavior of <code>G28</code> is unspecified, it is recommended <strong>not</strong> to automatically include <code>G28</code> in your ending G-code. On a Cartesian this will result in damaging the printed object. If you need to move the carriage at the completion of a print, use <code>G0</code> or <code>G1</code>.</p>
<p>Notes</p>
<p><sup>1</sup> MK4duo has a <code>B</code> parameter that tells the printer to return to the coordinates it was at before homing.<br><sup>2</sup> Original Prusa i3 MK2&#x2F;s, MK2.5&#x2F;s, MK3&#x2F;s supports a <code>W</code> parameter to suppress mesh bed leveling. If <code>W</code> is omitted, G28 will home only and NOT perform mesh bed leveling. Original Prusa i3 MK3&#x2F;s (TMC2130 drivers) supports a <code>C</code> parameter to calibrate the X and Y home position.</p>
<p><code>W</code> Suppress mesh bed leveling (Prusa MK2&#x2F;s, MK2.5&#x2F;s and MK3&#x2F;s only)<sup>2</sup></p>
<p><code>C</code> Calibrate X and Y home position (Prusa MK3&#x2F;s only)<sup>2</sup></p>
<h4 id="G29-Detailed-Z-Probe"><a href="#G29-Detailed-Z-Probe" class="headerlink" title="G29: Detailed Z-Probe"></a>G29: Detailed Z-Probe</h4><p>This command uses a probe to measure the bed height at 3 or more points to determine its tilt and overall flatness. It then enables compensation so that the nozzle will remain parallel to the bed. The printer must be homed with <code>G28</code> before using this command.</p>
<p>Each firmware behaves differently and depends on the type of bed leveling that’s been configured. For example, Marlin 1.0.2 provides 3 different types of automatic bed leveling (probe required) and a manual bed leveling option. See your firmware’s documentation for the specific options available.</p>
<p>Usage</p>
<p><code>G29</code></p>
<p><code>G29 Snnn</code></p>
<p>Parameters</p>
<p><code>Snnn</code> Firmware-dependent behavior</p>
<p><code>Pfile.csv</code> Optional file name for bed height map file (RepRapFirmware only)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G29    ; Probe the bed and enable compensation</span><br><span class="line">G29 S2 ; Special operation - see below</span><br><span class="line">G29 P1 ; UBL automated probe - see below</span><br></pre></td></tr></table></figure>

<h5 id="G29-Auto-Bed-Leveling-Marlin-MK4duo"><a href="#G29-Auto-Bed-Leveling-Marlin-MK4duo" class="headerlink" title="G29 Auto Bed Leveling (Marlin - MK4duo)"></a>G29 Auto Bed Leveling (Marlin - MK4duo)</h5><p>Marlin 1.0.2 and earlier provides three options for automatic bed leveling:</p>
<ul>
<li>The 3-point method probes the bed at three points to produce a matrix, adjusting for a flat but tilted bed.</li>
<li>The planar grid method (non-Delta) probes a grid pattern to produce a matrix by the “least-squares” method, adjusting for a flat but tilted bed.</li>
<li>The bilinear grid method (Delta only) probes a grid pattern to produce a mesh, using bilinear interpolation to adjust for an uneven bed.</li>
</ul>
<p>Marlin 1.1.0 and later allows the bilinear grid (i.e., “mesh”) method to be used on all types of machines, not just deltas. <em><strong>This is the recommended leveling method going forward.</strong></em></p>
<p>Also in Marlin 1.1.0 and later, the <code>PROBE_MANUALLY</code> option allows all forms of Auto Bed Leveling to be used without a probe. The procedure is similar to that of <code>MESH_BED_LEVELING</code> (see below). Begin the process with <code>G29</code> to move the nozzle to the first point. Adjust the Z axis using <code>G1</code> or your host software. Send <code>G29</code> again to move to the next point and repeat until all points have been sampled.</p>
<p>Parameters</p>
<p><code>P</code> Set the size of the grid that will be probed (P x P points). Not supported by non-linear delta printer bed leveling. Example: <code>G29 P4</code></p>
<p><code>S</code> Set the XY travel speed between probe points (in units&#x2F;min)</p>
<p><code>D</code> Dry-Run mode. Just evaluate the bed Topology - Don’t apply or clean the rotation Matrix. Useful to check the topology after a first run of G29.</p>
<p><code>V</code> Set the verbose level (0-4). Example: <code>G29 V3</code></p>
<p><code>T</code> Generate a Bed Topology Report. Example: <code>G29 P5 T</code> for a detailed report. This is useful for manual bed leveling and finding flaws in the bed (to assist with part placement). Not supported by non-linear delta printer bed leveling.</p>
<p><code>F</code> Set the Front limit of the probing grid</p>
<p><code>B</code> Set the Back limit of the probing grid</p>
<p><code>L</code> Set the Left limit of the probing grid</p>
<p><code>R</code> Set the Right limit of the probing grid</p>
<p>Global Parameters</p>
<p><code>E</code> By default <code>G29</code> will engage the Z probe, test the bed, then disengage. Include <code>E</code> or <code>E1</code> to engage&#x2F;disengage the Z probe for each sample. (This has no effect for fixed probes.)</p>
<h5 id="G29-Unified-Bed-Leveling-Marlin-MK4duo"><a href="#G29-Unified-Bed-Leveling-Marlin-MK4duo" class="headerlink" title="G29 Unified Bed Leveling (Marlin - MK4duo)"></a>G29 Unified Bed Leveling (Marlin - MK4duo)</h5><p>Marlin firmware (version 1.1.0 and later) includes the <code>AUTO_BED_LEVELING_UBL</code> option for Unified Bed Leveling. UBL combines mesh leveling, tilted plane adjustment, 3-point leveling, and manual editing tools all together in a single package. To accomplish so much, UBL overloads `G29` with several new parameters and provides an additional <code>G26</code> Mesh Tuning feature.</p>
<p>See the MarlinFW website for a dedicated <a target="_blank" rel="noopener" href="http://marlinfw.org/docs/features/unified_bed_leveling.html">Unified Bed Leveling page</a> and complete documentation on <a target="_blank" rel="noopener" href="http://marlinfw.org/docs/gcode/G029-ubl.html">`G29` for UBL</a> and <a target="_blank" rel="noopener" href="http://marlinfw.org/docs/gcode/G026.html">`G26` Mesh Validation</a>.</p>
<p>G29 UBL Parameters (synopsis)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">A     Activate   Activate the Unified Bed Leveling system. (i.e., M420 S1)</span><br><span class="line">D     Disable    Disable the Unified Bed Leveling system. (i.e., M420 S0)</span><br><span class="line"></span><br><span class="line">B#    Business   Do Manual Probing in &#x27;Business Card&#x27; mode.</span><br><span class="line">H#    Height     Height to raise the nozzle after each Manual Probe of the bed.</span><br><span class="line"></span><br><span class="line">C     Continue   Continue, Constant, or Current Location, depending on Phase.</span><br><span class="line">E     Every      Stow the probe after every sampled point.</span><br><span class="line">F#    Fade       Fade leveling compensation gradually, until it ceases at the given height.</span><br><span class="line">I#    Invalidate Invalidate a specified number of Mesh Points (X and Y).</span><br><span class="line">J#    Grid       Do a grid (planar) leveling of the current Mesh using a grid with n points on a side.</span><br><span class="line">K#    Kompare    Compare (diff) current Mesh with stored Mesh #, replacing current Mesh with the result.</span><br><span class="line"></span><br><span class="line">L     Load       Load Mesh from the previously activated location in the EEPROM.</span><br><span class="line">L#    Load       Load Mesh from the specified location in the EEPROM.</span><br><span class="line">S     Store      Store the current Mesh in the Activated area of the EEPROM. Also save all settings.</span><br><span class="line">S #   Store      Store the current Mesh at the specified area in EEPROM, set as the Activated area.</span><br><span class="line">S -1  Store      Store the current Mesh as a print-out suitable to be fed back into the system.</span><br><span class="line"></span><br><span class="line">O     Map        Display the Mesh Map Topology.</span><br><span class="line"></span><br><span class="line">P0    Phase 0    Zero Mesh Data and turn off the Mesh Compensation System.</span><br><span class="line">P1    Phase 1    Invalidate the Mesh and do Automatic Probing to generate new Mesh data.</span><br><span class="line">P2    Phase 2    Probe unpopulated areas of the Mesh (those that couldn&#x27;t be auto-probed).</span><br><span class="line">P3    Phase 3    Fill unpopulated Mesh points with a fixed value. No &#x27;C&#x27; for &quot;smart fill&quot; extrapolation.</span><br><span class="line">P4    Phase 4    Fine tune the Mesh. ** Delta Mesh Compensation requires an LCD panel. **</span><br><span class="line">P5    Phase 5    Find Mean Mesh Height and Standard Deviation.</span><br><span class="line">P6    Phase 6    Shift Mesh height. All Mesh points are adjusted by the amount specified with &#x27;C&#x27;.</span><br><span class="line"></span><br><span class="line">Q     Test       Load specified Test Pattern to help check system operation.</span><br><span class="line"></span><br><span class="line">R #   Repeat     Repeat the command the specified number of times. Default: grid points X * Y.</span><br><span class="line"></span><br><span class="line">T     3-Point    Perform a 3-Point Bed Leveling on the current Mesh.</span><br><span class="line"></span><br><span class="line">U     Unlevel    Perform a probe of the outer perimeter to assist in physically leveling the bed.</span><br><span class="line"></span><br><span class="line">W     What?      Print a report of Unified Bed Leveling stored data.</span><br><span class="line"></span><br><span class="line">X #              The X location for the command</span><br><span class="line">Y #              The Y location for the command</span><br><span class="line"></span><br><span class="line">Z     Zero       Do a single probe to set the Z Height of the nozzle.</span><br><span class="line">Z #   Zero       Raise/lower the entire Mesh to conform with the specified difference (plus zprobe_zoffset).</span><br></pre></td></tr></table></figure>

<h5 id="G29-Manual-Bed-Leveling-Marlin-MK4duo"><a href="#G29-Manual-Bed-Leveling-Marlin-MK4duo" class="headerlink" title="G29 Manual Bed Leveling (Marlin - MK4duo)"></a>G29 Manual Bed Leveling (Marlin - MK4duo)</h5><p>Marlin firmware (version 1.0.2 and later) also provides a <code>MESH_BED_LEVELING</code> feature that can be used to perform bed leveling on machines lacking a probe. This form of bed leveling compensates for uneven Z height across the surface of the bed using a mesh and bilinear interpolation.</p>
<p>Manual Bed Leveling Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G29 S1 ; Move to the first point and wait for a measurement</span><br><span class="line">G29 S2 ; Store the current Z, move to the next point</span><br><span class="line">G29 S3 Xn Yn Zn.nn ; Modify the Z height of a single point</span><br></pre></td></tr></table></figure>

<p>Options for the <code>S</code> parameter</p>
<p><code>S0</code> Produces a mesh report</p>
<p><code>S1</code> Start probing mesh points</p>
<p><code>S2</code> Probe the next mesh point</p>
<p><code>S3 Xn Yn Zn.nn</code> Manually modify a single point</p>
<p><code>S4 Zn.nn</code> Set z offset. Positive away from bed, negative closer to bed.</p>
<h5 id="G29-Auto-Bed-Leveling-Repetier-Firmware"><a href="#G29-Auto-Bed-Leveling-Repetier-Firmware" class="headerlink" title="G29 Auto Bed Leveling (Repetier-Firmware)"></a>G29 Auto Bed Leveling (Repetier-Firmware)</h5><p>Repetier firmware since v0.91 supports <code>G29</code> with the optional Snnn parameter as described below. Useful to simply detect the Z bed angle so you can manually readjust your bed and get it as close to in plane as possible. If you wish to apply automatic software Z plane compensation on Repetier, use <code>G32</code> instead with firmware 0.92.8 and above.</p>
<p><code>S0</code> Default value. Z bed heights are calculated at the measured points, relative to current Z position before issuing <code>G29</code>.</p>
<p><code>S1</code> Same as <code>S0</code>, except printer immediately moves to Z maximum position (Z max endstop required!), and calculates new Z maximum height. You must first issue <code>G28 Z</code> to home to Z maximum position before issuing <code>G29 Snnn</code> for this to work correctly, or the printer height will be invalid.</p>
<p><code>S2</code> Same as <code>S1</code>, except new calculated Z height is also stored to EEPROM.</p>
<h5 id="G29-Mesh-Bed-Compensation-RepRapFirmware"><a href="#G29-Mesh-Bed-Compensation-RepRapFirmware" class="headerlink" title="G29 Mesh Bed Compensation (RepRapFirmware)"></a>G29 Mesh Bed Compensation (RepRapFirmware)</h5><p>RepRapFirmware:</p>
<p><code>S0</code> (default if no <code>S</code> parameter) Probe the bed, save the height map in a file on the SD card, and activate the height map. The default folder for the height map file is <code>/sys</code> and the default file name is <code>heightmap.csv</code>.</p>
<p><code>S1</code> Load the height map from file and activate bed compensation. The default folder and filename as for <code>S0</code>.</p>
<p><code>S2</code> Clear the currently-loaded bed height map</p>
<p>To define the grid, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M557:_Set_Z_probe_point_or_define_probing_grid" title="G-code">M557</a>.</p>
<p>In RepRapFirmware 3.2 and later, G29 runs macro file mesh.g if it exists, otherwise it behaves like G29 S0. The mesh.g file can perform other actions (e.g. homing or tool selection) and then use G29 S0 to do the probing.</p>
<p>Notes</p>
<p>In Prusa Firmware <code>G29</code> is not active by default, instead <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G81:_Mesh_bed_leveling_status" title="G-code">G81</a> is used.<sup>1</sup></p>
<h4 id="G29-1-Set-Z-probe-head-offset"><a href="#G29-1-Set-Z-probe-head-offset" class="headerlink" title="G29.1: Set Z probe head offset"></a>G29.1: Set Z probe head offset</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G29.1 X30 Y20 Z0.5</span><br></pre></td></tr></table></figure>

<p>Set the offset of the Z probe head. The offset will be subtracted from all probe moves.</p>
<h4 id="G29-2-Set-Z-probe-head-offset-calculated-from-toolhead-position"><a href="#G29-2-Set-Z-probe-head-offset-calculated-from-toolhead-position" class="headerlink" title="G29.2: Set Z probe head offset calculated from toolhead position"></a>G29.2: Set Z probe head offset calculated from toolhead position</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G29.2 Z0.0</span><br></pre></td></tr></table></figure>

<p>Set the offset of the Z probe head. The offset will be subtracted from all probe moves. The calculated value is derived from the distance of the toolhead from the current axis zero point.</p>
<p>The user would typically place the toolhead at the zero point of the axis and issue the <code>G29.2</code> command.</p>
<h4 id="G30-Single-Z-Probe"><a href="#G30-Single-Z-Probe" class="headerlink" title="G30: Single Z-Probe"></a>G30: Single Z-Probe</h4><p>Usage</p>
<p><code>G30 Pnnn Xnnn Ynnn Znnn Hnnn Snnn</code></p>
<p>Parameters</p>
<p><code>Pnnn</code> Probe point number</p>
<p><code>Xnnn</code> X coordinate</p>
<p><code>Ynnn</code> Y coordinate</p>
<p><code>Znnn</code> Z coordinate</p>
<p><code>Hnnn</code> Height correction</p>
<p><code>Snnn</code> Set parameter</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G30</span><br></pre></td></tr></table></figure>

<p>Examples (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">G30                          ; Probe the bed at the current XY position. When the probe is triggered, set the Z coordinate to the probe trigger height.</span><br><span class="line">G30 S-1                      ; Probe the bed at the current XY position. When the probe is triggered, do not adjust the Z coordinate.</span><br><span class="line">G30 P0 X20 Y50 Z-99999       ; Probe the bed at X20 Y50 and save the XY coordinates and the height error as point 0</span><br><span class="line">G30 P3 X180 Y180 Z-99999 S4  ; Probe the bed at X180 Y180, save the XY coordinates and the height error as point 3 and calculate 4-point compensation or calibration</span><br><span class="line">G30 P3 X180 Y180 Z-99999 S-1 ; As previous example but just report the height errors</span><br></pre></td></tr></table></figure>

<p>In its simplest form probes bed at current XY location.</p>
<p>RepRapFirmware supports additional behaviour: if a <code>Pn</code> field is specified the probed <code>X</code>, <code>Y</code>, and <code>Z</code> values are saved as point n on the bed for calculating the offset plane or for performing delta printer calibration. If <code>X</code>, <code>Y</code>, or <code>Z</code> values are specified (e.g. <code>G30 P1 X20 Y50 Z0.3</code>) then those values are used instead of the machine’s current coordinates. A silly <code>Z</code> value (less than -9999.0) causes the machine to probe at the current point to get Z, rather than using the given value. If an S field is specified (e.g. <code>G30 P1 Z0.3 S</code>) the bed plane is computed for compensation and stored. The combination of these options allows for the machine to be moved to points using <code>G1</code> commands, and then probe the bed, or for the user to position the nozzle interactively and use those coordinates. The user can also record those values and place them in a setup G-code file for automatic execution.</p>
<p>RepRapFirmware uses the value of the <code>S</code> parameter to specify what computation to perform. If the value is -1 then the Z offsets of all the points probed are printed, but no calibration is done. If the value is zero or not present, then this specifies that the number of factors to be calibrated is the same as the number of points probed. Otherwise, the value indicates the number of factors to be calibrated, which must be no greater than the number of points probed. In version 1.09, the number of factors may be 3, 4 or 5 when doing auto bed compensation on a Cartesian or CoreXY printer, and 3, 4, 6 or 7 when doing auto calibration of a Delta printer.</p>
<p>RepRapFirmware supports an optional <code>H</code> parameter, which is a height correction for that probe point. It allows for the Z probe having a trigger height that varies with XY position. The nominal trigger height of the Z probe (e.g. at bed centre) is declared in the <code>Z</code> parameter of the <code>G31</code> command in the config.g file. When you probe using <code>G30</code> and the probe triggers, the firmware will assume that the nozzle is at the nominal trigger height plus the value you have in the <code>H</code> parameter.</p>
<p><sup>1</sup>MK4duo Firmware support an optional parameter for Delta.</p>
<p>Usage</p>
<p><code>G30 Xnnn Ynnn S Z P</code></p>
<p>Parameters</p>
<p><code>Xnnn</code> X coordinate</p>
<p><code>Ynnn</code> Y coordinate</p>
<p><code>Sn</code> Stows the probe if 1 (default&#x3D;1)</p>
<p><code>Zn</code> <bool> with a non-zero value will apply the result to current delta_height</p>
<p><code>Pn</code> <bool> with a non-zero value will apply the result to current zprobe_zoffset</p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>2</sup></p>
<h4 id="G31-Set-or-Report-Current-Probe-status"><a href="#G31-Set-or-Report-Current-Probe-status" class="headerlink" title="G31: Set or Report Current Probe status"></a>G31: Set or Report Current Probe status</h4><p>Usage</p>
<p><code>G31 Pnnn Xnnn Ynnn Znnn Cnnn Snnn</code></p>
<p>Parameters</p>
<p><code>Pnnn</code> Trigger value</p>
<p><code>Xnnn</code> Probe X offset<sup>1</sup></p>
<p><code>Ynnn</code> Probe Y offset<sup>1</sup></p>
<p><code>Znnn</code> Trigger Z height</p>
<p><code>Cnnn</code> Temperature coefficient(s) of trigger height<sup>2</sup></p>
<p><code>Snnn</code> Calibration temperature<sup>2</sup></p>
<p><code>Tnnn</code> (RepRapFirmware 1.17 and later) Z probe type to which these parameters apply, defaults to the current Z probe type as defined by <code>M558 P</code> parameter</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G31 P500 Z2.6</span><br><span class="line">G31 X16.0 Y1.5</span><br></pre></td></tr></table></figure>

<p>When used on its own this reports whether the Z probe is triggered, or gives the Z probe value in some units if the probe generates height values. If combined with a Z and P field (example: <code>G31 P312 Z0.7</code>) this will set the Z height to 0.7mm when the Z-probe value reaches 312 when a <code>G28 Z0</code> (zero Z axis) command is sent. The machine will then move a further -0.7mm in Z to place itself at Z &#x3D; 0. This allows non-contact measuring probes to approach but not touch the bed, and for the gap left to be allowed for. If the probe is a touch probe and generates a simple 0&#x2F;1 off&#x2F;on signal, then <code>G31 Z0.7</code> will tell the RepRap machine that it is at a height of 0.7mm when the probe is triggered.</p>
<p>In RepRapFirmware, separate <code>G31</code> parameters may be defined for different probe types (i.e. 0+4 for switches, 1+2 for IR probes and 3 for alternative sensors). To specify which probe you are setting parameters for, send a <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M558:_Set_Z_probe_type" title="G-code">M558</a> command to select the probe type before sending the <code>G31</code> command, or use the <code>T</code> parameter.</p>
<p>In Repetier, <code>G31</code> supports no parameters and simply prints the high&#x2F;low status of the Z probe.</p>
<p>Notes</p>
<p><sup>1</sup>X and Y offsets of the Z probe relative to the print head (i.e. the position when the empty tool is selected) can be specified in RepRapFirmware. This allows you to calculate your probe coordinates based on the geometry of the bed, without having to correct them for Z probe X and Y offset.</p>
<p><sup>2</sup>In RepRapFirmware, additional parameters ‘S’ (bed temperature in <sup>o</sup>C at which the specified <code>Z</code> parameter is correct, default is current bed temperature) and ‘C’ (temperature coefficient of <code>Z</code> parameter in mm&#x2F;<sup>o</sup>C, default zero) can be set for the alternative (ultrasonic) sensor. This is useful for probes that are affected by temperature such as PINDA. RepRapFirmware 3.1 and later allow both first and second order temperature coefficients to be specified, e.g. C0.015:0.001.</p>
<h4 id="G31-Dock-Z-Probe-sled"><a href="#G31-Dock-Z-Probe-sled" class="headerlink" title="G31: Dock Z Probe sled"></a>G31: Dock Z Probe sled</h4><p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G32-Probe-Z-and-calculate-Z-plane"><a href="#G32-Probe-Z-and-calculate-Z-plane" class="headerlink" title="G32: Probe Z and calculate Z plane"></a>G32: Probe Z and calculate Z plane</h4><p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G32           ; Probe and calculate</span><br><span class="line">G32 Snnn      ; Each firmware has its own parameters</span><br><span class="line">G32 Snnn Pnnn ; Refer to their specific documentation</span><br></pre></td></tr></table></figure>

<p>This command is implemented as a more sophisticated form of bed leveling (which uses a transformation matrix or motorized correction. Smoothieware uses this code instead of <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#G29:_Detailed_Z-Probe">`G29`</a>.</p>
<p>Each firmware behaves differently. For example, Repetier firmware allows for motorized rotation of the bed whilst ReprapFirmware probes the bed with a transformation matrix.</p>
<h5 id="Probe-and-calculate-in-Reprapfirmware"><a href="#Probe-and-calculate-in-Reprapfirmware" class="headerlink" title="Probe and calculate in Reprapfirmware"></a>Probe and calculate in Reprapfirmware</h5><p>RepRapFirmware executes macro file <code>bed.g</code> in response to the G31 command. The <code>bed.g</code> file is typically used to probe the bed and then perform delta calibration if the printer is a delta, or to perform individual leadscrew adjustment to level the bed if the printer has multiple independently-controlled Z motors, or to advise the user on how much to adjust each bed levelling adjustment screw.</p>
<h5 id="Probe-and-calculate-in-Repetier-firmware"><a href="#Probe-and-calculate-in-Repetier-firmware" class="headerlink" title="Probe and calculate in Repetier firmware"></a>Probe and calculate in Repetier firmware</h5><p>This command probes the bed at 3 or more pre-defined points and implements bed leveling compensation by either moving the A axis during printing (as with regular bed leveling, <code>G29</code>) or by tilting the bed with motors.</p>
<p>Parameters</p>
<p><code>Snnn</code> Bed leveling method</p>
<p><code>Pnnn</code> Bed correction method</p>
<p>The values for Snnn and Pnnn are as follows:</p>
<p><code>S0</code> This method measures at the 3 probe points and creates a plane through these points. If you have a really planar bed this gives the optimum result. The 3 points must not be in one line and have a long distance to increase numerical stability.</p>
<p><code>S1</code> This measures a grid. Probe point 1 is the origin and points 2 and 3 span a grid. We measure BED_LEVELING_GRID_SIZE points in each direction and compute a regression plane through all points. This gives a good overall plane if you have small bumps measuring inaccuracies.</p>
<p><code>S2</code> Bending correcting 4 point measurement. This is for cantilevered beds that have the rotation axis not at the side but inside the bed. Here we can assume no bending on the axis and a symmetric bending to both sides of the axis. So probe points 2 and 3 build the symmetric axis and point 1 is mirrored to 1m across the axis. Using the symmetry we then remove the bending from 1 and use that as plane.</p>
<p><code>P0</code> Use a rotation matrix. This will make z axis go up&#x2F;down while moving in x&#x2F;y direction to compensate the tilt. For multiple extruders make sure the height match the tilt of the bed or one will scratch. This is the default.</p>
<p><code>P1</code> Motorized correction. This method needs a bed that is fixed on 3 points from which 2 have a motor to change the height. The positions are defined in firmware by BED_MOTOR_1_X, BED_MOTOR_1_Y, BED_MOTOR_2_X, BED_MOTOR_2_Y, BED_MOTOR_3_X, BED_MOTOR_3_Y Motor 2 and 3 are the one driven by motor driver 0 and 1. These can be extra motors like Felix Pro 1 uses them or a system with 3 z axis where motors can be controlled individually like the Sparkcube does. This method requires a Z max endstop.</p>
<h4 id="G32-Undock-Z-Probe-sled"><a href="#G32-Undock-Z-Probe-sled" class="headerlink" title="G32: Undock Z Probe sled"></a>G32: Undock Z Probe sled</h4><p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G33-Firmware-dependent"><a href="#G33-Firmware-dependent" class="headerlink" title="G33: Firmware dependent"></a>G33: Firmware dependent</h4><h5 id="G33-Measure-List-Adjust-Distortion-Matrix-Repetier-Redeem"><a href="#G33-Measure-List-Adjust-Distortion-Matrix-Repetier-Redeem" class="headerlink" title="G33: Measure&#x2F;List&#x2F;Adjust Distortion Matrix (Repetier - Redeem)"></a>G33: Measure&#x2F;List&#x2F;Adjust Distortion Matrix (Repetier - Redeem)</h5><p>Usage</p>
<p><code>G33</code></p>
<p><code>G33 Lnnn</code></p>
<p><code>G33 Rnnn</code></p>
<p><code>G33 Xnnn Ynnn Znnn</code></p>
<p>Parameters</p>
<p><code>L0</code> List distortion matrix in a report</p>
<p><code>R0</code> Reset distortion matrix</p>
<p><code>X[pos] Y[pos] Z[zCorrection]</code> Set correction for nearest point</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G33</span><br><span class="line">G33 R0</span><br></pre></td></tr></table></figure>

<p>When used with no parameters, <code>G33</code> will measure a grid of points and store the distortion dips and valleys in the bed surface, and then enable software distortion correction for the first few or several layers. The values will be stored in EEPROM if enabled in firmware. You must previously have <code>G28</code> homed, and your Z minimum&#x2F;maximum height must be set correctly for this to work. Use the optional parameters to list, reset or modify the distortion settings. Distortion correction behavior can be later turned on or off by code <code>M323</code>.</p>
<h5 id="G33-Delta-Auto-Calibration-Marlin-1-1-x-MK4duo"><a href="#G33-Delta-Auto-Calibration-Marlin-1-1-x-MK4duo" class="headerlink" title="G33: Delta Auto Calibration (Marlin 1.1.x - MK4duo)"></a>G33: Delta Auto Calibration (Marlin 1.1.x - MK4duo)</h5><p>End-stops and tower angle corrections are normalized <strong>(P0)</strong>;</p>
<p>Performs a 1-4-7 point calibration of delta height <strong>(P1)</strong>, end-stops, delta radius <strong>(P2)</strong> and tower angle corrections <strong>(P&gt;&#x3D;3)</strong> by a least squares iteration process based on the displacement method.</p>
<p>Usage</p>
<p><code>G33</code></p>
<p><code>G33 Pn T Cx.xx Fn Vn E O Rx.xx</code></p>
<p>Parameters</p>
<p><code>Pn</code> Number of probe points: n*n (n&#x3D; 0-10), when P is omitted the default set in Configuration.h is used.</p>
<p><code>T</code> Do not calibrate tower angle corrections (if used with P&gt;&#x3D;3); do not use the probe points near the towers, but the probe points opposite to the towers (if used with P&#x3D;2)</p>
<p><code>Cx.xx</code> Force the iterations to stop when a standard deviation from the zero plane less then x.xx mm is achieved; when C is omitted the iterations go on until the best possible standard deviation is reached.</p>
<p><code>Fn</code> Force to run at least n iterations (n&#x3D;1-30) and take the best result</p>
<p><code>Vn</code> Verbose level: (n&#x3D;0-3) 0 &#x3D; dry run without calibration; 1(default) &#x3D; settings at start and end; 2 &#x3D; settings at all iterations; 3 &#x3D; settings and probe results</p>
<p><code>E</code> Engage the probe for each point</p>
<p><code>O</code> Do not probe at the required kinematic points but at positions offseted to the probe-offsets <sup>1</sup></p>
<p><code>R</code> Temporary reduce the size of the probe grid by the specified amount (mm) <sup>1</sup></p>
<p>Notes</p>
<p><sup>1</sup> since 2.0.9.2</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">G33 : calibrates with the default settings.</span><br><span class="line">G33 Auto Calibrate</span><br><span class="line">Checking... AC</span><br><span class="line">.Height:297.77    Ex:+0.00  Ey:+0.00  Ez:+0.00    Radius:100.00</span><br><span class="line">.Tower angle :    Tx:+0.00  Ty:+0.00  Tz:+0.00</span><br><span class="line">Iteration : 01                                    std dev:0.306</span><br><span class="line">Iteration : 02                                    std dev:0.049</span><br><span class="line">Iteration : 03                                    std dev:0.033</span><br><span class="line">Iteration : 04                                    std dev:0.031</span><br><span class="line">Calibration OK                                    rolling back.</span><br><span class="line">.Height:297.69    Ex:-0.10  Ey:-0.12  Ez:+0.00    Radius:100.91</span><br><span class="line">.Tower angle :    Tx:-0.03  Ty:+0.25  Tz:+0.00</span><br><span class="line">Save with M500 and/or copy to Configuration.h</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">G33 P6 V0 : probes 36 points in dry run mode.</span><br><span class="line">G33 Auto Calibrate</span><br><span class="line">Checking... AC (DRY-RUN)</span><br><span class="line">.Height:297.77    Ex:+0.00  Ey:+0.00  Ez:+0.00    Radius:100.00</span><br><span class="line">.Tower angle :    Tx:+0.00  Ty:+0.00  Tz:+0.00</span><br><span class="line">.      c:+0.03     x:+0.32   y:+0.34   z:+0.41</span><br><span class="line">.                 yz:+0.37  zx:+0.32  xy:+0.17</span><br><span class="line">End DRY-RUN                                       std dev:0.306</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">G33 P4 C0.05 T : probes 16 points and</span><br><span class="line">                 stops when a standard deviation of 0.05mm is reached;</span><br><span class="line">                 calibrates delta height, endstops and delta radius,</span><br><span class="line">                 leaves the tower angle corrections unaltered.</span><br><span class="line">G33 Auto Calibrate</span><br><span class="line">Checking... AC</span><br><span class="line">.Height:297.78    Ex:+0.00  Ey:+0.00  Ez:+0.00    Radius:100.00</span><br><span class="line">Iteration : 01                                    std dev:0.317</span><br><span class="line">Iteration : 02                                    std dev:0.059</span><br><span class="line">Calibration OK                                    std dev:0.042</span><br><span class="line">.Height:297.66    Ex:-0.17  Ey:-0.13  Ez:+0.00    Radius:100.91</span><br><span class="line">Save with M500 and/or copy to Configuration.h</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">G33 P2 : probes center and tower positions and</span><br><span class="line">         calibrates delta height, endstops and delta radius.</span><br><span class="line">G33 Auto Calibrate</span><br><span class="line">Checking... AC</span><br><span class="line">.Height:297.78    Ex:+0.00  Ey:+0.00  Ez:+0.00    Radius:100.00</span><br><span class="line">Iteration : 01                                    std dev:0.374</span><br><span class="line">Iteration : 02                                    std dev:0.054</span><br><span class="line">Iteration : 03                                    std dev:0.007</span><br><span class="line">Calibration OK                                    rolling back.</span><br><span class="line">.Height:297.68    Ex:-0.14  Ey:-0.14  Ez:+0.00    Radius:101.23</span><br><span class="line">Save with M500 and/or copy to Configuration.h</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">G33 P1 : probes the center and calibrates the delta height only.</span><br><span class="line">G33 Auto Calibrate</span><br><span class="line">Checking... AC</span><br><span class="line">.Height:261.40                                Offset:+0.30</span><br><span class="line">Calibration OK                                std dev:0.000</span><br><span class="line">.Height:261.58                                Offset:+0.10</span><br><span class="line">Save with M500 and/or copy to Configuration.h</span><br></pre></td></tr></table></figure>

<p><em>note: Height &#x3D; delta height; Ex, Ey, Ez &#x3D; end-stop corrections; Radius &#x3D; delta radius; Tx, Ty, Tz &#x3D; tower angular corrections; c, x, y, z, yz, zx, xy &#x3D; probe results at center, towers and opposite to towers; std dev &#x3D; standard deviation of the probe results towards the zero plane.</em></p>
<h4 id="G34-Z-Stepper-Auto-Align"><a href="#G34-Z-Stepper-Auto-Align" class="headerlink" title="G34: Z Stepper Auto-Align"></a>G34: Z Stepper Auto-Align</h4><p>Use multiple Z steppers and a probe to align Z axis connection points. See <code>M422</code> for other options.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G34 I3 T0.8 A1.5 ; 3 iterations, Target Accuracy 0.8, Amplification 1.5</span><br></pre></td></tr></table></figure>

<h4 id="G34-Calculate-Delta-Height-from-toolhead-position-DELTA"><a href="#G34-Calculate-Delta-Height-from-toolhead-position-DELTA" class="headerlink" title="G34: Calculate Delta Height from toolhead position (DELTA)"></a>G34: Calculate Delta Height from toolhead position (DELTA)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G34</span><br></pre></td></tr></table></figure>

<p>The values specified are added to the calculated end stop position when the axes are referenced. The calculated value is derived from the distance of the toolhead from the current axis zero point. The user would typically place the toolhead at the zero point of the axis and issue the <code>G34</code> command. This value can be saved to EEPROM using the <code>M500</code> command.</p>
<h4 id="G38-x-Straight-Probe-CNC-specific"><a href="#G38-x-Straight-Probe-CNC-specific" class="headerlink" title="G38.x Straight Probe (CNC specific)"></a>G38.x Straight Probe (CNC specific)</h4><h5 id="G38-2-probe-toward-workpiece-stop-on-contact-signal-error-if-failure"><a href="#G38-2-probe-toward-workpiece-stop-on-contact-signal-error-if-failure" class="headerlink" title="G38.2 probe toward workpiece, stop on contact, signal error if failure"></a>G38.2 probe toward workpiece, stop on contact, signal error if failure</h5><p>Monitors probe input while moving linearly towards the specified coordinates, stopping upon detecting contact or reaching specified coordinates.</p>
<p>Usage</p>
<p><code>G38.2 Xnnn Ynnn Znnn Fnnn</code></p>
<p>Parameters</p>
<p><code>Xnnn</code> target X coordinate</p>
<p><code>Ynnn</code> target Y coordinate</p>
<p><code>Znnn</code> target Z coordinate</p>
<p><code>Fnnn</code> Feedrate in mm&#x2F;min</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G38.2 Z0</span><br><span class="line">G38.2 X50</span><br><span class="line">G38.2 Z10 Y10</span><br></pre></td></tr></table></figure>

<h5 id="G38-3-probe-toward-workpiece-stop-on-contact"><a href="#G38-3-probe-toward-workpiece-stop-on-contact" class="headerlink" title="G38.3 probe toward workpiece, stop on contact"></a>G38.3 probe toward workpiece, stop on contact</h5><h5 id="G38-4-probe-away-from-workpiece-stop-on-loss-of-contact-signal-error-if-failure"><a href="#G38-4-probe-away-from-workpiece-stop-on-loss-of-contact-signal-error-if-failure" class="headerlink" title="G38.4 probe away from workpiece, stop on loss of contact, signal error if failure"></a>G38.4 probe away from workpiece, stop on loss of contact, signal error if failure</h5><h5 id="G38-5-probe-away-from-workpiece-stop-on-loss-of-contact"><a href="#G38-5-probe-away-from-workpiece-stop-on-loss-of-contact" class="headerlink" title="G38.5 probe away from workpiece, stop on loss of contact"></a>G38.5 probe away from workpiece, stop on loss of contact</h5><h4 id="G40-Compensation-Off-CNC-specific"><a href="#G40-Compensation-Off-CNC-specific" class="headerlink" title="G40: Compensation Off (CNC specific)"></a>G40: Compensation Off (CNC specific)</h4><p><code>G40</code> turns off cutter compensation. If tool compensation was on the next move must be a linear move and longer than the tool diameter. It is OK to turn compensation off when it is already off. <a target="_blank" rel="noopener" href="http://www.linuxcnc.org/docs/2.5/html/gcode/tool_compensation.html">http://www.linuxcnc.org/docs/2.5/html/gcode/tool_compensation.html</a></p>
<h4 id="G42-Move-to-Grid-Point"><a href="#G42-Move-to-Grid-Point" class="headerlink" title="G42: Move to Grid Point"></a>G42: Move to Grid Point</h4><p><code>G42</code> does a fast move in XY to any of the intersection points in the bed calibration grid. This is useful during calibration to align the nozzle or probe.</p>
<p>Parameters</p>
<p><code>Inn</code> Grid X index (zero-based). If omitted, the nearest latitude.</p>
<p><code>Jnn</code> Grid Y index (zero-based). If omitted, the nearest longitude.</p>
<p><code>P</code> Probe flag. Moves the probe to the grid point (instead of the nozzle).</p>
<p><code>Fnnn</code> Feedrate (mm&#x2F;min)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G42 I3 J4 P F3000 ; Move the probe to grid coordinate 3, 4</span><br></pre></td></tr></table></figure>

<h4 id="G53-59-Coordinate-System-Select-CNC-specific"><a href="#G53-59-Coordinate-System-Select-CNC-specific" class="headerlink" title="G53..59: Coordinate System Select (CNC specific)"></a>G53..59: Coordinate System Select (CNC specific)</h4><p>G53 refers to the native machine coordinate system, while the remaining coordinate systems are typically used to define the offset to the origin of specific parts.</p>
<p>See <a target="_blank" rel="noopener" href="http://linuxcnc.org/docs/html/gcode/g-code.html#gcode:g54-g59.3">linuxcnc.org</a> for more help</p>
<p>Not all builds of RepRapFirmware support these commands. For those that do (e.g. Duet WiFi&#x2F;Ethernet and Duet 3), from firmware version 2.02 the workplace coordinate offsets are included in the data saved to config-override.g by the M500 command.</p>
<p>Marlin supports these commands when enabled with the #define CNC_COORDINATE_SYSTEMS option in Configuration_adv.h.</p>
<h4 id="G60-Save-Restore-position"><a href="#G60-Save-Restore-position" class="headerlink" title="G60: Save &#x2F; Restore position"></a>G60: Save &#x2F; Restore position</h4><p>Use this command to save the current position to a memory slot, restore (and move to) a saved position, or delete a previously-saved position. When moving to a saved position, you can choose which axes to move, and some firmwares allow you to specify an offset distance for each axis. See usage notes for each firmware below.</p>
<p>G60 S Usage</p>
<p><code>G60 Snn</code></p>
<p>Parameters</p>
<p><code>Snn</code> <nn> specifies a memory slot # (0-based) to save into (default 0)</p>
<ul>
<li><p><strong>RepRapFirmware</strong>: RRF 1.21 has 3 slots (0..2). RRF 2.02 adds two more slots (4..5) skipping slot index 3. When a print is paused the coordinates are saved to slot 1 automatically, and at the start of a tool change the coordinates are saved to slot 2 automatically. Use G0 or G1 with the R0, R1 or R2 parameter to move the current tool to a saved position.</p>
</li>
<li><p><strong>Marlin</strong>: The number of save slots is defined with <code>SAVED_POSITIONS</code>.</p>
</li>
<li><p><strong>Druid</strong>: This firmware always has 64 slots (0..63).</p>
</li>
</ul>
<p>G60 Q Usage</p>
<p><code>G60 Qnnn Fnnn X Y Z ... E</code></p>
<p>Move back to a saved position. Specify one or more axes to restore unless all axes should be restored.</p>
<p>Parameters</p>
<p><code>Qnnn</code> - From slot # 0-63 (required)</p>
<p><code>Fnnn</code> - Feedrate (units&#x2F;min)</p>
<p><code>X   </code> - Flag to restore X</p>
<p><code>Y   </code> - Flag to restore Y</p>
<p><code>Z   </code> - Flag to restore Z</p>
<p><code>E   </code> - Flag to restore E</p>
<ul>
<li><p>Other axis letters may be included for fancier robots. If no axes are specified with <code>G60 Qnn</code> then all axes are restored.</p>
</li>
<li><p><strong>Marlin:</strong> Put a value next to an axis letter to specify an offset to add to the position before moving. The E axis is restored but never actually moved by this command.</p>
</li>
</ul>
<p>G60 D Usage</p>
<p><code>G60 Dnnn</code> - Delete content of slot number nnn (0…63)</p>
<p><code>G60 D   </code> - if D is provided without a slot number, all 64 slots will be deleted.</p>
<p>Notes</p>
<p>Only one of S, Q, or D may be used in the command. If more than one is present, the whole command will be ignored.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">G60 S0                 ; Save current position to slot #0</span><br><span class="line">G60 S63                ; Save current position to slot #63</span><br><span class="line">G60 Q55                ; Move to the position stored in slot #55 </span><br><span class="line">G60 Q10 F20000 X Y     ; Move XY to the position stored in slot #10, with feedrate 20000 units/min. </span><br><span class="line">G60 Q0 X               ; Move X to the position saved in slot #0</span><br><span class="line">G60 D0                 ; Delete the position saved in slot #0</span><br><span class="line">G60 D                  ; Delete all saved positions from all slots</span><br><span class="line">G60                    ; List all saved positions</span><br></pre></td></tr></table></figure>

<h4 id="G61-Restore-saved-position"><a href="#G61-Restore-saved-position" class="headerlink" title="G61: Restore saved position"></a>G61: Restore saved position</h4><p>Use this command to restore (and move to) a saved position, optionally specifying which axes to restore, with an optional offset for each axis.</p>
<p>Usage</p>
<p><code>G61 Snn</code></p>
<p>Parameters</p>
<p><code>Snn</code> <nn> specifies memory slot # (0-based) to restore from (default 0)</p>
<p>Move back to the position that was saved in the given slot. If nothing was saved in the slot, do nothing.</p>
<p><code>G61 Snn Fnnn X Y Z E</code></p>
<p>Move back to a saved position, specifying one or more axes to restore, with optional offset. The E axis is restored but never actually moved by this command.</p>
<p>Parameters</p>
<p><code>Snnn</code> - From slot # 0-63 (required)</p>
<p><code>Fnnn</code> - Feedrate (units&#x2F;min)</p>
<p><code>X   </code> - Flag to restore X axis, with optional X offset</p>
<p><code>Y   </code> - Flag to restore Y axis, with optional Y offset</p>
<p><code>Z   </code> - Flag to restore Z axis, with optional Z offset</p>
<p><code>E   </code> - Flag to restore E axis, with optional E offset</p>
<p>Other axis letters may be included for fancier robots. If no axes are specified then all axes are restored.</p>
<p>Put a value next to an axis letter to specify the offset to add to the position before moving &#x2F; restoring.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G61 S15                ; Move to the position from slot #15</span><br><span class="line">G61 S10 F20000 X3 Y    ; Move XY to the XY position from slot #10, shifting X by 3, with feedrate 20000 units/min</span><br><span class="line">G61 S0 X               ; Move X to the X position from slot #0</span><br></pre></td></tr></table></figure>

<h4 id="G68-Coordinate-rotation"><a href="#G68-Coordinate-rotation" class="headerlink" title="G68: Coordinate rotation"></a>G68: Coordinate rotation</h4><p>Usage</p>
<p><code>G68 Xnnn Ynnn Rnnnn [I]</code></p>
<p><code>G68 Annn Bnnn Rnnnn [I]</code></p>
<p>Parameters</p>
<p><code>Xnnn, Ynnn...</code> Centre coordinates to rotate about</p>
<p><code>Annn</code> first centre coordinate in the selected plane (e.g. equivalent to Xnnn if the selected plane is XY)</p>
<p><code>Bnnn</code> second centre coordinate in the selected plane (e.g. equivalent to Ynnn if the selected plane is XY)</p>
<p><code>Rnnn</code> angle to rotate in degrees. Positive angles rotate anticlockwise when viewing the selected plane from above.</p>
<p><code>I</code> if this parameter is present, the R parameter is added to the existing rotation instead of being absolute</p>
<p>Rotates the coordinate system in the current plane as selected by G17, G18 or G19. You may either specify the coordinates of the two axes of the selected plan (e.g. X and Y if using the default XY plane or after G17) or you may specify A and B coordinates.</p>
<p>RepRapFirmware implements G68 for the XY plane only.</p>
<h4 id="G69-Cancel-coordinate-rotation"><a href="#G69-Cancel-coordinate-rotation" class="headerlink" title="G69: Cancel coordinate rotation"></a>G69: Cancel coordinate rotation</h4><p>Usage</p>
<p><code>G69</code></p>
<p>This cancels any coordinate rotation that was set up by G68.</p>
<h4 id="G75-Print-temperature-interpolation"><a href="#G75-Print-temperature-interpolation" class="headerlink" title="G75: Print temperature interpolation"></a>G75: Print temperature interpolation</h4><p>Show&#x2F;print PINDA temperature interpolating.</p>
<p>Usage</p>
<p><code>G75</code></p>
<h4 id="G76-PINDA-probe-temperature-calibration"><a href="#G76-PINDA-probe-temperature-calibration" class="headerlink" title="G76: PINDA probe temperature calibration"></a>G76: PINDA probe temperature calibration</h4><p>This G-code is used to calibrate the temperature drift of the PINDA (inductive Sensor).</p>
<p>The PINDAv2 sensor has a built-in thermistor which has the advantage that the calibration can be done once for all materials.</p>
<p>The Original i3 Prusa MK2&#x2F;s uses PINDAv1 and this calibration improves the temperature drift, but not as good as the PINDAv2.</p>
<p>Usage</p>
<p><code>G76</code></p>
<p><code>G76 B</code><sup>1</sup></p>
<p><code>G76 P</code><sup>1</sup></p>
<p>Parameters</p>
<p><code>B</code> Calibrate bed only <sup>1</sup></p>
<p><code>P</code> Calibrate probe only <sup>1</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">G76</span><br><span class="line"></span><br><span class="line">echo PINDA probe calibration start</span><br><span class="line">echo start temperature: 35.0°</span><br><span class="line">echo ...</span><br><span class="line">echo PINDA temperature -- Z shift (mm): 0.---</span><br></pre></td></tr></table></figure>

<p>Notes<sup>1</sup></p>
<p>Marlin requires <code>PROBE_TEMP_COMPENSATION</code>.</p>
<p>This process can take a very long time. The timeout is currently set to 15min to allow the parts to fully heat up and cool down.</p>
<p>Use <code>M500</code> to save the result to EEPROM.</p>
<p>At this moment it is only supported in Marlin bugfix-2.0.x branch.</p>
<h4 id="G80-Cancel-Canned-Cycle-CNC-specific"><a href="#G80-Cancel-Canned-Cycle-CNC-specific" class="headerlink" title="G80: Cancel Canned Cycle (CNC specific)"></a>G80: Cancel Canned Cycle (CNC specific)</h4><p>It cancel canned cycle modal motion. G80 is part of modal group 1, so programming any other G code from modal group 1 will also cancel the canned cycle.</p>
<h4 id="G80-Mesh-based-Z-probe"><a href="#G80-Mesh-based-Z-probe" class="headerlink" title="G80: Mesh-based Z probe"></a>G80: Mesh-based Z probe</h4><p>Default 3x3 grid can be changed on MK2.5&#x2F;s and MK3&#x2F;s to 7x7 grid.</p>
<p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>N</code> Number of mesh points on x axis. Default is 3. Valid values are 3 and 7.</p>
<p><code>C</code> Probe retry counts. Default is value stored in EEPROM. Valid values are 1 to 10.</p>
<p><code>O</code> Return to origin. Default is 1. Valid values are 0 (false) and 1 (true). <sup>2</sup></p>
<p><code>M</code> Use magnet compensation. Will only be used if number of mesh points is set to 7. Default is value stored in EEPROM. Valid values are 0 (false) and 1 (true). <sup>2</sup></p>
<p>Using the following parameters enables additional “manual” bed leveling correction. Valid values are -100 microns to 100 microns.</p>
<p><code>L</code> Left Bed Level correct value in um.</p>
<p><code>R</code> Right Bed Level correct value in um.</p>
<p><code>F</code> Front Bed Level correct value in um.</p>
<p><code>B</code> Back Bed Level correct value in um.</p>
<p>The following parameters are used to define the area used by the print:</p>
<p><code>X</code> area lower left point X coordinate <sup>2</sup></p>
<p><code>Y</code> area lower left point Y coordinate <sup>2</sup></p>
<p><code>W</code> area width (on X axis) <sup>2</sup></p>
<p><code>H</code> area height (on Y axis) <sup>2</sup></p>
<p><sup>1</sup>Prusa Firmware till version 3.13.3</p>
<p><code>R</code> Probe retries. Default 3 max. 10 <sup>1</sup></p>
<p><code>V</code> Verbosity level 1&#x3D;low, 10&#x3D;mid, 20&#x3D;high.It can be only used if firmware has been compiled with SUPPORT_VERBOSITY active. <sup>1</sup></p>
<p><sup>2</sup>Prusa Firmware from version 3.14.0</p>
<p><sup>3</sup>Prusa MK3.5, MK3.9 and MK4</p>
<h4 id="G81-Mesh-bed-leveling-status"><a href="#G81-Mesh-bed-leveling-status" class="headerlink" title="G81: Mesh bed leveling status"></a>G81: Mesh bed leveling status</h4><p>Prints mesh bed leveling status and bed profile if activated.</p>
<p>Usage</p>
<p><code>G81</code></p>
<p>Notes</p>
<p>Equivalent to <code>M420 V</code> in Marlin Firmware (and possibly <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G29:_Detailed_Z-Probe" title="G-code">G29 T</a> depending on leveling system).</p>
<h4 id="G82-Single-Z-probe-at-current-location"><a href="#G82-Single-Z-probe-at-current-location" class="headerlink" title="G82: Single Z probe at current location"></a>G82: Single Z probe at current location</h4><p>WARNING! USE WITH CAUTION! If you’ll try to probe where is no leveling pad, nasty things can happen!</p>
<p>Usage</p>
<p><code>G82</code></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G83-Babystep-in-Z-and-store-to-EEPROM"><a href="#G83-Babystep-in-Z-and-store-to-EEPROM" class="headerlink" title="G83: Babystep in Z and store to EEPROM"></a>G83: Babystep in Z and store to EEPROM</h4><p>Usage</p>
<p><code>G83</code></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G84-UNDO-Babystep-Z-move-Z-axis-back"><a href="#G84-UNDO-Babystep-Z-move-Z-axis-back" class="headerlink" title="G84: UNDO Babystep Z (move Z axis back)"></a>G84: UNDO Babystep Z (move Z axis back)</h4><p>Usage</p>
<p><code>G84</code></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G85-Pick-best-babystep"><a href="#G85-Pick-best-babystep" class="headerlink" title="G85: Pick best babystep"></a>G85: Pick best babystep</h4><p>Usage</p>
<p><code>G85</code></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="G86-Disable-babystep-correction-after-home"><a href="#G86-Disable-babystep-correction-after-home" class="headerlink" title="G86: Disable babystep correction after home"></a>G86: Disable babystep correction after home</h4><p>This G-code will be performed at the start of a calibration script.</p>
<p>Usage</p>
<p><code>G86</code></p>
<h4 id="G87-Enable-babystep-correction-after-home"><a href="#G87-Enable-babystep-correction-after-home" class="headerlink" title="G87: Enable babystep correction after home"></a>G87: Enable babystep correction after home</h4><p>This G-code will be performed at the end of a calibration script.</p>
<p>Usage</p>
<p><code>G87</code></p>
<h4 id="G88-Reserved"><a href="#G88-Reserved" class="headerlink" title="G88: Reserved"></a>G88: Reserved</h4><p>Usage</p>
<p><code>G88</code></p>
<p>Notes</p>
<p>This G-code currently does not do anything.</p>
<h4 id="G90-Set-to-Absolute-Positioning"><a href="#G90-Set-to-Absolute-Positioning" class="headerlink" title="G90: Set to Absolute Positioning"></a>G90: Set to Absolute Positioning</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G90</span><br></pre></td></tr></table></figure>

<p>All coordinates from now on are absolute relative to the origin of the machine. (This is the RepRap default.)</p>
<h4 id="G91-Set-to-Relative-Positioning"><a href="#G91-Set-to-Relative-Positioning" class="headerlink" title="G91: Set to Relative Positioning"></a>G91: Set to Relative Positioning</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G91</span><br></pre></td></tr></table></figure>

<p>All coordinates from now on are relative to the last position. Note: RepRapFirmware latest revision firmware uses <code>M83</code> to set the extruder to relative mode: extrusion is NOT set to relative by ReprapFirmware on <code>G91</code>: only X,Y and Z are set to relative. By contrast, Marlin (for example) DOES also set extrusion to relative on a <code>G91</code> command, as well as setting X, Y and Z.</p>
<h4 id="G92-Set-Position"><a href="#G92-Set-Position" class="headerlink" title="G92: Set Position"></a>G92: Set Position</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Xnnn</code> new X axis position</p>
<p><code>Ynnn</code> new Y axis position</p>
<p><code>Znnn</code> new Z axis position</p>
<p><code>Ennn</code> new extruder position</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G92 X10 E90</span><br></pre></td></tr></table></figure>

<p>Allows programming of absolute zero point, by reseting the current position to the values specified. This would set the machine’s X coordinate to 10, and the extrude coordinate to 90. No physical motion will occur.</p>
<p>A <code>G92</code> without coordinates will reset all axes to zero on some firmware. This does not apply to RepRapFirmware.</p>
<h5 id="G92-x-Reset-Coordinate-System-Offsets-CNC-specific"><a href="#G92-x-Reset-Coordinate-System-Offsets-CNC-specific" class="headerlink" title="G92.x: Reset Coordinate System Offsets (CNC specific)"></a>G92.x: Reset Coordinate System Offsets (CNC specific)</h5><p>Usage</p>
<p><code>G92.1</code> - Reset axis offsets (and parameters 5211-5219) to zero. (<code>X Y Z A B C U V W</code>)</p>
<p><code>G92.2</code> - Reset axis offsets to zero</p>
<h4 id="G93-Feed-Rate-Mode-Inverse-Time-Mode-CNC-specific"><a href="#G93-Feed-Rate-Mode-Inverse-Time-Mode-CNC-specific" class="headerlink" title="G93: Feed Rate Mode (Inverse Time Mode) (CNC specific)"></a>G93: Feed Rate Mode (Inverse Time Mode) (CNC specific)</h4><p><code>G93</code> is Inverse Time Mode. In inverse time feed rate mode, an <code>F</code> word means the move should be completed in (one divided by the <code>F</code> number) minutes. For example, <code>F2.0</code> means the move should be completed in a half a minute.</p>
<p>When the inverse time feed rate mode is active, an <code>F</code> word must appear on every line which has a <code>G1</code>, <code>G2</code>, or <code>G3</code> motion, and an <code>F</code> word on a line that does not have <code>G1</code>, <code>G2</code>, or <code>G3</code> is ignored. Being in inverse time feed rate mode does not affect <code>G0</code> (rapid move) motions.</p>
<h4 id="G94-Feed-Rate-Mode-Units-per-Minute-CNC-specific"><a href="#G94-Feed-Rate-Mode-Units-per-Minute-CNC-specific" class="headerlink" title="G94: Feed Rate Mode (Units per Minute) (CNC specific)"></a>G94: Feed Rate Mode (Units per Minute) (CNC specific)</h4><p>G94 is Units per Minute Mode. In units per minute feed mode, an F word is interpreted to mean the controlled point should move at a certain number of inches per minute, millimeters per minute, or degrees per minute, depending upon what length units are being used and which axis or axes are moving.</p>
<h4 id="G98-Activate-farm-mode"><a href="#G98-Activate-farm-mode" class="headerlink" title="G98: Activate farm mode"></a>G98: Activate farm mode</h4><p>Enable Prusa-specific Farm functions and g-code.</p>
<p>Usage</p>
<p><code>G98</code></p>
<p>Notes</p>
<p>Set of internal Prusa commands</p>
<p><code>PRUSA [ Ping | PRN | FAN | fn | thx | uvlo | fsensor_recover | MMURES | RESET | fv | M28 | SN | Fir | Rev | Lang | Lz | Beat | FR ]</code></p>
<p>Parameters</p>
<p><code>Ping</code></p>
<p><code>PRN</code> Prints revision of the printer.</p>
<p><code>FAN</code> Prints fan details.</p>
<p><code>fn</code> Prints farm number.</p>
<p><code>thx</code></p>
<p><code>uvlo</code> Resets UVLO aka Power Panic and continues SD print.</p>
<p><code>fsensor_recover</code> Filament sensor recover - restore print and continue.</p>
<p><code>MMURES</code> Reset MMU.</p>
<p><code>Reset</code> Resets Printer.</p>
<p><code>fv</code>  ??? get file version. ???</p>
<p><code>M28</code> M28 write to SD.</p>
<p><code>SN</code> Get serial number from 32U2 processor. Typical format of S&#x2F;N is:CZPX0917X003XC13518</p>
<p><code>Fir</code> Prints firmware version.</p>
<p><code>Rev</code> Prints filament size, elelectronics, nozzle type.</p>
<p><code>Lang</code> Reset the language.</p>
<p><code>Lz</code>  ??? maybe resets Live Z values to 0 ???</p>
<p><code>Beat</code> Kick farm link timer.</p>
<p><code>FR</code> Full factory reset.</p>
<p><code>nozzle set &#39;diameter&#39; </code> Set nozzle diameter.</p>
<p><code>nozzle D&#39;diameter&#39;</code> Check nozzle diameter.</p>
<p><code>nozzle</code> Print nozzle diameter</p>
<h4 id="G99-Deactivate-farm-mode"><a href="#G99-Deactivate-farm-mode" class="headerlink" title="G99: Deactivate farm mode"></a>G99: Deactivate farm mode</h4><p>Usage</p>
<p><code>G99</code></p>
<h4 id="G100-Calibrate-floor-or-rod-radius"><a href="#G100-Calibrate-floor-or-rod-radius" class="headerlink" title="G100: Calibrate floor or rod radius"></a>G100: Calibrate floor or rod radius</h4><p>Parameters</p>
<p><code>X</code> Flag to set floor for X axis</p>
<p><code>Y</code> Flag to set floor for Y axis</p>
<p><code>Z</code> Flag to set floor for Z axis</p>
<p><code>Rnnn</code> Radius to add</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">G100 X Y Z ; set floor for argument passed in. Number ignored and may be absent.</span><br><span class="line">G100 R5    ; Add 5 to radius. Adjust to be above floor if necessary</span><br><span class="line">G100 R0    ; Set radius based on current z measurement. Moves all axes to zero</span><br></pre></td></tr></table></figure>

<h4 id="G130-Set-digital-potentiometer-value"><a href="#G130-Set-digital-potentiometer-value" class="headerlink" title="G130: Set digital potentiometer value"></a>G130: Set digital potentiometer value</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G130 X10 Y18 Z15 A20 B12</span><br></pre></td></tr></table></figure>

<p>Set the digital potentiometer value for the given axes. This is used to configure the current applied to each stepper axis. The value is specified as a value from 0-127; the mapping from current to potentimeter value is machine specific.</p>
<h4 id="G131-Remove-offset"><a href="#G131-Remove-offset" class="headerlink" title="G131: Remove offset"></a>G131: Remove offset</h4><h4 id="G132-Calibrate-endstop-offsets"><a href="#G132-Calibrate-endstop-offsets" class="headerlink" title="G132: Calibrate endstop offsets"></a>G132: Calibrate endstop offsets</h4><h4 id="G133-Measure-steps-to-top"><a href="#G133-Measure-steps-to-top" class="headerlink" title="G133: Measure steps to top"></a>G133: Measure steps to top</h4><h4 id="G161-Home-axes-to-minimum"><a href="#G161-Home-axes-to-minimum" class="headerlink" title="G161: Home axes to minimum"></a>G161: Home axes to minimum</h4><p>Parameters</p>
<p><code>X</code> Flag to home the X axis to its minimum position</p>
<p><code>Y</code> Flag to home the Y axis to its minimum position</p>
<p><code>Z</code> Flag to home the Z axis to its minimum position</p>
<p><code>Fnnn</code> Desired feedrate for this command</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G161 X Y Z F1800</span><br></pre></td></tr></table></figure>

<p>Instruct the machine to home the specified axes to their minimum position. Similar to <code>G28</code>, which decides on its own in which direction to search endstops.</p>
<h4 id="G162-Home-axes-to-maximum"><a href="#G162-Home-axes-to-maximum" class="headerlink" title="G162: Home axes to maximum"></a>G162: Home axes to maximum</h4><p>Parameters</p>
<p><code>X</code> Flag to home the X axis to its maximum position</p>
<p><code>Y</code> Flag to home the Y axis to its maximum position</p>
<p><code>Z</code> Flag to home the Z axis to its maximum position</p>
<p><code>Fnnn</code> Desired feedrate for this command</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G162 X Y Z F1800</span><br></pre></td></tr></table></figure>

<p>Instruct the machine to home the specified axes to their maximum position.</p>
<h4 id="G425-Perform-auto-calibration-with-calibration-cube"><a href="#G425-Perform-auto-calibration-with-calibration-cube" class="headerlink" title="G425: Perform auto-calibration with calibration cube"></a>G425: Perform auto-calibration with calibration cube</h4><p>This performs an automatic calibration of backlash, positional errors and nozzle offset by touching the nozzle on the sides of a bed mounted, electrically conductive cube, washer or bolt.</p>
<p>Parameters</p>
<p><code>B</code> Perform calibration of backlash only.</p>
<p><code>Tnnn</code> Perform calibration of toolhead only.</p>
<p><code>V</code> Probe cube and print position, error, backlash and hotend offset.</p>
<p><code>Unnn</code> Uncertainty, how far to start probe away from the cube (mm)</p>
<p>Examples (Marlin)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">G425                ; Perform full calibration sequence</span><br><span class="line">T1                  ; Switch to second nozzle</span><br><span class="line">G425 V              ; Validate by showing report for T1</span><br><span class="line">T0                  ; Switch to second nozzle</span><br><span class="line">G425 V              ; Validate by showing report for T0</span><br></pre></td></tr></table></figure>

<h2 id="M-commands"><a href="#M-commands" class="headerlink" title="M-commands"></a>M-commands</h2><h4 id="M0-Stop-or-Unconditional-stop"><a href="#M0-Stop-or-Unconditional-stop" class="headerlink" title="M0: Stop or Unconditional stop"></a>M0: Stop or Unconditional stop</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Pnnn</code> Time to wait, in milliseconds<sup>1</sup></p>
<p><code>Snnn</code> Time to wait, in seconds<sup>2</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M0</span><br></pre></td></tr></table></figure>

<p>The RepRap machine finishes any moves left in its buffer, then shuts down. All motors and heaters are turned off. It can be started again by pressing the reset button on the master microcontroller, although this step is not mandatory on RepRapFirmware. See also <code>M1</code>, <code>M112</code>.</p>
<p>The Marlin Firmware does wait for user to press a button on the LCD, or a specific time. “M0 P2000” waits 2000 milliseconds, “M0 S2” waits 2 seconds.</p>
<p>RepRapFirmware executes cancel.g if this file is present, if the print is paused and if the axes are homed. Otherwise stop.g is run and the drives are put into idle mode. Also the heaters are turned off if no ‘H1’ parameter is specified.</p>
<p>Notes</p>
<p><sup>1</sup>Not available in RepRapFirmware, but as a work-around <code>G4</code> can be run before <code>M0</code>.</p>
<p><sup>2</sup>Only available on Marlin and Prusa Firmware.</p>
<p><sup>3</sup>“Wait for user …” is shown on LCD in Prusa Firmware.</p>
<h4 id="M1-Sleep-or-Conditional-stop"><a href="#M1-Sleep-or-Conditional-stop" class="headerlink" title="M1: Sleep or Conditional stop"></a>M1: Sleep or Conditional stop</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M1</span><br><span class="line">M1 Hello world 1 </span><br></pre></td></tr></table></figure>

<p>The RepRap machine finishes any moves left in its buffer, then shuts down. All motors and heaters are turned off. It can still be sent G and M codes, the first of which will wake it up again. See also <code>M0</code>, <code>M112</code>.</p>
<p>The Marlin does the same as <code>M0</code>.</p>
<p>In Prusa 8-bit Firmware <sup>1</sup> the <code>M1 </code> needs at least a <em>space</em> behind the command to be executed correctly. It can be used the same as <code>M0 P&lt;ms&gt;</code> or <code>M0 S&lt;seconds&gt;</code> but will ignore the following “message”.</p>
<p>Prusa Firmware 8-bit example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M1 S5</span><br><span class="line"> will wait for 5 seconds and show in the LCD status line &quot;Waiting for user...&quot; the same as M0 S5</span><br><span class="line"></span><br><span class="line">M1 Hello world</span><br><span class="line"> will show in the LCD status line &quot;Hello world&quot; and wait until the user press the LCD knob.</span><br></pre></td></tr></table></figure>

<p>If Marlin is emulated in RepRapFirmware, this does the same as <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M25:_Pause_SD_print" title="G-code">M25</a> if the code was read from a serial or Telnet connection, else the macro file <code>sleep.g</code> is run before all heaters and drives are turned off.</p>
<h4 id="M2-Program-End"><a href="#M2-Program-End" class="headerlink" title="M2: Program End"></a>M2: Program End</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M2</span><br></pre></td></tr></table></figure>

<p>Teacup firmware does the same as <code>M84</code>.</p>
<h4 id="M3-Spindle-On-Clockwise-CNC-specific"><a href="#M3-Spindle-On-Clockwise-CNC-specific" class="headerlink" title="M3: Spindle On, Clockwise (CNC specific)"></a>M3: Spindle On, Clockwise (CNC specific)</h4><p>Parameters</p>
<p><code>Snnn</code> Spindle RPM</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M3 S4000</span><br></pre></td></tr></table></figure>

<p>The spindle is turned on with a speed of 4000 RPM.</p>
<p>Teacup firmware turn extruder on (same as <code>M101</code>).</p>
<p>RepRapFirmware interprets this code only if in CNC mode (<code>M453</code>), in laser mode (<code>M452</code>) or if a Roland mill has been configured. You must always provide an S parameter with this command to specify the required spindle speed pr laser power. In RepRapFirmware 2.05RC2 and later, and RepRapFirmware 3.0beta13 and later, in laser mode (M452) the laser will only fire during G1&#x2F;G2&#x2F;G2 moves.</p>
<p>In Repetier-Firmware in laser mode you need <code>S0</code>..<code>S255</code> to set laser intensity. Normally you use <code>S255</code> to turn it on full power for moves. Laser will only fire during <code>G1</code>&#x2F;<code>G2</code>&#x2F;<code>G3</code> moves and in laser mode (<code>M452</code>).</p>
<h4 id="M4-Spindle-On-Counter-Clockwise-CNC-specific"><a href="#M4-Spindle-On-Counter-Clockwise-CNC-specific" class="headerlink" title="M4: Spindle On, Counter-Clockwise (CNC specific)"></a>M4: Spindle On, Counter-Clockwise (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M4 S4000</span><br></pre></td></tr></table></figure>

<p>The spindle is turned on with a speed of 4000 RPM.</p>
<h4 id="M5-Spindle-Off-CNC-specific"><a href="#M5-Spindle-Off-CNC-specific" class="headerlink" title="M5: Spindle Off (CNC specific)"></a>M5: Spindle Off (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M5</span><br></pre></td></tr></table></figure>

<p>The spindle is turned off.</p>
<p>Teacup firmware turn extruder off (same as <code>M103</code>).</p>
<h4 id="M6-Tool-change"><a href="#M6-Tool-change" class="headerlink" title="M6: Tool change"></a>M6: Tool change</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M6</span><br></pre></td></tr></table></figure>

<h4 id="M7-Mist-Coolant-On-CNC-specific"><a href="#M7-Mist-Coolant-On-CNC-specific" class="headerlink" title="M7: Mist Coolant On (CNC specific)"></a>M7: Mist Coolant On (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M7</span><br></pre></td></tr></table></figure>

<p>Mist coolant is turned on (if available)</p>
<p>Teacup firmware turn on the fan, and set fan speed (same as <code>M106</code>).</p>
<h4 id="M8-Flood-Coolant-On-CNC-specific"><a href="#M8-Flood-Coolant-On-CNC-specific" class="headerlink" title="M8: Flood Coolant On (CNC specific)"></a>M8: Flood Coolant On (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M8</span><br></pre></td></tr></table></figure>

<p>Flood coolant is turned on (if available)</p>
<h4 id="M9-Coolant-Off-CNC-specific"><a href="#M9-Coolant-Off-CNC-specific" class="headerlink" title="M9: Coolant Off (CNC specific)"></a>M9: Coolant Off (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M9</span><br></pre></td></tr></table></figure>

<p>All coolant systems are turned off.</p>
<h4 id="M10-Vacuum-On-CNC-specific"><a href="#M10-Vacuum-On-CNC-specific" class="headerlink" title="M10: Vacuum On (CNC specific)"></a>M10: Vacuum On (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M10</span><br></pre></td></tr></table></figure>

<p>Dust collection vacuum system turned on.</p>
<h4 id="M11-Vacuum-Off-CNC-specific"><a href="#M11-Vacuum-Off-CNC-specific" class="headerlink" title="M11: Vacuum Off (CNC specific)"></a>M11: Vacuum Off (CNC specific)</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M11</span><br></pre></td></tr></table></figure>

<p>Dust collection vacuum system turned off.</p>
<h4 id="M13-Spindle-on-clockwise-rotation-and-coolant-on-flood"><a href="#M13-Spindle-on-clockwise-rotation-and-coolant-on-flood" class="headerlink" title="M13: Spindle on (clockwise rotation) and coolant on (flood)"></a>M13: Spindle on (clockwise rotation) and coolant on (flood)</h4><p>This one M-code does the work of both M03 and M08. It is not unusual for specific machine models to have such combined commands, which make for shorter, more quickly written programs.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M13</span><br></pre></td></tr></table></figure>

<h4 id="M16-Expected-Printer-Check"><a href="#M16-Expected-Printer-Check" class="headerlink" title="M16: Expected Printer Check"></a>M16: Expected Printer Check</h4><p>Do a case-sensitive comparison between the string argument and the configured <code>MACHINE_NAME</code>. If the machine name doesn’t match, halt the printer so that a reset is required. This safety feature is meant to prevent G-code sliced for a specific machine from being used on any other machine. In Marlin this feature is enabled with <code>EXPECTED_PRINTER_CHECK</code>.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M16 Cookie Monster</span><br></pre></td></tr></table></figure>

<h4 id="M17-Enable-Power-all-stepper-motors"><a href="#M17-Enable-Power-all-stepper-motors" class="headerlink" title="M17: Enable&#x2F;Power all stepper motors"></a>M17: Enable&#x2F;Power all stepper motors</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.<sup>1</sup></em></p>
<p><code>X</code> X axis</p>
<p><code>Y</code> Y axis</p>
<p><code>Z</code> Z axis</p>
<p><code>E</code> All extruders</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M17</span><br><span class="line">M17 X E0</span><br></pre></td></tr></table></figure>

<p>Powers on stepper motors.</p>
<p>Notes</p>
<p><sup>1</sup>Ability to specify axes was added to Marlin 2.0 and may not be available on other firmware implementations.</p>
<h4 id="M18-Disable-all-stepper-motors"><a href="#M18-Disable-all-stepper-motors" class="headerlink" title="M18: Disable all stepper motors"></a>M18: Disable all stepper motors</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.<sup>1</sup><sup>3</sup></em></p>
<p><code>X</code> X axis</p>
<p><code>Y</code> Y axis</p>
<p><code>Z</code> Z axis</p>
<p><code>E</code> Extruder drive(s)<sup>2</sup></p>
<p><code>S</code> Seconds<sup>3</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M18</span><br><span class="line">M18 X E0</span><br></pre></td></tr></table></figure>

<p>Disables stepper motors and allows axes to move ‘freely.’</p>
<p>On Marlin, <code>M18</code> is a synonym of <code>M84</code>, so it can also be used to configure or disable the idle timeout.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M18 S10  ; Idle steppers after 10 seconds of inactivity</span><br><span class="line">M18 S0   ; Disable idle timeout</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p><sup>1</sup>Some firmware implementations do not support parameters to be passed, but at least Marlin and RepRapFirmware do.</p>
<p><sup>2</sup>RepRapFirmware allows stepper motors to be disabled selectively. For example, <code>M18 X E0:2</code> will disable the X, extruder 0 and extruder 2 motors.</p>
<p><sup>3</sup>In Prusa Firmware this command can be used to set the stepper inactivity timeout (`S`) or to disable steppers (`X`,`Y`,`Z`,`E`)</p>
<h4 id="M20-List-SD-card"><a href="#M20-List-SD-card" class="headerlink" title="M20: List SD card"></a>M20: List SD card</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Snnn</code> Output style<sup>1</sup></p>
<p><code>Rnnn</code> File number to start at<sup>1</sup></p>
<p><code>Cnnn</code> Maximum number of files to return<sup>1</sup></p>
<p><code>P&quot;ddd&quot;</code> Directory to list<sup>2</sup></p>
<p><code>L</code> Reports long filenames instead of just short filenames. Requires host software parsing (Cap:EXTENDED_M20).<sup>4</sup></p>
<p><code>T</code> Report timestamps as well. The value is one uint32_t encoded as hex. Requires host software parsing (Cap:EXTENDED_M20).<sup>4</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M20</span><br><span class="line">M20 S2 P&quot;/gcodes/subdir&quot;</span><br><span class="line">M20 L 4</span><br><span class="line">M20 T 4</span><br></pre></td></tr></table></figure>

<p>This code lists all files in the root folder or G-code directory of the SD card to the serial port. One name per line, like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQUARE.G</span><br><span class="line">SQCOM.G</span><br><span class="line">ZCARRI~2.GCO</span><br><span class="line">CARRIA~1.GCO</span><br></pre></td></tr></table></figure>

<p>Please note that a file list response is usually encapsulated. Standard configurations of RepRapFirmware mimic this style in emulation mode:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Begin file list:</span><br><span class="line">SQUARE.G</span><br><span class="line">ZCARRI~2.GCO</span><br><span class="line">End file list</span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<p>The file size may be appended as an integer representing the size in bytes:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Begin file list:</span><br><span class="line">SQUARE.G 1234</span><br><span class="line">ZCARRI~2.GCO 234</span><br><span class="line">End file list </span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<p>At least OctoPrint also supports an additional format showing the file’s long name (see also M33) after the size:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Begin file list:</span><br><span class="line">SQUARE.G 1234 SQUARE.G</span><br><span class="line">ZCARRI~2.GCO 234 ZCARRIAGE_V2.GCO</span><br><span class="line">End file list </span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<p>If RepRapFirmware emulates no firmware compatibility, a typical response looks like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G-code files:</span><br><span class="line">&quot;Traffic cone.g&quot;,&quot;frog.gcode&quot;,&quot;calibration piece.g&quot;</span><br></pre></td></tr></table></figure>

<p>Note that some firmwares list file names in upper case, but - when sent to the <code>M23</code> command (below) they must be in lower case. Teacup and RepRapFirmware have no such trouble and accept both. RepRapFirmware always returns long filenames in the case in which they are stored.</p>
<p>Notes</p>
<p><sup>1</sup>RepRapFirmware specific: If the S2 parameter is used then the file list (or as much as can be fitted in the output buffer) is returned in JSON format as a single array called “files” with each name that corresponds to a subdirectory preceded by an asterisk, and the directory is returned in variable “dir”. The optional R parameter is the file number to start at, default 0. The JSON response also returns value “next” which is the number of the first file that wasn’t returned, or 0 if the last file in the folder was included in the response. This allows the caller to enumerate all files even if there are very many, by making successive M20 S2 calls with each call using R from the “next” value in the previous response, until “next” is zero. In RRF 3.6.0 and later the C parameter can be used to limit the maximum number of files that RRF returns in each response.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M20 S2 P/gcodes</span><br><span class="line">&#123;&quot;dir&quot;:&quot;\/gcodes&quot;,&quot;first&quot;:0,&quot;files&quot;:[&quot;4-piece-1-2-3-4.gcode&quot;,&quot;Hinged_Box.gcode&quot;,&quot;Hollow_Dodecahedron_190.gcode&quot;,&quot;*Calibration pieces&quot;],&quot;next&quot;:0&#125;</span><br></pre></td></tr></table></figure>

<p>Example for <code>M20 L</code><sup>4</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Begin file list</span><br><span class="line">TEST1.GCO 1234 &quot;TEST1.GCO&quot;</span><br><span class="line">DIR_ENTER: /TESTFO~1/ &quot;test folder&quot;</span><br><span class="line">DIR_EXIT</span><br><span class="line">LFNFIL~1.GCO 56789 &quot;LFN file.gcode&quot;</span><br><span class="line">End file list</span><br></pre></td></tr></table></figure>

<p>Example for <code>M20 L T</code><sup>4</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Begin file list</span><br><span class="line">TEST1.GCO 1234 0x52936b00 &quot;TEST1.GCO&quot;</span><br><span class="line">DIR_ENTER: /TESTFO~1/ &quot;test folder&quot;</span><br><span class="line">DIR_EXIT</span><br><span class="line">LFNFIL~1.GCO 56789 0x52936b08 &quot;LFN file.gcode&quot;</span><br><span class="line">End file list</span><br></pre></td></tr></table></figure>

<p>Example for <code>M20 T</code><sup>4</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Begin file list</span><br><span class="line">TEST1.GCO 1234 0x52936b00</span><br><span class="line">DIR_ENTER: /TESTFO~1/ &quot;test folder&quot;</span><br><span class="line">DIR_EXIT</span><br><span class="line">LFNFIL~1.GCO 56789 0x52936b08</span><br><span class="line">End file list</span><br></pre></td></tr></table></figure>

<p><sup>2</sup>This parameter is only supported by RepRapFirmware and defaults to the 0:&#x2F;gcodes directory, which is the directory that printable gcode files are normally stored in.</p>
<p><sup>3</sup>On Klipper, a virtual SD card is required for this to work.</p>
<p><sup>4</sup>The timestamp is a combination of both the date and time into a single integer and printed as a hex.</p>
<h4 id="M21-Initialize-SD-card"><a href="#M21-Initialize-SD-card" class="headerlink" title="M21: Initialize SD card"></a>M21: Initialize SD card</h4><p>Parameters</p>
<p><code>Pnnn</code> SD card number (RepRapFirmware only, default 0)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M21</span><br><span class="line">M21 P1</span><br></pre></td></tr></table></figure>

<p>The specified SD card is initialized. If an SD card is loaded when the machine is switched on, this will happen by default. SD card must be initialized for the other SD functions to work.</p>
<p>Marlin 2.0.9.4 added <code>S</code> and <code>U</code> parameters to mount the SD Card or USB drive, respectively. Hosts can look for “<code>Cap:MULTI_VOLUME:1</code>“.</p>
<p>Notes</p>
<p><sup>1</sup>On Klipper, a virtual SD card is required for this to work.</p>
<p><sup>2</sup>On Druid:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M21 is named &quot;Mount Media&quot;</span><br><span class="line">M21 P0 or S = Mount external SD CARD </span><br><span class="line">M21 P1 or M = Mount onboard Micro Sd-Card</span><br><span class="line">M21 P2 or U = Mount USB Flash Drive</span><br><span class="line">M21         = Mount current volume</span><br></pre></td></tr></table></figure>

<h4 id="M22-Release-SD-card"><a href="#M22-Release-SD-card" class="headerlink" title="M22: Release SD card"></a>M22: Release SD card</h4><p>Parameters</p>
<p><code>Pnnn</code> SD card number (RepRapFirmware only, default 0)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M22</span><br><span class="line">M22 P1</span><br></pre></td></tr></table></figure>

<p>The specified SD card is released, so further (accidental) attempts to read from it are guaranteed to fail. Helpful, but not mandatory before removing the card physically.</p>
<h4 id="M23-Select-SD-file"><a href="#M23-Select-SD-file" class="headerlink" title="M23: Select SD file"></a>M23: Select SD file</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M23 filename.gco</span><br></pre></td></tr></table></figure>

<p>The file specified as filename.gco (8.3 naming convention is supported) is selected ready for printing. RepRapFirmware supports long filenames as well as 8.3 format.</p>
<p>Notes</p>
<p><sup>1</sup>On Klipper, a virtual SD card is required for this to work.</p>
<h4 id="M24-Start-resume-SD-print"><a href="#M24-Start-resume-SD-print" class="headerlink" title="M24: Start&#x2F;resume SD print"></a>M24: Start&#x2F;resume SD print</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M24</span><br></pre></td></tr></table></figure>

<p>The machine prints from the file selected with the <code>M23</code> command. If the print was previously paused with <code>M25</code>, printing is resumed from that point. To restart a file from the beginning, use <code>M23</code> to reset it, then <code>M24</code>.</p>
<p>When this command is used to resume a print that was paused, RepRapFirmware runs macro file <code>resume.g</code> prior to resuming the print.</p>
<p>Notes</p>
<p><sup>1</sup>On Klipper, a virtual SD card is required for this to work.</p>
<h4 id="M25-Pause-SD-print"><a href="#M25-Pause-SD-print" class="headerlink" title="M25: Pause SD print"></a>M25: Pause SD print</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M25</span><br></pre></td></tr></table></figure>

<p>The machine pauses printing at the current position within the file. To resume printing, use <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M24:_Start.2Fresume_SD_print" title="G-code">M24</a>. Do not use this code within a GCode file to pause the print at that point, use <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M226:_Gcode_Initiated_Pause" title="G-code">M226</a> instead.</p>
<p>Prior to pausing, RepRapFirmware runs macro file <code>pause.g</code>. This allows the head to be moved away from the print, filament to be retracted, etc.</p>
<p>RepRapFirmware 1.20 and later also save the current state of the print to file &#x2F;sys&#x2F;resurrect.g. This is so that if the printer is turned off after pausing, the print can subsequently be resumed.</p>
<p>Without any parameters it will park the extruder to default or last set position. The default pause position will be set during power up and a reset, the new pause positions aren’t permanent.</p>
<p>Usage</p>
<p><code>M25 [ X | Y | Z | S ]</code> <sup>2</sup></p>
<p>Parameters</p>
<p><code>X</code> X position to park <sup>2</sup></p>
<p><code>Y</code> Y position to park <sup>2</sup></p>
<p><code>Z</code> Z raise before park <sup>2</sup></p>
<p><code>S</code> Set values [S0 &#x3D; set to default values | S1 &#x3D; set values] without pausing <sup>2</sup></p>
<p>Notes</p>
<p><sup>1</sup>On Klipper, a virtual SD card is required for this to work.</p>
<p><sup>2</sup>Prusa Firmware equivalent to M125 and M601</p>
<h4 id="M26-Set-SD-position"><a href="#M26-Set-SD-position" class="headerlink" title="M26: Set SD position"></a>M26: Set SD position</h4><p>Parameters</p>
<p><code>Snnn</code> File position from start of file in bytes</p>
<p><code>Pnnn</code> (Optional, RepRapFirmware only) Fraction of the first move to be skipped, default 0.0, must be less than 1.0</p>
<p><code>Xnnn,Ynnn,Znnn&lt;code&gt; (Optional, RepRapFirmware only) If the command at the specified file position is a G2 or G3 command and the P parameter is nonzero then two of these (e.g. X and Y if the XY plane is selected) are used to provide the coordinates of the centre of the arc.</code></p>
<p><code>  Example  M26 S49315  </code></p>
<p><code>Set the file offset in bytes from the start of the SD card file selected by M23. The offset must correspond to the start of a G-code command. </code></p>
<p><code>RepRapFirmware uses this command as part of the procedure to recover a job following a power failure. </code></p>
<p><code>  Notes  &lt;sup&gt;1&lt;/sup&gt;On Klipper, a virtual SD card is required for this to work.  #### M27: Report SD print status  &lt;table&gt; &lt;tbody&gt;&lt;tr&gt; &lt;th rowspan=&quot;4&quot;&gt; Support &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Marlin&quot;&gt;Marlin&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/RepRapFirmware&quot;&gt;RepRapFirmware&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Klipper&quot;&gt;Klipper&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Prusa_Firmware&quot;&gt;Prusa&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Prusa_Buddy_Firmware&quot;&gt;Buddy&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Repetier-Firmware&quot;&gt;Repetier&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Smoothie&quot;&gt;Smoothie&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Druid_Firmware&quot;&gt;Druid&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/MK4duo&quot;&gt;MK4duo&lt;/a&gt; &lt;/th&gt;&lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;Yes&lt;sup&gt;1&lt;/sup&gt; &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;??? &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt;&lt;/tr&gt; &lt;tr&gt; &lt;th&gt;  &lt;a href=&quot;https://reprap.org/wiki/Grbl&quot;&gt;grbl&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Sprinter&quot;&gt;Sprinter&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/RapMan&quot;&gt;BFB&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/FiveD&quot;&gt;FiveD&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Machinekit&quot;&gt;Machinekit&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Redeem&quot;&gt;Redeem&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Teacup&quot;&gt;Teacup&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/Yaskawa&quot;&gt;Yaskawa&lt;/a&gt; &lt;/th&gt; &lt;th&gt; &lt;a href=&quot;https://reprap.org/wiki/MakerBot&quot;&gt;MakerBot&lt;/a&gt; &lt;/th&gt;&lt;/tr&gt; &lt;tr&gt; &lt;td&gt;??? &lt;/td&gt; &lt;td&gt;Yes &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;No &lt;/td&gt; &lt;td&gt;??? &lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;   Parameters   **C** Report the open file&#39;s name and long name (Marlin 1.1.9 and up)   **Sn** Set the auto-report interval (Marlin 1.1.9 and up)  Example  ``` M27 ```  Report SD print status.  Marlin and RepRapFirmware report the number of bytes processed in this format, which can be processed by Pronterface:  ``` SD printing byte 2134/235422 ```  If no file is being printed, only this message is reported:  ``` Not SD printing. ``` </code></p>
<p><code>In Marlin 1.1.9 and up &lt;code&gt;M27 C</code> reports the open file’s DOS 8.3 name and long filename, if any.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M27 C</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Current file: filena~1.gco Filenagotcha.gcode</span><br></pre></td></tr></table></figure>

<p>In Marlin 1.1.9 and up <code>M27 Sn</code> sets the auto-report interval. This requires the <code>AUTO_REPORT_SD_STATUS</code> configuration option to be enabled. Marlin reports this capability in <code>M115</code> as <code>Cap: AUTO_REPORT_SD_STATUS 1</code> when this option is available.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M27 S2 ; Report the SD card status every 2 seconds</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p><sup>1</sup>On Klipper, a virtual SD card is required for this to work.</p>
<h4 id="M28-Begin-write-to-SD-card"><a href="#M28-Begin-write-to-SD-card" class="headerlink" title="M28: Begin write to SD card"></a>M28: Begin write to SD card</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M28 filename.gco</span><br></pre></td></tr></table></figure>

<p>File specified by filename.gco is created (or overwritten if it exists) on the SD card and all subsequent commands sent to the machine are written to that file.</p>
<h4 id="M29-Stop-writing-to-SD-card"><a href="#M29-Stop-writing-to-SD-card" class="headerlink" title="M29: Stop writing to SD card"></a>M29: Stop writing to SD card</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M29 filename.gco</span><br></pre></td></tr></table></figure>

<p>File opened by <code>M28</code> command is closed, and all subsequent commands sent to the machine are executed as normal.</p>
<h4 id="M30-Delete-a-file-on-the-SD-card"><a href="#M30-Delete-a-file-on-the-SD-card" class="headerlink" title="M30: Delete a file on the SD card"></a>M30: Delete a file on the SD card</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M30 filename.gco</span><br><span class="line">&gt; filename.gco is deleted.</span><br></pre></td></tr></table></figure>

<h5 id="M30-Program-Stop"><a href="#M30-Program-Stop" class="headerlink" title="M30: Program Stop"></a>M30: Program Stop</h5><p>- For Yaskawa and in grbl - Same as M2 in Yaskawa G-code</p>
<p>Example</p>
<p>M30 ; Exchange pallet shuttles and end the program. Pressing cycle start will start the program at the beginning of the file.</p>
<h4 id="M31-Output-time-since-last-M109-or-SD-card-start-to-serial"><a href="#M31-Output-time-since-last-M109-or-SD-card-start-to-serial" class="headerlink" title="M31: Output time since last M109 or SD card start to serial"></a>M31: Output time since last <code>M109</code> or SD card start to serial</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M31</span><br></pre></td></tr></table></figure>

<p>The response looks like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo:54 min, 38 sec</span><br></pre></td></tr></table></figure>

<h4 id="M32-Select-file-and-start-SD-print"><a href="#M32-Select-file-and-start-SD-print" class="headerlink" title="M32: Select file and start SD print"></a>M32: Select file and start SD print</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M32 filename.gco</span><br></pre></td></tr></table></figure>

<p>It can be used when printing from SD card and does the same as <code>M23</code> and <code>M24</code>.</p>
<p>tba available in marlin(14&#x2F;6&#x2F;2014)</p>
<h4 id="M33-Get-the-long-name-for-an-SD-card-file-or-folder"><a href="#M33-Get-the-long-name-for-an-SD-card-file-or-folder" class="headerlink" title="M33: Get the long name for an SD card file or folder"></a>M33: Get the long name for an SD card file or folder</h4><p>Get the long name for a file or folder on the SD card from a dos path. Introduced in Marlin firmware 1.1.0 September 2015.</p>
<p>Example input:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M33 miscel~1/armchair/armcha~1.gco</span><br></pre></td></tr></table></figure>

<p>Example output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Miscellaneous/Armchair/Armchair.gcode</span><br></pre></td></tr></table></figure>

<h4 id="M33-Stop-and-Close-File-and-save-restart-gcode"><a href="#M33-Stop-and-Close-File-and-save-restart-gcode" class="headerlink" title="M33: Stop and Close File and save restart.gcode"></a>M33: Stop and Close File and save restart.gcode</h4><p>Stop the printing from SD and save all position in restart.gcode for restart printing in future</p>
<h4 id="M34-Set-SD-file-sorting-options"><a href="#M34-Set-SD-file-sorting-options" class="headerlink" title="M34: Set SD file sorting options"></a>M34: Set SD file sorting options</h4><p>Parameters</p>
<p><strong>S1</strong> Enable sorting</p>
<p><strong>S0</strong> Disable sorting</p>
<p><strong>F-1</strong> Folders first, followed by the files (both group, alphabetically)</p>
<p><strong>F0</strong> Folders and files together, listed alphabetically</p>
<p><strong>F1</strong> Files first, followed by folders (both group, alphabetically)</p>
<p>Enable and disable SD card file-sorting, and&#x2F;or set the folder sorting order. Proposed by Marlin firmware, May 2015.</p>
<h4 id="M35-Upload-firmware-NEXTION-from-SD"><a href="#M35-Upload-firmware-NEXTION-from-SD" class="headerlink" title="M35: Upload firmware NEXTION from SD"></a>M35: Upload firmware NEXTION from SD</h4><h4 id="M36-Return-file-information"><a href="#M36-Return-file-information" class="headerlink" title="M36: Return file information"></a>M36: Return file information</h4><p>Example</p>
<p>M36 filename.gco</p>
<p>M36</p>
<p>Returns information in JSON format for the specified SD card file (if a filename was provided) or for the file currently being printed. A sample response is:</p>
<p>{“err”:0,”size”:436831,”fileName”:”EscherLizardModified.gcode”,”lastModified”:”2017-09-21T16:58:07”,”height”:5.20,”layerHeight”:0.20,”printTime”:660,”simulatedTime”:1586,”filament”:[1280.7],”generatedBy”:”Simplify3D(R) Version 4.0.0”}</p>
<p>The “err” field is zero if successful, nonzero if the file was not found or an error occurred while processing it. The “size” field should always be present if the operation was successful. The presence or absence of other fields depends on whether the corresponding values could be found by reading the file. The “filament” field is an array of the filament lengths required from each spool. The size is in bytes, the times are in seconds, all other values are in mm. “printTime” is the printing time estimated by the slicer, “simulationTime” is the time measured when the print was simulated by the firmware. The fields may appear in any order, and additional fields may be present. Versions of RepRapFirmware prior to 3.4 do not provide the “fileName” field if information for a specific file was requested.</p>
<p>RepRapFirmware 3.4 and later also return information about thumbnail imaged embedded in the GCode file via an additional JSON field “thumbnails”. A sample value for this field is:</p>
<p>“thumbnails”:[{“width”:32,”height”:32,”fmt”:”qoi”,”offset”:103,”size”:2140},{“width”:220,”height”:220,”fmt”:”qoi”,”offset”:2384,”size”:25464}]</p>
<p>The “fmt” field denotes the encoding of the thumbnail and is either “png” or “qoi”. The “thumbnails” field is omitted entirely if there are no thumbnails embedded in the GCode file.</p>
<h4 id="M36-1-Return-embedded-thumbnail-data"><a href="#M36-1-Return-embedded-thumbnail-data" class="headerlink" title="M36.1: Return embedded thumbnail data"></a>M36.1: Return embedded thumbnail data</h4><p>Parameters</p>
<p><strong>P”filename”</strong> Name of the GCode file from which thumbnail data is to be retrieved</p>
<p><strong>Snnnn</strong> Byte offset into the file at which thumbnail data is to be fetched</p>
<p>This command is used to return the data for an thumbnail image in a GCode file. The offset value should be either the offset of the start of data for a thumbnail as returned by the M36 command, or the value returned in the “next” field by a previous M36.1 command. The response is in JSON format. Here is a sample response:</p>
<p>{fileName”:”EscherLizardModified.gcode”,”offset”:103,”data”:”cW9pZgAAACA….AAAAB”,”next”:0,err”: 0}</p>
<p>The “fileName” and “offset” values are as given in the command. “data” is part or all of the base64-encoded thumbnail data starting at that offset. “next” is zero if there is no more data for that thumbnail, otherwise not all the thumbnail data was returned and “next” is the byte offset in the file of the rest of the thumbnail data. “err” is 0 if the command was successful, otherwise “err” is nonzero and the other fields may or may not be present.</p>
<h4 id="M37-Simulation-mode"><a href="#M37-Simulation-mode" class="headerlink" title="M37: Simulation mode"></a>M37: Simulation mode</h4><p>Parameters</p>
<p><strong>S1</strong> Enter simulation mode</p>
<p><strong>S0</strong> Leave simulation mode</p>
<p><strong>P”filename”</strong> (optional) Simulate printing a file from SD card</p>
<p>Examples</p>
<p>M37 S1</p>
<p>M37 P”MyModel.g”</p>
<p>Used to switch between printing mode and simulation mode. Simulation mode allows the electronics to compute an accurate printing time, taking into account the maximum speeds, accelerations etc. that are configured.</p>
<p>M37 S1 enters simulation mode. All G and M codes will not be acted on, but the time they would take to execute will be calculated.</p>
<p>M37 S0 leaves simulation mode and prints the total time taken by simulated moves since entering simulation mode.</p>
<p>M37 with no S parameter prints the time taken by the simulation, from the time it was first entered using M37 S1, up to the current point (if simulation mode is still active) or the point that the simulation was ended (if simulation mode is no longer active).</p>
<p>M37 P”filename” enters simulation mode, prints the specified file, exits simulation mode, reports the print time, and appends it to the G-code file as a comment for later retrieval.</p>
<h4 id="M38-Compute-SHA1-hash-of-target-file"><a href="#M38-Compute-SHA1-hash-of-target-file" class="headerlink" title="M38 Compute SHA1 hash of target file"></a>M38 Compute SHA1 hash of target file</h4><p>Used to compute a hash of a file on the SD card. Examples:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; M38 gcodes/myfile.g</span><br><span class="line">&gt; Cannot find file</span><br><span class="line">&gt; M38 www/reprap.htm</span><br><span class="line">&gt; 91199139dbfadac15a18cfb962dfd4853db83999</span><br></pre></td></tr></table></figure>

<p>Returns a hexadecimal string which is the SHA1 of the file. If the file cannot be found, then the string “Cannot find file” is returned instead.</p>
<h4 id="M39-Report-SD-card-information"><a href="#M39-Report-SD-card-information" class="headerlink" title="M39 Report SD card information"></a>M39 Report SD card information</h4><p>Parameters</p>
<p><strong>Pn</strong> SD slot number, default 0</p>
<p><strong>Sn</strong> Response format. S0 returns a plain text response, S2 returns a response in JSON format.</p>
<p>Examples</p>
<p><strong>M39</strong>  ; report information for SD card 0 in plain text format</p>
<p><strong>M39 P1 S2</strong> ; report information for SD card 1 in JSON format</p>
<p>This command returns information about the SD card in the specified slot in the requested format. At least the following is returned:</p>
<ul>
<li>Whether or not a usable card is present in the slot</li>
<li>The capacity of the card in bytes (if a card is present)</li>
<li>The amount of free space on the card in bytes (if a card is present)</li>
</ul>
<p>The JSON response has the following format (more fields may be added in future):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;SDinfo&quot;:&#123;&quot;slot&quot;:0,&quot;present&quot;:1,&quot;capacity&quot;:4294967296,&quot;free&quot;:2147485184,&quot;speed&quot;:20971520,&quot;clsize&quot;:32768&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>The capacity, free space and cluster size are in bytes, and the interface speed is in bytes&#x2F;second.</p>
<h4 id="M40-Eject"><a href="#M40-Eject" class="headerlink" title="M40: Eject"></a>M40: Eject</h4><p>If your RepRap machine can eject the parts it has built off the bed, this command executes the eject cycle. This usually involves cooling the bed and then performing a sequence of movements that remove the printed parts from it. The X, Y and Z position of the machine at the end of this cycle are undefined (though they can be found out using the <code>M114</code> command, q.v.).</p>
<p>See also <code>M240</code> and <code>M241</code> below.</p>
<h4 id="M41-Loop"><a href="#M41-Loop" class="headerlink" title="M41: Loop"></a>M41: Loop</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M41</span><br></pre></td></tr></table></figure>

<p>If the RepRap machine was building a file from its own memory such as a local SD card (as opposed to a file being transmitted to it from a host computer) this goes back to the beginning of the file and runs it again. So, for example, if your RepRap is capable of ejecting parts from its build bed then you can set it printing in a loop and it will run and run. Use with caution - the only things that will stop it are:</p>
<ol>
<li>When you press the reset button,</li>
<li>When the build material runs out (if your RepRap is set up to detect this), and</li>
<li>When there’s an error (such as a heater failure).</li>
</ol>
<h4 id="M42-Switch-I-O-pin"><a href="#M42-Switch-I-O-pin" class="headerlink" title="M42: Switch I&#x2F;O pin"></a>M42: Switch I&#x2F;O pin</h4><p>Parameters</p>
<p><code>Pnnn</code> Pin number</p>
<p><code>Snnn</code> Pin value</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M42 P7 S255</span><br></pre></td></tr></table></figure>

<p><code>M42</code> switches a general purpose I&#x2F;O pin. Use <code>M42 Px Sy</code> to set pin x to value y, when omitting Px the LEDPIN will be used.</p>
<p>In Teacup, general purpose devices are handled like a heater, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#M104:_Set_Extruder_Temperature">M104</a>.</p>
<p>In Marlin Firmware, pin numbers for 32-bit processors are in the form PORT * 100 + PIN. So pin P1_02 on LPC1768 can be set with <code>M42 P102 S1</code>.</p>
<p>Marlin 1.x includes an <code>I</code> parameter to permit setting “volatile” pins that Marlin is using.</p>
<p>Marlin 2.0.5.2 - 2.0.9.3 uses the <code>M</code> parameter to set the pin mode: 0&#x3D;INPUT, 1&#x3D;OUTPUT, 2&#x3D;INPUT_PULLUP, 3&#x3D;INPUT_PULLDOWN. In Marlin 2.0.9.4 and up the <code>T</code> parameter is used instead.</p>
<p>In RepRapFirmware, the S field may be in the range 0..1 or 0..255. The pin reference is an internal firmware reference named “digital pin”, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Duet_pinout" title="Duet pinout">Duet pinout</a>. It maps on different connector pins depending the hardware. On Duet 0.6 and 0.8.5 hardware using pre-1.16 firmware, the supported pin numbers and their names on the expansion connector are:</p>
<table>
<thead>
<tr>
<th>P</th>
<th>Name</th>
<th>Expansion Port Pin</th>
</tr>
</thead>
<tbody><tr>
<td>16</td>
<td>TXD1</td>
<td>11</td>
</tr>
<tr>
<td>17</td>
<td>RXD1</td>
<td>12</td>
</tr>
<tr>
<td>18</td>
<td>TXD0</td>
<td>13</td>
</tr>
<tr>
<td>19</td>
<td>RXD0</td>
<td>14</td>
</tr>
<tr>
<td>20</td>
<td>TWD1</td>
<td>35</td>
</tr>
<tr>
<td>21</td>
<td>TWCK1</td>
<td>36</td>
</tr>
<tr>
<td>23</td>
<td>PA14</td>
<td>10</td>
</tr>
<tr>
<td>36</td>
<td>PC4</td>
<td>18</td>
</tr>
<tr>
<td>52</td>
<td>AD14</td>
<td>41</td>
</tr>
<tr>
<td>67</td>
<td>PB16</td>
<td>32</td>
</tr>
</tbody></table>
<p>In firmware 1.16, the pin numbering has changed.</p>
<table>
<thead>
<tr>
<th>P</th>
<th>Name</th>
<th>Expansion Port Pin</th>
</tr>
</thead>
<tbody><tr>
<td>60</td>
<td>PA10&#x2F;RXD0</td>
<td>14</td>
</tr>
<tr>
<td>61</td>
<td>PA11&#x2F;TXD0</td>
<td>13</td>
</tr>
<tr>
<td>62</td>
<td>PA12&#x2F;RXD1</td>
<td>12</td>
</tr>
<tr>
<td>63</td>
<td>PA13&#x2F;TXD1</td>
<td>11</td>
</tr>
<tr>
<td>64</td>
<td>PA14&#x2F;RTS1</td>
<td>10</td>
</tr>
<tr>
<td>65</td>
<td>PB12&#x2F;TWD1</td>
<td>35</td>
</tr>
<tr>
<td>66</td>
<td>PB13&#x2F;TWCK1</td>
<td>36</td>
</tr>
<tr>
<td>67</td>
<td>PB16&#x2F;DAC1*</td>
<td>32</td>
</tr>
<tr>
<td>68</td>
<td>PB21&#x2F;AD14</td>
<td>41</td>
</tr>
<tr>
<td>69</td>
<td>PC4</td>
<td>18</td>
</tr>
</tbody></table>
<ul>
<li>Also used as CS signal on external SD card socket</li>
</ul>
<table>
<thead>
<tr>
<th>P</th>
<th>Signal Name</th>
<th>Expansion Connector Label</th>
<th>Expansion Pin</th>
</tr>
</thead>
<tbody><tr>
<td>60</td>
<td>CS5</td>
<td>CS5</td>
<td>50</td>
</tr>
<tr>
<td>61</td>
<td>CS6</td>
<td>E3_STOP</td>
<td>9</td>
</tr>
<tr>
<td>62</td>
<td>CS7</td>
<td>E4_STOP</td>
<td>14</td>
</tr>
<tr>
<td>63</td>
<td>CS8</td>
<td>E5_STOP</td>
<td>19</td>
</tr>
</tbody></table>
<p>See <a target="_blank" rel="noopener" href="https://duet3d.com/wiki/Using_servos_and_controlling_unused_I/O_pins">Using servos and controlling unused I&#x2F;O pins</a> for all pin definitions.</p>
<p>Pre-1.16 example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M42 P20 S1 ;set the connector pin 35 to high.</span><br></pre></td></tr></table></figure>

<p>On RADDS hardware running RepRapFirmware-dc42, the supported Arduino Due pin numbers and their names are:</p>
<p>5 TIOA6, 6 PWML7, 39 PWMH2, 58 AD3, 59 AD2, 66 DAC0, 67 DAC1, 68 CANRX0, 69 CANTX0, 70 SDA1, 71 SCL1, 72 RX LED, 73 TX LED.</p>
<p>See also <code>M583</code>.</p>
<h4 id="M43-Stand-by-on-material-exhausted"><a href="#M43-Stand-by-on-material-exhausted" class="headerlink" title="M43: Stand by on material exhausted"></a>M43: Stand by on material exhausted</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M43</span><br></pre></td></tr></table></figure>

<p>If your RepRap can detect when its material runs out, this decides the behaviour when that happens. The X and Y axes are zeroed (but not Z), and then the machine shuts all motors and heaters off except the heated bed, the temperature of which is maintained. The machine will still respond to G and M code commands in this state.</p>
<h4 id="M43-Pin-report-and-debug"><a href="#M43-Pin-report-and-debug" class="headerlink" title="M43: Pin report and debug"></a>M43: Pin report and debug</h4><p>Usage</p>
<p><code>M43 En Pnnn Wn In</code></p>
<p>Parameters</p>
<p><code>En</code> Enable &#x2F; disable background endstop monitoring</p>
<p><code>Pnnn</code> Pin to read or watch. If omitted, read&#x2F;watch all pins</p>
<p><code>Wn</code> bool watch pins -reporting changes- until reset, click, or <code>M108</code></p>
<p><code>In</code> bool Flag to ignore pin protection</p>
<p>Note</p>
<p>You must have <code>PINS_DEBUGGING</code> uncommented in your <code>Configuration_adv.h</code> file for M43 to work.</p>
<h4 id="M44-Codes-debug-report-codes-available"><a href="#M44-Codes-debug-report-codes-available" class="headerlink" title="M44: Codes debug - report codes available"></a>M44: Codes debug - report codes available</h4><p>In MK4duo you must enable <code>FASTER_GCODE_EXECUTE</code> to get this G-code.</p>
<p>Parameters</p>
<p><code>In</code> G-code list</p>
<p><code>Jn</code> M-code list</p>
<h4 id="M44-Reset-the-bed-skew-and-offset-calibration"><a href="#M44-Reset-the-bed-skew-and-offset-calibration" class="headerlink" title="M44: Reset the bed skew and offset calibration"></a>M44: Reset the bed skew and offset calibration</h4><p>Resets the bed skew and offset calibration on Prusa i3 MK2&#x2F;s,MK2.5&#x2F;s,MK3&#x2F;s.</p>
<h4 id="M45-Bed-skew-and-offset-with-manual-Z-up"><a href="#M45-Bed-skew-and-offset-with-manual-Z-up" class="headerlink" title="M45: Bed skew and offset with manual Z up"></a>M45: Bed skew and offset with manual Z up</h4><p>Runs the xyz calibration on Prusa i3 MK2&#x2F;s,MK2.5&#x2F;s,MK3&#x2F;s.</p>
<p>Parameters</p>
<p><code>Vnn</code> Verbosity level 1, 10 and 20 (low, mid, high). Only when SUPPORT_VERBOSITY is defined. This parameter is optional.</p>
<h4 id="M46-Show-the-assigned-IP-address"><a href="#M46-Show-the-assigned-IP-address" class="headerlink" title="M46: Show the assigned IP address"></a>M46: Show the assigned IP address</h4><p>Reports the assigned IP address of a Toshiba FlashAir on Prusa i3 MK2&#x2F;s,MK2.5&#x2F;s,MK3&#x2F;s. At this moment it is deactivated.</p>
<h4 id="M47-Show-end-stops-dialog-on-the-display"><a href="#M47-Show-end-stops-dialog-on-the-display" class="headerlink" title="M47: Show end stops dialog on the display"></a>M47: Show end stops dialog on the display</h4><p>Show end stops dialog on the display on Prusa i3 MK2&#x2F;s,MK2.5&#x2F;s,MK3&#x2F;s.</p>
<h4 id="M48-Measure-Z-Probe-repeatability"><a href="#M48-Measure-Z-Probe-repeatability" class="headerlink" title="M48: Measure Z-Probe repeatability"></a>M48: Measure Z-Probe repeatability</h4><p>Parameters</p>
<p><code>Pnnn</code> number of points</p>
<p><code>Xnnn</code> position on the X axis</p>
<p><code>Ynnn</code> position on the Y axis</p>
<p><code>Vnnn</code> verbosity</p>
<p><code>E</code> engage</p>
<p><code>Lnnn</code> legs of travel</p>
<p><code>S</code> schizoid</p>
<p>As with <code>G29</code>, the E flag causes the probe to stow after each probe.</p>
<p>The S flag will result is a random sized, 5 pointed star, being traced (X and Y axis) between each sample. Usually a user will get worse repeat-ability numbers with S specified because the X axis and Y axis movements will add to the machine’s positioning errors.</p>
<p>Prusa specific <sup>1</sup></p>
<p>This function assumes the bed has been homed. Specifically, that a G28 command as been issued prior to invoking the M48 Z-Probe repeatability measurement function. Any information generated by a prior G29 Bed leveling command will be lost and need to be regenerated.</p>
<p>The number of samples will default to 10 if not specified. You can use upper or lower case letters for any of the options EXCEPT n. n must be in lower case because Marlin uses a capital N for its communication protocol and will get horribly confused if you send it a capital N.</p>
<p>Usage</p>
<p><code>M48 nAA Xnnnn Ynnnn Vn Lnn</code></p>
<p>Parameters</p>
<p><code>nAA</code> number(AA) of samples, default&#x3D;10 (valid values between 4 and 50)</p>
<p><code>Xnnn</code> X position for samples</p>
<p><code>Ynnn</code> Y position for samples</p>
<p><code>Vn</code> Verbosity level 1-4 (low to highest)</p>
<p><code>Lnn</code> Legs of travel 1-15</p>
<h4 id="M49-Set-G26-debug-flag"><a href="#M49-Set-G26-debug-flag" class="headerlink" title="M49: Set G26 debug flag"></a>M49: Set G26 debug flag</h4><p>Usage</p>
<p>M49 S1 ; Enable G26 verbose debug output</p>
<h4 id="M70-Display-message"><a href="#M70-Display-message" class="headerlink" title="M70: Display message"></a>M70: Display message</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M70 P200 Message</span><br></pre></td></tr></table></figure>

<p>Display a message on the LCD. <code>P</code> is the time to display message for.</p>
<h4 id="M72-Firmware-dependent"><a href="#M72-Firmware-dependent" class="headerlink" title="M72: Firmware dependent"></a>M72: Firmware dependent</h4><h5 id="M72-Play-a-tone-or-song"><a href="#M72-Play-a-tone-or-song" class="headerlink" title="M72: Play a tone or song"></a>M72: Play a tone or song</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M72 P2</span><br></pre></td></tr></table></figure>

<p>Instruct the machine to play a preset song. Acceptable song IDs are machine specific. P is the ID of the song to play.</p>
<h5 id="M72-Set-get-Printer-State"><a href="#M72-Set-get-Printer-State" class="headerlink" title="M72: Set&#x2F;get Printer State"></a>M72: Set&#x2F;get Printer State</h5><p>Without any parameter get printer state</p>
<p><code>0</code> NotReady Used by PrusaConnect</p>
<p><code>1</code> IsReady Used by PrusaConnect</p>
<p><code>2</code> Idle</p>
<p><code>3</code> SD printing finished</p>
<p><code>4</code> Host printing finished</p>
<p><code>5</code> SD printing</p>
<p><code>6</code> Host printing</p>
<p>Usage</p>
<p><code>M72 [ S ]</code></p>
<p>Parameters</p>
<p><code>S</code> Set printer state 0 &#x3D; not_ready, 1 &#x3D; ready</p>
<h4 id="M73-Set-Get-build-percentage"><a href="#M73-Set-Get-build-percentage" class="headerlink" title="M73: Set&#x2F;Get build percentage"></a>M73: Set&#x2F;Get build percentage</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M73 P50</span><br></pre></td></tr></table></figure>

<p>Tell the firmware the current build progress percentage. The machine is expected to display this on its display. If the percentage is exactly 0 a “Build Start” notification is sent to the host. If the percentage is exactly 100 a “Build End” notification is sent to the host.</p>
<p>Use “M73” by itself to get a report of the current print progress.</p>
<p>Prusa specific<sup>1</sup></p>
<p>Prusa firmware shows percent done, time remaining and time to change&#x2F;pause&#x2F;user interaction.</p>
<p>Usage</p>
<p><code>M73 P R Q S C&lt;sup&gt;1&lt;/sup&gt; D&lt;sup&gt;1&lt;/sup&gt;</code></p>
<p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>P</code> Percent in normal mode</p>
<p><code>R</code> Time remaining in normal mode (minutes)</p>
<p><code>Q</code> Percent in silent mode</p>
<p><code>S</code> Time remaining in silent mode (minutes)</p>
<p><code>C</code> Time to change&#x2F;pause&#x2F;user interaction in normal mode (minutes)<sup>1</sup></p>
<p><code>D</code> Time to change&#x2F;pause&#x2F;user interaction in silent mode (minutes)<sup>1</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">M73</span><br><span class="line">echo NORMAL MODE: Percent done: ---%; print time remaining in mins: -----&quot;</span><br><span class="line">echo SILENT MODE: Percent done: ---%; print time remaining in mins: -----&quot;</span><br><span class="line"></span><br><span class="line">Prusa Firmware 3.10.0+1</span><br><span class="line">echo NORMAL MODE: Percent done: ---%; print time remaining in mins: -----; Change in mins: -----&quot;1</span><br><span class="line">echo SILENT MODE: Percent done: ---%; print time remaining in mins: -----; Change in mins: -----&quot;1</span><br></pre></td></tr></table></figure>

<h4 id="M74-Set-weight-on-print-bed"><a href="#M74-Set-weight-on-print-bed" class="headerlink" title="M74: Set weight on print bed"></a>M74: Set weight on print bed</h4><p>Parameters</p>
<p><code>W</code> Set the total mass in grams of everything that is currently on the bed.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M74 W100</span><br></pre></td></tr></table></figure>

<p>Tell the firmware the current weight of 100g on the bed.</p>
<h4 id="M75-Start-the-print-job-timer"><a href="#M75-Start-the-print-job-timer" class="headerlink" title="M75: Start the print job timer"></a>M75: Start the print job timer</h4><h4 id="M76-Pause-the-print-job-timer"><a href="#M76-Pause-the-print-job-timer" class="headerlink" title="M76: Pause the print job timer"></a>M76: Pause the print job timer</h4><h4 id="M77-Stop-the-print-job-timer"><a href="#M77-Stop-the-print-job-timer" class="headerlink" title="M77: Stop the print job timer"></a>M77: Stop the print job timer</h4><h4 id="M78-Show-statistical-information-about-the-print-jobs"><a href="#M78-Show-statistical-information-about-the-print-jobs" class="headerlink" title="M78: Show statistical information about the print jobs"></a>M78: Show statistical information about the print jobs</h4><h4 id="M79-Start-host-timer"><a href="#M79-Start-host-timer" class="headerlink" title="M79: Start host timer"></a>M79: Start host timer</h4><p>Start the printer-host enable keep-alive timer. While the timer has not expired, the printer will enable host specific features.</p>
<p>Usage</p>
<p><code>M79 [ S ]</code></p>
<p>Parameters</p>
<p><code>S</code> Quoted string containing two characters e.g. “PL”</p>
<h4 id="M80-ATX-Power-On"><a href="#M80-ATX-Power-On" class="headerlink" title="M80: ATX Power On"></a>M80: ATX Power On</h4><p>Parameters</p>
<p><code>C&quot;port_name&quot;</code> (RepRapFirmware 3.4 and later only) Name of the pin used to control the power supply, default “pson”</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M80           ; Turn on the power supply</span><br><span class="line">M80 S         ; Report power supply state (Marlin 1.1.1)</span><br><span class="line">M80 C&quot;!pson&quot;  ; invert the PS_ON output for Meanwell power supplies</span><br></pre></td></tr></table></figure>

<p>Turns on the ATX power supply from standby mode to fully operational mode. No-op on electronics without standby mode.</p>
<p>Notes</p>
<ul>
<li>Marlin requires the <code>POWER_SUPPLY</code> configuration option to be set to a non-zero value to enable <code>M80</code>.</li>
<li>Some firmwares (e.g., <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Teacup_Firmware" title="Teacup Firmware">Teacup</a>) handle power on&#x2F;off automatically, so this is redundant there. Also, see <a target="_blank" rel="noopener" href="http://forums.reprap.org/read.php?219,132664">RAMPS wiring for ATX on&#x2F;off</a>.</li>
<li>Prusa requires <code>defined (PS_ON_PIN)</code> and <code>PS_ON_PIN</code> must be set.<sup>1</sup></li>
</ul>
<h4 id="M81-ATX-Power-Off"><a href="#M81-ATX-Power-Off" class="headerlink" title="M81: ATX Power Off"></a>M81: ATX Power Off</h4><p>Parameters</p>
<p><strong>P</strong> quit the daemon (redeem only)</p>
<p><strong>R</strong> restart the daemon (redeem only)</p>
<p><strong>Sn</strong> n&#x3D;0 turn power off immediately (default), n&#x3D;1 turn power off when all thermostatic fans have turned off (RepRapFirmware 1.20 and later only)</p>
<p>Examples</p>
<p>M81  ; turn power off immediately</p>
<p>M81 S1 ; turn power off when everything has cooled down (RepRapFirmware)</p>
<p>Turns off the ATX power supply. Counterpart to <code>M80</code>.</p>
<p>Notes</p>
<ul>
<li>Prusa requires <code>defined (PS_ON_PIN)</code> and <code>PS_ON_PIN</code> must be set to Power off.<sup>1</sup></li>
</ul>
<h4 id="M82-Set-extruder-to-absolute-mode"><a href="#M82-Set-extruder-to-absolute-mode" class="headerlink" title="M82: Set extruder to absolute mode"></a>M82: Set extruder to absolute mode</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M82</span><br></pre></td></tr></table></figure>

<p>Makes the extruder interpret extrusion as absolute positions.</p>
<p>This is the default in repetier and for Yaskawa controllers.</p>
<h4 id="M83-Set-extruder-to-relative-mode"><a href="#M83-Set-extruder-to-relative-mode" class="headerlink" title="M83: Set extruder to relative mode"></a>M83: Set extruder to relative mode</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M83</span><br></pre></td></tr></table></figure>

<p>Makes the extruder interpret extrusion values as relative positions.</p>
<p>Note that the Ultimaker 3 will revert back to absolute extrusion after each tool change.</p>
<h4 id="M84-Stop-idle-hold"><a href="#M84-Stop-idle-hold" class="headerlink" title="M84: Stop idle hold"></a>M84: Stop idle hold</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Innn</code> Reset flags<sup>1</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M84</span><br></pre></td></tr></table></figure>

<p>Stop the idle hold on all axis and extruder. In some cases the idle hold causes annoying noises, which can be stopped by disabling the hold. Be aware that by disabling idle hold during printing, you will get quality issues. This is recommended only in between or after printjobs.</p>
<p>On Marlin, Repetier and RepRapFirmware, <code>M84</code> can also be used to configure or disable the idle timeout. For example, “M84 S10” will idle the stepper motors after 10 seconds of inactivity. “M84 S0” will disable idle timeout; steppers will remain powered up regardless of activity. For Yaskawa systems M84 is not applicable due to servo motors not producing the annoying noises.</p>
<p>Notes</p>
<p><sup>1</sup>RepRapFirmware-dc42 and other firmware may not support this parameter.</p>
<p><sup>2</sup>Prusa firmware uses <code>M84</code> similar to <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M18:_Disable_all_stepper_motors" title="G-code">G-code#M18:_Disable_all_stepper_motors</a></p>
<p><sup>3</sup>On Klipper <code>M84</code> is equivalent to <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M18:_Disable_all_stepper_motors" title="G-code">G-code#M18:_Disable_all_stepper_motors</a></p>
<p>Prusa Usage</p>
<p><code>M84 E S X Y Z</code></p>
<p>Prusa Parameters</p>
<p><em>This command can be used without any additional parameters.<sup>2</sup></em></p>
<p><code>E</code> Extruder drive(s)<sup>2</sup></p>
<p><code>S</code> Seconds</p>
<p><code>X</code> X axis</p>
<p><code>Y</code> Y axis</p>
<p><code>Z</code> Z axis</p>
<h4 id="M85-Set-Inactivity-Shutdown-Timer"><a href="#M85-Set-Inactivity-Shutdown-Timer" class="headerlink" title="M85: Set Inactivity Shutdown Timer"></a>M85: Set Inactivity Shutdown Timer</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M85 S30</span><br></pre></td></tr></table></figure>

<p>Set Inactivity Shutdown Timer with parameter S<seconds>. “M85 S0” will disable the inactivity shutdown time (default)</p>
<h4 id="M86-Set-Safety-Timeout"><a href="#M86-Set-Safety-Timeout" class="headerlink" title="M86: Set Safety Timeout"></a>M86: Set Safety Timeout</h4><p>Usage</p>
<p><code>M86 Snnnn</code></p>
<p>Parameters</p>
<p><code>S</code> Seconds</p>
<p><code>T</code> Trigger Temperature (Marlin)</p>
<p><code>E</code> Extruder Idle Temperature (Marlin)</p>
<p><code>B</code> Bed Idle Temperature (Marlin)</p>
<p>Similar to <code>M85</code> but applies to the “safety timer” in Prusa and Marlin Firmware.</p>
<p>Set the Safety Timeout in seconds. <strong>M86 S0</strong> will disable the safety timer.</p>
<p>When the safety timer expires, heatbed and nozzle target temperatures are set to zero (Prusa Firmware) or idle temperatures (Marlin).</p>
<p>In Marlin Firmware the Hotend Idle Timeout is active whenever the hotend temperature goes above the trigger value and the timer gets reset whenever the extruder or other axes move. So if the machine is sitting idle for the timeout period (set by <strong>M86 T</strong>) the machine will reduce the hotend and bed temperatures to those set by <strong>M86 E</strong> and <strong>M86 B</strong>. These settings are saved to the EEPROM by <strong>M500</strong> and reset to configuration defaults by <strong>M502</strong>.</p>
<h4 id="M87-Cancel-Safety-Timer"><a href="#M87-Cancel-Safety-Timer" class="headerlink" title="M87: Cancel Safety Timer"></a>M87: Cancel Safety Timer</h4><p>Usage</p>
<p><code>M87</code></p>
<p>Cancels the safety timer. Equivalent to <code>M86 S0</code>.</p>
<h4 id="M92-Set-axis-steps-per-unit"><a href="#M92-Set-axis-steps-per-unit" class="headerlink" title="M92: Set axis_steps_per_unit"></a>M92: Set axis_steps_per_unit</h4><p>Parameters</p>
<p><code>Xnnn</code> Steps per unit for the X drive</p>
<p><code>Ynnn</code> Steps per unit for the Y drive</p>
<p><code>Znnn</code> Steps per unit for the Z drive</p>
<p><code>Ennn</code> Steps per unit for the extruder drive(s)</p>
<p><code>Snnn</code> Defines in which microstepping the above steps per unit are given. If omitted it will use the microstepping currently set by M350.<sup>1</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M92 X87.489 Y87.489 Z87.489</span><br><span class="line">M92 E420:420</span><br></pre></td></tr></table></figure>

<p>Allows programming of steps per unit (usually mm) for motor drives. These values are reset to firmware defaults on power on, unless saved to EEPROM if available (<code>M500</code> in Marlin) or in the configuration file (config.g in RepRapFirmware). Very useful for calibration.</p>
<p>RepRapFirmware will report the current steps&#x2F;mm if you send <code>M92</code> without any parameters. For Yaskawa systems M92&#x2F;M93 is not applicable due to use of servo motors.</p>
<p>Notes</p>
<p><sup>1</sup> Only available in RepRapFirmware &gt;&#x3D;2.03</p>
<h4 id="M93-Send-axis-steps-per-unit"><a href="#M93-Send-axis-steps-per-unit" class="headerlink" title="M93: Send axis_steps_per_unit"></a>M93: Send axis_steps_per_unit</h4><h4 id="M98-Call-Macro-Subprogram"><a href="#M98-Call-Macro-Subprogram" class="headerlink" title="M98: Call Macro&#x2F;Subprogram"></a>M98: Call Macro&#x2F;Subprogram</h4><p>Parameters</p>
<p><code>Pnnn</code> Macro filename. In RepRapFirmware 3 this must be enclosed in double-quote characters. In RepRapFirmware 2 the double-quote characters are optional.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M98 Pmymacro.g</span><br><span class="line">M98 P&quot;mymacro.g&quot;</span><br></pre></td></tr></table></figure>

<p>Runs the macro in the file mymacro.g. In conventional G Codes for CNC machines the <code>P</code> parameter normally refers to a line number in the program itself (P2000 would run the Macro starting at line O2000, say). For RepRap, which almost always has some sort of mass storage device inbuilt, it simply refers to the name of a G-code file that is executed by the <code>G98</code> call. That G-code file does not need to end with an <code>M99</code> (return) as the end-of-file automatically causes a return. RepRapFirmware supports nested macro calls up to a depth of 5.</p>
<p>Certain machine parameters are saved at the start of the macro call and restored at the end. For RepRapFirmware these are: axis movement relative&#x2F;absolute mode, extruder movement absolute&#x2F;relative mode, feed rate, inches&#x2F;mm setting, and whether or not volumetric extrusion is selected. This allows the macro to change these settings without affecting the subsequent behaviour of the calling file.</p>
<p>RepRapFirmware also allows the filename to include a path to a subdirectory. For relative paths, the default folder is &#x2F;sys, but some implementations may check the &#x2F;macros directory too. Absolute file paths are supported by RepRapFirmware too.</p>
<h4 id="M99-Return-from-Macro-Subprogram"><a href="#M99-Return-from-Macro-Subprogram" class="headerlink" title="M99: Return from Macro&#x2F;Subprogram"></a>M99: Return from Macro&#x2F;Subprogram</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M99</span><br></pre></td></tr></table></figure>

<p>Returns from an <code>M98</code> call.</p>
<p>RepRapFirmware closes the currently active macro file. If a nested macro is being run, RepRapFirmware goes up one stack level.</p>
<h4 id="M101-Turn-extruder-1-on-Forward-Undo-Retraction"><a href="#M101-Turn-extruder-1-on-Forward-Undo-Retraction" class="headerlink" title="M101: Turn extruder 1 on (Forward), Undo Retraction"></a>M101: Turn extruder 1 on (Forward), Undo Retraction</h4><p>In Teacup firmware: If a DC extruder is present, turn that on. Else, undo filament retraction, which means, make the extruder ready for extrusion. Complement to <code>M103</code>.</p>
<p>In BFB&#x2F;RapMan: Turn extruder on (forward&#x2F;filament in).</p>
<p>In RepRapFirmware: undo filament retraction. The length and speed are set by the <code>M207</code> command. RepRapFirmware supports this command for compatibility with Simplify3D.</p>
<p>In other firmwares: Deprecated. Regarding filament retraction, see <code>G10</code>, <code>G11</code>, <code>M207</code>, <code>M208</code>, <code>M227</code>, <code>M228</code>, <code>M229</code>.</p>
<h4 id="M102-Turn-extruder-1-on-Reverse"><a href="#M102-Turn-extruder-1-on-Reverse" class="headerlink" title="M102: Turn extruder 1 on (Reverse)"></a>M102: Turn extruder 1 on (Reverse)</h4><p>In BFB&#x2F;RapMan firmware: Turn extruder on Reverse (Still to add)</p>
<h4 id="M102-Configure-Distance-Sensor"><a href="#M102-Configure-Distance-Sensor" class="headerlink" title="M102: Configure Distance Sensor"></a>M102: Configure Distance Sensor</h4><p>For Marlin’s <code>BD_SENSOR</code> option, configure the sensor.</p>
<p><code>M102 S&lt;10ths&gt;</code> : Set adjustable Z height in 10ths of a mm (e.g., ‘<code>M102 S4</code>‘ enables adjusting for Z &lt;&#x3D; 0.4mm.)</p>
<p><code>M102 S0</code> : Disable adjustable Z height.</p>
<p>Negative S values are commands</p>
<p><code>M102 S-1</code> : Read sensor information</p>
<p><code>M102 S-5</code> : Read raw Calibration data</p>
<p><code>M102 S-6</code> : Start Calibration</p>
<h4 id="M103-Turn-all-extruders-off-Extruder-Retraction"><a href="#M103-Turn-all-extruders-off-Extruder-Retraction" class="headerlink" title="M103: Turn all extruders off, Extruder Retraction"></a>M103: Turn all extruders off, Extruder Retraction</h4><p>In Teacup firmware: If a DC extruder is present, turn that off. Else, retract the filament in the hope to prevent nozzle drooling. Complement to <code>M101</code>.</p>
<p>In BFB&#x2F;RapMan firmware: Turn extruder off.</p>
<p>In RepRapFirmware: retract filament. The length and speed are set by the <code>M207</code> command. RepRapFirmware supports this command for compatibility with Simplify3D.</p>
<p>In other firmwares: Deprecated. Regarding filament retraction, see <code>G10</code>, <code>G11</code>, <code>M207</code>, <code>M208</code>, <code>M227</code>, <code>M228</code>, <code>M229</code>.</p>
<h4 id="M104-Set-Extruder-Temperature"><a href="#M104-Set-Extruder-Temperature" class="headerlink" title="M104: Set Extruder Temperature"></a>M104: Set Extruder Temperature</h4><p>Parameters</p>
<p><code>C</code> Use fan for cooling (Buddy only)</p>
<p><code>Dnnn</code> Display temperature (Buddy only)</p>
<p><code>Snnn</code> Target temperature</p>
<p><code>Rnnn</code> Idle temperature (Only MK4duo)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M104 S190</span><br><span class="line">M104 S190 R170</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the current extruder to 190<sup>o</sup>C and return control to the host immediately (<em>i.e.</em> before that temperature has been reached by the extruder). See also <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#M109:_Set_Extruder_Temperature_and_Wait" title="G-code">M109</a>.</p>
<p>See also using <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G10:_Set_tool_Offset_and.2For_workplace_coordinates_and.2For_tool_temperatures" title="G-code">G10</a>. Deprecation of <code>M104</code> is <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Talk:G-code#M104_.26_M109_Deprecation.2C_G10_Introduction" title="Talk:G-code">subject to discussion</a>. –<a target="_blank" rel="noopener" href="https://reprap.org/wiki/User:Traumflug" title="User:Traumflug">Traumflug</a> 11:33, 19 July 2012 (UTC)</p>
<h5 id="M104-in-Marlin-Firmware"><a href="#M104-in-Marlin-Firmware" class="headerlink" title="M104 in Marlin Firmware"></a>M104 in Marlin Firmware</h5><p>See <a target="_blank" rel="noopener" href="http://marlinfw.org/docs/gcode/M104.html">Marlin Wiki</a>. In Marlin Firmware, using <code>M104</code> with no parameters will turn off the heater for the current extruder. This is also the case for <code>M104 S</code> without a number after the <code>S</code> parameter.</p>
<h5 id="M104-in-Teacup-Firmware"><a href="#M104-in-Teacup-Firmware" class="headerlink" title="M104 in Teacup Firmware"></a>M104 in Teacup Firmware</h5><p>In Teacup Firmware, <code>M104</code> can be additionally used to handle all devices using a temperature sensor. It supports the additional <code>P</code> parameter, which is a zero-based index into the list of sensors in config.h. For devices without a temp sensor, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#M106:_Fan_On">M106</a>.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M104 P1 S100</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the device attached to the second temperature sensor to 100°C.</p>
<h5 id="M104-in-RepRapFirmware-and-Klipper"><a href="#M104-in-RepRapFirmware-and-Klipper" class="headerlink" title="M104 in RepRapFirmware and Klipper"></a>M104 in RepRapFirmware and Klipper</h5><p>RepRapFirmware and some other firmwares support the optional <code>T</code> parameter (as generated by slic3r) to specify which tool the command applies to.</p>
<h4 id="M105-Get-Extruder-Temperature"><a href="#M105-Get-Extruder-Temperature" class="headerlink" title="M105: Get Extruder Temperature"></a>M105: Get Extruder Temperature</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M105</span><br></pre></td></tr></table></figure>

<p>Request the temperature of the current extruder, the build base and the build chamber in degrees Celsius. The temperatures are returned to the host computer. For example, the line sent to the host in response to this command can look like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ok T:201 B:117</span><br><span class="line">ok T:201 /202 B:117 /120</span><br><span class="line">ok T:201 /202 B:117 /120 C:49.3 /50</span><br><span class="line">ok T:201 /202 T0:110 /110 T1:23 /0 B:117 /120 C:49.3 /50</span><br><span class="line">ok T0:110 /110 T1:23 /0 B:117 /120</span><br><span class="line">ok T:20.2 /0.0 B:19.1 /0.0 T0:20.2 /0.0 @:0 B@:0 P:19.8 A:26.4</span><br></pre></td></tr></table></figure>

<p>The parameters mean the following:</p>
<ul>
<li>T, T0, …, Tn - extruder temperature. In a single extruder setup, only T will be reported. Some firmware variants will report no T0 in multi extruder setups - in that case T is to be considered the temperature of the first tool. Otherwise, T should be considered the temperature of the currently selected tool (which will be repeated in one of the Tn entries)</li>
<li>B - bed temperature</li>
<li>C - chamber temperature</li>
<li>@ - Hotend power</li>
<li>B@ - Bed power</li>
<li>P - PINDAv2 actual (Prusa MK2.5&#x2F;s MK3&#x2F;s only)<sup>1</sup></li>
<li>A - Ambient actual (Prusa MK3&#x2F;s only)<sup>1</sup></li>
</ul>
<p>A temperature report will usually include actual and target temperature for all available heaters, with the format being “actual&#x2F;target” or - for some firmware variants - “actual &#x2F;target”. During a blocking heatup some firmware variants only report the temperature tuple for the heater that is currently in blocking heatup state.</p>
<p>Note that temperatures can be reported as integers or floats. There sadly are a lot of interpretations of how an M105 response should look like across firmware variants, making parsing them potentially tricky.</p>
<p>Expansion&#x2F;generalization of <code>M105</code> to be considered using S1 parameter as noted in <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Pronterface_I/O_Monitor" title="Pronterface I/O Monitor">Pronterface I&#x2F;O Monitor</a></p>
<p>In Repetier and MK4duo you can add X0 (X1 MK4duo) to get raw values as well:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M105 X0</span><br><span class="line">==&gt; 11:05:48.910 : T:23.61 /0 @:0 T0:23.61 /0 @0:0 RAW0:3922 T1:23.89 /0 @1:0 RAW1:3920</span><br></pre></td></tr></table></figure>

<p>Recent versions of RepRapFirmware also report the current and target temperatures of all active heaters.</p>
<hr>
<p><sup>1</sup>Druid firmware</p>
<p><em><strong>Temperature actual&#x2F;target in Celcius</strong> (actual with one decimal , target is integer)</em></p>
<ul>
<li><strong>T0:</strong> in a single extruder systems,</li>
<li><strong>T0:</strong> and <strong>T1:</strong> in dual extruder systems.</li>
<li><strong>B:</strong> for Heated bed</li>
<li><strong>C:</strong> for Heated chamber</li>
</ul>
<p><em><strong>Power applied</strong> (PWM value 0-255)</em></p>
<ul>
<li><strong>@0: and @1:</strong> for Hotends</li>
<li><strong>B@:</strong> for Heated bed</li>
<li><strong>C@:</strong> for Heated chamber</li>
</ul>
<p><em>Active or not, the values for all available heaters on the system are sent.</em></p>
<p>Examples</p>
<p>T0:27.8&#x2F;0 @0:0</p>
<p>T0:27.7&#x2F;0 B:21.6&#x2F;0 @0:0 B@:0</p>
<p>T0:27.8&#x2F;0 T1:27.8&#x2F;210 B:21.6&#x2F;0 C:85.0&#x2F;0 @0:0 @1:255 B@:0 C@:0</p>
<h4 id="M106-Fan-On"><a href="#M106-Fan-On" class="headerlink" title="M106: Fan On"></a>M106: Fan On</h4><p>Parameters</p>
<p><code>Pnnn</code> Fan number (optional, defaults to 0)<sup>2</sup></p>
<p><code>Snnn</code> Fan speed (0 to 255; RepRapFirmware also accepts 0.0 to 1.0))</p>
<p>Extra Parameters</p>
<p><code>Innn</code> Invert signal, or disable fan<sup>1</sup> <sup>3</sup></p>
<p><code>Fnnn</code> Set fan PWM frequency, in Hz<sup>1</sup> <sup>3</sup></p>
<p><code>Lnnn</code> Set minimum fan speed (0 to 255 or 0.0 to 1.0)<sup>1</sup> <sup>3</sup></p>
<p><code>Xnnn</code> Set maximum fan speed (0 to 255 or 0.0 to 1.0)<sup>1</sup> <sup>3</sup></p>
<p><code>Bnnn</code> Blip time - fan will be run at full PWM for this number of seconds when started from standstill<sup>1</sup></p>
<p><code>Hnn:nn:nn...</code> Select heaters monitored when in thermostatic mode<sup>1</sup> <sup>3</sup></p>
<p><code>Rnnn</code> Restore fan speed to the value it has when the print was paused<sup>1</sup></p>
<p><code>Tnnn</code> Set thermostatic mode trigger temperature</p>
<p><code>Cnnn</code> Set custom name (RRF &gt; 2.01 only)<sup>1</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M106 S127</span><br></pre></td></tr></table></figure>

<p>Examples (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M106 P1 I1 S87</span><br><span class="line">M106 P1 T45 H1:2</span><br><span class="line">M106 P2 B0.1 L0.05</span><br></pre></td></tr></table></figure>

<p>The first example turns on the default cooling fan at half speed. The second one inverts the cooling fan signal of the second fan and sets its value to 1&#x2F;3 of its maximum. The third one sets the second fan to a thermostatic fan for heaters 1 and 2 (e.g. the extruder heaters in a dual-nozzle machine) such that the fan will be on when either hot end is at or above 45C.</p>
<p>Mandatory parameter ‘S’ declares the PWM value (0-255). <code>M106 S0</code> turns the fan off. In some implementations like RepRapFirmware the PWM value may alternatively be specified as a real fraction: <code>M106 S0.7</code>.</p>
<p>Notes</p>
<p><sup>1</sup>These parameters are only available in RepRapFirmware.</p>
<p><sup>2</sup>Marlin 1.0 to 1.1.6 only supports a single fan. Marlin 1.1.7 and up supports up to 3 fans.</p>
<p><sup>3</sup>These parameters are only available in MK4duo.</p>
<h5 id="M106-in-RepRapFirmware"><a href="#M106-in-RepRapFirmware" class="headerlink" title="M106 in RepRapFirmware"></a>M106 in RepRapFirmware</h5><p>If an <code>S</code> parameter is provided but no other parameter is present, then the speeds of the print cooling fans associated with the current tool will be set (see the <code>F</code> parameter in the <code>M563</code> command). If no tool is active then the speed of Fan 0 will be set. Either way, the speed is remembered so that it can be recalled using the <code>R2</code> parameter (see below).</p>
<p>If no <code>S</code> parameter is given but the R1 parameter is used, the fan speed when the print was last paused will be set. If the <code>R2</code> parameter is used, then the speeds of the print cooling fans associated with the current tool will be set to the remembered value (see above).</p>
<p>The <code>T</code> and <code>H</code> parameters allow a fan to be configured to operate in thermostatic mode, for example to use one of the fan channels to control the hot end fan. In this mode the fan will be fully on when the temperature of any of the heaters listed in the <code>H</code> parameter is at or above the trigger temperature set by the <code>T</code> parameter, and off otherwise. Thermostatic mode can be disabled using parameter H-1.</p>
<p>The <code>B</code> parameter sets the time for which the fan will be operated at full PWM when started from cold, to allow low fan speeds t be used. A value of 0.1 seconds is usually sufficient.</p>
<p>The <code>L</code> parameter defines the minimum PWM value that is usable with this fan. If a lower value is commanded that is not zero, it will be rounded up to this value. The <code>X</code> parameter defines the maximum PWM value that is allowed for this fan. If a higher value is commanded, it will be rounded down to this value.</p>
<p>The <code>I</code> parameter causes the fan output signal to be inverted if its value is greater than zero. This makes the cooling fan output suitable for feeding the PWM input of a 4-wire fan via a diode. If the parameter is present and zero, the output is not inverted. If the <code>I</code> parameter is negative then in RRF 1.16 and later the fan is disabled, which frees up the pin for use as a general purpose I&#x2F;O pin that can be controlled using <code>M42</code>.</p>
<h5 id="M106-in-Teacup-Firmware"><a href="#M106-in-Teacup-Firmware" class="headerlink" title="M106 in Teacup Firmware"></a>M106 in Teacup Firmware</h5><p>Additionally to the above, Teacup Firmware uses <code>M106</code> to control general devices. It supports the additional <code>P</code> parameter, which is an zero-based index into the list of heaters&#x2F;devices in config.h.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M106 P2 S255</span><br></pre></td></tr></table></figure>

<p>Turn on device #3 at full speed&#x2F;wattage.</p>
<p><strong>Note</strong>: When turning on a temperature sensor equipped heater with <code>M106</code> and <code>M104</code> at the same time, temperature control will override the value given in <code>M106</code> quickly.</p>
<p><em>Note well:</em> <strong>The ambiguous text in the note above needs to be reworded by someone who knows the actual functioning. Below is my interpretation based on language use, not practical experience or code inspection.</strong></p>
<p><strong>Note:</strong> <em>If <code>M104</code> is (or becomes) active on a heater (or other device) with a feedback sensor it will correct any <code>M106</code> initiated control output value change in the time it takes for the PID (of other feedback) loop to adjust it back to minimum error. It may not be easy to observe a change in the temperature (process value) due to this brief change in the control value</em></p>
<h4 id="M107-Fan-Off"><a href="#M107-Fan-Off" class="headerlink" title="M107: Fan Off"></a>M107: Fan Off</h4><p>Deprecated in Teacup firmware and in RepRapFirmware. Use <code>M106 S0</code> instead.</p>
<h4 id="M108-Cancel-Heating"><a href="#M108-Cancel-Heating" class="headerlink" title="M108: Cancel Heating"></a>M108: Cancel Heating</h4><p>Breaks out of an <code>M109</code> or <code>M190</code> wait-for-temperature loop, continuing the print job. Use this command with caution! If cold extrusion prevention is enabled (see <code>M302</code>) and the temperature is too low, this will start “printing” without extrusion. If cold extrusion prevention is disabled and the hot-end temperature is too low, the extruder may jam.</p>
<p>This command was introduced in Marlin 1.1.0. As with other emergency commands [e.g., <code>M112</code>] this requires the host to leave space in the command buffer, or the command won’t be executed until later.</p>
<p>Recent versions of Marlin introduce <code>EMERGENCY_PARSER</code>, which overcomes the buffer limitation by watching the incoming serial stream. Commands M108, M112, M410, and M876 can all be intercepted by the emergency parser, so it is recommended to enable this feature.</p>
<h4 id="M108-Set-Extruder-Speed-BFB"><a href="#M108-Set-Extruder-Speed-BFB" class="headerlink" title="M108: Set Extruder Speed (BFB)"></a>M108: Set Extruder Speed (BFB)</h4><p>Sets speed of extruder motor. (Deprecated in FiveD firmware, see <code>M113</code>)</p>
<h4 id="M109-Set-Extruder-Temperature-and-Wait"><a href="#M109-Set-Extruder-Temperature-and-Wait" class="headerlink" title="M109: Set Extruder Temperature and Wait"></a>M109: Set Extruder Temperature and Wait</h4><p>Parameters</p>
<p><code>C</code> Use fan for cooling (Buddy only)</p>
<p><code>Snnn</code> minimum target temperature, waits until heating</p>
<p><code>Rnnn</code> maximum target temperature, waits until cooling (Sprinter)</p>
<p><code>Rnnn</code> accurate target temperature, waits until heating and cooling (Marlin and MK4duo)</p>
<p><code>Tn</code> tool number (RepRapFirmware and Klipper), optional</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M109 S215</span><br></pre></td></tr></table></figure>

<h5 id="M109-in-Teacup"><a href="#M109-in-Teacup" class="headerlink" title="M109 in Teacup"></a>M109 in Teacup</h5><p>Not needed. To mimic Marlin behaviour, use <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#M104:_Set_Extruder_Temperature">M104</a> followed by <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#M116:_Wait">M116</a>.</p>
<h5 id="M109-in-Marlin-MK4duo-Sprinter-ATmega-port-RepRapFirmware-Prusa"><a href="#M109-in-Marlin-MK4duo-Sprinter-ATmega-port-RepRapFirmware-Prusa" class="headerlink" title="M109 in Marlin, MK4duo, Sprinter (ATmega port), RepRapFirmware, Prusa"></a>M109 in Marlin, MK4duo, Sprinter (ATmega port), RepRapFirmware, Prusa</h5><p>Set extruder heater temperature in degrees celsius and wait for this temperature to be achieved.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M109 S185</span><br></pre></td></tr></table></figure>

<p>RepRapFirmware also supports the optional <code>T</code> parameter (as generated by slic3r) to specify which tool the command refers to (see below).</p>
<h5 id="M109-in-Sprinter-4pi-port"><a href="#M109-in-Sprinter-4pi-port" class="headerlink" title="M109 in Sprinter (4pi port)"></a>M109 in Sprinter (4pi port)</h5><p>Parameters: <code>S</code> (optional), set target temperature value. If not specified, waits for the temperature set by <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#M104:_Set_Extruder_Temperature">M104</a>. <code>R</code> (optional), sets target temperature range maximum value.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M109 S185 R240 ; set extruder temperature to 185 and wait for the temperature to be between 185 - 240.</span><br></pre></td></tr></table></figure>

<p>If you have multiple extruders, use <code>T</code> or <code>P</code> parameter to specify which extruder you want to set&#x2F;wait.</p>
<p>Another way to do this is to use <a target="_blank" rel="noopener" href="https://reprap.org/wiki/#G10:_Tool_Offset">G10</a>.</p>
<h5 id="M109-in-MakerBot"><a href="#M109-in-MakerBot" class="headerlink" title="M109 in MakerBot"></a>M109 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M109 S70 T0</span><br></pre></td></tr></table></figure>

<p>Sets the target temperature for the current build platform. S is the temperature to set the platform to, in degrees Celsius. T is the platform to heat.</p>
<h5 id="M109-in-Klipper"><a href="#M109-in-Klipper" class="headerlink" title="M109 in Klipper"></a>M109 in Klipper</h5><p>According to the <a target="_blank" rel="noopener" href="https://www.klipper3d.org/G-Codes.html">documentation</a>, Klipper will wait for the specified temperature to settle, i.e. it will wait until it goes back down in case it overshoots. Klipper also supports the optional <code>T</code> parameter to specify which tool the command refers to (see above).</p>
<h4 id="M110-Set-Current-Line-Number"><a href="#M110-Set-Current-Line-Number" class="headerlink" title="M110: Set Current Line Number"></a>M110: Set Current Line Number</h4><p>This command is used for host handshaking, error detection, and resend requests in host-driven print jobs when line numbers are used. See the G-code protocol described above.</p>
<p>Parameters</p>
<p><code>Nnnn</code> Line number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M110 N123</span><br></pre></td></tr></table></figure>

<p>This example sets the current command line number to 123. Thus the expected next line after this command will be 124.  </p>
<p>In Marlin 2.1.3 and up <code>M110</code> with no parameter reports the current command line number.</p>
<h4 id="M111-Set-Debug-Level"><a href="#M111-Set-Debug-Level" class="headerlink" title="M111: Set Debug Level"></a>M111: Set Debug Level</h4><p>Parameters</p>
<p><code>Pnnn</code> Debug module<sup>1</sup></p>
<p><code>Snnn</code> Debug on&#x2F;off</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M111 S6</span><br><span class="line">M111 P1 S1</span><br></pre></td></tr></table></figure>

<p>Enable or disable debugging features in the firmware. The implementation may look different per firmware.</p>
<p>Notes</p>
<p><sup>1</sup>This parameter is only available in RepRapFirmware.</p>
<p><sup>2</sup>Prusa fimrware use D-codes&#x2F;commands for debugging.</p>
<h5 id="M111-in-RepRapFirmware"><a href="#M111-in-RepRapFirmware" class="headerlink" title="M111 in RepRapFirmware"></a>M111 in RepRapFirmware</h5><p>RepRapFirmware allows debugging to be set for each module. If the optional ‘P’ parameter is not specified, debugging will be enabled for all modules. For a list of modules, send <code>M111 S1 P15</code>.</p>
<h5 id="M111-in-Repetier"><a href="#M111-in-Repetier" class="headerlink" title="M111 in Repetier"></a>M111 in Repetier</h5><p>Set the level of debugging information transmitted back to the host to level 6. The level is the OR of three bits:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#define DEBUG_ECHO (1&lt;&lt;0)</span><br><span class="line">#define DEBUG_INFO (1&lt;&lt;1)</span><br><span class="line">#define DEBUG_ERRORS (1&lt;&lt;2)</span><br><span class="line">#define DEBUG_DRYRUN (1&lt;&lt;3) // repetier-firmware</span><br><span class="line">#define DEBUG_COMMUNICATION (1&lt;&lt;4) // repetier-firmware</span><br></pre></td></tr></table></figure>

<p>Thus 6 means send information and errors, but don’t echo commands. (This is the RepRap default.)</p>
<p>For firmware that supports ethernet and web interfaces <code>M111 S9</code> will turn web debug information on without changing any other debug settings, and <code>M111 S8</code> will turn it off. Web debugging usually means that HTTP requests will be echoed to the USB interface, as will the responses.</p>
<h4 id="M112-Full-Emergency-Stop"><a href="#M112-Full-Emergency-Stop" class="headerlink" title="M112: Full (Emergency) Stop"></a>M112: Full (Emergency) Stop</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M112</span><br></pre></td></tr></table></figure>

<p>Any moves in progress are immediately terminated, then RepRap shuts down. All motors and heaters are turned off. It can be started again by pressing the reset button on the master microcontroller. See also <code>M0</code> and <code>M1</code>.</p>
<p>Please note while many systems termed this an Emergency Stop, this terminology is regulated in many regions with specific requirements behind its use. Marlin 2.0.x has renamed this to Full Stop. RepRapFirmware has indicated an intention to make a similar change as well. This stop function is NOT implemented in a Category 0 or 1 stop fashion or with fail-safe hardware compliying with PLd or better. The function as implemented is a category 2 software stop with no redundancies.</p>
<h4 id="M113-Set-Extruder-PWM"><a href="#M113-Set-Extruder-PWM" class="headerlink" title="M113: Set Extruder PWM"></a>M113: Set Extruder PWM</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M113</span><br></pre></td></tr></table></figure>

<p>Set the PWM for the currently-selected extruder. On its own this command sets RepRap to use the on-board potentiometer on the extruder controller board to set the PWM for the currently-selected extruder’s stepper power. With an S field:</p>
<p>M113 S0.7</p>
<p>it causes the PWM to be set to the <code>S</code> value (70% in this instance). <code>M113 S0</code> turns the extruder off, until an <code>M113</code> command other than <code>M113 S0</code> is sent.</p>
<h4 id="M113-Host-Keepalive"><a href="#M113-Host-Keepalive" class="headerlink" title="M113: Host Keepalive"></a>M113: Host Keepalive</h4><p>During some lengthy processes, such as G29, Marlin may appear to the host to have “gone away.” The “host keepalive” feature will send messages to the host when Marlin is busy or waiting for user response so the host won’t try to reconnect.</p>
<p>Usage</p>
<p><code>M113 Snnn</code></p>
<p>Parameters</p>
<p><code>Snnn</code> keepalive interval to set</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M113 S2</span><br></pre></td></tr></table></figure>

<h4 id="M114-Get-Current-Position"><a href="#M114-Get-Current-Position" class="headerlink" title="M114: Get Current Position"></a>M114: Get Current Position</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M114</span><br></pre></td></tr></table></figure>

<p>This causes the RepRap machine to report its current X, Y, Z and E coordinates to the host.</p>
<p>For example, the machine returns a string such as:</p>
<p>ok C: X:0.00 Y:0.00 Z:0.00 E:0.00</p>
<p>In Marlin first 3 numbers is the position for the planner. The other positions are the positions from the stepper function. This helps for debugging a previous stepper function bug.</p>
<p>X:0.00 Y:0.00 RZ:0.00 LZ:0.00 Count X:0.00 Y:0.00 RZ:41.02 LZ:41.02</p>
<h4 id="M115-Get-Firmware-Version-and-Capabilities"><a href="#M115-Get-Firmware-Version-and-Capabilities" class="headerlink" title="M115: Get Firmware Version and Capabilities"></a>M115: Get Firmware Version and Capabilities</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Bnnn</code> (RepRapFirmware 3 only) Expansion board number (typically the CAN address) for which the firmware version is requested, default 0 (i.e. main board)</p>
<p><code>Pnnn</code> Electronics type<sup>1</sup></p>
<p><code>V</code> Report the Prusa version number<sup>2</sup></p>
<p><code>Unnnnnn</code> Check the firmware version provided<sup>2</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M115</span><br><span class="line">M115 P2</span><br></pre></td></tr></table></figure>

<p>Request the Firmware Version and Capabilities of the current microcontroller The details are returned to the host computer as key:value pairs separated by spaces and terminated with a linefeed.</p>
<p>sample data from firmware:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ok PROTOCOL_VERSION:0.1 FIRMWARE_NAME:FiveD FIRMWARE_URL:http%3A//reprap.org MACHINE_TYPE:Mendel EXTRUDER_COUNT:1</span><br></pre></td></tr></table></figure>

<p>This <code>M115</code> code is inconsistently implemented, and should not be relied upon to exist, or output correctly in all cases. An initial implementation was committed to svn for the FiveD Reprap firmware on 11 Oct 2010. Work to more formally define protocol versions is currently (October 2010) being discussed. See <a target="_blank" rel="noopener" href="https://reprap.org/wiki/M115_Keywords" title="M115 Keywords">M115_Keywords</a> for one draft set of keywords and their meanings. See the <code>M408</code> command for a more comprehensive report on machine capabilities supported by RepRapFirmware.</p>
<p>Notes</p>
<p><sup>1</sup>This parameter is supported only in RepRapFirmware and can be used tell the firmware about the hardware on which it is running. If the <code>P</code> parameter is present then the integer argument specifies the hardware being used. The following are currently supported:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M115 P0   Automatic board type selection if supported, or default if not</span><br><span class="line">M115 P1   Duet 0.6</span><br><span class="line">M115 P2   Duet 0.7</span><br><span class="line">M115 P3   Duet 0.85</span><br></pre></td></tr></table></figure>

<p><sup>2</sup>These parameters are only supported in Prusa Firmware. Parameter <code>Unnnnnn</code> will check the firmware version provided. If the firmware version provided by the U code is higher than the currently running firmware, it will pause the print for 30s and ask the user to upgrade the firmware.</p>
<p>sample data <code>M115</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FIRMWARE_NAME:Prusa-Firmware 3.8.1 based on Marlin FIRMWARE_URL:https://github.com/prusa3d/Prusa-Firmware PROTOCOL_VERSION:1.0 MACHINE_TYPE:Prusa i3 MK3S EXTRUDER_COUNT:1 UUID:00000000-0000-0000-0000-000000000000</span><br></pre></td></tr></table></figure>

<p>sample data <code>M115 V</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.8.1</span><br></pre></td></tr></table></figure>

<p>sample data on display for 30s or user interaction<code>M115 U3.8.2-RC1</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New firmware version availible:</span><br><span class="line">3.8.2-RC1</span><br><span class="line">Please upgrade.</span><br></pre></td></tr></table></figure>

<h4 id="M116-Wait"><a href="#M116-Wait" class="headerlink" title="M116: Wait"></a>M116: Wait</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.<sup>1</sup></em></p>
<p><code>Pnnn</code> Tool number</p>
<p><code>Hnnn</code> Heater number</p>
<p><code>Cnnn</code> Chamber number</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M116</span><br><span class="line">M116 P1</span><br></pre></td></tr></table></figure>

<p>Wait for <em>all</em> temperatures and other slowly-changing variables to arrive at their set values if no parameters are specified. See also <code>M109</code>.</p>
<p>Notes</p>
<p><sup>1</sup>Most implementations don’t support any parameters, but RepRapFirmware version 1.04 and later supports an optional ‘P’ parameter that is used to specify a tool number. If this parameter is present, then the system only waits for temperatures associated with that tool to arrive at their set values. This is useful during tool changes, to wait for the new tool to heat up without necessarily waiting for the old one to cool down fully.</p>
<p>Recent versions of RepRapFirmware also allow a list of the heaters to be specified using the ‘H’ parameter, and if the ‘C’ parameter is present, this will indicate that the chamber heater should be waited for.</p>
<h4 id="M117-Get-Zero-Position"><a href="#M117-Get-Zero-Position" class="headerlink" title="M117: Get Zero Position"></a>M117: Get Zero Position</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M117</span><br></pre></td></tr></table></figure>

<p>This causes the RepRap machine to report the X, Y, Z and E coordinates <em>in steps not mm</em> to the host that it found when it last hit the zero stops for those axes. That is to say, when you zero X, the <em>x</em> coordinate of the machine when it hits the X endstop is recorded. This value should be 0, of course. But if the machine has drifted (for example by dropping steps) then it won’t be. This command allows you to measure and to diagnose such problems. (E is included for completeness. It doesn’t normally have an endstop.)</p>
<h4 id="M117-Display-Message"><a href="#M117-Display-Message" class="headerlink" title="M117: Display Message"></a>M117: Display Message</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M117 Hello World</span><br></pre></td></tr></table></figure>

<p>This causes the given message to be shown in the status line on an attached LCD. The above command will display Hello World. If RepRapFirmware is used and no LCD is attached, this message will be reported on the web interface.</p>
<p>Notes</p>
<p>In Prusa Firmware it is also used to display internal messages on LCD.<sup>1</sup></p>
<p>In RepRapFirmware the message may optionally be enclosed in double-quotation marks. Doing this is recommended, to clarify the extent of the text to be displayed.</p>
<h4 id="M118-Echo-message-on-host"><a href="#M118-Echo-message-on-host" class="headerlink" title="M118: Echo message on host"></a>M118: Echo message on host</h4><p>Use this code to print a visible message to the host console, preceded by ‘echo:’.</p>
<p>Parameters</p>
<p><code>Pn</code> (RepRapFirmware only) Message targets(s): 0 &#x3D; generic [default], 1 &#x3D; USB, 2 &#x3D; LCD, 3 &#x3D; HTTP, 4 &#x3D; Telnet</p>
<p><code>S&quot;msg&quot;</code> (RepRepFirmware only) Message to send</p>
<p>Example (Marlin)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M118 Color changing to blue</span><br></pre></td></tr></table></figure>

<p>Example (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M118 P2 S&quot;Color changing to blue&quot;</span><br></pre></td></tr></table></figure>

<h4 id="M118-Negotiate-Features"><a href="#M118-Negotiate-Features" class="headerlink" title="M118: Negotiate Features"></a>M118: Negotiate Features</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M118 P42</span><br></pre></td></tr></table></figure>

<p>This M-code is for future proofing. NO firmware or hostware supports this at the moment. It is used in conjunction with <code>M115</code>‘s FEATURES keyword.</p>
<p>See <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Protocol_Feature_Negotiation" title="Protocol Feature Negotiation">Protocol_Feature_Negotiation</a> for more info.</p>
<h4 id="M119-Get-Endstop-Status"><a href="#M119-Get-Endstop-Status" class="headerlink" title="M119: Get Endstop Status"></a>M119: Get Endstop Status</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M119</span><br></pre></td></tr></table></figure>

<p>Returns the current state of the configured X, Y, Z endstops. Takes into account any ‘inverted endstop’ settings, so one can confirm that the machine is interpreting the endstops correctly.</p>
<p>In redeem, <code>M119</code> can also be used to invert end stops.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M119 X1 1</span><br></pre></td></tr></table></figure>

<p>This will invert end stop X1 (Inverted means switch is connected in Normally Open state (NO))</p>
<h4 id="M120-Push"><a href="#M120-Push" class="headerlink" title="M120: Push"></a>M120: Push</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M120</span><br></pre></td></tr></table></figure>

<p>Push the state of the RepRap machine onto a stack. Exactly what variables get pushed depends on the implementation (as does the depth of the stack - a typical depth might be 5). A sensible minimum, however, might be</p>
<ul>
<li>Current feedrate</li>
<li>Whether moves are relative or absolute</li>
<li>Whether extrusion is relative or absolute</li>
</ul>
<p>RepRapFirmware calls this automatically when a macro file is run. In addition to the variables above, it pushes the following values on the stack:</p>
<ul>
<li>Whether the units are inches or mm</li>
<li>Whether or not volumetric extrusion is in use</li>
<li>The selected plane (see G17&#x2F;G18&#x2F;G19) for G2&#x2F;G3 moves</li>
</ul>
<h4 id="M121-Pop"><a href="#M121-Pop" class="headerlink" title="M121: Pop"></a>M121: Pop</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M121</span><br></pre></td></tr></table></figure>

<p>Recover the last state pushed onto the stack. RepRapFirmware calls this automatically when execution of a macro file terminates.</p>
<h4 id="M120-Enable-endstop-detection"><a href="#M120-Enable-endstop-detection" class="headerlink" title="M120: Enable endstop detection"></a>M120: Enable endstop detection</h4><h4 id="M121-Disable-endstop-detection"><a href="#M121-Disable-endstop-detection" class="headerlink" title="M121: Disable endstop detection"></a>M121: Disable endstop detection</h4><h4 id="M122-Firmware-dependent"><a href="#M122-Firmware-dependent" class="headerlink" title="M122: Firmware dependent"></a>M122: Firmware dependent</h4><h5 id="M122-Diagnose-RepRapFirmware"><a href="#M122-Diagnose-RepRapFirmware" class="headerlink" title="M122: Diagnose (RepRapFirmware)"></a>M122: Diagnose (RepRapFirmware)</h5><p>Parameters</p>
<p><strong>Bmmm</strong> Expansion board number for which diagnostics are requested, default 0 which means main board</p>
<p><strong>Pnnn</strong> Optional parameter to specify what diagnostics are required. Caution: some values of P will crash the firmware deliberately to test error handling! See the Duet3D wiki for more details.</p>
<p><strong>“DSF”</strong> Immediate DSF diagnostics (RRF3&#x2F;Duet3 only with attached SBC)</p>
<p><code>P200</code> - <strong>LPC and STM32 Port Only</strong> Outputs the configuration of all the pins allocated by the firmware and board.txt</p>
<p>Example</p>
<p>M122</p>
<p>Sending an <code>M122</code> causes the RepRap to transmit diagnostic information, for example via a USB serial link.</p>
<p>If RepRapFirmware is used and debugging is enabled for the Network module, this will also print LWIP stats to the host via USB.</p>
<h5 id="M122-Set-Software-Endstop-MK4duo"><a href="#M122-Set-Software-Endstop-MK4duo" class="headerlink" title="M122: Set Software Endstop (MK4duo)"></a>M122: Set Software Endstop (MK4duo)</h5><p>Disabled or Enabled Software Endstop M122 S&lt;0&#x2F;1&gt;</p>
<h5 id="M122-Debug-Stepper-drivers-Marlin"><a href="#M122-Debug-Stepper-drivers-Marlin" class="headerlink" title="M122: Debug Stepper drivers (Marlin)"></a>M122: Debug Stepper drivers (Marlin)</h5><p>Get diagnostic info about L6470 or Trinamic stepper drivers having a UART or SPI interface.</p>
<p>With Trinamic drivers there are some extra parameters, and depending on the configuration either basic or detailed information will be reported. Use parameters <code>X</code>, <code>Y</code>, <code>Z</code>, etc. to limit the report only to the specified steppers, otherwise all steppers are reported. Pass <code>I</code> to re-initialize the drivers. Use parameter <code>S</code> to sample at regular intervals. The <code>P</code> parameter can be used to set the sample interval in milliseconds.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M122</span><br></pre></td></tr></table></figure>

<h4 id="M123-Firmware-dependent"><a href="#M123-Firmware-dependent" class="headerlink" title="M123: Firmware dependent"></a>M123: Firmware dependent</h4><h5 id="M123-Tachometer-value-RepRap-Prusa-Marlin"><a href="#M123-Tachometer-value-RepRap-Prusa-Marlin" class="headerlink" title="M123: Tachometer value (RepRap, Prusa &amp; Marlin)"></a>M123: Tachometer value (RepRap, Prusa &amp; Marlin)</h5><p>Sending a <code>M123</code> causes the RepRap to transmit filament tachometer values from all extruders.</p>
<p>Sending a <code>M123</code> is used in Prusa firmware to report fan speeds and fan pwm values.<sup>1</sup></p>
<p>Sending a <code>M123</code> is used in Marlin firmware to report only extruders fans speeds and pwm values.<sup>2</sup></p>
<p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M123</span><br></pre></td></tr></table></figure>

<p>Parameters<sup>2</sup></p>
<p><code>Sn</code> autoreport every n seconds (0 to disable)</p>
<p>Prusa firmware output<sup>1</sup></p>
<p><code>E0:     - Hotend fan speed in RPM</code></p>
<p><code>PRN1:   - Part cooling fans speed in RPM</code></p>
<p><code>E0@:    - Hotend fan PWM value</code></p>
<p><code>PRN1@:  - Part cooling fan PWM value</code></p>
<p>Examples<sup>1</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo E0:3240 RPM PRN1:4560 RPM E0@:255 PRN1@:255</span><br></pre></td></tr></table></figure>

<p>Examples<sup>2</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo E0:7040 RPM E0@:255</span><br></pre></td></tr></table></figure>

<h5 id="M123-Endstop-Logic-MK4duo"><a href="#M123-Endstop-Logic-MK4duo" class="headerlink" title="M123: Endstop Logic (MK4duo)"></a>M123: Endstop Logic (MK4duo)</h5><p>Parameters</p>
<p><code>Xn</code> X Logic</p>
<p><code>Yn</code> Y Logic</p>
<p><code>Zn</code> Z Logic</p>
<p><code>In</code> X2 Logic</p>
<p><code>Jn</code> Y2 Logic</p>
<p><code>Kn</code> Z2 Logic</p>
<p><code>Pn</code> Probe Logic</p>
<p><code>Dn</code> Door Logic</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M123 ; Print Status</span><br><span class="line">M123 X1 Y1 Z0 P0</span><br></pre></td></tr></table></figure>

<h4 id="M124-Firmware-dependent"><a href="#M124-Firmware-dependent" class="headerlink" title="M124: Firmware dependent"></a>M124: Firmware dependent</h4><h5 id="M124-Immediate-motor-stop"><a href="#M124-Immediate-motor-stop" class="headerlink" title="M124: Immediate motor stop"></a>M124: Immediate motor stop</h5><p>Immediately stops all motors.</p>
<h5 id="M124-Set-Endstop-Pullup"><a href="#M124-Set-Endstop-Pullup" class="headerlink" title="M124: Set Endstop Pullup"></a>M124: Set Endstop Pullup</h5><p>Parameters</p>
<p><code>Xn</code> X Pullup on&#x2F;off</p>
<p><code>Yn</code> Y Pullup on&#x2F;off</p>
<p><code>Zn</code> Z Pullup on&#x2F;off</p>
<p><code>In</code> X2 Pullup on&#x2F;off</p>
<p><code>Jn</code> Y2 Pullup on&#x2F;off</p>
<p><code>Kn</code> Z2 Pullup on&#x2F;off</p>
<p><code>Pn</code> Probe Pullup on&#x2F;off</p>
<p><code>Dn</code> Door Pullup on&#x2F;off</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M124 ; Print Status</span><br><span class="line">M124 X1 Y1 Z0 P0</span><br></pre></td></tr></table></figure>

<h4 id="M125-Firmware-dependent"><a href="#M125-Firmware-dependent" class="headerlink" title="M125: Firmware dependent"></a>M125: Firmware dependent</h4><h5 id="M125-Park-Head"><a href="#M125-Park-Head" class="headerlink" title="M125: Park Head"></a>M125: Park Head</h5><p>Save the current nozzle position and move to the configured park position.</p>
<p>Usage</p>
<p><code>M125 [L | P | X | Y |Z ]</code></p>
<p>Parameters</p>
<p><code>L</code> Retract length</p>
<p><code>P</code> Always show a prompt and await a response <sup>1</sup></p>
<p><code>X</code> X position to park</p>
<p><code>Y</code> Y position to park</p>
<p><code>Z</code> Z raise before park</p>
<p><sup>1</sup> Not in Prusa Buddy firmware</p>
<h5 id="M125-Pause-print"><a href="#M125-Pause-print" class="headerlink" title="M125: Pause print"></a>M125: Pause print</h5><p>Without any parameters it will park the extruder to default or last set position. The default pause position will be set during power up and a reset, the new pause positions aren’t permanent.</p>
<p>Usage</p>
<p><code>M125 [ X | Y | Z | S ]</code></p>
<p>Parameters</p>
<p><code>X</code> X position to park</p>
<p><code>Y</code> Y position to park</p>
<p><code>Z</code> Z raise before park</p>
<p><code>S</code> Set values [S0 &#x3D; set to default values | S1 &#x3D; set values] without pausing</p>
<p>Equivalent to M601 and M25 in Prusa Firmware</p>
<h4 id="M126-Open-Valve"><a href="#M126-Open-Valve" class="headerlink" title="M126: Open Valve"></a>M126: Open Valve</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M126 P500</span><br></pre></td></tr></table></figure>

<p>Open the extruder’s valve (if it has one) and wait 500 milliseconds for it to do so.</p>
<h5 id="M126-in-MakerBot"><a href="#M126-in-MakerBot" class="headerlink" title="M126 in MakerBot"></a>M126 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M126 T0</span><br></pre></td></tr></table></figure>

<p>Enables an extra output attached to a specific toolhead (e.g. fan)</p>
<h4 id="M127-Close-Valve"><a href="#M127-Close-Valve" class="headerlink" title="M127: Close Valve"></a>M127: Close Valve</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M127 P400</span><br></pre></td></tr></table></figure>

<p>Close the extruder’s valve (if it has one) and wait 400 milliseconds for it to do so.</p>
<h5 id="M127-in-MakerBot"><a href="#M127-in-MakerBot" class="headerlink" title="M127 in MakerBot"></a>M127 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M127 T0</span><br></pre></td></tr></table></figure>

<p>Disables an extra output attached to a specific toolhead (e.g. fan)</p>
<h4 id="M128-Extruder-Pressure-PWM"><a href="#M128-Extruder-Pressure-PWM" class="headerlink" title="M128: Extruder Pressure PWM"></a>M128: Extruder Pressure PWM</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M128 S255</span><br></pre></td></tr></table></figure>

<p>PWM value to control internal extruder pressure. <code>S255</code> is full pressure.</p>
<h4 id="M129-Extruder-pressure-off"><a href="#M129-Extruder-pressure-off" class="headerlink" title="M129: Extruder pressure off"></a>M129: Extruder pressure off</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M129 P100</span><br></pre></td></tr></table></figure>

<p>In addition to setting Extruder pressure to 0, you can turn the pressure off entirely. P400 will wait 100ms to do so.</p>
<h4 id="M130-Set-PID-P-value"><a href="#M130-Set-PID-P-value" class="headerlink" title="M130: Set PID P value"></a>M130: Set PID P value</h4><p>Parameters</p>
<p><code>Pnnn</code> heater number</p>
<p><code>Snnn</code> proportional (Kp)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M130 P0 S8.0  ; Sets heater 0 P factor to 8.0</span><br></pre></td></tr></table></figure>

<p>Teacup can control multiple heaters with independent PID controls. For the default shown at <a target="_blank" rel="noopener" href="https://github.com/Traumflug/Teacup_Firmware/blob/master/config.default.h">https://github.com/Traumflug/Teacup_Firmware&#x2F;blob&#x2F;master&#x2F;config.default.h</a>, heater 0 is the extruder (P0), and heater 1 is the bed (P1).</p>
<p>Teacup’s PID proportional units are in pwm&#x2F;255 counts per quarter C, so to convert from counts&#x2F;C, you would divide by 4. Conversely, to convert from count&#x2F;qC to count&#x2F;C, multiply by 4. In the above example, S&#x3D;8 represents a Kp&#x3D;8*4&#x3D;32 counts&#x2F;C.</p>
<h4 id="M131-Set-PID-I-value"><a href="#M131-Set-PID-I-value" class="headerlink" title="M131: Set PID I value"></a>M131: Set PID I value</h4><p>Parameters</p>
<p><code>Pnnn</code> heater number</p>
<p><code>Snnn</code> integral (Ki)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M131 P1 S0.5  ; Sets heater 1 I factor to 0.5</span><br></pre></td></tr></table></figure>

<p>Teacup’s PID integral units are in pwm&#x2F;255 counts per (quarter C*quarter second), so to convert from counts&#x2F;qCqs, you would divide by 16. Conversely, to convert from count&#x2F;qCqs to count&#x2F;Cs, multiply by 16. In the above example, S&#x3D;0.5 represents a Ki&#x3D;0.5*16&#x3D;8 counts&#x2F;Cs.</p>
<h4 id="M132-Set-PID-D-value"><a href="#M132-Set-PID-D-value" class="headerlink" title="M132: Set PID D value"></a>M132: Set PID D value</h4><p>Parameters</p>
<p><code>Pnnn</code> heater number</p>
<p><code>Snnn</code> derivative (Kd)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M132 P0 S24  ; Sets heater 0 D factor to 24.0</span><br></pre></td></tr></table></figure>

<p>Teacup’s PID derivative units are in pwm&#x2F;255 counts per (quarter degree per 2 seconds), so to convert from counts&#x2F;C, you would divide by 4. Conversely, to convert from count&#x2F;qC to count&#x2F;C, multiply by 8. In the above example, S&#x3D;24 represents a Kd&#x3D;24*8&#x3D;194 counts&#x2F;(C&#x2F;s).</p>
<h5 id="M132-in-MakerBot"><a href="#M132-in-MakerBot" class="headerlink" title="M132 in MakerBot"></a>M132 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M132 X Y Z A B</span><br></pre></td></tr></table></figure>

<p>Loads the axis offset of the current home position from the EEPROM and waits for the buffer to empty.</p>
<h4 id="M133-Set-PID-I-limit-value"><a href="#M133-Set-PID-I-limit-value" class="headerlink" title="M133: Set PID I limit value"></a>M133: Set PID I limit value</h4><p>Parameters</p>
<p><code>Pnnn</code> heater number</p>
<p><code>Snnn</code> integral limit (Ki)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M133 P1 S264  ; Sets heater 1 I limit value to 264</span><br></pre></td></tr></table></figure>

<p>Teacup’s PID integral limit units are in quarter-C*quarter-seconds, so to convert from C-s, you would multiply by 16. Conversely, to convert from qC*qs to C*s, divide by 16. In the above example, S&#x3D;264 represents an integral limit of 16.5 C*s.</p>
<h5 id="M133-in-MakerBot"><a href="#M133-in-MakerBot" class="headerlink" title="M133 in MakerBot"></a>M133 in MakerBot</h5><p>Wait for the toolhead to reach its target temperature.</p>
<p>Parameters</p>
<p><code>Tnn</code> : Extruder to wait for</p>
<p><code>Pnn</code> : Time limit, in seconds</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M133 T0 P500 ; Wait for Tool 0 to reach target. Fail after 8:20.</span><br></pre></td></tr></table></figure>

<h4 id="M134-Write-PID-values-to-EEPROM"><a href="#M134-Write-PID-values-to-EEPROM" class="headerlink" title="M134: Write PID values to EEPROM"></a>M134: Write PID values to EEPROM</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M134</span><br></pre></td></tr></table></figure>

<h5 id="M134-in-MakerBot"><a href="#M134-in-MakerBot" class="headerlink" title="M134 in MakerBot"></a>M134 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M134 T0 P500</span><br></pre></td></tr></table></figure>

<p>Instruct the machine to wait for the platform to reach its target temperature. T is the platform to wait for. P if present, sets the time limit.</p>
<h4 id="M135-Set-PID-sample-interval"><a href="#M135-Set-PID-sample-interval" class="headerlink" title="M135: Set PID sample interval"></a>M135: Set PID sample interval</h4><p>Parameters</p>
<p><code>Snnn</code> Heat sample time in seconds</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M135 S300</span><br></pre></td></tr></table></figure>

<p>Set the PID to measure temperatures and calculate the power to send to the heaters every 300ms.</p>
<h5 id="M135-in-MakerBot"><a href="#M135-in-MakerBot" class="headerlink" title="M135 in MakerBot"></a>M135 in MakerBot</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M135 T0</span><br></pre></td></tr></table></figure>

<p>Instructs the machine to change its toolhead. Also updates the State Machine’s current tool_index. T is the toolhead for the machine to switch to and the new tool_index for the state machine to use.</p>
<h4 id="M136-Print-PID-settings-to-host"><a href="#M136-Print-PID-settings-to-host" class="headerlink" title="M136: Print PID settings to host"></a>M136: Print PID settings to host</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M136 P1  ; print heater 0 PID parameters to host</span><br></pre></td></tr></table></figure>

<h4 id="M140-Set-Bed-Temperature-Fast"><a href="#M140-Set-Bed-Temperature-Fast" class="headerlink" title="M140: Set Bed Temperature (Fast)"></a>M140: Set Bed Temperature (Fast)</h4><p>Parameters</p>
<p><code>Pnnn</code> Bed heater index<sup>1</sup></p>
<p><code>Hnnn</code> Heater number<sup>1</sup></p>
<p><code>Tnnn</code> Tool number<sup>2</sup></p>
<p><code>Snnn</code> Active&#x2F;Target temperature</p>
<p><code>Rnnn</code> Standby temperature<sup>1</sup> <sup>2</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M140 S55</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the build bed to 55<sup>o</sup>C and return control to the host immediately (<em>i.e.</em> before that temperature has been reached by the bed).</p>
<p>Notes</p>
<p><sup>1</sup> These parameters are only supported in RepRapFirmware. RepRapFirmware allows the bed heater to be switched off if the absolute negative temperature (-273.15) is passed as target temperature. In this case the current bed temperature is not affected:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M140 S-273.15</span><br></pre></td></tr></table></figure>

<p><sup>2</sup> These parameters are only supported in MK4duo for Idle temperature</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M140 S60 R30</span><br><span class="line">M140 T1 S60 R30</span><br></pre></td></tr></table></figure>

<p>There is an optional R field that sets the bed standby temperature: <code>M140 S65 R40</code>.</p>
<p>Recent versions of RepRapFirmware also provide an optional ‘H’ parameter to set the hot bed heater number. If no heated bed is present, a negative value may be specified to disable it.</p>
<h4 id="M141-Set-Chamber-Temperature-Fast"><a href="#M141-Set-Chamber-Temperature-Fast" class="headerlink" title="M141: Set Chamber Temperature (Fast)"></a>M141: Set Chamber Temperature (Fast)</h4><p>Parameters</p>
<p><code>Pnnn</code> Chamber index<sup>1</sup></p>
<p><code>Hnnn</code> Heater number<sup>1</sup></p>
<p><code>Tnnn</code> Tool number<sup>2</sup></p>
<p><code>Snnn</code> Active&#x2F;Target temperature</p>
<p><code>Rnnn</code> Standby temperature<sup>1</sup> <sup>2</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M141 S30</span><br><span class="line">M141 H0</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the chamber to 30<sup>o</sup>C and return control to the host immediately (<em>i.e.</em> before that temperature has been reached by the chamber).</p>
<p>Notes</p>
<p><sup>1</sup> These parameters are only supported in RepRapFirmware and work just like in M140.</p>
<p><sup>2</sup> These parameters are only supported in MK4duo and work just like in M140.</p>
<h4 id="M142-Firmware-dependent"><a href="#M142-Firmware-dependent" class="headerlink" title="M142: Firmware dependent"></a>M142: Firmware dependent</h4><h5 id="M142-Holding-Pressure"><a href="#M142-Holding-Pressure" class="headerlink" title="M142: Holding Pressure"></a>M142: Holding Pressure</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M142 S1</span><br></pre></td></tr></table></figure>

<p>Set the holding pressure of the bed to 1 bar.</p>
<p>The holding pressure is in bar. For hardware which only has on&#x2F;off holding, when the holding pressure is zero, turn off holding, when the holding pressure is greater than zero, turn on holding.</p>
<h5 id="M142-Set-Cooler-Temperature-Fast"><a href="#M142-Set-Cooler-Temperature-Fast" class="headerlink" title="M142: Set Cooler Temperature (Fast)"></a>M142: Set Cooler Temperature (Fast)</h5><p>Parameters</p>
<p><code>Tnnn</code> Tool number</p>
<p><code>Snnn</code> Active&#x2F;Target temperature</p>
<p><code>Rnnn</code> Standby temperature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M142 S60</span><br><span class="line">M142 S60 R30</span><br><span class="line">M141 T1 S60 R30</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the cooler</p>
<h4 id="M143-Firmware-dependent"><a href="#M143-Firmware-dependent" class="headerlink" title="M143: Firmware dependent"></a>M143: Firmware dependent</h4><h5 id="M143-Set-Laser-Cooler-Temperature-Fast"><a href="#M143-Set-Laser-Cooler-Temperature-Fast" class="headerlink" title="M143: Set Laser Cooler Temperature (Fast)"></a>M143: Set Laser Cooler Temperature (Fast)</h5><p>Parameters</p>
<p><code>Snnn</code> Target temperature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M143 S80</span><br></pre></td></tr></table></figure>

<p>Set the target temperature of the laser cooler and return immediately. Use <code>M193</code> to set and wait for the temperature to be reached.</p>
<h5 id="M143-Maximum-heater-temperature"><a href="#M143-Maximum-heater-temperature" class="headerlink" title="M143: Maximum heater temperature"></a>M143: Maximum heater temperature</h5><p>Parameters</p>
<p><code>H</code> Heater number (RepRapFirmware 1.17 and later, default 1 which is normally the first hot end)</p>
<p><code>S</code> Maximum temperature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M143 S275      ; set the maximum temperature of the hot-end to 275°C</span><br><span class="line">M143 H0 S125   ; set the maximum bed temperature to 125C</span><br></pre></td></tr></table></figure>

<p>The default maximum temperature for all heaters was 300°C prior to RepRapFirmware version 1.13, and 262°C from 1.13 onwards. From RepRapFirmware 1.17 onwards, the default maximum temperatures are 262C for extruders and 125C for the bed.</p>
<p>When the temperature of the heater exceeds this value, countermeasures will be taken.</p>
<h4 id="M144-Bed-Standby"><a href="#M144-Bed-Standby" class="headerlink" title="M144: Bed Standby"></a>M144: Bed Standby</h4><p>Parameters</p>
<p><strong>Pnn</strong> Bed heater number, default 0</p>
<p><strong>Sn</strong> 0 &#x3D; set bed heater to standby (default), 1 &#x3D; set bad heater active</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M144</span><br></pre></td></tr></table></figure>

<p>Switch the bed heater to its standby temperature. <code>M140 S1</code> turns it back to its active temperature.</p>
<h4 id="M146-Set-Chamber-Humidity"><a href="#M146-Set-Chamber-Humidity" class="headerlink" title="M146: Set Chamber Humidity"></a>M146: Set Chamber Humidity</h4><p>Parameters</p>
<p><code>Rnnn</code> Relative humidity in percent</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M146 R60</span><br></pre></td></tr></table></figure>

<p>Set the relative humidity of the chamber to 60% and return control to the host immediately (<em>i.e.</em> before that humidity has been reached by the chamber).</p>
<h4 id="M149-Set-temperature-units"><a href="#M149-Set-temperature-units" class="headerlink" title="M149: Set temperature units"></a>M149: Set temperature units</h4><p>Parameters</p>
<p><code>C</code> Flag to treat temperature as degrees Celsius</p>
<p><code>K</code> Flag to treat temperature as Kelvin</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M149 K</span><br></pre></td></tr></table></figure>

<p>It affects the <code>S</code> or <code>R</code> values in the codes <code>M104</code>, <code>M109</code>, <code>M140</code>, <code>M141</code>, <code>M143</code>, <code>M190</code> and <code>G10.</code> The default is <code>M149 C</code>.</p>
<h4 id="M150-Set-LED-color"><a href="#M150-Set-LED-color" class="headerlink" title="M150: Set LED color"></a>M150: Set LED color</h4><p>Parameters</p>
<p><code>Rnnn</code> Red component</p>
<p><code>Unnn</code> Green component</p>
<p><code>Bnnn</code> Blue component</p>
<p><code>Wnnn</code> White component (Marlin)</p>
<p><code>Pnnn</code> Brightness (0-255) (Marlin, also RepRapFirmware 2.03 and later)</p>
<p><code>P</code> Set full brightness (Marlin)</p>
<p><code>Snnn</code> (RepRapFirmware) Number of individual LEDs to set to these colours</p>
<p><code>Fn</code> (RepRapFirmware) Following command action. F0 (default) means this is the last command for the LED strip, so the next M150 command starts at the beginning of the strip. F1 means further M150 commands for the remainder of the strip follow this one.</p>
<p><code>Xn</code> (RepRapFirmware) LED type: X0 (default) &#x3D; DotStar, X1 &#x3D; NeoPixel. This parameter is remembered from one call to the next, so it only needs to be given once.</p>
<p><code>Ynn</code> (RepRapFirmware) Brightness, 0-31 (alternative to P 0-255)</p>
<p><code>Qnnn</code> (RepRapFirmware) Use specified SPI frequency (in Hz) instead of default frequency. This parameter is only processed if X parameter also present. When using NeoPixels, only frequencies between about 2.5MHz and 4MHz will work.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M150 R255 U128 B192</span><br></pre></td></tr></table></figure>

<p>Example (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M150 X1 F3000000         ; set LED type to NeoPixel and set SPI frequency to 3MHz</span><br><span class="line">M150 R255 P128 S20 F1    ; set first 20 LEDs to red, half brightness, more commands for the strip follow</span><br><span class="line">M150 U255 B255 P255 S20  ; set next 20 LEDs to cyan, full brightness, finished programming LED strip</span><br></pre></td></tr></table></figure>

<p>Set BlinkM, Neopixel, and&#x2F;or other LED light color and intensity with RGBW component values from 0 to 255. Some LCD controllers use this interface for a backlight. Firmware may override the set color to indicate the current printer status.</p>
<p>RepRapFirmware uses this command to control DotStar or NeoPixel LED strips on controllers that provide a connector for this purpose. When using NeoPixel strips there is a firmware-dependent maximum number of LEDs in the strip supported determined by the size of the DMA buffer.</p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="M154-Auto-Report-Position"><a href="#M154-Auto-Report-Position" class="headerlink" title="M154: Auto Report Position"></a>M154: Auto Report Position</h4><p>Hosts normally monitor printer position by sending <code>M114</code> every couple of seconds. This adds more serial traffic and fails if the command queue is full. <code>M154</code> reduces traffic by setting the firmware to report the ‘projected’ position at regular intervals. This behavior is disabled by default for best compatibility with existing hosts. If the firmware supports <code>M154</code> the output of <code>M115</code> will report the <code>AUTOREPORT_POS</code> capability.</p>
<p>Usage</p>
<p><code>M154 Snnn</code> : Set the auto-report interval in seconds. Set the interval to 0 to disable.</p>
<h4 id="M155-Automatically-send-temperatures"><a href="#M155-Automatically-send-temperatures" class="headerlink" title="M155: Automatically send temperatures"></a>M155: Automatically send temperatures</h4><p>Parameters</p>
<p><code>Snnn</code> enable sending temperatures &#x3D; 1, disable &#x3D; 0</p>
<p><code>Snnn</code> Interval in seconds between auto-reports. S0 to disable. (Marlin) Prusa has a Maximum: 255<sup>1</sup></p>
<p><code>Cnn</code> Activate auto-report function (bit mask). Default is temperature.<sup>1</sup></p>
<p>C bitmap<sup>1</sup></p>
<p><code>bit 0 = Auto-report temperatures</code></p>
<p><code>bit 1 = Auto-report fans</code></p>
<p><code>bit 2 = Auto-report position</code></p>
<p><code>bit 3 = free</code></p>
<p><code>bit 4 = free</code></p>
<p><code>bit 5 = free</code></p>
<p><code>bit 6 = free</code></p>
<p><code>bit 7 = free</code></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M155 S1 ; Enable temperature report (Marlin: every 1 second)</span><br><span class="line">M155 S0 ; Stop reporting temperatures</span><br><span class="line">M155 S4 ; Report temperatures every 4 seconds (Marlin)</span><br><span class="line">M155 S4 C7; Reports temperatures, fans and position every 4 seconds (Prusa)1</span><br></pre></td></tr></table></figure>

<p>Hosts normally monitor printer temperatures by sending <code>M105</code> every couple of seconds. This not only adds serial traffic but it will fail whenever the command queue is full. <code>M155</code> addresses these problems by telling the firmware to automatically report temperatures at regular intervals. This behavior is disabled by default for best compatibility with existing hosts. If the firmware supports <code>M155</code> the output of <code>M115</code> will report the <code>AUTOREPORT_TEMP</code> capability:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cap:AUTOREPORT_TEMP:1</span><br></pre></td></tr></table></figure>

<p>Prusa Firmware 3.10.0+ also adds capabilities:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cap:AUTOREPORT_FANS:1</span><br><span class="line">Cap:AUTOREPORT_POSITION:1</span><br><span class="line">Cap:EXTENDED_M20:1</span><br></pre></td></tr></table></figure>

<h4 id="M160-Number-of-mixed-materials"><a href="#M160-Number-of-mixed-materials" class="headerlink" title="M160: Number of mixed materials"></a>M160: Number of mixed materials</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M160 S4</span><br></pre></td></tr></table></figure>

<p>This command has been superseded by the tool definition command <code>M563</code> (see below).</p>
<p>Set the number of materials, N, that the current extruder can handle to the number specified. The default is 1.</p>
<p>When N &gt;&#x3D; 2, then the E field that controls extrusion requires N values separated by colons “:” after it like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M160 S4</span><br><span class="line">G1 X90.6 Y13.8 E2.24:2.24:2.24:15.89</span><br><span class="line">G1 X70.6 E0:0:0:42.4</span><br><span class="line">G1 E42.4:0:0:0</span><br></pre></td></tr></table></figure>

<p>The second line moves straight to the point (90.6, 13.8) extruding a total of 22.4mm of filament. The mix ratio for the move is 0.1:0.1:0.1:0.7.</p>
<p>The third line moves back 20mm in X extruding 42.4mm of filament.</p>
<p>The fourth line has no physical effect.</p>
<h4 id="M163-Set-weight-of-mixed-material"><a href="#M163-Set-weight-of-mixed-material" class="headerlink" title="M163: Set weight of mixed material"></a>M163: Set weight of mixed material</h4><p>Parameters</p>
<p><code>Snnn</code> extruder number</p>
<p><code>Pnnn</code> weight</p>
<p>Set weight for this mixing extruder drive.<br>See <em><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Repetier_Color_Mixing" title="Repetier Color Mixing">Repetier Color Mixing</a></em> for more informations.</p>
<h4 id="M164-Store-weights"><a href="#M164-Store-weights" class="headerlink" title="M164: Store weights"></a>M164: Store weights</h4><p>Parameters</p>
<p><code>Snnn</code> virtual extruder number</p>
<p><code>Pnnn</code> store to eeprom (P0 &#x3D; no, P1 &#x3D; yes)</p>
<p>Store weights as virtual extruder S.</p>
<h4 id="M165-Set-multiple-mix-weights"><a href="#M165-Set-multiple-mix-weights" class="headerlink" title="M165: Set multiple mix weights"></a>M165: Set multiple mix weights</h4><p>Parameters <code>A B C D H I</code></p>
<p><code>A[factor]</code> Mix factor for extruder stepper 1</p>
<p><code>B[factor]</code> Mix factor for extruder stepper 2</p>
<p><code>C[factor]</code> Mix factor for extruder stepper 3</p>
<p><code>D[factor]</code> Mix factor for extruder stepper 4</p>
<p><code>H[factor]</code> Mix factor for extruder stepper 5</p>
<p><code>I[factor]</code> Mix factor for extruder stepper 6</p>
<ul>
<li>Set multiple mix factors for a mixing extruder.</li>
<li>Factors that are left out will be set to 0.</li>
<li>All factors together must add up to 1.0.</li>
</ul>
<h4 id="M190-Wait-for-bed-temperature-to-reach-target-temp"><a href="#M190-Wait-for-bed-temperature-to-reach-target-temp" class="headerlink" title="M190: Wait for bed temperature to reach target temp"></a>M190: Wait for bed temperature to reach target temp</h4><p>Parameters</p>
<p><code>Snnn</code> minimum target temperature, waits until heating</p>
<p><code>Rnnn</code> accurate target temperature, waits until heating and cooling (Marlin and Prusa)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M190 S60</span><br></pre></td></tr></table></figure>

<p>Wait for the bed temperature to reach 60 degrees, printing out the temperatures once per second.</p>
<h4 id="M191-Wait-for-chamber-temperature-to-reach-target-temp"><a href="#M191-Wait-for-chamber-temperature-to-reach-target-temp" class="headerlink" title="M191: Wait for chamber temperature to reach target temp"></a>M191: Wait for chamber temperature to reach target temp</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M191 S60</span><br></pre></td></tr></table></figure>

<p>Set the temperature of the build chamber to 60 °C and wait for the temperature to be reached.</p>
<p>Parameters</p>
<p><code>Snnn</code> minimum target temperature, waits until heating</p>
<p><code>Rnnn</code> accurate target temperature, waits until heating and cooling (Marlin)</p>
<h4 id="M192-Wait-for-Probe-Temperature"><a href="#M192-Wait-for-Probe-Temperature" class="headerlink" title="M192: Wait for Probe Temperature"></a>M192: Wait for Probe Temperature</h4><p>Use <code>M192</code> to dwell until the probe is at or above a given temperature.</p>
<h4 id="M193-Set-Laser-Cooler-Temperature"><a href="#M193-Set-Laser-Cooler-Temperature" class="headerlink" title="M193: Set Laser Cooler Temperature"></a>M193: Set Laser Cooler Temperature</h4><p>Parameters</p>
<p><code>Snnn</code> Target temperature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M193 S65</span><br></pre></td></tr></table></figure>

<p>Set the target temperature of the laser cooler and wait for the temperature to be reached. Use <code>M143</code> to set the temperature and return immediately. If the Emergency Parser is enabled you can use <code>M108</code> to break out of the wait loop.</p>
<h4 id="M200-Set-filament-diameter"><a href="#M200-Set-filament-diameter" class="headerlink" title="M200: Set filament diameter"></a>M200: Set filament diameter</h4><p>Volumetric Extrusion is a firmware mode (and an option you can set in some slicers) wherein all extrusion amounts are specified as a volume —using cubic millimeters or inches (i.e., mm<sup>3</sup> or in<sup>3</sup>)— instead of a linear distance. This makes it possible to use the same G-code with any filament diameter.</p>
<p><code>M200</code> tells the firmware what the filament diameter is, and (if non-zero) to enable Volumetric Extrusion.</p>
<p>Send <code>M200</code> without parameters to get the current Volumetric Extrusion state and filament diameters.</p>
<p>Note that slicer-commanded retraction amounts must also be specified in mm<sup>3</sup> since the E axis is interpreted as a volume. However, when using Firmware Retraction (<code>G10</code> &#x2F; <code>G11</code>) the retractions specified by <code>M207</code> are still set in linear units.</p>
<p>Parameters (Marlin)</p>
<p><code>D[linear]</code> Set the filament diameter in current units. If non-zero, enable Volumetric Extrusion.</p>
<p><code>T[index]</code> Select the target extruder. If omitted, the active extruder.</p>
<p><code>S[bool]</code> Enable or Disable Volumetric Extrusion (without modifying the filament diameter).</p>
<p><code>L[limit]</code> Set the Maximum Extrusion Volume in mm<sup>3</sup> per second. (Ignores units set by <code>G20</code>.) Use <code>L0</code> for no limit.</p>
<p>Examples (Marlin)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M200 D0       ; Disable Volumetric Extrusion on all extruders</span><br><span class="line">M200 D1.75    ; Set filament diameter for the current extruder to 1.75mm</span><br><span class="line">M200 T1 D2.85 ; Set filament diameter for E2 to 1.75mm</span><br><span class="line">M200 T1 L12   ; Set Maximum Extrusion Volume for E2 to 12mm3</span><br><span class="line">M200 S1       ; Enable Volumetric Extrusion using the last-set diameters</span><br></pre></td></tr></table></figure>

<p>Parameters (RepRapFirmware)</p>
<p><code>Daaa:bbb:ccc...</code> Set filament diameter to aaa for extruder 1, bbb for extruder 2, etc. In RepRapFirmware 3.4 and earlier, if any of aaa, bbb etc. are zero then Volumetric Extrusion is disabled for that extruder.</p>
<p><code>Daaa</code> Set filament diameter for all extruders.</p>
<p><code>S[bool]</code> Enable or disable volumetric extrusion for this input channel (RepRapFirmware 3.5 and later)</p>
<p>Examples (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M200 D0               ; Disable volumetric extrusion on all extruders (RRF 3.4 and earlier)</span><br><span class="line">M200 S0               ; Disable volumetric extrusion for tis input channel (RRF 3.5 and later)</span><br><span class="line">M200 D1.75            ; Set all extruder filament diameters to 1.75mm</span><br><span class="line">M200 D1.75:3.0:1.75   ; Set extruder 0 to 1.75mm, E1 to 3.0mm and the rest to 1.75mm</span><br></pre></td></tr></table></figure>

<h4 id="M201-Set-max-acceleration"><a href="#M201-Set-max-acceleration" class="headerlink" title="M201: Set max acceleration"></a>M201: Set max acceleration</h4><p>Parameters</p>
<p><code>Xnnn</code> Acceleration for X axis in units&#x2F;s<sup>2</sup></p>
<p><code>Ynnn</code> Acceleration for Y axis in units&#x2F;s<sup>2</sup></p>
<p><code>Znnn</code> Acceleration for Z axis in units&#x2F;s<sup>2</sup></p>
<p><code>Ennn</code> Acceleration for the active or specified extruder in units&#x2F;s<sup>2</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M201 X1000 Y1000 Z100 E2000</span><br></pre></td></tr></table></figure>

<p>Set the acceleration that axes can do in units&#x2F;s<sup>2</sup>.</p>
<p>The <code>M201</code> command is intended to define the machine’s physical limits. Slicers should use the <code>M204</code> command to define accelerations for a job and leave <code>M201</code> settings to the user.</p>
<p>RepRapFirmware specific: Multiple colon-separated E values can be provided, so that different extruders can use different accelerations. If a single E value is provided, that value is applied to all extruders. The values must be provided in mm&#x2F;sec^2 even if G20 has been used to set units to inches. M201 without parameters reports the current settings.</p>
<h4 id="M201-1-Set-reduced-acceleration-for-special-move-types"><a href="#M201-1-Set-reduced-acceleration-for-special-move-types" class="headerlink" title="M201.1: Set reduced acceleration for special move types"></a>M201.1: Set reduced acceleration for special move types</h4><p>Parameters</p>
<p><code>Xnnn</code> Acceleration for X axis in units&#x2F;s<sup>2</sup></p>
<p><code>Ynnn</code> Acceleration for Y axis in units&#x2F;s<sup>2</sup></p>
<p><code>Znnn</code> Acceleration for Z axis in units&#x2F;s<sup>2</sup></p>
<p><code>Ennn:nnn...</code> Acceleration for the extruders in units&#x2F;s<sup>2</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M201.1 X500 Y500 Z20 E500:500</span><br></pre></td></tr></table></figure>

<p>Set the acceleration that axes should use for special types of move that should be done using reduced acceleration.</p>
<p>RepRapFirmware specific: these values are used for probing moves (because some types of Z probe can be triggered by high acceleration at the start of the move) and for moves that involve stall detection endstops (because high acceleration can bring the motor close to stalling). If a single E value is provided, that value is applied to all extruders. The values must be provided in mm&#x2F;sec^2 even if G20 has been used to set units to inches. M201.1 without parameters reports the current settings.</p>
<h4 id="M202-Set-max-travel-acceleration"><a href="#M202-Set-max-travel-acceleration" class="headerlink" title="M202: Set max travel acceleration"></a>M202: Set max travel acceleration</h4><p>Set max travel acceleration in units&#x2F;s^2 for travel moves (<code>M202 X1000 Y1000</code>). <em>Unused in Marlin!!</em></p>
<h4 id="M203-Firmware-dependent"><a href="#M203-Firmware-dependent" class="headerlink" title="M203: Firmware dependent"></a>M203: Firmware dependent</h4><h5 id="M203-Set-maximum-feedrate"><a href="#M203-Set-maximum-feedrate" class="headerlink" title="M203: Set maximum feedrate"></a>M203: Set maximum feedrate</h5><p>Parameters</p>
<p><code>Xnnn</code> Maximum feedrate for X axis</p>
<p><code>Ynnn</code> Maximum feedrate for Y axis</p>
<p><code>Znnn</code> Maximum feedrate for Z axis</p>
<p><code>Ennn</code> Maximum feedrate for extruder drives</p>
<p><code>Innn</code> (RepRapFirmware) Minimum feed rate (optional)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M203 X6000 Y6000 Z300 E10000</span><br></pre></td></tr></table></figure>

<p>Sets the maximum feedrates that your machine can do in mm&#x2F;min. (Marlin uses mm&#x2F;sec).</p>
<p>This command is intended to define the machine limits. Slicers should not generate M203 commands, instead they should use the F parameter on G0, G1 etc. command to specify the requested speeds.</p>
<h5 id="M203-Repetier-Set-temperature-monitor"><a href="#M203-Repetier-Set-temperature-monitor" class="headerlink" title="M203 (Repetier): Set temperature monitor"></a>M203 (Repetier): Set temperature monitor</h5><p>Set temperature monitor to <code>Sx</code>. Repetier Firmware only.</p>
<h4 id="M204-Firmware-dependent"><a href="#M204-Firmware-dependent" class="headerlink" title="M204: Firmware dependent"></a>M204: Firmware dependent</h4><h5 id="M204-Set-default-acceleration"><a href="#M204-Set-default-acceleration" class="headerlink" title="M204: Set default acceleration"></a>M204: Set default acceleration</h5><p>Parameters (RepRapFimware)</p>
<p><code>Pnnn</code> Acceleration for printing moves</p>
<p><code>Tnnn</code> Acceleration for travel moves</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M204 P500 T2000</span><br></pre></td></tr></table></figure>

<p>Accelerations set with <code>M204</code> apply to the move as a whole based on the type of move. Use <code>M201</code> to set limits for each axis individually. Both of these limits will be applied during printing.</p>
<p>Parameters (MK4duo)</p>
<p><code>Pnnn</code> Acceleration for printing moves</p>
<p><code>Vnnn</code> Acceleration for travel moves</p>
<p><code>Rnnn</code> Acceleration for Retraction for Tools with T code</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M204 P500 V2000 T0 R5000</span><br></pre></td></tr></table></figure>

<p><strong>Other firmwares:</strong></p>
<p><code>S[accel]</code> Set Acceleration for normal moves in units&#x2F;s<sup>2</sup></p>
<p><code>T[accel]</code> Set Acceleration for retract&#x2F;recover moves in units&#x2F;s<sup>2</sup></p>
<p><code>B[ms]</code> Set Minimum Segment Time to prevent planner starvation.</p>
<p><strong>Marlin notes:</strong> Since version 1.0.2-1 the <code>M204</code> options are:</p>
<p><code>P[accel]</code> Set Acceleration for Printing moves. (i.e., Any XYZ motion plus E.)</p>
<p><code>R[accel]</code> Set Acceleration for Retract moves. (i.e., E-axis only moves.)</p>
<p><code>T[accel]</code> Set Acceleration for Travel moves. (i.e., without E movement)</p>
<p>Example</p>
<p>Set the acceleration for printing movements to 800mm&#x2F;s^2, for travels to 3000mm&#x2F;s^2 and for retracts to 9000mm&#x2F;s^2.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M204 P800 T3000 R9000</span><br></pre></td></tr></table></figure>

<h5 id="M204-Set-PID-values"><a href="#M204-Set-PID-values" class="headerlink" title="M204: Set PID values"></a>M204: Set PID values</h5><p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M204 X[Kp] Y[Ki] Z[Kd]</span><br></pre></td></tr></table></figure>

<p>Set one or more PID parameters. Values are 100 * real value.</p>
<h4 id="M205-Firmware-dependent"><a href="#M205-Firmware-dependent" class="headerlink" title="M205: Firmware dependent"></a>M205: Firmware dependent</h4><h5 id="M205-Advanced-settings"><a href="#M205-Advanced-settings" class="headerlink" title="M205: Advanced settings"></a>M205: Advanced settings</h5><p>Sprinter &#x2F; Marlin</p>
<p>Minimum travel speed &#x3D; <code>S[printing]</code> <code>T[travel]</code></p>
<p><code>B[min segment time] X[max XY jerk] Z[max Z jerk] E[max E jerk]</code></p>
<p>Sprinter &#x2F; Marlin Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M205 X30 Z5 ; Set X/Y Jerk to 30mm/s, Z jerk to 5mm/s</span><br></pre></td></tr></table></figure>

<p><strong>Smoothieware</strong> uses a different algorithm: <a target="_blank" rel="noopener" href="https://onehossshay.wordpress.com/2011/09/24/improving_grbl_cornering_algorithm/">[1]</a></p>
<p>X[xy junction deviation] Z[z junction deviation] S[minimum planner speed].</p>
<p>Z junction deviation only applies to z only moves</p>
<p>0 disables junction deviation for Z</p>
<p>-1 uses global junction deviation</p>
<p>Smoothie example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M205 X0.05  ; set X/Y Junction Deviation</span><br></pre></td></tr></table></figure>

<h5 id="M205-EEPROM-Report"><a href="#M205-EEPROM-Report" class="headerlink" title="M205: EEPROM Report"></a>M205: EEPROM Report</h5><p>Output EEPROM settings. Repetier Firmware only.</p>
<h4 id="M206-Firmware-dependent"><a href="#M206-Firmware-dependent" class="headerlink" title="M206: Firmware dependent"></a>M206: Firmware dependent</h4><h5 id="M206-Offset-axes"><a href="#M206-Offset-axes" class="headerlink" title="M206: Offset axes"></a>M206: Offset axes</h5><p>Parameters</p>
<p><code>Xnnn</code> X axis offset</p>
<p><code>Ynnn</code> Y axis offset</p>
<p><code>Znnn</code> Z axis offset</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M206 X10.0 Y10.0 Z-0.4</span><br></pre></td></tr></table></figure>

<p>The values specified are added to the endstop position when the axes are referenced. The same can be achieved with a <code>G92</code> right after homing (<code>G28</code>, <code>G161</code>).</p>
<p>With Marlin firmware, the current values can read from the machine with a bare <code>M206</code> command and be saved to EEPROM using the <code>M500</code> command. (See also <code>M290</code>: Babystepping)</p>
<p>A similar command is <code>G10</code>, aligning these two is <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Talk:G-code#M104_.26_M109_Deprecation.2C_G10_Introduction" title="Talk:G-code">subject to discussion</a>.</p>
<p>With Marlin 1.0.0 RC2 a negative value for z lifts(!) your printhead.</p>
<p>In builds of RepRapFirmware that support CNC workplace coordinates, using this command is equivalent to using G10 L2 P1 to set the coordinate offsets for workplace 1.</p>
<h5 id="M206-Set-EEPROM-value"><a href="#M206-Set-EEPROM-value" class="headerlink" title="M206: Set EEPROM value"></a>M206: Set EEPROM value</h5><p>Set a Repetier Firmware EEPROM value.</p>
<p>Parameters</p>
<p><code>T[type]</code> Value type</p>
<p><code>P[pos]</code> Value position</p>
<p><code>[S(long)]</code> An integer value</p>
<p><code>[X(float)]</code> A float value</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M206 T3 P39 X19.9 ; Set Jerk to 19.9</span><br></pre></td></tr></table></figure>

<h4 id="M207-Firmware-dependent"><a href="#M207-Firmware-dependent" class="headerlink" title="M207: Firmware dependent"></a>M207: Firmware dependent</h4><h5 id="M207-Set-retract-length"><a href="#M207-Set-retract-length" class="headerlink" title="M207: Set retract length"></a>M207: Set retract length</h5><p>Parameters</p>
<p><code>Snnn</code> positive length to retract, in mm</p>
<p><code>Rnnn</code> positive or negative additional length to un-retract, in mm (RepRapFirmware only)</p>
<p><code>Fnnn</code> retraction feedrate, in mm&#x2F;min</p>
<p><code>Tnnn</code> feedrate for un-retraction if different from retraction, mm&#x2F;min (RepRapFirmware 1.16 and later only)</p>
<p><code>Znnn</code> additional zlift&#x2F;hop</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M207 S4.0 F2400 Z0.075</span><br></pre></td></tr></table></figure>

<p>Set the retract length used by the <code>G10</code> and <code>G11</code> commands. Units are in mm regardless of <code>M200</code> setting.</p>
<p>Machinekit uses different parameters and speed units for <code>M207</code>. Use <code>P</code> to set retract length in mm. Use <code>Q</code> to set retract velocity in mm&#x2F;s. For firmware retraction Machinekit uses <code>G22</code> and <code>G23</code> in place of <code>G10</code> and <code>G11</code>.</p>
<h5 id="M207-Calibrate-Z-axis-with-Z-max-endstop"><a href="#M207-Calibrate-Z-axis-with-Z-max-endstop" class="headerlink" title="M207 Calibrate Z axis with Z max endstop"></a>M207 Calibrate Z axis with Z max endstop</h5><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M207</span><br></pre></td></tr></table></figure>

<p>After placing the tip of the nozzle in the position you expect to be considered Z&#x3D;0, issue this command to calibrate the Z axis. It will perform a z axis homing routine and calculate the distance traveled in this process. The result is stored in EEPROM as z_max_length. For using this calibration method the machine must be using a Z MAX endstop.</p>
<p>This procedure is usually more reliable than mechanical adjustments of a Z MIN endstop.</p>
<h5 id="M207-Repetier-Set-jerk-without-saving-to-EEPROM"><a href="#M207-Repetier-Set-jerk-without-saving-to-EEPROM" class="headerlink" title="M207 (Repetier): Set jerk without saving to EEPROM"></a>M207 (Repetier): Set jerk without saving to EEPROM</h5><p>Repetier Firmware only. Change the maximum instantaneous speed change (“jerk”) values, but don’t store the change in EEPROM.</p>
<p>Since Repetier 0.91 December 2013 <a target="_blank" rel="noopener" href="https://github.com/repetier/Repetier-Firmware/blob/d86da831853288d4a10fb0584d006c7763ca2bb6/src/ArduinoAVR/Repetier/Repetier.ino#102">[2]</a> (if not earlier)</p>
<p>Parameters</p>
<p><code>Xnnn</code> Temporarily set XY jerk in mm&#x2F;s</p>
<p><code>Znnn</code> Temporarily set Z jerk in mm&#x2F;s</p>
<p><code>Ennn</code> Temporarily set Extruder jerk in mm&#x2F;s</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M207 X10  ; Change the X/Y Jerk to 10mm/s</span><br></pre></td></tr></table></figure>

<h4 id="M208-Firmware-dependent"><a href="#M208-Firmware-dependent" class="headerlink" title="M208: Firmware dependent"></a>M208: Firmware dependent</h4><h5 id="M208-Set-unretract-length"><a href="#M208-Set-unretract-length" class="headerlink" title="M208: Set unretract length"></a>M208: Set unretract length</h5><p>Parameters</p>
<p><code>Snnn</code> positive length surplus to the <code>M207 Snnn</code>, in mm</p>
<p><code>Fnnn</code> feedrate, in mm&#x2F;sec</p>
<p>Sets the “recover” (aka “unretract”) length.</p>
<h5 id="M208-RepRapFirmware-Set-axis-max-travel"><a href="#M208-RepRapFirmware-Set-axis-max-travel" class="headerlink" title="M208 (RepRapFirmware): Set axis max travel"></a>M208 (RepRapFirmware): Set axis max travel</h5><p>Parameters</p>
<p><code>Snnn</code> 0 &#x3D; set axis maximum (default), 1 &#x3D; set axis minimum</p>
<p><code>Xnnn</code> X axis limit</p>
<p><code>Ynnn</code> Y axis limit</p>
<p><code>Znnn</code> Z axis limit</p>
<p>Example</p>
<p>M208 X200 Y200 Z90 ; set axis maxima</p>
<p>M208 X-5 Y0 Z0 S1 ; set axis minima</p>
<p>The values specified set the software limits for axis travel in the specified direction. The axis limits you set are also the positions assumed when an endstop is triggered.</p>
<h4 id="M209-Enable-automatic-retract"><a href="#M209-Enable-automatic-retract" class="headerlink" title="M209: Enable automatic retract"></a>M209: Enable automatic retract</h4><p>With automatic retract detection, G-code generated by slicers without <code>G10</code>&#x2F;<code>G11</code> support can take advantage of Firmware Retraction. The firmware converts E-only moves into retract&#x2F;recover moves, using the firmware’s tuned lengths and feedrates in place of the original E moves.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M209 S1</span><br></pre></td></tr></table></figure>

<p>The <code>S</code> parameter turns Automatic Retract Detection on (1) or off (0).</p>
<h4 id="M210-Set-homing-feedrates"><a href="#M210-Set-homing-feedrates" class="headerlink" title="M210: Set homing feedrates"></a>M210: Set homing feedrates</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M210 X1000 Y1500</span><br></pre></td></tr></table></figure>

<p>Set the feedrates used for homing to the values specified in mm per minute.</p>
<p>If the machine is set to inches mode (e.g., with <code>G20</code>), this command may treat input values as inches-per-minute.</p>
<h4 id="M211-Disable-Enable-software-endstops"><a href="#M211-Disable-Enable-software-endstops" class="headerlink" title="M211: Disable&#x2F;Enable software endstops"></a>M211: Disable&#x2F;Enable software endstops</h4><p>The boolean value S 1&#x3D;enable or 0&#x3D;disable controls state of software endstop.</p>
<p>The boolean value X, Y or Z 1&#x3D;max endstop or 0&#x3D;min endstop selects which endstop is controlled.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M211 X1 Y1 Z1 S0</span><br></pre></td></tr></table></figure>

<p>Disables X,Y,Z max endstops</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M211 X0 S1</span><br></pre></td></tr></table></figure>

<p>Enables X min endstop</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M211</span><br></pre></td></tr></table></figure>

<p>Prints current state of software endstops.</p>
<h4 id="M212-Set-Bed-Level-Sensor-Offset"><a href="#M212-Set-Bed-Level-Sensor-Offset" class="headerlink" title="M212: Set Bed Level Sensor Offset"></a>M212: Set Bed Level Sensor Offset</h4><p>This G-Code command is known to be available in the newer versions of PrintrBot’s branch of Marlin. It may not be available in other firmware.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M212 Z-0.2</span><br></pre></td></tr></table></figure>

<p>Set the Z home to 0.2 mm lower than where the sensor says Z home is. This is extremely useful when working with printers with hard-to-move sensors, like the PrintrBot Metal Plus.</p>
<p>PrintrBot suggests that the user make minor (0.1-0.2) adjustments between attempts and immediately executes <code>M500</code> &amp; <code>M501</code> after setting this.</p>
<h4 id="M214-Set-Arc-configuration-values"><a href="#M214-Set-Arc-configuration-values" class="headerlink" title="M214: Set Arc configuration values"></a>M214: Set Arc configuration values</h4><p>Usage</p>
<p><code>M214 [P] [S] [N] [R] [F]</code></p>
<p>Parameters</p>
<p><code>Pnnn</code> A float representing the max and default millimeters per arc segment. Must be greater than 0.</p>
<p><code>Snnn</code> A float representing the minimum allowable millimeters per arc segment. Set to 0 to disable</p>
<p><code>Nnnn</code> An int representing the number of arcs to draw before correcting the small angle approximation. Set to 0 to disable.</p>
<p><code>Rnnn</code> An int representing the minimum number of segments per arcs of any radius, except when the results in segment lengths greater than or less than the minimum and maximum segment length. Set to 0 to disable.</p>
<p><code>Fnnn</code> An int representing the number of segments per second, unless this results in segment lengths greater than or less than the minimum and maximum segment length. Set to 0 to disable.</p>
<p>Prusa Firmware for MK3S&#x2F;+, MK2.5&#x2F;S only!</p>
<h4 id="M217-Toolchange-Parameters"><a href="#M217-Toolchange-Parameters" class="headerlink" title="M217: Toolchange Parameters"></a>M217: Toolchange Parameters</h4><p>If arguments are given, sets tool-change retract and prime length (mm), prime feedrate (mm&#x2F;min), retract feedrate (mm&#x2F;min), and park position&#x2F;raise (mm) or Z raise (mm): S<length> P&lt;prime_speed&gt; R&lt;retract_speed&gt; X<xpos> Y<ypos> Z<zraise>. XY arguments require <strong>SINGLENOZZLE_SWAP_PARK</strong>. If no arguments are given, reports current values. Currently used to set the <code>SINGLENOZZLE</code> tool-change options in Marlin 2.0 and up. May be extended for other tool-changing systems in the future.</p>
<h4 id="M218-Set-Hotend-Offset"><a href="#M218-Set-Hotend-Offset" class="headerlink" title="M218: Set Hotend Offset"></a>M218: Set Hotend Offset</h4><p>Sets hotend offset (in mm): T&lt;extruder_number&gt; X&lt;offset_on_X&gt; Y&lt;offset_on_Y&gt;.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M218 T1 X50 Y0.5</span><br></pre></td></tr></table></figure>

<h4 id="M220-Set-speed-factor-override-percentage"><a href="#M220-Set-speed-factor-override-percentage" class="headerlink" title="M220: Set speed factor override percentage"></a>M220: Set speed factor override percentage</h4><p>Parameters</p>
<p><code>Snnn</code> Speed factor override percentage (0..100 or higher)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M220 S80</span><br></pre></td></tr></table></figure>

<p>Sets the speed factor override percentage.</p>
<h4 id="M221-Set-extrude-factor-override-percentage"><a href="#M221-Set-extrude-factor-override-percentage" class="headerlink" title="M221: Set extrude factor override percentage"></a>M221: Set extrude factor override percentage</h4><p>Parameters</p>
<p><code>Snnn</code> Extrude factor override percentage (0..100 or higher), default 100%</p>
<p><code>Dnnn</code> Extruder drive number (RepRapFirmware only), default 0</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M221 S70</span><br><span class="line">M221 S95 D1</span><br></pre></td></tr></table></figure>

<p>Sets extrude factor override percentage. In the case of RepRapFirmware, sets the extrusion factor percentage for the specified extruder drive only.</p>
<h4 id="M220-Turn-off-AUX-V1-0-5"><a href="#M220-Turn-off-AUX-V1-0-5" class="headerlink" title="M220: Turn off AUX V1.0.5"></a>M220: Turn off AUX V1.0.5</h4><h4 id="M221-Turn-on-AUX-V1-0-5"><a href="#M221-Turn-on-AUX-V1-0-5" class="headerlink" title="M221: Turn on AUX V1.0.5"></a>M221: Turn on AUX V1.0.5</h4><h4 id="M222-Set-speed-of-fast-XY-moves"><a href="#M222-Set-speed-of-fast-XY-moves" class="headerlink" title="M222: Set speed of fast XY moves"></a>M222: Set speed of fast XY moves</h4><h4 id="M223-Set-speed-of-fast-Z-moves"><a href="#M223-Set-speed-of-fast-Z-moves" class="headerlink" title="M223: Set speed of fast Z moves"></a>M223: Set speed of fast Z moves</h4><h4 id="M224-Enable-extruder-during-fast-moves"><a href="#M224-Enable-extruder-during-fast-moves" class="headerlink" title="M224: Enable extruder during fast moves"></a>M224: Enable extruder during fast moves</h4><h4 id="M225-Disable-on-extruder-during-fast-moves"><a href="#M225-Disable-on-extruder-during-fast-moves" class="headerlink" title="M225: Disable on extruder during fast moves"></a>M225: Disable on extruder during fast moves</h4><h4 id="M226-G-code-Initiated-Pause"><a href="#M226-G-code-Initiated-Pause" class="headerlink" title="M226: G-code Initiated Pause"></a>M226: G-code Initiated Pause</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M226</span><br></pre></td></tr></table></figure>

<p>Initiates a synchronous pause (pauses after all previous commands from the same stream have been completed). That is, program execution is stopped and the printer waits for user interaction. This matches the behaviour of <code>M1</code> in the <a target="_blank" rel="noopener" href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=823374">NIST RS274NGC G-code standard</a> and <code>M0</code> in Marlin firmware.</p>
<h4 id="M226-Wait-for-pin-state"><a href="#M226-Wait-for-pin-state" class="headerlink" title="M226: Wait for pin state"></a>M226: Wait for pin state</h4><p>Parameters</p>
<p><code>Pnnn</code> pin number</p>
<p><code>Snnn</code> pin state</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M226 P2 S1</span><br></pre></td></tr></table></figure>

<p>Wait for a pin to be in some state.</p>
<h4 id="M227-Enable-Automatic-Reverse-and-Prime"><a href="#M227-Enable-Automatic-Reverse-and-Prime" class="headerlink" title="M227: Enable Automatic Reverse and Prime"></a>M227: Enable Automatic Reverse and Prime</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M227 P1600 S1600</span><br></pre></td></tr></table></figure>

<p>P and S are steps.</p>
<p>“Reverse and Prime” means, the extruder filament is retracted some distance when not in use and pushed forward the same amount before going into use again. This shall help to prevent drooling of the extruder nozzle. Teacup firmware implements this with <code>M101</code>&#x2F;<code>M103</code>.</p>
<h4 id="M228-Disable-Automatic-Reverse-and-Prime"><a href="#M228-Disable-Automatic-Reverse-and-Prime" class="headerlink" title="M228: Disable Automatic Reverse and Prime"></a>M228: Disable Automatic Reverse and Prime</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M228</span><br></pre></td></tr></table></figure>

<p>See also <code>M227</code>.</p>
<h4 id="M229-Enable-Automatic-Reverse-and-Prime"><a href="#M229-Enable-Automatic-Reverse-and-Prime" class="headerlink" title="M229: Enable Automatic Reverse and Prime"></a>M229: Enable Automatic Reverse and Prime</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M229 P1.0 S1.0</span><br></pre></td></tr></table></figure>

<p><code>P</code> and <code>S</code> are extruder screw rotations. See also <code>M227</code>.</p>
<h4 id="M230-Disable-Enable-Wait-for-Temperature-Change"><a href="#M230-Disable-Enable-Wait-for-Temperature-Change" class="headerlink" title="M230: Disable &#x2F; Enable Wait for Temperature Change"></a>M230: Disable &#x2F; Enable Wait for Temperature Change</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M230 S1</span><br></pre></td></tr></table></figure>

<p><code>S1</code> Disable wait for temperature change <code>S0</code> Enable wait for temperature change</p>
<h4 id="M231-Set-OPS-parameter"><a href="#M231-Set-OPS-parameter" class="headerlink" title="M231: Set OPS parameter"></a>M231: Set OPS parameter</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M231 S[OPS_MODE] X[Min_Distance] Y[Retract] Z[Backslash] F[RetractMove]</span><br></pre></td></tr></table></figure>

<h4 id="M232-Read-and-reset-max-advance-values"><a href="#M232-Read-and-reset-max-advance-values" class="headerlink" title="M232: Read and reset max. advance values"></a>M232: Read and reset max. advance values</h4><h4 id="M240-Trigger-camera"><a href="#M240-Trigger-camera" class="headerlink" title="M240: Trigger camera"></a>M240: Trigger camera</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M240</span><br></pre></td></tr></table></figure>

<p>Triggers a camera to take a photograph. (Add to your per-layer G-code.)</p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="M240-Start-conveyor-belt-motor-Echo-off"><a href="#M240-Start-conveyor-belt-motor-Echo-off" class="headerlink" title="M240: Start conveyor belt motor &#x2F; Echo off"></a>M240: Start conveyor belt motor &#x2F; Echo off</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M240</span><br></pre></td></tr></table></figure>

<p>The conveyor belt allows to start mass production of a part with a reprap.</p>
<p>Echoing may be controlled in some firmwares with <code>M111</code>.</p>
<h4 id="M241-Stop-conveyor-belt-motor-echo-on"><a href="#M241-Stop-conveyor-belt-motor-echo-on" class="headerlink" title="M241: Stop conveyor belt motor &#x2F; echo on"></a>M241: Stop conveyor belt motor &#x2F; echo on</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M241</span><br></pre></td></tr></table></figure>

<p>Echoing may be controlled in some firmwares with <code>M111</code>.</p>
<h4 id="M245-Start-cooler"><a href="#M245-Start-cooler" class="headerlink" title="M245: Start cooler"></a>M245: Start cooler</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M245</span><br></pre></td></tr></table></figure>

<p>used to cool parts&#x2F;heated-bed down after printing for easy remove of the parts after print</p>
<h4 id="M246-Stop-cooler"><a href="#M246-Stop-cooler" class="headerlink" title="M246: Stop cooler"></a>M246: Stop cooler</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M246</span><br></pre></td></tr></table></figure>

<h4 id="M250-Set-LCD-contrast"><a href="#M250-Set-LCD-contrast" class="headerlink" title="M250: Set LCD contrast"></a>M250: Set LCD contrast</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M250 C20</span><br></pre></td></tr></table></figure>

<p>Sets LCD contrast C<contrast value> (value 0..63), if available.</p>
<h4 id="M256-Set-LCD-brightness"><a href="#M256-Set-LCD-brightness" class="headerlink" title="M256: Set LCD brightness"></a>M256: Set LCD brightness</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M256 B128</span><br></pre></td></tr></table></figure>

<p>Set the LCD brightness B<brightness value> (value 0..255), if available.</p>
<h4 id="M251-Measure-Z-steps-from-homing-stop-Delta-printers"><a href="#M251-Measure-Z-steps-from-homing-stop-Delta-printers" class="headerlink" title="M251: Measure Z steps from homing stop (Delta printers)"></a>M251: Measure Z steps from homing stop (Delta printers)</h4><p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M251 S0 ; Reset</span><br><span class="line">M251 S1 ; Print</span><br><span class="line">M251 S2 ; Store to Z length (also EEPROM if enabled)</span><br></pre></td></tr></table></figure>

<p>(This is a Repetier-Firmware only feature.)</p>
<h4 id="M260-i2c-Send-Data"><a href="#M260-i2c-Send-Data" class="headerlink" title="M260: i2c Send Data"></a>M260: i2c Send Data</h4><p>Buffer and send data over the i2c bus. Use <code>A</code> to set the address from 0-127. Add up to 32 bytes to the buffer with each <code>B</code>. Send and reset the buffer with <code>S</code>.</p>
<p>Parameters (Marlin, MK4duo)</p>
<p><strong>Ann</strong> I2C address</p>
<p><strong>Bnn</strong> Byte to buffer or send</p>
<p><strong>S</strong> If present, sends the bytes that have been buffered</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">M260 A5 B65 S ; Send &#x27;A&#x27; to Address 5 now</span><br><span class="line">M260 A0       ; Set address to 0 (broadcast)</span><br><span class="line">M260 B77  ; M</span><br><span class="line">M260 B97  ; a</span><br><span class="line">M260 B114 ; r</span><br><span class="line">M260 B108 ; l</span><br><span class="line">M260 B105 ; i</span><br><span class="line">M260 B110 ; n</span><br><span class="line">M260 S1   ; Send the current buffer</span><br></pre></td></tr></table></figure>

<p>Parameters (RepRapFirmware)</p>
<p><strong>Ann</strong> I2C address</p>
<p><strong>Bnn:nn:nn…</strong> Bytes to send</p>
<p><strong>Snn</strong> Number of bytes to receive (RepRapFirmware 2.02 and later)</p>
<p><strong>V”name”</strong> (optional, RepRapFirmware 3.6) variable to store the received data into. Ignored unless a nonzero S parameter was provided.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M260 A5 B65                    ; Send &#x27;A&#x27; to address 5</span><br><span class="line">M260 A&#123;0x7F&#125; B65               ; Send &#x27;A&#x27; to address 7F (hex)</span><br><span class="line">M260 A0 B82:101:112:82:97:112  ; Send &#x27;RepRap&#x27; to address 0</span><br></pre></td></tr></table></figure>

<p>RepRapFirmware does not use the S parameter to mean send the current buffer, instead the address and all the bytes to send are specified in a single command.</p>
<h4 id="M260-1-Modbus-Write-register-s"><a href="#M260-1-Modbus-Write-register-s" class="headerlink" title="M260.1: Modbus Write register(s)"></a>M260.1: Modbus Write register(s)</h4><p>Parameters (provisional, RepRapFirmware)</p>
<p><strong>Pnn</strong> Serial port to send&#x2F;receive through, numbered as in M575 (1 &#x3D; first aux port, 2 &#x3D; second aux port). The port must already have been set to Modbus mode using M575.</p>
<p><strong>Ann</strong> Modbus slave device address</p>
<p><strong>Rnn</strong> First Modbus register number to send data to</p>
<p><strong>Bnn:nn:nn…</strong> 16-bit words to send</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M260 A5 R10 B956               ; write 956 to register 10 of the device at address 5</span><br><span class="line">M260 A8 R20 B123:456           ; write 123 to register 20 and 456 to register 21 of the device at address 8</span><br></pre></td></tr></table></figure>

<h4 id="M261-i2c-Request-Data"><a href="#M261-i2c-Request-Data" class="headerlink" title="M261: i2c Request Data"></a>M261: i2c Request Data</h4><p>Request data (synchronously) from an i2c slave device. This command in basic form simply relays the received data to the host.</p>
<p>Parameters</p>
<p><strong>Ann</strong> I2C device address</p>
<p><strong>Bnn</strong> How many bytes to request</p>
<p><strong>Snn</strong> (Marlin 2.0.9.3) Style of output: 0 &#x3D; Raw (default), 1 &#x3D; Bytes (hex), 2 &#x3D; 1-2 byte (integer), 3 &#x3D; Bytes (decimal)</p>
<p><strong>V”name”</strong> (optional, RepRapFirmware 3.6 and later) name of variable to receive data into. If this parameter is not present then the data read is output to the console.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M261 A99 B5                          ; Request/get 5 bytes from I2C address 99 and print them as-is.</span><br><span class="line">M261 A32 B7 S1                       ; (Marlin) Request/get 7 bytes from Address 32 and print them as space-delimited hex bytes.</span><br><span class="line">M261 A80 R10 B2 V&quot;var.modbusData&quot;    ; (RepRapFirmware) Read registers 10 and 11 from I2C address 80 and store the result in var.modbusData</span><br></pre></td></tr></table></figure>

<p>Both <code>M260</code> and <code>M261</code> are commands demonstrating use of the i2c bus (TWIBus class) in Marlin Firmware. Developers and vendors can make Marlin an i2c master device by enabling <code>EXPERIMENTAL_I2CBUS</code>, and Marlin can act as a slave device by setting <code>I2C_SLAVE_ADDRESS</code> from 8-127. This class can be used to divide up processing responsibilities between multiple instances of Marlin running on multiple boards. For example, one board might control a Z axis with 4 independent steppers to create a self-leveling system, or a second board could drive the graphical display while the first board handles printing.</p>
<h4 id="M261-1-Modbus-Read-Input-Registers"><a href="#M261-1-Modbus-Read-Input-Registers" class="headerlink" title="M261.1: Modbus Read Input Registers"></a>M261.1: Modbus Read Input Registers</h4><p>Request data (synchronously) from a Modbus slave device.</p>
<p>Parameters (provisional)</p>
<p><strong>Ann</strong> Modbus device address</p>
<p><strong>Bnn</strong> How many 16-bit registers to request</p>
<p><strong>Pnn</strong> Port to request data through, same numbering as in M575 command (1 &#x3D; first aux port, 2 &#x3D; second aux port). The port must already have been put into Modbus mode using M575.</p>
<p><strong>Rnn</strong> Register number to start from</p>
<p><strong>V”name”</strong> (optional) name of variable to receive data into. If this parameter is not present then the data read is output to the console.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M261 P1 A80 R10 B2 V&quot;var.modbusData&quot; ; (RepRapFirmware) Read registers 10 and 11 from Modbus station 80 via the first aux port and store the result in var.modbusData</span><br></pre></td></tr></table></figure>

<h4 id="M280-Set-servo-position"><a href="#M280-Set-servo-position" class="headerlink" title="M280: Set servo position"></a>M280: Set servo position</h4><p>Set servo position absolute.</p>
<p>Parameters</p>
<p><code>Pnnn</code> Servo index</p>
<p><code>Snnn</code> Angle or microseconds</p>
<p><code>I1</code> Invert polarity (RepRapFirmware only)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M280 P1 S50</span><br></pre></td></tr></table></figure>

<p>Marlin and RepRapFirmware treat <code>S</code> values below 200 as angles, and 200 or greater as the pulse width in microseconds.</p>
<p>In RepRapFirmware, the servo index is the same as the pin number for the <code>M42</code> command. See <a target="_blank" rel="noopener" href="https://duet3d.com/wiki/Using_servos_and_controlling_unused_I/O_pins">https://duet3d.com/wiki/Using_servos_and_controlling_unused_I&#x2F;O_pins</a> for details.</p>
<p>RepRapFirmware supports the optional I1 parameter, which if present causes the polarity of the servo pulses to be inverted compared to normal for that output pin. The <code>I</code> parameter is not remembered between <code>M280</code> commands (unlike the <code>I</code> parameter in <code>M106</code> commands), so if you need inverted polarity then you must include I1 in every <code>M280</code> command you send.</p>
<table><caption>Duet 0.8.5 M280 P value to Expansion Port Pin Mapping</caption><tbody><tr><th>P</th><th>Name</th><th>Expansion Port Pin</th></tr><tr><td colspan="3">Use M307 H# A-1 C-1 D-1 before using these pins</td></tr><tr><td>3</td><td>PC23_PWML6</td><td>21</td></tr><tr><td>4</td><td>PC22_PWML5</td><td>22</td></tr><tr><td>5</td><td>PC21_PWML4</td><td>23</td></tr></tbody></table>

<p>On the Duet 0.6, pin 18 is controlled by heater 2. On the 0.8.5, pin 18 is controlled by heater 6, but is also shared with fan1. In order to use this pin, the fan must be disabled (<code>M106 P1 I-1</code>). See <a target="_blank" rel="noopener" href="https://duet3d.com/wiki/Using_servos_and_controlling_unused_I/O_pins">Using servos and controlling unused I&#x2F;O pins</a></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="M281-Set-Servo-Angles"><a href="#M281-Set-Servo-Angles" class="headerlink" title="M281: Set Servo Angles"></a>M281: Set Servo Angles</h4><p>Set the angles for a servo’s deployed (or selected) and stowed (or unselected) states. To activate this command in Marlin enable the <code>EDITABLE_SERVO_ANGLES</code> option.</p>
<p>Parameters</p>
<p><code>P[index]</code> - Servo Index</p>
<p><code>L[angle]</code> - Deployed &#x2F; Selected Angle</p>
<p><code>U[angle]</code> - Stowed &#x2F; Unselected Angle</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M281 P0 L30 U90</span><br></pre></td></tr></table></figure>

<h4 id="M282-Detach-Servo"><a href="#M282-Detach-Servo" class="headerlink" title="M282: Detach Servo"></a>M282: Detach Servo</h4><p>Detach servo. This disables the servo until its next move. To activate this command in Marlin enable the <code>SERVO_DETACH_GCODE</code> option.</p>
<p>Parameters</p>
<p><code>Pnnn</code> Servo index</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M282 P1</span><br></pre></td></tr></table></figure>

<h4 id="M290-Babystepping"><a href="#M290-Babystepping" class="headerlink" title="M290: Babystepping"></a>M290: Babystepping</h4><p>Parameters (RepRapFirmware)</p>
<p><code>Snnn</code> Amount to baby step Z in mm. Positive values raise the head, negative values lower it.</p>
<p><code>Xnnn, Ynnn, ...</code> Amount to baby step other axes in mm (optional, supported in later RepRapFirmware versions)</p>
<p><code>Znnn</code> Synonym for S (RepRapFirmware 1.21 and later)</p>
<p><code>Rn</code> (Optional, RepRapFirmware 1.21 and later) R1 &#x3D; relative (add to any existing babystep amount, the default), R0 &#x3D; absolute (set babystepping offset to the specified amount)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M290 S0.05  ; babystep the head up 0.05mm</span><br><span class="line">M290 R0 S0  ; clear babystepping (RepRapFirmware 1.21 and later only)</span><br></pre></td></tr></table></figure>

<p>Parameters (Repetier)</p>
<p><code>Znnn</code> Amount to baby step in mm. Positive values raise the head, negative values lower it.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M290 S0.05  ; babystep the head up 0.05mm</span><br></pre></td></tr></table></figure>

<p>Additional Parameters (Marlin 1.1.7 and later)</p>
<p><code>Xnnn</code> Amount to babystep X in current units. (Requires <code>BABYSTEP_XY</code>)</p>
<p><code>Ynnn</code> Amount to babystep Y in current units. (Requires <code>BABYSTEP_XY</code>)</p>
<p><code>Znnn</code> Amount to babystep Z in current units. Synonym for ‘<code>S</code>‘ parameter.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M290 X0.2 Z0.05 ; Babystep X by 0.2mm, Z by 0.05mm</span><br></pre></td></tr></table></figure>

<p>This command tells the printer to move the axis (or axes) transparently to the motion system. This is like physically moving the axes by force, but much nicer to the machine.</p>
<p>In RepRapFirmware <code>M290</code> with no parameters reports the accumulated baby stepping offset. Marlin doesn’t track accumulated babysteps.</p>
<p>In RepRapFirmware 1.19 and earlier, the babystepping offset is reset to zero when the printer is homed or the bed is probed. In RepRapFirmware 1.21 and later, homing and bed probing don’t reset babystepping, but you can reset it explicitly using M290 R0 S0.</p>
<p>Note: If the <code>BABYSTEP_ZPROBE_OFFSET</code> option is used in Marlin, this command also affects the Z probe offset (as set by <code>M851</code>) and that offset <em>will</em> be saved to EEPROM.</p>
<h4 id="M291-Display-message-and-optionally-wait-for-response"><a href="#M291-Display-message-and-optionally-wait-for-response" class="headerlink" title="M291: Display message and optionally wait for response"></a>M291: Display message and optionally wait for response</h4><p>Parameters</p>
<p><code>P&quot;message&quot;</code> The message to display, which must be enclosed in double quotation marks. If the message itself contains a double quotation mark, use two double quotation marks to represent it.</p>
<p><code>R&quot;message&quot;</code> Optional title for the message box. Must be enclosed in double quotation marks too.</p>
<p><code>Sn</code> Message box mode (defaults to 1)</p>
<p><code>Tn</code> Timeout in seconds, only legal for S&#x3D;0 and S&#x3D;1. The message will be cancelled after this amount of time, if the user does not cancel it before then. A zero or negative value means that the message does not time out (it may still be cancelled by the user if it has a Close button). In RepRapFirmware, the default timeout for messages that do not require acknowledgement is 10 seconds.</p>
<p><code>Zn</code> 0 &#x3D; no special action, 1 &#x3D; display Z jog buttons alongside the message to allow the user to adjust the height of the print head</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M291 P&quot;Please do something and press OK when done&quot; S2</span><br><span class="line">M291 P&quot;This message will be closed after 10 seconds&quot; T10</span><br></pre></td></tr></table></figure>

<p>This command provides a more flexible alternative to M117, in particular messages that time out, messages that suspend execution until the user acknowledges them, and messages that allow the user to adjust the height of the print head before acknowledging them.</p>
<p>Allowed message box modes include:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0. No buttons are displayed (non-blocking)</span><br><span class="line">1. Only &quot;Close&quot; is displayed (non-blocking)</span><br><span class="line">2. Only &quot;OK&quot; is displayed (blocking, send M292 to resume the execution)</span><br><span class="line">3. &quot;OK&quot; and &quot;Cancel&quot; are displayed  (blocking, send M292 to resume the execution or M292 P1 to cancel the operation in progress)</span><br></pre></td></tr></table></figure>

<p>The combination S0 T0 is not permitted, because that would generate a message box with no close button and that never times out, which would lock up the user interface.</p>
<p>Duet Web Control 2.0.3 and later supports HTML in the message body.</p>
<h4 id="M292-Acknowledge-message"><a href="#M292-Acknowledge-message" class="headerlink" title="M292: Acknowledge message"></a>M292: Acknowledge message</h4><p>Parameters</p>
<p><code>Pn</code> Whether the current operation shall be cancelled. Only legal if M291 was called with S&#x3D;3 (optional)</p>
<p>This command is sent by the user interface when the user acknowledges a message that was displayed because of a M291 command with parameter S&#x3D;2 or S&#x3D;3.</p>
<h4 id="M293-Babystep-Z"><a href="#M293-Babystep-Z" class="headerlink" title="M293: Babystep Z+"></a>M293: Babystep Z+</h4><p>Babystep Z upward by one increment according to settings. Requires <code>EP_BABYSTEPPING</code>. With `EMERGENCY_PARSER` babystepping is asynchronous and doesn’t rely on the queue.</p>
<h4 id="M294-Babystep-Z"><a href="#M294-Babystep-Z" class="headerlink" title="M294: Babystep Z-"></a>M294: Babystep Z-</h4><p>Babystep Z downward by one increment according to settings. Requires <code>EP_BABYSTEPPING</code>. With `EMERGENCY_PARSER` babystepping is asynchronous and doesn’t rely on the queue.</p>
<h4 id="M300-Play-beep-sound"><a href="#M300-Play-beep-sound" class="headerlink" title="M300: Play beep sound"></a>M300: Play beep sound</h4><p>Parameters</p>
<p><code>Snnn</code> frequency in Hz</p>
<p><code>Pnnn</code> duration in milliseconds</p>
<p><code>Vnnn</code> volume in rage 0 - 1</p>
<p><code>Cnnn</code> custom buzzer port (only in RRF 3.6 or later, must be PWM-capable)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M300 S300 P1000</span><br></pre></td></tr></table></figure>

<p>Play beep sound, use to notify important events like the end of printing. <a target="_blank" rel="noopener" href="https://reprap.org/wiki/R2C2_RepRap_Electronics" title="R2C2 RepRap Electronics">R2C2 electronics</a>.</p>
<p>If an LCD device is attached to RepRapFirmware, a sound is played via the add-on touch screen control panel. Else the web interface will play a beep sound.</p>
<p>Notes</p>
<p><sup>1</sup>In Prusa Firmware the defaults are 100Hz and 1000ms, so that <code>M300</code> without parameters will beep for a second.</p>
<p><sup>2</sup>Klipper does not support <code>M300</code> by default, however it can be easily added as a <a target="_blank" rel="noopener" href="https://github.com/KevinOConnor/klipper/blob/master/config/sample-macros.cfg">G-code macro</a></p>
<h4 id="M301-Set-PID-parameters"><a href="#M301-Set-PID-parameters" class="headerlink" title="M301: Set PID parameters"></a>M301: Set PID parameters</h4><p>Parameters</p>
<p><code>Hnnn</code> heater number (Smoothie uses ‘S’, Redeem uses ‘E’)</p>
<p><code>Pnnn</code> proportional (Kp)</p>
<p><code>Innn</code> integral (Ki)</p>
<p><code>Dnnn</code> derivative (Kd)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M301 H1 P1 I2 D3 ; Marlin, RepRapFirmware</span><br><span class="line">M301 S0 P30 I10 D10 ; Smoothie</span><br><span class="line">M301 E0 P30 I10 D10 ; Redeem (E = Extruder, -1=Bed, 0=E, 1=H, 2=A, 3=B, 4=C, default = 0)</span><br></pre></td></tr></table></figure>

<p>Sets Proportional (P), Integral (I) and Derivative (D) values for hot end. See also <a target="_blank" rel="noopener" href="https://reprap.org/wiki/PID_Tuning" title="PID Tuning">PID Tuning</a>.</p>
<h5 id="MK4duo"><a href="#MK4duo" class="headerlink" title="MK4duo"></a>MK4duo</h5><p>H[heaters] H &#x3D; 0-5 Hotend, H &#x3D; -1 BED, H &#x3D; -2 CHAMBER, H &#x3D; -3 COOLER</p>
<h5 id="Marlin"><a href="#Marlin" class="headerlink" title="Marlin"></a>Marlin</h5><p>Hot end only; see <code>M304</code> for bed PID. H is the heater number, default 1 (i.e. first extruder heater).</p>
<h5 id="RepRapFirmware-1-15-onwards"><a href="#RepRapFirmware-1-15-onwards" class="headerlink" title="RepRapFirmware 1.15 onwards"></a>RepRapFirmware 1.15 onwards</h5><p>In RepRapFirmware 1.15 and later the M301 is supported as described above, but it is not normally used. Instead the heater model is defined by M307 or found by auto tuning, and the firmware calculates the PID parameters from the model. An M301 command can be used in config.g after the M307 command for that heater to override the firmware-computed PID parameters.</p>
<h5 id="RepRapFirmware-1-09-to-1-14-inclusive"><a href="#RepRapFirmware-1-09-to-1-14-inclusive" class="headerlink" title="RepRapFirmware 1.09 to 1.14 inclusive"></a>RepRapFirmware 1.09 to 1.14 inclusive</h5><ul>
<li><code>H</code> Is the heater number, and is compulsory. H0 is the bed, H1 is the first hot end, H2 the second etc.</li>
<li><code>P</code> Interprets a negative P term as indicating that bang-bang control should be used instead of PID (not recommended for the hot end, but OK for the bed heater).</li>
<li><code>I</code> Integral value</li>
<li><code>D</code> Derivative value</li>
<li><code>T</code> Is the approximate additional PWM (on a scale of 0 to 255) needed to maintain temperature, per degree C above room temperature. Used to preset the I-accumulator when switching from heater fully on&#x2F;off to PID.</li>
<li><code>S</code> PWM scaling factor, to allow for variation in heater power and supply voltage. Is designed to allow a correction to be made for a change in heater power and&#x2F;or power supply voltage without having to change all the other parameters. For example, an S factor of 0.8 means that the final output of the PID controller should be scaled to 0.8 times the standard value, which would compensate for a heater that is 25% more powerful than the standard one or a supply voltage that is 12.5% higher than standard.</li>
<li><code>W</code> Wind-up. Sets the maximum value of I-term, must be high enough to reach 245C for ABS printing.</li>
<li><code>B</code> PID Band. Errors larger than this cause heater to be on or off.</li>
</ul>
<p>An example using all of these would be:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M301 H1 P20 I0.5 D100 T0.4 S1 W180 B30</span><br></pre></td></tr></table></figure>

<h5 id="Smoothie"><a href="#Smoothie" class="headerlink" title="Smoothie"></a>Smoothie</h5><p><code>S0</code> is 0 for the hotend, and 1 for the bed, other numbers may apply to your configuration, depending on the order in which you declare temperature control modules.</p>
<h5 id="Other-implementations"><a href="#Other-implementations" class="headerlink" title="Other implementations"></a>Other implementations</h5><p>W: Wind-up. Sets the maximum value of I-term, so it does not overwhelm other PID values, and the heater stays on. (Check firmware support - Sprinter, Marlin?)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M301 W125</span><br></pre></td></tr></table></figure>

<h5 id="Teacup"><a href="#Teacup" class="headerlink" title="Teacup"></a>Teacup</h5><p>See <code>M130</code>, <code>M131</code>, <code>M132</code>, <code>M133</code> for <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Teacup" title="Teacup">Teacup</a>‘s codes for setting the PID parameters.</p>
<h4 id="M302-Allow-cold-extrudes"><a href="#M302-Allow-cold-extrudes" class="headerlink" title="M302: Allow cold extrudes"></a>M302: Allow cold extrudes</h4><p>Parameters</p>
<p><code>Snnn</code> Cold extrude minimum temperature (also in RepRapFirmware 2.02 and later)</p>
<p><code>Pnnn</code> Cold extrude allow state (RepRapFirmware)</p>
<p><code>Rnnn</code> Cold retraction minimum temperature (RepRapFirmware 2.02 and later)</p>
<p>Examples (RepRapFirmwre)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M302       ; Report current state</span><br><span class="line">M302 P1    ; Allow cold extrusion</span><br><span class="line">M302 S120 R110 ; Allow extrusion starting from 120°C and retractions already from 110°C</span><br></pre></td></tr></table></figure>

<p>Examples (Others)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M302 S0    ; Allow extrusion at any temperature</span><br><span class="line">M302 S170  ; Allow extrusion above 170</span><br></pre></td></tr></table></figure>

<p>This tells the printer to allow movement of the extruder motor above a certain temperature, or if disabled, to allow extruder movement when the hotend is below a safe printing temperature.</p>
<p>Notes</p>
<p><sup>1</sup>RepRapFirmware uses the <code>P[0|1]</code> parameter instead of <code>S[temperature]</code>, and for <code>M302</code> with no parameters it will report the current cold extrusion state.</p>
<h4 id="M303-Run-PID-tuning"><a href="#M303-Run-PID-tuning" class="headerlink" title="M303: Run PID tuning"></a>M303: Run PID tuning</h4><p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/PID_Tuning" title="PID Tuning">PID Tuning</a> refers to a control algorithm used in some repraps to tune heating behavior for hot ends and heated beds. This command generates Proportional (Kp), Integral (Ki), and Derivative (Kd) values for the hotend or bed (E-1). Send the appropriate code and wait for the output to update the firmware.</p>
<p>Hot end usage:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 S&lt;temperature&gt; C&lt;cycles&gt;</span><br></pre></td></tr></table></figure>

<p>Bed usage (repetier, not sure whether cycles work here):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 P1 S&lt;temperature&gt;</span><br></pre></td></tr></table></figure>

<p>Bed usage (others):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 E-1 C&lt;cycles&gt; S&lt;temperature&gt;</span><br></pre></td></tr></table></figure>

<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 C8 S175</span><br></pre></td></tr></table></figure>

<p>Smoothie’s syntax, where <code>E0</code> is the first temperature control module (usually the hot end) and <code>E1</code> is the second temperature control module (usually the bed):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 E0 S190</span><br></pre></td></tr></table></figure>

<p>In RepRapFirmware, this command computes the process model parameters (see <code>M307</code>), which are in turn used to calculate the PID constants. H is the heater number, P is the PWM to use (default 0.5), and S is the maximum allowable temperature (default 225). Tuning is performed asynchronously. Run <code>M303</code> with no parameters to see the current tuning state or the last tuning result.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M303 H1 P0.4 S240 ; tune heater 1 using 40% PWM, quit if temperature exceeds 240C</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p>In Marlin Firmware you can add the <code>U1</code> parameter to apply the PID results to current settings upon completion.</p>
<h4 id="M304-Set-PID-parameters-Bed"><a href="#M304-Set-PID-parameters-Bed" class="headerlink" title="M304: Set PID parameters - Bed"></a>M304: Set PID parameters - Bed</h4><p>Parameters</p>
<p><code>Pnnn</code> proportional (Kp)</p>
<p><code>Innn</code> integral (Ki)</p>
<p><code>Dnnn</code> derivative (Kd)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M304 P1 I2 D3 ; set kP=3, kI=2, kD=3</span><br><span class="line">M304 P1 I2 D3 T0.7 B20 W127 ; RepRapFirmware</span><br><span class="line">M304          ; Report parameters</span><br></pre></td></tr></table></figure>

<p>Sets Proportional, Integral and Derivative values for bed. RepRapFirmware interprets a negative P term as indicating that bang-bang control should be used instead of PID. In RepRapFirmware, this command is identical to <code>M301</code> except that the <code>H</code> parameter (heater number) defaults to zero.</p>
<p>See also <a target="_blank" rel="noopener" href="https://reprap.org/wiki/PID_Tuning" title="PID Tuning">PID Tuning</a>.</p>
<h5 id="M304-in-RepRapPro-version-of-Marlin-Set-thermistor-values"><a href="#M304-in-RepRapPro-version-of-Marlin-Set-thermistor-values" class="headerlink" title="M304 in RepRapPro version of Marlin: Set thermistor values"></a>M304 in RepRapPro version of Marlin: Set thermistor values</h5><p>In the RepRapPro version of Marlin ( <a target="_blank" rel="noopener" href="https://github.com/reprappro/Marlin">https://github.com/reprappro/Marlin</a> ) <code>M304</code> is used to set thermistor values (as <code>M305</code> is in later firmwares). RRP Marlin calculates temperatures on the fly, rather than using a temperature table. <code>M304</code> Sets the parameters for temperature measurement.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M304 H1 B4200 R4800 T100000</span><br></pre></td></tr></table></figure>

<p>This tells the firmware that for heater 1 (<code>H</code> parameter: 0 &#x3D; heated bed, H &#x3D; first extruder), the thermistor beta (<code>B</code> parameter) is 4200, the thermistor series resistance (<code>R</code> parameter) is 4.8Kohms, the thermistor 25C resistance (<code>T</code> parameter) is 100Kohms. All parameters other than H are optional. If only the <code>H</code> parameter is given, the currently-used values are displayed. They are also displayed within the response to <code>M503</code>.</p>
<h4 id="M305-Set-thermistor-and-ADC-parameters"><a href="#M305-Set-thermistor-and-ADC-parameters" class="headerlink" title="M305: Set thermistor and ADC parameters"></a>M305: Set thermistor and ADC parameters</h4><p>Parameters</p>
<p><code>Pnnn</code> Heater number, or virtual heater number</p>
<p><code>S&quot;name&quot;</code> Heater name (optional, RepRapFirmware only)</p>
<p><code>Tnnn</code> (for thermistor sensors) Thermistor resistance at 25<sup>o</sup>C</p>
<p><code>T&quot;c&quot;</code> (for MAX31856-based thermocouple sensors) The thermistor type letter, default K</p>
<p><code>Bnnn</code> Beta value, or the reciprocal of the Steinhart-Hart thermistor model B coefficient</p>
<p><code>Cnnn</code> Steinhart-Hart C coefficient (MK4duo and RepRapFirmware 1.17 and later), default 0</p>
<p><code>Rnnn</code> Series resistor value</p>
<p><code>Lnnn</code> ADC low offset correction, default 0</p>
<p><code>Hnnn</code> ADC high offset correction, default 0</p>
<p><code>Xnnn</code> Heater ADC channel, or thermocouple or PT100 or current loop adapter channel, defaults to the same value as the <code>P</code> parameter</p>
<p><code>Fnn </code> (where nn is 50 or 60) If the sensor interface uses a MAX31856 thermocouple chip or MAX31865 PT100 chip, this is the local mains frequency. Readings will be timed to optimise rejection of interference at this frequency.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M305 P1 T100000 R1000 B4200</span><br></pre></td></tr></table></figure>

<p>Sets the parameters for temperature measurement. The example above tells the firmware that for heater 1 (<code>P</code> parameter: 0 &#x3D; heated bed, 1 &#x3D; first extruder) the thermistor 25C resistance (<code>T</code> parameter) is 100Kohms, the thermistor series resistance (<code>R</code> parameter) is 1Kohms, the thermistor beta (<code>B</code> parameter) is 4200. All parameters other than P are optional. If only the <code>P</code> parameter is given, the existing values are displayed.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M305 P1 T100000 R1000 B4200 H14 L-11 X2</span><br></pre></td></tr></table></figure>

<p>The H correction affects the reading at high ADC input voltages, so it has the greatest effect at low temperatures. The L correction affects the reading at low input voltages, which correspond to high temperatures.</p>
<p>The <code>X</code> parameter tells the firmware to use the thermistor input corresponding to a different heating channel. RepRapFirmware also allow an external SPI thermocouple interface (such as the MAX31855) or PT100 interface (MAX31865) to be configured. MAX31855 thermocouple channels are numbered from 100, MAX31856 thermocouple channels are numbered from 150, PT100 channels from 200 and current loop channels from 300. Channel 1000 is the CPU temperature indication, 1001 is the temperature of the hottest stepper motor driver on the main board, and 1001 is the temperature of the hottest drivers on the expansion board.</p>
<p>In the above example, the ADC high end correction (<code>H</code> parameter) is 14, the ADC low end correction (<code>L</code> parameter) is -11, and thermistor input #2 is used to measure the temperature of heater #1.</p>
<h4 id="M306-Set-home-offset-calculated-from-toolhead-position"><a href="#M306-Set-home-offset-calculated-from-toolhead-position" class="headerlink" title="M306: Set home offset calculated from toolhead position"></a>M306: Set home offset calculated from toolhead position</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M306 Z0</span><br></pre></td></tr></table></figure>

<p>The values specified are added to the calculated end stop position when the axes are referenced. The calculated value is derived from the distance of the toolhead from the current axis zero point.</p>
<p>The user would typically place the toolhead at the zero point of the axis and issue the <code>M306</code> command.</p>
<p>This value can be saved to EEPROM using the <code>M500</code> command (as <code>M206</code> value).</p>
<p>Implemented in Smoothieware</p>
<h4 id="M307-Set-or-report-heating-process-parameters"><a href="#M307-Set-or-report-heating-process-parameters" class="headerlink" title="M307: Set or report heating process parameters"></a>M307: Set or report heating process parameters</h4><p>Parameters</p>
<p><code>Hn</code> Heater number (0 is usually the bed heater)</p>
<p><code>Annn</code> gAin, expressed as ultimate temperature rise obtained in degC divided by the PWM fraction. For example, if G&#x3D;180 then at 50% PWM the ultimate temperature rise would be 90C.</p>
<p><code>Cnnn</code> dominant time Constant of the heating process in seconds</p>
<p><code>Dnnn</code> Dead time in seconds</p>
<p>Four optional additional parameters help control the heating process</p>
<p><code>Fnnn</code> PWM frequency to use (not supported in RepRapFirmware 3, use M950 instead).</p>
<p><code>Bn</code> selects Bang-bang control instead of PID if non-zero. Default at power-up is 0 for extruder heaters, 1 for bed and chamber heaters.</p>
<p><code>Snnn</code> maximum PWM to be used used with this heater on a scale of 0 to 1. Default 1.0.</p>
<p><code>Vnnn</code> VIN supply voltage at which the A parameter was calibrated (RepRapFirmware 1.20 and later). This allows the PID controller to compensate for changes in supply voltage. A value of zero (the default) disables compensation for changes in supply voltage.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M307 H0 ; report the process parameters for heater 0</span><br><span class="line">M307 H1 A346.2 C140 D5.3 B0 S0.8 V23.8 ; set process parameters for heater 1, use PID, and limit heater 1 PWM to 80%</span><br></pre></td></tr></table></figure>

<p>Each heater and its corresponding load may be approximated as a first order process with dead time, which is characterised by the gain, time constant and dead time parameters. The model can used to calculate optimum PID parameters, using different values for the heating or cooling phase and the steady state phase. It is also used to better detect heater faults. In future it may be used to calculate feed-forward terms to better respond to changes in the load. Normally these model parameters are found by auto tuning - see <code>M303</code>.</p>
<p>RepRapFirmware 1.16 and later allow the PID controller for a heater to be disabled by setting the <code>A</code>, <code>C</code>, and <code>D</code> parameters to -1. This frees up the corresponding heater control pin for use as a general purpose I&#x2F;O pin to use with the M42 or M280 command. In RepRapFirmware 3, M950 should be used to free up the pin instead.</p>
<h4 id="M308-Set-or-report-sensor-parameters"><a href="#M308-Set-or-report-sensor-parameters" class="headerlink" title="M308: Set or report sensor parameters"></a>M308: Set or report sensor parameters</h4><p>Common Parameters</p>
<p><code>Sn</code> Sensor number</p>
<p><code>P&quot;pin_name&quot;</code> The name of the control board pin that this sensor uses. For thermistors it is the thermistor input pin name. For sensors connected to the SPI bus it is the name of the output pin used as the chip select.</p>
<p><code>Y&quot;sensor_type&quot;</code> The sensor and interface type, e.g. “thermistor”, “pt1000”, “rtdmax31865”, “max31855”, “max31856”, “linear-analog”, “dht22-temp”, “dht22-humidity”, “current-loop-pyro”</p>
<p><code>A&quot;name&quot;</code> Sensor name (optional), displayed in the web interface</p>
<p>Additional parameters for thermistors</p>
<p><code>Tnnn</code> (for thermistor sensors) Thermistor resistance at 25<sup>o</sup>C</p>
<p><code>Bnnn</code> Beta value, or the reciprocal of the Steinhart-Hart thermistor model B coefficient</p>
<p><code>Cnnn</code> Steinhart-Hart C coefficient, default 0</p>
<p><code>Rnnn</code> Series resistor value</p>
<p><code>Lnnn</code> ADC low offset correction, default 0 (ignored if the hardware supports automatic ADC gain and offset calibration)</p>
<p><code>Hnnn</code> ADC high offset correction, default 0 (ignored if the hardware supports automatic ADC gain and offset calibration)</p>
<p>Additional parameters for PT1000 sensors</p>
<p><code>Rnnn</code> Series resistor value</p>
<p><code>Lnnn</code> ADC low offset correction, default 0 (ignored if the hardware supports automatic ADC gain and offset calibration)</p>
<p><code>Hnnn</code> ADC high offset correction, default 0 (ignored if the hardware supports automatic ADC gain and offset calibration)</p>
<p>Additional parameters for MAX31856-based thermocouple sensors</p>
<p><code>T&quot;c&quot;</code> The thermistor type letter, default K</p>
<p><code>Fnn </code> (where nn is 50 or 60) The local mains frequency. Readings will be timed to optimise rejection of interference at this frequency.</p>
<p>Additional parameters for MAX31865-based PT100 sensors</p>
<p><code>Rnnn</code> Series resistor value</p>
<p><code>Fnn </code> (where nn is 50 or 60) The local mains frequency. Readings will be timed to optimise rejection of interference at this frequency.</p>
<p>Additional parameters for linear analog sensors</p>
<p><code>Fn</code> F0 &#x3D; unfiltered (fast response), F1 &#x3D; filtered (slower response, but noise reduced and ADC oversampling used to increase resolution)</p>
<p><code>Lnnn</code> The temperature or other value when the ADC output is zero</p>
<p><code>Hnnn</code> The temperature or other value when the ADC output is full scale</p>
<p>This code replaces M305 in RepRapFirmware 3. In earlier versions of RepRapFirmware, sensors only existed in combination with heaters, which necessitated the concept of a “virtual heater” to represent a sensor with no associated heater (e.g. MCU temperature sensor). RepRapFirmware 3 allows sensors to be defined independently of heaters. The association between heaters and sensors is defined using M950.</p>
<p>M308 can be used in the following ways:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M308 Snn Y&quot;type&quot; P&quot;pin&quot; [other parameters] ; delete sensor nn if it exists, create a new one with default settings, and configure it using the other parameters</span><br><span class="line">M308 Snn ; report the settings of sensor nn</span><br><span class="line">M308 A&quot;name&quot; ; report the settings of the first sensor named &quot;name&quot;</span><br><span class="line">M308 Snn [any other parameters except Y] ; amend the settings of sensor nn</span><br></pre></td></tr></table></figure>

<p>Sensor type names obey the same rules as pin names, i.e. case is not significant, neither are hyphen and underscore characters.</p>
<h4 id="M309-Set-or-report-heater-feedforward"><a href="#M309-Set-or-report-heater-feedforward" class="headerlink" title="M309: Set or report heater feedforward"></a>M309: Set or report heater feedforward</h4><p>Parameters</p>
<p><strong>Pn</strong> Tool number</p>
<p><strong>Saaa:bbb:ccc…</strong> Feedforward coefficients. The number of coefficients provided must equal the number of heaters configured for the tool when it was created (see M563).</p>
<p>If the P parameter is not provided, the current tool is assumed. If the S parameter is not provided, the existing coefficients are reported.</p>
<p>The units of <strong>S</strong> are PWM fraction (on a scale of 0 to 1) per mm&#x2F;sec of filament forward movement.</p>
<h4 id="M310-Temperature-model-settings"><a href="#M310-Temperature-model-settings" class="headerlink" title="M310: Temperature model settings"></a>M310: Temperature model settings</h4><p>Usage</p>
<p><code>M310</code>  ; report values</p>
<p><code>M310 [ A ]</code>  ; autotune C+R values</p>
<p><code>M310 [ F ]</code>  ; force model self-test state</p>
<p><code>M310 [ S ]</code>  ; set 0&#x3D;disable 1&#x3D;enable</p>
<p><code>M310 [ I ] [ R ]</code>  ; set resistance at index</p>
<p><code>M310 [ P | C ]</code>  ; set power, capacitance</p>
<p><code>M310 [ B | E | W ]</code>  ; set beeper, warning and error threshold</p>
<p><code>M310 [ T ]</code>  ; set ambient temperature correction</p>
<p>Parameters</p>
<p><code>A</code> autotune C+R values</p>
<p><code>F</code> force model self-test state (0&#x3D;off 1&#x3D;on) during autotune using current values</p>
<p><code>Snnn</code> set 0&#x3D;disable 1&#x3D;enable</p>
<p><code>Innn</code> resistance index position (0-15)</p>
<p><code>Rnnn</code> resistance value at index (K&#x2F;W; requires :<code>Innn</code>)</p>
<p><code>Pnnn</code> power (W)</p>
<p><code>Cnnn</code> capacitance (J&#x2F;K)</p>
<p><code>Bnnn</code> beep and warn when reaching warning threshold 0&#x3D;disable 1&#x3D;enable (default: 1)</p>
<p><code>Ennn</code> error threshold (K&#x2F;s; default in variant)</p>
<p><code>Wnnn</code>‘ warning threshold (K&#x2F;s; default in variant)</p>
<p><code>Tnnn</code> ambient temperature correction (K; default in variant)</p>
<p>Prusa Firmware for MK3S&#x2F;+, MK2.5&#x2F;S only!</p>
<h4 id="M320-Activate-autolevel-Repetier"><a href="#M320-Activate-autolevel-Repetier" class="headerlink" title="M320: Activate autolevel (Repetier)"></a>M320: Activate autolevel (Repetier)</h4><p>Usage</p>
<p><code>M320</code></p>
<p><code>M320 S1</code></p>
<p>Parameters</p>
<p><code>Snnn</code> if greater than 0, activate and store persistently in EEPROM</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M320    ; temporarily activate auto leveling</span><br><span class="line">M320 S1 ; permanently activate auto leveling</span><br></pre></td></tr></table></figure>

<p>Parameter <code>Snnn</code> is optional.</p>
<p>(Repetier only)</p>
<h4 id="M321-Deactivate-autolevel-Repetier"><a href="#M321-Deactivate-autolevel-Repetier" class="headerlink" title="M321: Deactivate autolevel (Repetier)"></a>M321: Deactivate autolevel (Repetier)</h4><p>Usage</p>
<p><code>M321</code></p>
<p><code>M321 S1</code></p>
<p>Parameters</p>
<p><code>Snnn</code> if greater than 0, deactivate and store persistently in EEPROM</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M321    ; temporarily deactivate auto leveling</span><br><span class="line">M321 S1 ; permanently deactivate auto leveling</span><br></pre></td></tr></table></figure>

<p>Parameter <code>Snnn</code> is optional.</p>
<p>(Repetier only)</p>
<h4 id="M322-Reset-autolevel-matrix-Repetier"><a href="#M322-Reset-autolevel-matrix-Repetier" class="headerlink" title="M322: Reset autolevel matrix (Repetier)"></a>M322: Reset autolevel matrix (Repetier)</h4><p>Usage</p>
<p><code>M322</code></p>
<p><code>M322 S1</code></p>
<p>Parameters</p>
<p><code>Snnn</code> if greater than 0, also reset the matrix values saved EEPROM</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M322    ; temporarily reset auto level matrix</span><br><span class="line">M322 S1 ; permanently reset auto level matrix</span><br></pre></td></tr></table></figure>

<p>Parameter <code>Snnn</code> is optional.</p>
<p>(Repetier only)</p>
<h4 id="M323-Distortion-correction-on-off-Repetier"><a href="#M323-Distortion-correction-on-off-Repetier" class="headerlink" title="M323: Distortion correction on&#x2F;off (Repetier)"></a>M323: Distortion correction on&#x2F;off (Repetier)</h4><p>Usage</p>
<p><code>M323</code></p>
<p><code>M323 Snnn</code></p>
<p><code>M323 Snnn Pnnn</code></p>
<p>Parameters</p>
<p><code>Snnn</code> 0 (disable correction) or 1 (enable correction)</p>
<p><code>Pnnn</code> 1 (store correction state persistently in EEPROM)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M323       ; Show if distortion correction is enabled</span><br><span class="line">M323 S0    ; Disable distortion correction temporarily</span><br><span class="line">M323 S1 P1 ; Enable distortion correction permanently</span><br></pre></td></tr></table></figure>

<p>(Repetier only) Controls distortion correction feature after having set it up using <code>G33.</code></p>
<h4 id="M340-Control-the-servos"><a href="#M340-Control-the-servos" class="headerlink" title="M340: Control the servos"></a>M340: Control the servos</h4><p>(Repetier only ,Marlin see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Gcode#M280:_Set_servo_position" title="Gcode">M280</a>)</p>
<p>M340 P<servoId> S<pulseInUS> &#x2F; ServoID &#x3D; 0..3 pulseInUs &#x3D; 500..2500</p>
<p>Servos are controlled by a pulse width normally between 500 and 2500 with 1500ms in center position. 0 turns servo off.</p>
<h4 id="M350-Set-microstepping-mode"><a href="#M350-Set-microstepping-mode" class="headerlink" title="M350: Set microstepping mode"></a>M350: Set microstepping mode</h4><p>Sets microstepping mode.</p>
<p>Warning: Steps per unit remains unchanged; except that in RepRapFirmware the steps&#x2F;mm will be adjusted automatically.</p>
<p>Usage</p>
<p><code>M350 Snn Xnn Ynn Znn Enn Bnn</code></p>
<p>Parameters</p>
<p><em>Not all parameters need to be used, but at least <strong>one</strong> should be used. As with other commands, RepRapFirmware reports the current settings if no parameters are used</em>.</p>
<p><code>Snn</code> Set stepping mode for all drivers (not supported by RepRapFirmware)</p>
<p><code>Xnn</code> Set stepping mode for the X axis</p>
<p><code>Ynn</code> Set stepping mode for the Y axis</p>
<p><code>Znn</code> Set stepping mode for the Z axis</p>
<p><code>Enn</code> Set stepping mode for Extruder 0 (for RepRapFirmware use <code>Enn:nn:nn</code> etc. for multiple extruders)</p>
<p><code>Bnn</code> Set stepping mode for Extruder 1 (not supported by RepRapFirmware, see above)</p>
<p><code>Inn</code> Enable (nn&#x3D;1) or disable (nn&#x3D;0) microstep interpolation mode for the specified drivers, if they support it (RepRapFirmware only)</p>
<p>Modes (nn)</p>
<p>1 &#x3D; full step</p>
<p>2 &#x3D; half step</p>
<p>4 &#x3D; quarter step</p>
<p>8 &#x3D; 1&#x2F;8 step</p>
<p>16 &#x3D; 1&#x2F;16 step</p>
<p>64 &#x3D; 1&#x2F;64 step</p>
<p>128 &#x3D; 1&#x2F;128 step</p>
<p>256 &#x3D; 1&#x2F;256 step</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M350 S16    ; reset all drivers to the default 1/16 micro-stepping - not supported by RepRapFirmware</span><br><span class="line">M350 Z1     ; set the Z-axis&#x27; driver to use full steps</span><br><span class="line">M350 E4 B4  ; set both extruders to use quarter steps - Marlin/Repetier</span><br><span class="line">M350 E4:4:4 ; set extruders 0-2 to use quarter steps - RepRapFirmware</span><br></pre></td></tr></table></figure>

<h4 id="M351-Toggle-MS1-MS2-pins-directly"><a href="#M351-Toggle-MS1-MS2-pins-directly" class="headerlink" title="M351: Toggle MS1 MS2 pins directly"></a>M351: Toggle MS1 MS2 pins directly</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M351</span><br></pre></td></tr></table></figure>

<h4 id="M355-Turn-case-lights-on-off"><a href="#M355-Turn-case-lights-on-off" class="headerlink" title="M355: Turn case lights on&#x2F;off"></a>M355: Turn case lights on&#x2F;off</h4><p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">M355 S1 ; Enable lights</span><br><span class="line">M355 S0 ; Disable lights</span><br><span class="line">M355    ; Report status</span><br><span class="line">M355 P0 ; Turn light off</span><br><span class="line">M355 P128 ; Turn light on with half power</span><br><span class="line">M355 P255 ; Turn light on with full power</span><br></pre></td></tr></table></figure>

<p>Every call or change over LCD menu sends a state change for connected hosting software like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Case lights on</span><br><span class="line">Case lights off</span><br><span class="line">No case lights</span><br></pre></td></tr></table></figure>

<h4 id="M360-Report-firmware-configuration"><a href="#M360-Report-firmware-configuration" class="headerlink" title="M360: Report firmware configuration"></a>M360: Report firmware configuration</h4><p>Target</p>
<p>This command helps hosting software to detect configuration details, which the user would need to enter otherwise. It should reduce configuration time considerably if supported.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M360</span><br></pre></td></tr></table></figure>

<p>Response</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">Config:Baudrate:250000</span><br><span class="line">Config:InputBuffer:127</span><br><span class="line">Config:NumExtruder:2</span><br><span class="line">Config:MixingExtruder:0</span><br><span class="line">Config:HeatedBed:0</span><br><span class="line">Config:SDCard:1</span><br><span class="line">Config:Fan:1</span><br><span class="line">Config:LCD:1</span><br><span class="line">Config:SoftwarePowerSwitch:1</span><br><span class="line">Config:XHomeDir:-1</span><br><span class="line">Config:YHomeDir:-1</span><br><span class="line">Config:ZHomeDir:-1</span><br><span class="line">Config:SupportG10G11:1</span><br><span class="line">Config:SupportLocalFilamentchange:1</span><br><span class="line">Config:CaseLights:0</span><br><span class="line">Config:ZProbe:1</span><br><span class="line">Config:Autolevel:0</span><br><span class="line">Config:EEPROM:1</span><br><span class="line">Config:PrintlineCache:24</span><br><span class="line">Config:JerkXY:30.00</span><br><span class="line">Config:JerkZ:0.30</span><br><span class="line">Config:RetractionLength:3.00</span><br><span class="line">Config:RetractionLongLength:13.00</span><br><span class="line">Config:RetractionSpeed:40.00</span><br><span class="line">Config:RetractionZLift:0.00</span><br><span class="line">Config:RetractionUndoExtraLength:0.00</span><br><span class="line">Config:RetractionUndoExtraLongLength:0.00</span><br><span class="line">Config:RetractionUndoSpeed:0.00</span><br><span class="line">Config:XMin:0.00</span><br><span class="line">Config:YMin:0.00</span><br><span class="line">Config:ZMin:0.00</span><br><span class="line">Config:XMax:250.00</span><br><span class="line">Config:YMax:150.00</span><br><span class="line">Config:ZMax:90.00</span><br><span class="line">Config:XSize:250.00</span><br><span class="line">Config:YSize:150.00</span><br><span class="line">Config:ZSize:90.00</span><br><span class="line">Config:XPrintAccel:250.00</span><br><span class="line">Config:YPrintAccel:250.00</span><br><span class="line">Config:ZPrintAccel:100.00</span><br><span class="line">Config:XTravelAccel:250.00</span><br><span class="line">Config:YTravelAccel:250.00</span><br><span class="line">Config:ZTravelAccel:100.00</span><br><span class="line">Config:PrinterType:Cartesian</span><br><span class="line">Config:MaxBedTemp:120</span><br><span class="line">Config:Extr.1:Jerk:50.00</span><br><span class="line">Config:Extr.1:MaxSpeed:100.00</span><br><span class="line">Config:Extr.1:Acceleration:10000.00</span><br><span class="line">Config:Extr.1:Diameter:0.00</span><br><span class="line">Config:Extr.1:MaxTemp:220</span><br><span class="line">Config:Extr.2:Jerk:50.00</span><br><span class="line">Config:Extr.2:MaxSpeed:100.00</span><br><span class="line">Config:Extr.2:Acceleration:10000.00</span><br><span class="line">Config:Extr.2:Diameter:0.00</span><br><span class="line">Config:Extr.2:MaxTemp:220</span><br></pre></td></tr></table></figure>

<h4 id="SCARA-calibration-codes-Morgan"><a href="#SCARA-calibration-codes-Morgan" class="headerlink" title="SCARA calibration codes (Morgan)"></a>SCARA calibration codes (Morgan)</h4><p>In order to ease calibration of Reprap Morgan, the following M-codes are used to set the machine up</p>
<h4 id="M360-Move-to-Theta-0-degree-position"><a href="#M360-Move-to-Theta-0-degree-position" class="headerlink" title="M360: Move to Theta 0 degree position"></a>M360: Move to Theta 0 degree position</h4><p>The arms move into a position where the Theta steering arm is parallel to the top platform edge. The user then calibrates the position by moving the arms with the jog buttons in software like pronterface until it is perfectly parallel. Using <code>M114</code> will then display the calibration offset that can then be programmed into the unit using <code>M206</code> (Home offset) X represents Theta.</p>
<p>Smoothieware: <code>M360 P0</code> will take the current position as parallel to the platform edge, and store the offset in the homing trim offset (M666) No further user interaction is needed.</p>
<h4 id="M361-Move-to-Theta-90-degree-position"><a href="#M361-Move-to-Theta-90-degree-position" class="headerlink" title="M361: Move to Theta 90 degree position"></a>M361: Move to Theta 90 degree position</h4><p>Theta move to 90 degrees with platform edge. User calibrates by using jog arms to place exactly 90 degrees. Steps per degree can then be read out by using <code>M114</code>, and programmed using <code>M92</code>. X represents Theta. Program Y (Psi) to the same value initially. Remember to repeat <code>M360</code> after adjusting steps per degree.</p>
<p>Smoothieware: <code>M360 P0</code> will accept the current position as 90deg to platform edge. New steps per angle is calculated and entered into memory (M92) No further user interaction is required, except to redo <code>M360</code>.</p>
<h4 id="M362-Move-to-Psi-0-degree-position"><a href="#M362-Move-to-Psi-0-degree-position" class="headerlink" title="M362: Move to Psi 0 degree position"></a>M362: Move to Psi 0 degree position</h4><p>Arms move to Psi 0 degree. Check only after other Theta calibrations</p>
<h4 id="M363-Move-to-Psi-90-degree-position"><a href="#M363-Move-to-Psi-90-degree-position" class="headerlink" title="M363: Move to Psi 90 degree position"></a>M363: Move to Psi 90 degree position</h4><p>Arms move to Psi 90 degree. Check only after other Theta calibrations</p>
<h4 id="M364-Move-to-Psi-Theta-90-degree-position"><a href="#M364-Move-to-Psi-Theta-90-degree-position" class="headerlink" title="M364: Move to Psi + Theta 90 degree position"></a>M364: Move to Psi + Theta 90 degree position</h4><p>Move arms to form a 90 degree angle between the inner and outer Psi arms. Calibrate by moving until angle is exactly 90 degree. Read out with <code>M114</code>, and calibrate value into Home offset <code>M206</code>. Psi is represented by Y.</p>
<p>Smoothieware: <code>M364 P0</code> will accept the current position as 90deg between arms. The offset is stored as a trim offset (M666) and no further user interaction is required except to save all changes via <code>M500</code>.</p>
<h4 id="M365-SCARA-scaling-factor"><a href="#M365-SCARA-scaling-factor" class="headerlink" title="M365: SCARA scaling factor"></a>M365: SCARA scaling factor</h4><p>Adjust X Y and Z scaling by entering the factor. 100% scaling (default) is represented by 1</p>
<h4 id="M366-SCARA-convert-trim"><a href="#M366-SCARA-convert-trim" class="headerlink" title="M366: SCARA convert trim"></a>M366: SCARA convert trim</h4><p>Executing this command translates the calculated trim values of the SCARA calibration to real home offsets. This prevents the home and trim movement after calibration.</p>
<h4 id="M370-Morgan-manual-bed-level-clear-map"><a href="#M370-Morgan-manual-bed-level-clear-map" class="headerlink" title="M370: Morgan manual bed level - clear map"></a>M370: Morgan manual bed level - clear map</h4><p>Clear the map and prepare for calibration</p>
<p>Usage</p>
<p><code>M370</code></p>
<p><code>M370 X[divisions] Y[divisions]</code></p>
<p>Without parameters is defaults to <code>X5 Y5</code> (25 calibration points) When specifying parameters, uneven numbers are recommended.</p>
<h4 id="M371-Move-to-next-calibration-position"><a href="#M371-Move-to-next-calibration-position" class="headerlink" title="M371: Move to next calibration position"></a>M371: Move to next calibration position</h4><p>Move to the next position for calibration. User moves the bed towards the hotend until it just touches</p>
<h4 id="M372-Record-calibration-value-and-move-to-next-position"><a href="#M372-Record-calibration-value-and-move-to-next-position" class="headerlink" title="M372: Record calibration value, and move to next position"></a>M372: Record calibration value, and move to next position</h4><p>The position of the bed is recorded and the machine moves to the next position. Repeat until all positions programmed</p>
<h4 id="M373-End-bed-level-calibration-mode"><a href="#M373-End-bed-level-calibration-mode" class="headerlink" title="M373: End bed level calibration mode"></a>M373: End bed level calibration mode</h4><p>End calibration mode and enable z correction matrix. Does not save current matrix</p>
<h4 id="M374-Save-calibration-grid"><a href="#M374-Save-calibration-grid" class="headerlink" title="M374: Save calibration grid"></a>M374: Save calibration grid</h4><p>Saves the calibration grid.</p>
<p>Parameters</p>
<p><code>extension</code> (Smoothieware only) Extension of the grid file</p>
<p><code>P&quot;filename&quot;</code> (RepRapFirmware only) Name of the file to save to</p>
<p><code>Z</code> (Smoothieware only) Also save the <code>M206</code> Z homing offset into the grid file</p>
<p>Usage (Smoothieware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M374</span><br><span class="line">M374 &lt;file extension&gt; Z</span><br></pre></td></tr></table></figure>

<p>Usage (RepRapFirmware)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M374</span><br><span class="line">M374 P&quot;MyAlternateHeightMap.csv&quot;</span><br></pre></td></tr></table></figure>

<p>In Smoothieware, without parameters this saves the grid into the default grid file that gets loaded at boot. The optional parameter specifies the extension of the grid file - useful for special grid files such as for a special print surface like a removable print plate. Addition of Z will additionally save the <code>M206 Z</code> homing offset into the grid file.</p>
<p>In RepRapFirmware, this saves the grid parameters and height map into the specified file, or the default file <code>heightmap.csv</code> if no filename was specified. To load the height map automatically at startup, use command <code>M375</code> in the config.g file.</p>
<h4 id="M375-Display-matrix-Load-Matrix"><a href="#M375-Display-matrix-Load-Matrix" class="headerlink" title="M375: Display matrix &#x2F; Load Matrix"></a>M375: Display matrix &#x2F; Load Matrix</h4><p>Displays the bed level calibration matrix (Marlin), or loads the grid matrix file (Smoothieware and RepRapFirmware)</p>
<p>Parameters</p>
<p><code>extension</code> (Smoothieware only)</p>
<p><code>P&quot;filename&quot;</code> (RepRapFirmware only)</p>
<p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M375</span><br><span class="line">M375 [file extension] ; (Smoothieware only)</span><br><span class="line">M375 P&quot;MyAlternateHeightMap.csv&quot; ; (RepRapFirmware only)</span><br></pre></td></tr></table></figure>

<p>Without parameters loads default grid, and with specified extension or specified filename attempts to load the specified grid. If not available will not modify the current grid. In Smoothieware, if Z was saved with the grid file, it will load the saved Z with the grid.</p>
<h4 id="M376-Set-bed-compensation-taper"><a href="#M376-Set-bed-compensation-taper" class="headerlink" title="M376: Set bed compensation taper"></a>M376: Set bed compensation taper</h4><p>Parameters</p>
<p><code>Hnnn</code> Height (mm) over which to taper off the bed compensation</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M376 H10</span><br></pre></td></tr></table></figure>

<p>This command specifies that bed compensation should be tapered off over the specified height, so that no bed compensation is applied at and above that height. If H is zero or negative then no tapering is applied, so compensation is performed throughout the entire print.</p>
<p>If the firmware does not adjust the extrusion amount to compensate for the changing layer height while tapering is being applied, you will get under- or over-extrusion. Using a large taper height will reduce this effect. For example, if the taper height is 50 times the largest bed height error, then under- or over-extrusion will be limited to 2%.</p>
<h4 id="M380-Activate-solenoid"><a href="#M380-Activate-solenoid" class="headerlink" title="M380: Activate solenoid"></a>M380: Activate solenoid</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M380</span><br></pre></td></tr></table></figure>

<p>Activates solenoid on active extruder.</p>
<h4 id="M381-Disable-all-solenoids"><a href="#M381-Disable-all-solenoids" class="headerlink" title="M381: Disable all solenoids"></a>M381: Disable all solenoids</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M381</span><br></pre></td></tr></table></figure>

<h4 id="M400-Wait-for-current-moves-to-finish"><a href="#M400-Wait-for-current-moves-to-finish" class="headerlink" title="M400: Wait for current moves to finish"></a>M400: Wait for current moves to finish</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M400</span><br></pre></td></tr></table></figure>

<p>Finishes all current moves and and thus clears the buffer. That’s identical to <code>G4 P0</code> for Teacup printers.</p>
<h4 id="M401-Deploy-Z-Probe"><a href="#M401-Deploy-Z-Probe" class="headerlink" title="M401: Deploy Z Probe"></a>M401: Deploy Z Probe</h4><p>Parameters</p>
<p><strong>P</strong> Probe number, default 0 (RepRapFirmware)</p>
<p><strong>S</strong> Set BLTouch HS Mode (Marlin 2.0.9.3+ with <code>BLTOUCH</code> enabled.)</p>
<p><strong>H</strong> Report current BLTouch HS Mode (Marlin 2.0.9.4+ with <code>BLTOUCH</code> enabled.)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M401</span><br><span class="line">M401 P1</span><br></pre></td></tr></table></figure>

<p>Deploy the z-probe (if present). In RepRapFirmware this command runs the macro file <strong>sys&#x2F;deployprobe#.g</strong> (where # is the probe number) if it exists, otherwise it runs <strong>sys&#x2F;deployprobe.g</strong> if it exists.</p>
<h4 id="M402-Stow-Z-Probe"><a href="#M402-Stow-Z-Probe" class="headerlink" title="M402: Stow Z Probe"></a>M402: Stow Z Probe</h4><p>Parameters</p>
<p><strong>P</strong> (RepRapFirmware only) Probe number, default 0</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M402</span><br><span class="line">M402 P1</span><br></pre></td></tr></table></figure>

<p>Raise z-probe if present. In RepRapFirmware this runs macro file <strong>sys&#x2F;retractprobe#.g</strong> (where # is the probe number) if it exists, otherwise <strong>sys&#x2F;retractprobe.g</strong> if it exists.</p>
<h4 id="M403-Set-filament-type-material-for-particular-extruder-and-notify-the-MMU"><a href="#M403-Set-filament-type-material-for-particular-extruder-and-notify-the-MMU" class="headerlink" title="M403: Set filament type (material) for particular extruder and notify the MMU"></a>M403: Set filament type (material) for particular extruder and notify the MMU</h4><p>Parameters</p>
<p><code>E</code> Extruder number</p>
<p><code>F</code> Filament type</p>
<p>Currently three different materials are needed (default, flex and PVA).</p>
<p>And storing this information for different load&#x2F;unload profiles etc. in the future firmware does not have to wait for “ok” from MMU.</p>
<h4 id="M404-Filament-diameter"><a href="#M404-Filament-diameter" class="headerlink" title="M404: Filament diameter"></a>M404: Filament diameter</h4><p>Parameters</p>
<p><code>Nnnn</code> Filament diameter (in mm)</p>
<p><code>Dnnn</code> Nozzle diameter (in mm)<sup>1</sup></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M404 N1.75</span><br><span class="line">M404 N3.0 D1.0</span><br></pre></td></tr></table></figure>

<p>Specifies the nominal filament diameter (typically 3mm or 1.75mm) or displays the nominal filament diameter if no parameters are provided.</p>
<p>Notes</p>
<p><sup>1</sup>While Marlin only accepts the ‘N’ parameter, older versions of RepRapFirmware allowed the nozzle diameter (in mm) to be specified via the ‘D ‘parameter. This value was used to help detect the first layer height when files are parsed. Newer version of RepRapFirmware ignore the D parameter.</p>
<h4 id="M405-Filament-Sensor-on"><a href="#M405-Filament-Sensor-on" class="headerlink" title="M405: Filament Sensor on"></a>M405: Filament Sensor on</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M405</span><br></pre></td></tr></table></figure>

<p>Turn on Filament Sensor extrusion control. Optional D<delay in cm> to set delay in centimeters between sensor and extruder.</p>
<h4 id="M406-Filament-Sensor-off"><a href="#M406-Filament-Sensor-off" class="headerlink" title="M406: Filament Sensor off"></a>M406: Filament Sensor off</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M406</span><br></pre></td></tr></table></figure>

<p>Turn off Filament Sensor extrusion control.</p>
<h4 id="M407-Display-filament-diameter"><a href="#M407-Display-filament-diameter" class="headerlink" title="M407: Display filament diameter"></a>M407: Display filament diameter</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M407</span><br></pre></td></tr></table></figure>

<p>Displays measured filament diameter. In RepRapFirmware, <code>M407</code> does the same as <code>M404</code>.</p>
<h4 id="M408-Report-JSON-style-response"><a href="#M408-Report-JSON-style-response" class="headerlink" title="M408: Report JSON-style response"></a>M408: Report JSON-style response</h4><p><strong>This command is deprecated in RepRapFirmware 3.3 and later. Support for it will be removed in a future release. Use M409 instead.</strong></p>
<p>Parameters</p>
<p><code>Snnn</code> Response type</p>
<p><code>Rnnn</code> Response sequence number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M408 S0</span><br></pre></td></tr></table></figure>

<p>Report a JSON-style response by specifying the desired type using the ‘S’ parameter. The following response types are supported:</p>
<ul>
<li>Type 0 is a short-form response, similar to the response used by older versions of the web interface.</li>
<li>Type 1 is like type 0 except that static values are also included.</li>
<li>Type 2 is similar to the response provided by the web server for Duet Web Control.</li>
<li>Type 3 is an extended version of type 2 which includes some additional parameters that aren’t expected to change very frequently.</li>
<li>Type 4 is an extended version of type 2 which may be used to poll for current printer statistics.</li>
<li>Type 5 reports the current machine configuration.</li>
</ul>
<p>Here is an example of a typical type 0 response:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;status&quot;:&quot;I&quot;,&quot;heaters&quot;:[25.0,29.0,28.3],&quot;active&quot;:[-273.1,0.0,0.0],&quot;standby&quot;:[-273.1,0.0,0.0],&quot;hstat&quot;:[0,2,1],&quot;pos&quot;:[-11.00,0.00,0.00],&quot;extr&quot;:[0.0,0.0],</span><br><span class="line"> &quot;sfactor&quot;:100.00, &quot;efactor&quot;:[100.00,100.00],&quot;tool&quot;:1,&quot;probe&quot;:&quot;535&quot;,&quot;fanPercent&quot;:[75.0,0.0],&quot;fanRPM&quot;:0,&quot;homed&quot;:[0,0,0],&quot;fraction_printed&quot;:0.572&#125;</span><br></pre></td></tr></table></figure>

<p>The response is set as a single line with a newline character at the end. The meaning of the fields is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">status:  I=idle, P=printing from SD card, S=stopped (i.e. needs a reset), C=running config file (i.e starting up), A=paused, D=pausing, R=resuming from a pause, B=busy (e.g. running a macro), F=performing firmware update</span><br><span class="line">heaters: current heater temperatures, numbered as per the machine (typically, heater 0 is the bed)</span><br><span class="line">active:  active temperatures of the heaters</span><br><span class="line">standby: standby temperatures of the heaters</span><br><span class="line">hstat:   status of the heaters, 0=off, 1=standby, 2=active, 3=heater fault. Heater 0 is normally the bed heater, heaters 1, 2.. are the extruder heaters.</span><br><span class="line">pos:     the X, Y and Z (and U, V, W if present) axis positions of the current tool (if a tool is selected), or of the print head reference point if no tool is selected</span><br><span class="line">extr:    the positions of the extruders</span><br><span class="line">sfactor: the current speed factor (see M220</span><br><span class="line"> command)</span><br><span class="line">efactor: the current extrusion factors (see M221</span><br><span class="line"> command), one value per extruder</span><br><span class="line">tool:    the selected tool number. A negative number typically means no tool selected.</span><br><span class="line">probe:   the Z-probe reading</span><br><span class="line">fanPercent: the speeds of the controllable fans, in percent of maximum</span><br><span class="line">fanRPM:  the print cooling fan RPM</span><br><span class="line">homed:   the homed status of the X, Y and Z axes (and U, V, W if they exist), or towers on a delta. 0=axis has not been homed so position is not reliable, 1=axis has been homed so position is reliable.</span><br><span class="line">fraction_printed: the fraction of the file currently being printed that has been read and at least partially processed.</span><br><span class="line">message: the message to be displayed on the screen (only present if there is a message to display)</span><br><span class="line">timesLeft: an array of the estimated remaining print times (in seconds) calculated by different methods. These are currently based on the proportion of the file read,</span><br><span class="line">           the proportion of the total filament consumed, and the proportion of the total layers already printed. Only present if a print from SD card is in progress.</span><br><span class="line">seq:     the sequence number of the most recent non-trivial G-code response or error message. Only present if the R</span><br><span class="line"> parameter was provided and the current sequence number is greater than that.</span><br><span class="line">resp:    the most recent non-trivial G-code response or error message. Only present if the R</span><br><span class="line"> parameter was provided and the current sequence number is greater.</span><br></pre></td></tr></table></figure>

<p>The type 1 response comprises these fields plus some additional ones that do not generally change and therefore do not need to be fetched as often. The extra fields include:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">myName:  the name of the printer</span><br><span class="line">firmwareName: the name of the firmware, e.g. &quot;RepRapFirmware&quot;, &quot;Smoothieware&quot; or &quot;Repetier&quot;</span><br><span class="line">geometry: one of &quot;cartesian&quot;, &quot;delta&quot;, &quot;corexy, &quot;corexz&quot; etc.</span><br><span class="line">axes:    the number of axes</span><br><span class="line">volumes: the number of SD card slots available</span><br><span class="line">numTools:   the number of available tools numbered contiguously starting from 0</span><br></pre></td></tr></table></figure>

<p>The fields may be in any order in the response. Other implementations may omit fields and&#x2F;or add additional fields.</p>
<p>For a more detailed comparison of type 2 - 5, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/RepRap_Firmware_Status_responses" title="RepRap Firmware Status responses">RepRap_Firmware_Status_responses</a>.</p>
<p>PanelDue currently uses only <code>M408 S0</code> and <code>M408 S1</code>.</p>
<h4 id="M409-Query-object-model"><a href="#M409-Query-object-model" class="headerlink" title="M409: Query object model"></a>M409: Query object model</h4><p>Parameters</p>
<p><code>K&quot;key&quot;</code> Key string, default empty</p>
<p><code>F&quot;flags&quot;</code> Flags string, default empty</p>
<p><code>Rnnn</code> Pass through request to RepRapFirmware (only for SBC mode, v3.5.2 or later)</p>
<p><code>Innn</code> Increment sequence number of the given key (reserved for internal usage ONLY)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">M409 K&quot;move.axes&quot; F&quot;f&quot;     ; report all frequently-changing properties of all axes</span><br><span class="line">M409 K&quot;move.axes[0] F&quot;v&quot;   ; report all properties of the first axis, including values not normally reported</span><br><span class="line">M409 K&quot;move.axes[].homed&quot;  ; for all axes, report whether it is homed</span><br><span class="line">M409 K&quot;#move.axes&quot;         ; report the number of axes</span><br><span class="line">M408 F&quot;f&quot;                  ; report all values that are likely to have changed recently</span><br><span class="line">M409 F&quot;v&quot;                  ; report the entire object model (caution, this may be very large!)</span><br></pre></td></tr></table></figure>

<p>The key string is just the path to the Object Model (OM) variables wanted, with the following extensions:</p>
<ul>
<li>An element that is an array may be followed by either [<em>number</em>] to select just one element, or by [] to select all elements and report the results as an array</li>
<li>The path may be preceded by # in which case the path must refer to an array and just the number of array elements is returned</li>
</ul>
<p>An empty key string selects the entire object model.</p>
<p>The flags string may include one or more of the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d#: (depth) return the OM to depth d# where # is a sequence of digits. The default depth is 1 if the key is empty or not provided (because the returned object would be very large, perhaps too large to send), otherwise a large value (larger than the maximum depth of anything in the OM).</span><br><span class="line">f: (frequent) return only those values in the object model that typically change frequently during a job. User interfaces can use M409 with this flag to stay up to date.</span><br><span class="line">n: (null) include fields with null values (null fields are normally omitted, but null array elements are never omitted) </span><br><span class="line">v: (verbose) include values that are rarely needed and not normally returned (e.g. controller electronics and firmware limits)</span><br></pre></td></tr></table></figure>

<p>The response is a JSON object of the following form:</p>
<p>{“key”:”<em>key</em>“,”flag’”:”<em>flags</em>“,”result”:<em>object-value</em>}</p>
<p>The key and flags fields are as provided in the M409 command. If the key string is malformed or refers to a property that does not exist in the object model, the result field is <strong>null</strong>.</p>
<p>RepRapFirmware on network-enabled electronics also provides the same functionality via the rr_model call to the HTTP API.</p>
<h4 id="M410-Quick-Stop"><a href="#M410-Quick-Stop" class="headerlink" title="M410: Quick-Stop"></a>M410: Quick-Stop</h4><p>This command does a quick stop of all stepper motors and aborts all moves in the planner. This command is only intended for emergency situations, and due to the instant stop the actual stepper positions may be shifted. Note that if `EMERGENCY_PARSER` is disabled, the response may be delayed while the command buffer is being queued. If a print job is in progress, it will continue, so it is important to suspend the print job before using this command.</p>
<h4 id="M412-Disable-Filament-Runout-Detection"><a href="#M412-Disable-Filament-Runout-Detection" class="headerlink" title="M412: Disable Filament Runout Detection"></a>M412: Disable Filament Runout Detection</h4><p>Enable or disable filament runout detection. When filament sensors are enabled, the firmware responds to a filament runout by running the configured G-code (usually <code>M600</code> Filament Change). When filament runout detection is disabled, no action will be taken on filament runout.</p>
<p>Usage: <code>M412 S[on|off]</code></p>
<p>If no ‘S’ parameter is given, this command reports the current state of filament runout detection.</p>
<p>Examples</p>
<p><code>M412 S1</code> <em>Enable filament runout detection</em></p>
<p><code>M412 S0</code> <em>Disable filament runout detection</em></p>
<p><code>M412</code> <em>Report the current filament runout detection state</em></p>
<h4 id="M413-Power-Loss-Recovery"><a href="#M413-Power-Loss-Recovery" class="headerlink" title="M413: Power-Loss Recovery"></a>M413: Power-Loss Recovery</h4><p>Enable or disable the <strong>Power-loss Recovery</strong> feature. When this feature is enabled, the state of the current print job (SD card only) will be saved to a file on the SD card. If the machine crashes or a power outage occurs, the firmware will present an option to Resume the interrupted print job. In Marlin 2.0 the <code>POWER_LOSS_RECOVERY</code> option must be enabled.</p>
<p>This feature operates without a power-loss detection circuit by writing to the recovery file periodically (e.g., once per layer), or if a <code>POWER_LOSS_PIN</code> is configured then it will write the recovery info only when a power-loss is detected. The latter option is preferred, since constant writing to the SD card can shorten its life, and the print will be resumed where it was interrupted rather than repeating the last layer. (Future implementations may allow use of the EEPROM or the on-board SD card.)</p>
<p>Usage: <code>M413 S[on|off]</code></p>
<p>If no ‘S’ parameter is given, this command reports the current state of Power-loss Recovery.</p>
<p>Examples</p>
<p><code>M413 S1</code> <em>Enable power-loss recovery</em></p>
<p><code>M413 S0</code> <em>Disable power-loss recovery</em></p>
<p><code>M413</code> <em>Report the current power-loss recovery state</em></p>
<h4 id="M415-Host-Rescue"><a href="#M415-Host-Rescue" class="headerlink" title="M415: Host Rescue"></a>M415: Host Rescue</h4><p>The host rescue G-code is essential to enabling host software to recover from a lost connection or power loss. With this solution the firmware stores the last received coordinate and current position in EEPROM. Once the host reconnects, the firmware reports this recovery information. From the last-received coordinate the host can determine the last line that was processed. Firmware should move the extruder to a parking position if commands stop arriving during an active print job (with heaters still on). Once the host starts sending new commands the firmware should restore the last position. Host and firmware developers can work together to optimize this solution.</p>
<p>If the firmware supports this solution it should announce it with the capability: <code>Cap:HOST_RESCUE:1</code></p>
<p>Examples</p>
<p><code>M415 S1</code> <em>Enable host rescue system</em></p>
<p><code>M415 S0</code> <em>Disable host rescue system</em></p>
<p><code>M415 Z[zpos]</code> <em>Set Z position as if homed</em></p>
<p><code>M415</code> <em>Report rescue state</em></p>
<p>Every call to M415 reports the state. Answers are</p>
<p>RESCUE_STATE: OFF</p>
<p>Nothing stored. Print finished.</p>
<p>RESCUE_STATE: LX:121.97 LY:143.33 LZ:3.30 LE:1.84 LT:0 X:0.00 Y:240.00 Z:13.30 E:1.84</p>
<p>Print was interrupted. Coordinates with leading L are last received positions, LT is active extruder. Normal coordinates are current position and can be omitted, if the move did not finish due to power loss.</p>
<p>On a power loss the firmware should respond with <code>POWERLOSS_DETECTED</code> as early as possible to give host time to flush log as it is likely host will also go down very soon.</p>
<p>Support is available in Repetier-Firmware 1.0.4 or higher. Repetier-Server 0.91.0 is the first to use this concept and can be used to validate implementation.</p>
<h4 id="M416-Power-loss"><a href="#M416-Power-loss" class="headerlink" title="M416: Power loss"></a>M416: Power loss</h4><p>Host tells firmware that it will loose power. This is the solution in case a connected host has a power loss detection and firmware does not. Firmware should return the message <code>POWERLOSS_DETECTED</code> and do whatever firmware is supposed to do in that case. In combination with host rescue it should store positions, disable heaters, go to park position.</p>
<h4 id="M420-Firmware-dependent"><a href="#M420-Firmware-dependent" class="headerlink" title="M420: Firmware dependent"></a>M420: Firmware dependent</h4><h5 id="M420-Set-RGB-Colors-as-PWM-MachineKit"><a href="#M420-Set-RGB-Colors-as-PWM-MachineKit" class="headerlink" title="M420: Set RGB Colors as PWM (MachineKit)"></a>M420: Set RGB Colors as PWM (MachineKit)</h5><p>Usage: <code>M420 R[Red PWM (0-255)] E[Green PWM (0-255)] B[Blue PWM (0-255)]</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M420 R255 E255 B255</span><br></pre></td></tr></table></figure>

<p>Set the color of your RGB LEDs that are connected to PWM-enabled pins. Note, the Green color is controlled by the <code>E</code> value instead of the G value due to the G code being a primary code that cannot be overridden.</p>
<p>In Marlin <code>M420</code> is Enable&#x2F;Disable Mesh Leveling (with current values) S1&#x3D;enable S0&#x3D;disable</p>
<h5 id="M420-Leveling-On-Off-Fade-Marlin"><a href="#M420-Leveling-On-Off-Fade-Marlin" class="headerlink" title="M420: Leveling On&#x2F;Off&#x2F;Fade (Marlin)"></a>M420: Leveling On&#x2F;Off&#x2F;Fade (Marlin)</h5><p>Enable&#x2F;Disable Bed Leveling (using the current stored grid or mesh).</p>
<p>Usage</p>
<p><code>M420 S[bool] Z[float]</code></p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M420 S1  ; Enable compensation using current grid/mesh</span><br><span class="line">M420 Z10 ; Gradually reduce compensation until Z=10</span><br></pre></td></tr></table></figure>

<p>Marlin 1.1.0 adds the <code>Z</code> parameter to set the “fade” height. This requires the <code>ENABLE_LEVELING_FADE_HEIGHT</code> option.</p>
<p>When the <code>Z</code> fade height value is set non-zero, bed compensation will gradually reduce up to the given height, and cease completely above that height.</p>
<h5 id="M420-Mesh-bed-leveling-status"><a href="#M420-Mesh-bed-leveling-status" class="headerlink" title="M420: Mesh bed leveling status"></a>M420: Mesh bed leveling status</h5><p>Prints mesh bed leveling status and bed profile if activated.</p>
<p>Usage</p>
<p><code>M420</code></p>
<p>Equivalent to <code>G81</code></p>
<h4 id="M421-Set-a-Mesh-Bed-Leveling-Z-coordinate"><a href="#M421-Set-a-Mesh-Bed-Leveling-Z-coordinate" class="headerlink" title="M421: Set a Mesh Bed Leveling Z coordinate"></a>M421: Set a Mesh Bed Leveling Z coordinate</h4><p>Set a single Z coordinate in the Mesh, Bilinear or UBL Leveling grid. Requires <code>MESH_BED_LEVELING</code> or <code>AUTO_BED_LEVELING_BILINEAR</code> or <code>AUTO_BED_LEVELING_UBL</code>.</p>
<p>I &amp; J are the index for the X and Y axis respectively.</p>
<p>Usage</p>
<p><code>M421 I[index] J[index] Z[float]</code> to set an absolute value to a mesh point</p>
<p>or</p>
<p><code>M421 I[index] J[index] Q[float]</code> to offset a mesh point by a specified value</p>
<h4 id="M422-Set-a-G34-Point"><a href="#M422-Set-a-G34-Point" class="headerlink" title="M422: Set a G34 Point"></a>M422: Set a G34 Point</h4><p>Set a single XY coordinate to be used by <code>G34</code> for Z Stepper Alignment.</p>
<p>Usage</p>
<p><code>M422 S[index] X[pos] Y[pos]</code></p>
<h4 id="M423-X-Axis-Twist-Compensation"><a href="#M423-X-Axis-Twist-Compensation" class="headerlink" title="M423: X-Axis Twist Compensation"></a>M423: X-Axis Twist Compensation</h4><p>Reset, set, or report X-Axis Twist Compensation data that will be used by subsequent <code>G29</code> commands to compensate for a twisted X-axis.</p>
<p>Parameters</p>
<p><code>R</code> Flag to reset the X-twist data to configured defaults.</p>
<p><code>X[index]</code> Zero-based index into the X-twist data array. (<code>Z</code> is also required)</p>
<p><code>Z[offset]</code> An offset value to set. (<code>X</code> is also required)</p>
<p><code>A[start]</code> Set the starting X position.</p>
<p><code>I[spacing]</code> Set the X spacing distance.</p>
<p>Usage</p>
<p><code>M423</code> to report the current X-twist data to the host console.</p>
<p><code>M423 R</code> to reset X-twist data to the configured defaults.</p>
<p><code>M423 X[index] Z[offset]</code> to set an offset value.</p>
<p><code>M423 A[start] I[spacing]</code> to set the X-start position and X-spacing distance.</p>
<h4 id="M424-Global-Z-Offset"><a href="#M424-Global-Z-Offset" class="headerlink" title="M424: Global Z Offset"></a>M424: Global Z Offset</h4><p>Set or report the global Z offset for the leveling mesh. The command <code>G29</code> will set this automatically to an average mesh value to allow for “leveling fade” with a biased mesh. In Marlin this feature requires the <code>GLOBAL_MESH_Z_OFFSET</code> option.</p>
<p>Parameters</p>
<p><code>Z</code> New global offset value to apply.</p>
<p>Usage</p>
<p><code>M424</code> to report the current global mesh Z offset.</p>
<p><code>M424 Z[offset]</code> to set the global mesh Z offset.</p>
<h4 id="M425-Backlash-Correction"><a href="#M425-Backlash-Correction" class="headerlink" title="M425: Backlash Correction"></a>M425: Backlash Correction</h4><p>Parameters</p>
<p><code>Fnnn</code> Enable&#x2F;disable&#x2F;fade-out backlash correction (0.0 &#x3D; none to 1.0 &#x3D; 100%)</p>
<p><code>Snnn</code> Distance over which backlash correction is spread<sup>1</sup> (mm)</p>
<p><code>Xnnn</code> Set the backlash distance on X (mm; 0 to disable)</p>
<p><code>Ynnn</code> Set the backlash distance on Y (mm; 0 to disable)</p>
<p><code>Znnn</code> Set the backlash distance on Z (mm; 0 to disable)</p>
<p><code>X</code> Use measured value for backlash on X (if available)</p>
<p><code>Y</code> Use measured value for backlash on Y (if available)</p>
<p><code>Z</code> Use measured value for backlash on Z (if available)</p>
<p>Examples (Marlin)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M425                ; Report current state</span><br><span class="line">M425 Z              ; Use measured value of backlash on Z</span><br><span class="line">M425 F1 S3          ; Full backlash compensation while smoothing over 3mm.</span><br><span class="line">M425 F0.5 S0.0      ; Compensate for 50% of the backlash with no smoothing</span><br><span class="line">M425 X0.1 Y0.2 Z0.3 ; Set backlash to specific values for all axis</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p><sup>1</sup> In Marlin, backlash compensation works by adding extra steps to one or more segments after a motor direction reversal. With smoothing off, this can cause blemishes on the print. Enabling smoothing will cause those extra steps to be spread over multiple segments, minimizing artifacts.</p>
<h4 id="M450-Report-Printer-Mode"><a href="#M450-Report-Printer-Mode" class="headerlink" title="M450: Report Printer Mode"></a>M450: Report Printer Mode</h4><p>Usage</p>
<p><code>M450</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M450</span><br><span class="line">&gt; PrinterMode:FFF</span><br></pre></td></tr></table></figure>

<p>Printers can be used for different task by exchanging the toolhead. Depending on the tool, a different behavior of some commands can be expected. This command reports the current working mode. Possible answers are:</p>
<p>PrinterMode:FFF</p>
<p>PrinterMode:Laser</p>
<p>PrinterMode:CNC</p>
<h4 id="M451-Select-FFF-Printer-Mode"><a href="#M451-Select-FFF-Printer-Mode" class="headerlink" title="M451: Select FFF Printer Mode"></a>M451: Select FFF Printer Mode</h4><p>Usage</p>
<p><code>M451</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M451</span><br><span class="line">&gt; PrinterMode:FFF</span><br></pre></td></tr></table></figure>

<p>Switches to FFF mode for filament printing.</p>
<h4 id="M452-Select-Laser-Printer-Mode"><a href="#M452-Select-Laser-Printer-Mode" class="headerlink" title="M452: Select Laser Printer Mode"></a>M452: Select Laser Printer Mode</h4><p>Usage</p>
<p><code>M452</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M452</span><br><span class="line">&gt; PrinterMode:Laser</span><br></pre></td></tr></table></figure>

<p>Switches to laser mode. This mode enables handling of a laser pin and makes sure that the laser is only activated during <code>G1</code> moves if laser was enabled or E is increasing. <code>G0</code> moves should never enable the laser. <code>M3</code>&#x2F;<code>M5</code> can be used to enable&#x2F;disable the laser for moves.</p>
<h4 id="M453-Select-CNC-Printer-Mode"><a href="#M453-Select-CNC-Printer-Mode" class="headerlink" title="M453: Select CNC Printer Mode"></a>M453: Select CNC Printer Mode</h4><p>Usage</p>
<p><code>M453</code></p>
<p>Parameters (RepRapFirmware only)</p>
<ul>
<li><strong>Snnn</strong> (optional) Spindle index, defaults to 0. Duet 2 supports 4 spindles max</li>
<li><strong>Pfff:rrr</strong> Logical pin numbers used to drive the spindle motor in clockwise and counterclockwise directions. Omit the “:rrr” part if the spindle turns clockwise only.</li>
<li><strong>I</strong>n Invert (I1) or don’t invert (I0, default) the output polarity</li>
<li><strong>Rnnn</strong> Spindle RPM that is achieved at full PWM. Used to convert the S parameter in M3 and M4 commands to a PWM value.</li>
<li><strong>Fnnn</strong> (optional) The PWM frequency to use</li>
<li><strong>Tnnn</strong> (optional) Assign spindle to a tool allowing better control in DWC</li>
</ul>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M453</span><br><span class="line">&gt; PrinterMode:CNC</span><br></pre></td></tr></table></figure>

<p>Switches to CNC mode. In this mode <code>M3</code>&#x2F;<code>M4</code>&#x2F;<code>M5</code> control the pins defined for the milling device.</p>
<p>Notes for RepRapFirmware: By default, no output is assigned to the spindle motor. Logical pin numbers for the P parameters are as defined for the M42 and M208 commands. If you wish to assign a heater or fan output to control the spindle motor as in the above example, you must first disable the corresponding heater (see M307) or fan (see M106).</p>
<h4 id="M460-Define-temperature-range-for-thermistor-controlled-fan"><a href="#M460-Define-temperature-range-for-thermistor-controlled-fan" class="headerlink" title="M460: Define temperature range for thermistor-controlled fan"></a>M460: Define temperature range for thermistor-controlled fan</h4><p>Usage</p>
<p><code>M460 X[minTemp] Y[maxTemp]</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M460 X50 Y60</span><br></pre></td></tr></table></figure>

<p>If the firmware has a thermistor controlled fan defined, you can set at which temperature the fan starts and from which temperature on it should run with maximum speed.</p>
<h4 id="M470-Create-Directory-on-SD-Card"><a href="#M470-Create-Directory-on-SD-Card" class="headerlink" title="M470: Create Directory on SD-Card"></a>M470: Create Directory on SD-Card</h4><p>Parameters</p>
<p><code>P&quot;name&quot;</code> Name of directory to create</p>
<p>Usage</p>
<p><code>M470 P&quot;directory/to/create&quot;</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M470 P&quot;/sys/config.d&quot;</span><br></pre></td></tr></table></figure>

<p>This will create a new directory on the SD-Card. If not otherwise specified the default root should be the first&#x2F;internal SD-Card.</p>
<h4 id="M471-Rename-File-Directory-on-SD-Card"><a href="#M471-Rename-File-Directory-on-SD-Card" class="headerlink" title="M471: Rename File&#x2F;Directory on SD-Card"></a>M471: Rename File&#x2F;Directory on SD-Card</h4><p>Parameters</p>
<p><code>S&quot;name&quot;</code> Name of existing file&#x2F;directory</p>
<p><code>T&quot;name&quot;</code> New name of file&#x2F;directory</p>
<p><code>Dnnn</code> Setting this to 1 will delete an existing file that matches the T parameter value</p>
<p>Usage</p>
<p><code>M471 S&quot;source/name&quot; T&quot;dest/name&quot; D1</code></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M471 S&quot;/sys/config-override.g&quot; T&quot;/sys/config-override.g.bak&quot;</span><br></pre></td></tr></table></figure>

<p>Rename or move a file or directory. Using the D parameter can delete a file with the target name. Renaming or moving across directories is possible though not from one SD-Card to another.</p>
<h4 id="M472-Delete-File-Directory-on-SD-Card"><a href="#M472-Delete-File-Directory-on-SD-Card" class="headerlink" title="M472: Delete File&#x2F;Directory on SD-Card"></a>M472: Delete File&#x2F;Directory on SD-Card</h4><p>Parameters</p>
<p><code>P&quot;name&quot;</code> Name of file&#x2F;directory to delete</p>
<p><code>Rn</code> (optional) R1 &#x3D; recursive delete</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M472 P&quot;/gcodes/old_files&quot; R1</span><br></pre></td></tr></table></figure>

<p>If the R1 parameter is provided and the P parameter is a directory, then files will be deleted recursively i.e. all contained files and directories will be deleted too. Otherwise, if “name” refers to a non-empty directory then deletion will fail.</p>
<p>See also M30.</p>
<h4 id="M486-Cancel-Object"><a href="#M486-Cancel-Object" class="headerlink" title="M486: Cancel Object"></a>M486: Cancel Object</h4><p>The <code>M486</code> G-code provides an interface to identify objects on the print bed and cancel them. Basic usage: Use <code>M486 T</code> to tell the firmware how many objects there are, so it can provide an LCD interface. (Otherwise the firmware counts them up in the first layer.) In every layer of your G-code, you must preface each object’s layer slice with <code>M486 S[index]</code> to indicate which object is being printed. The index should be zero-based. To cancel the first object, use <code>M486 P0</code>; to cancel the 5th object use <code>M486 P4</code>; and so on. The “current” object is canceled with <code>M486 C</code>.</p>
<p>G-codes associated with the canceled objects are no longer printed. Firmware supports this feature by ignoring G0-G3&#x2F;G5 moves in XYZ while updating F and keeping the E coordinate up-to-date without extruding.</p>
<p>Slicers should number purge towers and other global features with a negative index (or other flag) to distinguish them from regular print objects, since it is important to preserve color changes, purge towers, and brims.</p>
<p>Host software (such as OctoPrint) may be able to cancel individual objects through a plugin, and in this case they should not use M486 P to cancel objects (although doing so should cause no harm).</p>
<p>Usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">M486 T12               ; Total of 12 objects (otherwise the firmware must count)</span><br><span class="line">M486 S3                ; Indicate that the 4th object is starting now</span><br><span class="line">M486 S3 A&quot;cube copy 3&quot; ; Indicate that the 4th object is starting now and name it (RepRapFirmware)</span><br><span class="line">M486 S-1               ; Indicate a non-object, purge tower, or other global feature</span><br><span class="line">M486 P10               ; Cancel object with index 10 (the 11th object)</span><br><span class="line">M486 U2                ; Un-cancel object with index 2 (the 3rd object)</span><br><span class="line">M486 C                 ; Cancel the current object (use with care!)</span><br><span class="line">M486                   ; List the objects on the build plate (RepRapFirmware)</span><br></pre></td></tr></table></figure>

<p>M486 implementation in RepRapFirmware</p>
<p>If the GCode file being printed contains object label comments (e.g. using the “Label objects” option in PrusaSlicer) then it is not necessary to use M486 S commands to indicate which object is being printed. Objects on the build plate will be numbered from 0 in the order in which their labels first appear in the file.</p>
<p>If you do use M486 S commands in the GCode file instead of object label comments, then RepRapFirmware provides an optional A parameter to the M486 S command to allow objects to be named. The name of each object need only be specified once.</p>
<p>M486 without parameters lists the names and approximate locations of known objects on the build plate. For the benefit of user interfaces, this information may also be retrieved from the object model using the M409 command or using the rr_model HTTP API.</p>
<h4 id="M493-Fixed-Time-Motion-Control"><a href="#M493-Fixed-Time-Motion-Control" class="headerlink" title="M493: Fixed-Time Motion Control"></a>M493: Fixed-Time Motion Control</h4><p>Use <code>M493</code> to enable&#x2F;disable and set parameters for Fixed-Time Motion Control (by Ulendo). Requires the <code>FT_MOTION</code> feature to be enabled. Fixed-Time Motion Control supersedes normal motion control when enabled, and can only be applied to Cartesian and Core motion systems. This is likely to change in future versions. This motion system implements its own Linear (Pressure) Advance and Input Shaping, but does not include proprietary Fast B-Spline (FBS) acceleration. Due to its overhead and memory requirements (around 11 kilobytes), it requires a fast board with plenty of RAM.</p>
<p>Parameters</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">S&lt;mode&gt; Set the motion / shaping mode. Shaping requires an X axis, at the minimum.</span><br><span class="line">   0: NORMAL</span><br><span class="line">   1: FIXED-TIME</span><br><span class="line">  10: ZV</span><br><span class="line">  11: ZVD</span><br><span class="line">  12: EI</span><br><span class="line">  13: 2HEI</span><br><span class="line">  14: 3HEI</span><br><span class="line">  15: MZV</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">P&lt;bool&gt; Enable (1) or Disable (0) Linear Advance pressure control</span><br><span class="line">K&lt;gain&gt; Set Linear Advance gain</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D&lt;mode&gt; Set Dynamic Frequency mode</span><br><span class="line">   0: DISABLED</span><br><span class="line">   1: Z-based (Requires a Z axis)</span><br><span class="line">   2: Mass-based (Requires X and E axes)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A&lt;Hz&gt; Set static/base frequency for the X axis</span><br><span class="line">F&lt;Hz&gt; Set frequency scaling for the X axis</span><br><span class="line">B&lt;Hz&gt; Set static/base frequency for the Y axis</span><br><span class="line">H&lt;Hz&gt; Set frequency scaling for the Y axis</span><br></pre></td></tr></table></figure>

<h4 id="M500-Store-parameters-in-non-volatile-storage"><a href="#M500-Store-parameters-in-non-volatile-storage" class="headerlink" title="M500: Store parameters in non-volatile storage"></a>M500: Store parameters in non-volatile storage</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M500</span><br></pre></td></tr></table></figure>

<p>Save current parameters to EEPROM, SD card, Flash memory or other non-volatile storage.</p>
<p>In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Redeem" title="Redeem">Redeem</a> any parameters set through G&#x2F;M-codes which is different than what is read from the config files, are stored back to the local config. For instance setting stepper current and microstepping through <code>M906</code> and <code>M907</code> followed by <code>M500</code> will update &#x2F;etc&#x2F;redeem&#x2F;local.cfg.</p>
<p>In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Druid_Firmware" title="Druid Firmware">Druid Firmware</a>, because of the small size for parameter storage (512 bytes), a 128K flash memory sector is used as permanent storage. The sector can be partially written 256 times (512 bytes per backup) before requiring a complete sector wipe, to restart the same process again. (That was 1 write cycle). The flash memory minimum write cycles guaranteed for the STM32F407 MCU by ST Microelectronics are 10000, yielding a total of 2.56 million times, parameters can be saved.</p>
<p>Also with <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Druid_Firmware" title="Druid Firmware">Druid Firmware</a>, you no longer have to worry about saving your newly modified settings. Druid firmware save them in a temporary file as you make them. At every Boot, it loads the settings from the FLASH memory block, and also read the temp file and apply the previously modified settings to the RAM, seamlessly. When the size of the temporary file is above the limit set by the users, or when using <code>M500</code>, Druid Firmware merge theses changes and write all settings to the next 512 byte block in the flash, and delete the temporary file.</p>
<p>In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Druid_Firmware" title="Druid Firmware">Druid Firmware</a>, users will only have to use <code>M500</code>, to immediately force the merging of the temporary file with the current settings, in which, all changed parameters are saved, before the file limit size is reached (as explained in previous paragraph)</p>
<h4 id="M501-Read-parameters-from-EEPROM"><a href="#M501-Read-parameters-from-EEPROM" class="headerlink" title="M501: Read parameters from EEPROM"></a>M501: Read parameters from EEPROM</h4><p>Parameters</p>
<p><code>Snnn</code> Enable auto-save (only RepRapFirmware)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M501</span><br></pre></td></tr></table></figure>

<p>Set the active parameters to those stored in the EEPROM, SD card or other non-volatile storage. This is useful to revert parameters after experimenting with them.</p>
<p>RepRapFirmware versions prior to 1.17 allows “S1” to be passed, which forces parameters to be automatically saved to EEPROM when they are changed.</p>
<p>In RepRapFirmware 1.17 and later, the parameters are saved in file sys&#x2F;config-override.g on the SD card.</p>
<h4 id="M502-Restore-Default-Settings"><a href="#M502-Restore-Default-Settings" class="headerlink" title="M502: Restore Default Settings"></a>M502: Restore Default Settings</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M502</span><br></pre></td></tr></table></figure>

<p>This command resets all tunable parameters to their default values, as set in the firmware’s configuration files. This doesn’t reset any parameters stored in the EEPROM, so it must be followed with <code>M500</code> to reboot with default settings.</p>
<h4 id="M503-Report-Current-Settings"><a href="#M503-Report-Current-Settings" class="headerlink" title="M503: Report Current Settings"></a>M503: Report Current Settings</h4><p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M503 ; Output current settings</span><br><span class="line">M503 S0 ; Settings as G-code only (Marlin 1.1)</span><br></pre></td></tr></table></figure>

<p>This command asks the firmware to reply with the current print settings as set in memory. Settings will differ from EEPROM contents if changed since the last load &#x2F; save. The reply output includes the G-Code commands to produce each setting. For example, Steps-Per-Unit values are displayed as an <code>M92</code> command.</p>
<p>RepRapFirmware outputs the content of the configuration file, but note that it may be truncated if it is too long.</p>
<h4 id="M504-Validate-EEPROM"><a href="#M504-Validate-EEPROM" class="headerlink" title="M504: Validate EEPROM"></a>M504: Validate EEPROM</h4><p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M504 ; Check EEPROM</span><br></pre></td></tr></table></figure>

<p>This command checks the contents of EEPROM for correct version, size, and checksum and reports the result.</p>
<h4 id="M505-Firmware-dependent"><a href="#M505-Firmware-dependent" class="headerlink" title="M505: Firmware dependent"></a>M505: Firmware dependent</h4><h5 id="M505-Clear-EEPROM-and-RESET-Printer"><a href="#M505-Clear-EEPROM-and-RESET-Printer" class="headerlink" title="M505: Clear EEPROM and RESET Printer"></a>M505: Clear EEPROM and RESET Printer</h5><p>This command erase all EEPROM and reset the board.</p>
<h5 id="M505-Set-configuration-file-folder"><a href="#M505-Set-configuration-file-folder" class="headerlink" title="M505: Set configuration file folder"></a>M505: Set configuration file folder</h5><p>Parameters</p>
<p><strong>P”name”</strong> ; name of folder, default path is <em>&#x2F;sys&#x2F;</em> if it is a relative path</p>
<p>Example</p>
<p><strong>M505 P”experimental”</strong> ; change config file path from <em>&#x2F;sys&#x2F;</em> to <em>&#x2F;sys&#x2F;experimental&#x2F;</em></p>
<p>Following this command, files that would normally be fetched from &#x2F;sys&#x2F; (for example, homing files and system macro files in RepRapFirmware) are fetched from the specified folder instead. Any such files that are already being executed will continue to run.</p>
<p>This command can be used to allow multiple configurations to be maintained easily. In RepRapFirmware the file <em>&#x2F;sys&#x2F;config&#x2F;g</em> can contain just these two lines:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M505 P&quot;config1&quot;</span><br><span class="line">M98 P&quot;config.g&quot;</span><br></pre></td></tr></table></figure>

<p>The first line changes the config file folder to <em>&#x2F;sys&#x2F;config1</em> and the second one executes file <em>config.g</em> in that folder. To select an alternative configuration, only the first line needs to be edited.</p>
<h5 id="M505-Set-a-named-EEPROM-value"><a href="#M505-Set-a-named-EEPROM-value" class="headerlink" title="M505: Set a named EEPROM value"></a>M505: Set a named EEPROM value</h5><p>Use <code>M505 varname value</code> to directly set and store a named variable and value to EEPROM. The variable name can be up to 31 characters in length and the value can be up to 63 characters. Be careful with this G-code because a larger name or value can cause some versions of Buddy firmware to crash.</p>
<h4 id="M509-Force-language-selection"><a href="#M509-Force-language-selection" class="headerlink" title="M509: Force language selection"></a>M509: Force language selection</h4><p>Resets the language to English. Only on Original Prusa i3 MK2.5&#x2F;s and MK3&#x2F;s with multiple languages.</p>
<h4 id="M510-Lock-Machine"><a href="#M510-Lock-Machine" class="headerlink" title="M510: Lock Machine"></a>M510: Lock Machine</h4><p>Lock the machine. When the machine is locked a passcode is required to unlock it. Use <code>M511 P</code> with your passcode to unlock the machine. In Marlin this feature is enabled with the <code>PASSWORD_FEATURE</code> option.</p>
<p>In Druid, this feature is always enabled.</p>
<h4 id="M511-Unlock-Machine-with-Passcode"><a href="#M511-Unlock-Machine-with-Passcode" class="headerlink" title="M511: Unlock Machine with Passcode"></a>M511: Unlock Machine with Passcode</h4><p>Check the given passcode and unlock the machine if it is correct. Otherwise, delay for a period of time before allowing another attempt. In Marlin this feature is enabled with the <code>PASSWORD_FEATURE</code> option.</p>
<p>Parameters</p>
<p><strong>P”passcode”</strong> ; a numeric passcode to try</p>
<p>Notes</p>
<p>In Druid, this feature is always enabled.</p>
<p>M511 “12PWS5pb” Between double quote.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Fixed length = 8 Char.</span><br><span class="line">Valid Characters (a-z A-Z 0-9)</span><br><span class="line">Always case-sensitive, regardless of Gcode Parser Case sensitivity option (M544)</span><br></pre></td></tr></table></figure>

<h4 id="M512-Set-Passcode"><a href="#M512-Set-Passcode" class="headerlink" title="M512: Set Passcode"></a>M512: Set Passcode</h4><p>Check the given passcode (<code>P</code>) and if it is correct clear the passcode. If <code>S</code> is given, set a new passcode. In Marlin this feature is enabled with the <code>PASSWORD_CHANGE_GCODE</code> option.</p>
<p>Parameters</p>
<p><strong>P”oldpass”</strong> ; the current numeric passcode</p>
<p><strong>S”newpass”</strong> ; a new numeric passcode</p>
<p>Notes</p>
<p>In Druid, we use similar procedures to create, modify the password, but it is never saved, instead it is a one-way cryptographic hash generated from it, that is saved inside the MCU, to insure maximum security. Before setting a password, the user must make a backup of its PUID (a 96 bit serial number unique to every STMicroelectronics MCU). If the password is lost, the only solution is to enter the PUID, on our website <a target="_blank" rel="noopener" href="http://www.druid3d.com/">www.druid3d.com</a> in the members area. A one-way cryptographic hash will be generated from the provided PUID, and will be available as a text file and as a string. When this file is added to the external SD CARD. The Bootloader, that is looking for it at every boot, will find it, and will verify that it matches the one it will generate from the internal PUID. Verified in a few microseconds, both will be erased, from the RAM and the SD card, then it will remove the password, unlock the machine. This is the most secure way of protecting a device. Any other system is hackable in a few minutes. (See also M513, to remove password, with either current or “PW Removal HASH String” )</p>
<p>M512 “PASSWORD  ; set new password, if none already set.</p>
<p>M512 “curPW001&#x2F;NEWnew02” ; set new password, if current match.</p>
<p>(between double quote, separated by a slash ‘&#x2F;‘ or a space ‘ ‘ ) Fixed length &#x3D; 8 Char, Valid Characters (a-z A-Z 0-9), Always case-sensitive, regardless of Gcode Parser Case sensitivity option (M544)</p>
<h4 id="M513-Remove-Password"><a href="#M513-Remove-Password" class="headerlink" title="M513: Remove Password"></a>M513: Remove Password</h4><p>Example with Druid firmware</p>
<p><strong>M513 “currpass”</strong>  ; the current password (if known)</p>
<p><strong>M513 “0446759DBDC230122126F5AC”</strong> ; 24 char.”PW Removal HASH String”, generated from MCU PUID.</p>
<p>visit <a target="_blank" rel="noopener" href="http://www.druid3d.com/">www.druid3D.com</a> to generate your unique Password Removal HASH String.</p>
<h4 id="M524-Abort-SD-Printing"><a href="#M524-Abort-SD-Printing" class="headerlink" title="M524: Abort SD Printing"></a>M524: Abort SD Printing</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M524</span><br></pre></td></tr></table></figure>

<p>If an SD print is in progress, this command aborts the print, just as if you had selected “Stop print” from the LCD menu.</p>
<h4 id="M530-Enable-printing-mode"><a href="#M530-Enable-printing-mode" class="headerlink" title="M530: Enable printing mode"></a>M530: Enable printing mode</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M530 S1 L270</span><br></pre></td></tr></table></figure>

<p>This command tells the firmware that a print has started (<code>S1</code>) or ended (<code>S0</code>). The <code>L</code> parameter sets the number of layers. <code>L0</code> denotes unknown layer count. This enables the firmware to switch into a special print display mode to show print progress. Firmware should indicate the presence of this feature by responding to <code>M115</code> with an additional line:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cap:PROGRESS:1</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p><sup>1</sup>In MK4duo this command starts print counters for statistics. It also turns off a 30-minute timer for the heaters. If the timer reaches 30, turn off all the heaters.</p>
<h4 id="M531-Set-print-name"><a href="#M531-Set-print-name" class="headerlink" title="M531: Set print name"></a>M531: Set print name</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M531 Demo Model</span><br></pre></td></tr></table></figure>

<p>Sets the name of the currently printed object. Should follow <code>M530 S1</code> for correct display.</p>
<h4 id="M532-Set-print-progress"><a href="#M532-Set-print-progress" class="headerlink" title="M532: Set print progress"></a>M532: Set print progress</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M532 X23.7 L56</span><br></pre></td></tr></table></figure>

<p>Sets the print progress (X &#x3D; 0..100) and currently printed layer (L). Should be send every 0.1% progress change on every layer change.</p>
<h4 id="M540-Set-MAC-address"><a href="#M540-Set-MAC-address" class="headerlink" title="M540: Set MAC address"></a>M540: Set MAC address</h4><p>Parameters</p>
<p><code>Pnnn</code> The MAC address</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M540 P0xBE:0xEF:0xDE:0xAD:0xFE:0xED</span><br><span class="line">M540 PDE:AD:BE:EF:CA:FE</span><br></pre></td></tr></table></figure>

<p>Sets the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/MAC_address">MAC address</a> of the RepRap. This should be done before any other network commands. The MAC address is six one-byte hexadecimal numbers separated by colons. The 0x prefix is optional in later firmware revisions.</p>
<p>All devices running on the same network shall all have different MAC addresses. For your printers, changing the last digit is sufficient.</p>
<p>This command is only needed when using older electronics that doesn’t provide a unique MAC address, for example Duet 0.6 and Duet 0.8.5.</p>
<h4 id="M540-in-Marlin-Druid-MK4duo-Enable-Disable-“Stop-SD-Print-on-Endstop-Hit”"><a href="#M540-in-Marlin-Druid-MK4duo-Enable-Disable-“Stop-SD-Print-on-Endstop-Hit”" class="headerlink" title="M540 in Marlin&#x2F;Druid&#x2F;MK4duo: Enable&#x2F;Disable “Stop SD Print on Endstop Hit”"></a>M540 in Marlin&#x2F;Druid&#x2F;MK4duo: Enable&#x2F;Disable “Stop SD Print on Endstop Hit”</h4><p>Parameters</p>
<p><code>Snnn</code> state, S1&#x3D;enable, S0&#x3D;disable</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M540 S1</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="M544-Gcode-Parser-Options"><a href="#M544-Gcode-Parser-Options" class="headerlink" title="M544: Gcode Parser Options"></a>M544: Gcode Parser Options</h4><p>Parameters</p>
<p><strong>Snnn</strong> S1&#x3D;case insensitive, S0&#x3D;case sensitive</p>
<p><strong>S</strong> Report current case state.</p>
<p><strong>L</strong> List all supported Gcodes</p>
<p><strong>K</strong> List all Druid proprietary MMM commands (Media and Memory Management)</p>
<h4 id="M550-Set-Name"><a href="#M550-Set-Name" class="headerlink" title="M550: Set Name"></a>M550: Set Name</h4><p>Parameters</p>
<p><code>Pnnn</code> Machine name</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M550 PGodzilla</span><br></pre></td></tr></table></figure>

<p>Sets the name of the RepRap to (in this case) Godzilla. The name can be any string of printable characters except ‘;’, which still means start comment.</p>
<h4 id="M551-Set-Password"><a href="#M551-Set-Password" class="headerlink" title="M551: Set Password"></a>M551: Set Password</h4><p>Parameters</p>
<p><code>Pnnn</code> Password</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M551 Pmy-very-secret-word</span><br></pre></td></tr></table></figure>

<p>On machines that need a password to activate them, set that password. The code ‘P’ is not part of the password. Note that as this is sent in clear it does not (nor is it intended to) offer a very high level of security. But on machines that are (say) on a network, it prevents idle messing about by the unauthorised. The password can contain any printable characters except ‘;’, which still means start comment.</p>
<p>Note for RepRapFirmware: If the specified password differs from the default one (i.e. reprap), the user will be asked to enter it when a connection is established via HTTP or Telnet. For FTP, the password must always be passed explicitly.</p>
<h4 id="M552-Set-IP-address-enable-disable-network-interface"><a href="#M552-Set-IP-address-enable-disable-network-interface" class="headerlink" title="M552: Set IP address, enable&#x2F;disable network interface"></a>M552: Set IP address, enable&#x2F;disable network interface</h4><p>Parameters</p>
<p><code>Innn</code> (Optional) Number of the network interface to manage (defaults to 0)</p>
<p><code>Pnnn</code> IP address, 0.0.0.0 means acquire an IP address using DHCP</p>
<p><code>Snnn</code> (optional) -1 &#x3D; reset network interface, 0 &#x3D; disable networking, 1 &#x3D; enable networking as a client, 2 &#x3D; enable networking as an access point (WiFi-enabled electronics only)</p>
<p><code>Rnnn</code> (optional, RepRapFirmware 1.17 and earlier only) HTTP port, default 80</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M552 P192.168.1.14</span><br></pre></td></tr></table></figure>

<p>Sets the IP address of the machine to (in this case) 192.168.1.14. If the <code>S</code> parameter is not present then the enable&#x2F;disable state of the network interface is not changed.</p>
<p>In RepRapFirmware 1.18 and later the HTTP port address is set using the <code>M586</code> command, so the <code>R</code> parameter of this command is no longer supported.</p>
<p>M552 with no parameters reports the current network state and IP address.</p>
<h4 id="M553-Set-Netmask"><a href="#M553-Set-Netmask" class="headerlink" title="M553: Set Netmask"></a>M553: Set Netmask</h4><p>Parameters</p>
<p><code>Innn</code> (Optional) Number of the network interface to manage (defaults to 0)</p>
<p><code>Pnnn</code> Net mask</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M553 P255.255.255.0</span><br></pre></td></tr></table></figure>

<p>Sets the network mask of the RepRap machine to (in this case) 255.255.255.0. A restart may be required before the new network mask is used. If no ‘P’ field is specified, this echoes the existing network mask configured.</p>
<p>Recent RepRapFirmware versions allow the IP configuration to be changed without a restart.</p>
<h4 id="M554-Set-Gateway-and-or-DNS-server"><a href="#M554-Set-Gateway-and-or-DNS-server" class="headerlink" title="M554: Set Gateway and&#x2F;or DNS server"></a>M554: Set Gateway and&#x2F;or DNS server</h4><p>Parameters</p>
<p><code>Innn</code> (Optional) Number of the network interface to manage (defaults to 0)</p>
<p><code>Pnnn</code> Gateway</p>
<p><code>Snnn</code> (Optional) DNS server (only supported by DSF 3.3 with DuetPi system config plugin)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M554 P192.168.1.1</span><br></pre></td></tr></table></figure>

<p>Sets the Gateway IP address of the RepRap machine to (in this case) 192.168.1.1. A restart may be required before the new gateway IP address is used. If no ‘P’ field is specified, this echoes the existing Gateway IP address configured.</p>
<p>Recent RepRapFirmware versions allow the IP configuration to be changed without a restart.</p>
<h4 id="M555-Set-compatibility"><a href="#M555-Set-compatibility" class="headerlink" title="M555: Set compatibility"></a>M555: Set compatibility</h4><p>Parameters</p>
<p><code>Pnnn</code> Emulation type</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M555 P1</span><br></pre></td></tr></table></figure>

<p>For firmware that can do it, the firmware is set to a mode where its input and (especially) output behaves exactly like other established firmware. The value of the ‘P’ argument is:</p>
<table>
<thead>
<tr>
<th>P value</th>
<th>Firmware</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>Native (i.e. whatever the firmware actually is)</td>
</tr>
<tr>
<td>1</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/RepRapFirmware" title="RepRapFirmware">RepRapFirmware</a></td>
</tr>
<tr>
<td>2</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Marlin" title="Marlin">Marlin</a></td>
</tr>
<tr>
<td>3</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Teacup" title="Teacup">Teacup</a></td>
</tr>
<tr>
<td>4</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Sprinter" title="Sprinter">Sprinter</a></td>
</tr>
<tr>
<td>5</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Repetier" title="Repetier">Repetier</a></td>
</tr>
<tr>
<td>6</td>
<td><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Marlin" title="Marlin">Marlin</a> with changes for nanoDLP</td>
</tr>
</tbody></table>
<h4 id="M555-Set-Bounding-Box"><a href="#M555-Set-Bounding-Box" class="headerlink" title="M555: Set Bounding Box"></a>M555: Set Bounding Box</h4><p>Parameters</p>
<p><code>Xnnn</code> Minimum X coordinate</p>
<p><code>Ynnn</code> Minimum Y coordinate of model</p>
<p><code>Wnnn</code> X size of model (max - min X coordinate)</p>
<p><code>Hnnn</code> Y size of model (max - min Y coordinate)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M555 X10 Y20 W30 H40</span><br></pre></td></tr></table></figure>

<p>Tells the printer about the size of the model. The XL uses this information to save power for smaller models by only heating the area under it.</p>
<h4 id="M556-Axis-compensation"><a href="#M556-Axis-compensation" class="headerlink" title="M556: Axis compensation"></a>M556: Axis compensation</h4><p>Parameters</p>
<p><code>Snnn</code> Height of the measured distances</p>
<p><code>Xnnn</code> Deviation in X direction</p>
<p><code>Ynnn</code> Deviation in Y direction</p>
<p><code>Znnn</code> Deviation in Z direction</p>
<p><code>Pnnn</code> Apply XY compensation to Y axis instead of X (defaults to 0, requires RRF 3.2-b4 or newer)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M556 S100 X0.7 Y-0.2 Z0.6</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/File:CalibrationAngle.png"><img src="https://reprap.org/mediawiki/images/thumb/2/2d/CalibrationAngle.png/300px-CalibrationAngle.png"></a></p>
<p>Image denoting how to determine the S parameter for G-code M556</p>
<p>Though with care and adjustment a RepRap can be set up with its axes at right-angles to each other within the accuracy of the machine, who wants to bother with care and adjustment when the problem can be solved by software? This tells software the tangents of the angles between the axes of the machine obtained by printing then measuring a test part. The <code>S</code> parameter (100 here) is the length of a triangle along each axis in mm. The X, Y and Z figures are the number of millimeters of the short side of the triangle that represents how out of true a pair of axes is. The X figure is the error between X and Y, the Y figure is the error between Y and Z, and the Z figure is the error between X and Z. Positive values indicate that the angle between the axis pair is obtuse, negative acute.</p>
<h4 id="M557-Set-Z-probe-point-or-define-probing-grid"><a href="#M557-Set-Z-probe-point-or-define-probing-grid" class="headerlink" title="M557: Set Z probe point or define probing grid"></a>M557: Set Z probe point or define probing grid</h4><p>Parameters to define <code>G32</code> probe points (Cartesian&#x2F;CoreXY printers only, no longer supported in RepRapFirmware)</p>
<p><code>Pnnn</code> Probe point number</p>
<p><code>Xnnn</code> X coordinate</p>
<p><code>Ynnn</code> Y coordinate</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M557 P1 X30 Y40.5</span><br></pre></td></tr></table></figure>

<p>Parameters to define <code>G29</code> probe grid (all values in mm)</p>
<p><code>Xaaa:bbb</code> Minimum and maximum X coordinates to probe</p>
<p><code>Yaaa:bbb</code> Minimum and maximum Y coordinates to probe</p>
<p><code>Rnnn</code> Radius to probe</p>
<p><code>Snn</code> or <code>Sxx:yy</code> Probe point spacing</p>
<p><code>Pnn</code> or <code>Pxx:yy</code> Number of probe points in each direction (RepRapFirmware 2.02 and later) - use instead of specifying the spacing</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M557 X0:200 Y0:220 S20</span><br><span class="line">M557 R150 S15</span><br></pre></td></tr></table></figure>

<p>Set the points at which the bed will be probed to compensate for its plane being slightly out of horizontal.</p>
<p>The first form defines the points for for <code>G32</code> bed probing. The <code>P</code> value is the index of the point (indices start at 0) and the <code>X</code> and <code>Y</code> values are the position to move extruder 0 to to probe the bed. An implementation should allow a minimum of three points (P0, P1 and P2). This just records the point coordinates; it does not actually do the probing. See <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#G32:_Probe_Z_and_calculate_Z_plane" title="G-code">G32</a>. Defining the probe points in this way is no longer supported by RepRapFirmware, you should define them in a bed.g file instead.</p>
<p>The second form defines the grid for <code>G29</code> bed probing. For Cartesian printers, specify minimum and maximum <code>X</code> and <code>Y</code> values to probe and the probing interval. For Delta printers, specify the probing radius. If you define both, the probing area will be the intersection of the rectangular area and the circle. There is a firmware-dependent maximum number of probe points supported, which may be as low as 100.</p>
<h4 id="M558-Set-Z-probe-type"><a href="#M558-Set-Z-probe-type" class="headerlink" title="M558: Set Z probe type"></a>M558: Set Z probe type</h4><p>Parameters</p>
<p><code>Knn</code> Z probe number (optional, default 0)</p>
<p><code>Pnnn</code> Z probe type</p>
<p><code>Fnnn</code> Feed rate (i.e. probing speed, mm&#x2F;min)</p>
<p><code>Hnnn</code> Dive height (mm)</p>
<p><code>Innn</code> Invert (I1) or do not invert (I0) the Z probe reading (RepRapFirmware 1.16 and later)</p>
<p><code>Rnnn</code> Z probe recovery time after triggering, default zero (seconds) (RepRapFirmware 1.17 and later)<sup>1</sup></p>
<p><code>Tnnn</code> Travel speed to and between probe points (mm&#x2F;min)</p>
<p><code>Annn</code> Maximum number of times to probe each point, default 1 (RepRapFirmware 1.21 and later)</p>
<p><code>Snnn</code> Tolerance when probing multiple times, default 0.03 (RepRapFirmware 1.21 and later)</p>
<p><code>Bn</code> B1 turns off all heaters during probing moves and during the probe recovery time (RepRapFirmware 1.21 and later)</p>
<p>Obsolete parameters</p>
<p><code>Xnnn</code> If nonzero, use probe for homing X axis (RepRapFirmware 1.19 and earlier only)</p>
<p><code>Ynnn</code> If nonzero, use probe for homing Y axis (RepRapFirmware 1.19 and earlier only)</p>
<p><code>Znnn</code> If nonzero, use probe for homing Z axis (RepRapFirmware 1.19 and earlier only)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M558 P1 F500 T5000 H3</span><br></pre></td></tr></table></figure>

<p>A Z probe may be a switch, an IR proximity sensor, or some other device. This selects which to use:</p>
<p>P0 indicates that no Z probe is present</p>
<p>P1 indicates an unmodulated IR probe, or any other probe type that emulates an unmodulated IR probe (probe output is an analog signal that rises with decreasing nozzle height above the bed). If there is a control signal to the probe, it is driven high when the probe type is P1</p>
<p>P2 specifies a modulated IR probe, where the modulation is commanded directly by the main board firmware using the control signal to the probe</p>
<p>P3 selects an alternative Z probe similar to P1 but the control signal to the probe low</p>
<p>P4 selects a switch for bed probing (on the Duet, this must be connected to the E0 endstop pins)</p>
<p>P5 (from RepRapFirmware 1.14) selects a switch or a digital output device to the In pin of the Z-probe connector</p>
<p>P6 is as P4 but the switch is connected to and alternative connector (on the Duet series, the E1 endstop connector)</p>
<p>P7 is as P4 but the switch is connected to and alternative connector (on the Duet series, the Z endstop connector)</p>
<p>P8 is as P5 but the signal is unfiltered for faster response</p>
<p>P9 is as P5 but the probe is deployed and retracted at every probe point. This is intended for BLTouch.</p>
<p>P10 means use Z motor stall detection as the Z probe trigger.</p>
<p>P11 means a scanning Z probe with an analog output (supported from RRF 3.5.0-beta.4). Such probes must be calibrated before use (see M558.1).</p>
<p>Related codes: G29, G30, G31, G32, M401, M402, M558.1, M558.2.</p>
<h4 id="M558-1-Calibrate-height-vs-reading-for-analog-Z-probe"><a href="#M558-1-Calibrate-height-vs-reading-for-analog-Z-probe" class="headerlink" title="M558.1: Calibrate height vs. reading for analog Z probe"></a>M558.1: Calibrate height vs. reading for analog Z probe</h4><p>Parameters</p>
<p><code>Knn</code> Z probe number (optional, default 0)</p>
<p><code>Sn.n</code> Height to scan above and below the trigger height, in mm</p>
<p><code>Ann.n</code> (optional) Linear coefficient of the output, in mm per count</p>
<p><code>Bnn.n</code> (optional, ignored unless A parameter is also present, default 0.0) Quadratic coefficient of the output, in mm^2 per count</p>
<p><code>Cnn.n</code> (optional, ignored unless A parameter is also present, default 0.0) Cubic coefficient of the output, in mm^3 per count</p>
<p>If the A parameter is present then the S parameter is ignored and the equation to calculate the actual height of the Z probe is set to this:</p>
<p><code> height = trigger_height + A * (probe_reading - probe_threshold) + B * (probe_reading - probe_threshold)^2 + C * (probe_reading - probe_threshold)^3 </code></p>
<p>where trigger_height and probe_threshold are as set by G31.</p>
<p>If the A parameter is not present but the S parameter is present then the probe is raised or lowered to (trigger_height + S_parameter) at the current XY position, then readings are taken as the probe is gradually lowered to (trigger_height - S_parameter). The readings are used to compute, store and report new values of A, B, C and the trigger threshold.</p>
<p>If neither the A nor the S parameter is present, the current A, B and C values are reported.</p>
<h4 id="M558-2-Set-report-or-calibrate-drive-current-for-analog-Z-probe"><a href="#M558-2-Set-report-or-calibrate-drive-current-for-analog-Z-probe" class="headerlink" title="M558.2: Set, report or calibrate drive current for analog Z probe"></a>M558.2: Set, report or calibrate drive current for analog Z probe</h4><p>Parameters</p>
<p><code>Knn</code> Z probe number (optional, default 0)</p>
<p><code>Sn.n</code> Drive level to set, or -1 to determine automatically. For LDC1612-based probes, when setting the current this should be in the range 0 to 31.</p>
<p>This command is used to control the drive current of scanning Z probes that use the LDC1612 chip. If the drive current is set too low, the sensor will not work when it is close to the bed. If the drive current is set too high, it will not work when the sensor is distant from the bed. Use M122 B# (where # is the CAN address of the board that carries the sensor) to determine whether the sensor is working normally.</p>
<p>When using this command with S-1 to determine the optimum drive current automatically, the sensor should first be placed at the lower distance limit (closest distance from the metal bed surface) of the intended operating range.</p>
<p>If M558 is used with no S parameter then the current drive level is reported.</p>
<p>After using M558.2 to change the drive level, M558.1 should be used to recalibrate the sensor.</p>
<h4 id="M558-3-Set-touch-mode-parameters-for-analog-Z-probe"><a href="#M558-3-Set-touch-mode-parameters-for-analog-Z-probe" class="headerlink" title="M558.3: Set touch mode parameters for analog Z probe"></a>M558.3: Set touch mode parameters for analog Z probe</h4><p>Parameters (provisional)</p>
<p><code>Knn</code> Z probe number</p>
<p><code>Sn</code> Mode to use: 0 &#x3D; standard mode, 1 &#x3D; touch mode</p>
<p><code>Fnnn</code> Feed rate to use (mm&#x2F;min) in touch mode</p>
<p><code>Hn.nn</code> Nozzle height (mm) to be assumed when touch is detected, normally negative</p>
<p><code>Vn.nn</code> Sensitivity to touch, between 0 (not at all sensitive) and 1.0 (very sensitive)</p>
<p>Additional sensitivity parameters may be added in future to provide better control of touch recognition.</p>
<p>All parameters are optional. If the K parameter is not provided then probe 0 is assumed. If other parameters are not provided then their values remain unchanged. If no parameters (except possibly K) are provided then the existing values are reported.</p>
<p>In standard mode the output of an analog Z probe is compared with the threshold as the probing move progresses. When the probe output reaches the threshold, probing stops and the Z height is assumed to be equal to the trigger height. In RepRapFirmware both the threshold and trigger height are set using the G31 command.</p>
<p>In touch mode the output of the probe is monitored as the probing move progresses. When the rate of change reduces sharply (the exact details depending on the sensitivity parameters) it is assumed hat the nozzle has contacted the bed. The Z height is assumed to be the value set using the H parameter.</p>
<p>When an analog Z probe is created using M558, the mode is set to standard mode, the feed rate in touch mode (M558.3 F parameter) is set to the feed rate in standard mode (first or only value of the M558 F parameter) and the touch mode nozzle height and sensitivity assume default values. Fast-then-slow probing is not available in touch mode.</p>
<h4 id="M559-Upload-configuration-file"><a href="#M559-Upload-configuration-file" class="headerlink" title="M559: Upload configuration file"></a>M559: Upload configuration file</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M559</span><br></pre></td></tr></table></figure>

<p>If the RepRap supports it, this uploads a file that is run on re-boot to configure the machine. This file usually is a special G Code file. After sending <code>M559</code>, the file should be sent, ending with an <code>M29</code> (q.v.).</p>
<h4 id="M560-Upload-web-page-file"><a href="#M560-Upload-web-page-file" class="headerlink" title="M560: Upload web page file"></a>M560: Upload web page file</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M560</span><br></pre></td></tr></table></figure>

<p>For RepRaps that have web support and that can be driven by a web browser, this uploads the file that is the control page for the RepRap. After sending <code>M560</code> the file (usually an HTML file) should be sent, terminated by the string</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- **EoF** --&gt;</span><br></pre></td></tr></table></figure>

<p>. Clearly that string cannot exist in the body of the file, but can be put on the end to facilitate this process. This should not be too serious a restriction…</p>
<h4 id="M561-Set-Identity-Transform"><a href="#M561-Set-Identity-Transform" class="headerlink" title="M561: Set Identity Transform"></a>M561: Set Identity Transform</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M561</span><br></pre></td></tr></table></figure>

<p>This cancels any bed-plane fitting as the result of probing (or anything else) and returns the machine to moving in the user’s coordinate system.</p>
<h4 id="M562-Reset-temperature-fault"><a href="#M562-Reset-temperature-fault" class="headerlink" title="M562: Reset temperature fault"></a>M562: Reset temperature fault</h4><p>Parameters</p>
<p><code>Pnnn</code> Heater number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M562 P2</span><br></pre></td></tr></table></figure>

<p>Reset a temperature fault on heater&#x2F;sensor 2. If the RepRap has switched off and locked a heater because it has detected a fault, this will reset the fault condition and allow you to use the heater again. Obviously to be used with caution. If the fault persists it will lock out again after you have issued this command. P0 is the bed; P1 the first extruder, and so on.</p>
<p>Later versions of RepRapFirmware support M562 without the P parameter, which will reset all heater faults.</p>
<h4 id="M563-Define-or-remove-a-tool"><a href="#M563-Define-or-remove-a-tool" class="headerlink" title="M563: Define or remove a tool"></a>M563: Define or remove a tool</h4><p>Parameters</p>
<p><code>Pnnn</code> Tool number</p>
<p><code>S&quot;name&quot;</code> Tool name (optional)</p>
<p><code>Dnnn</code> Extruder drive(s)</p>
<p><code>Hnnn</code> Heater(s)</p>
<p><code>Fnnn</code> Fan(s) to map the print cooling fan to (RepRapFirmware 1.16 and later)</p>
<p><code>Xnnn</code> Axis or axes to map X movement to (RepRapFirmware 1.16 and later)</p>
<p><code>Ynnn</code> Axis or axes to map Y movement to</p>
<p><code>Lnnn</code> Drive to use for filament mapping. By default RRF will use the first and only extruder drive if this parameter is not specified (supported by RRF &gt;&#x3D; 2.02)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M563 P0 D0:2:3 H1:3                 ; create a tool using extruder drives 0, 2 and 3 and heaters 1 and 3</span><br><span class="line">M563 P1 D1 H2 X3                    ; create a tool using extruder drive 1 and heater 2 with X movement mapped to the U axis</span><br><span class="line">M563 P2 D0:1 H1:2 X0:3 F0:2         ; create a tool using extruder drives 0 and 1, heaters 1 and 2,</span><br><span class="line">                                    ; with X movement mapped to both X and U axes and fan 0 mapped to fan 0 and fan 2</span><br><span class="line">M563 P3 D0 H1 S&quot;Chocolate extruder&quot; ; create a named tool using extruder drive 0 and heater 1</span><br></pre></td></tr></table></figure>

<p>Tools are usually (though not necessarily) extruders. The ‘P’ field specifies the tool number. Tool numbers can have any positive integer value and 0. The ‘D’ field specifies the drive(s) used by the tool - in the first example drives 0, 2 and 3. Drive 0 is the first drive in the machine after the movement drives (usually X, Y and Z). If there is no ‘D’ field the tool has no drives. The ‘H’ field specifies the tool’s heaters - in the first example heaters 1 and 3. Heater 0 is usually the hot bed (if any) so the first extruder heater is usually 1. If there is no H field the tool has no heaters.</p>
<p>Tools are driven using multiple values in the ‘E’ field of <code>G1</code> commands, each controlling the corresponding drive in the ‘D’ field above, as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G1 X90.6 Y13.8 E2.24:2.24:15.89</span><br><span class="line">G1 X70.6 E0:0:42.4</span><br></pre></td></tr></table></figure>

<p>The first line moves straight to the point (90.6, 13.8) extruding a total of 2.24mm of filament from both drives 0 and 2 and 15.98mm of filament from drive 3. The second line moves back 20mm in X extruding 42.4mm of filament from drive 3.</p>
<p>Alternatively, if the slicer does not support generating <code>G1</code> commands with multiple values for the extrusion amount, the <code>M567</code> command can be used to define a tool mix ratio.</p>
<p>Normally an <code>M563</code> command is immediately followed by a <code>G10</code> command to set the tool’s offsets and temperatures.</p>
<p>It is permissible for different tools to share some (or all) of their drives and heaters. So, for example, you can define two tools with identical hardware, but that just operate at different temperatures.</p>
<p>The X mapping option is used to create tools on machines with multiple independent X carriages. The additional carriages are set up as axes U, V etc. (see <code>M584</code>) and the X mapping option in <code>M563</code> defines which carriage or carriages are used.</p>
<p>If you use the <code>M563</code> command with a <code>P</code> value for a tool that has already been defined, that tool is redefined using the new values you provide.</p>
<p>RepRapFirmware supports an additional form of the <code>M563</code> command. The command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M563 S1</span><br></pre></td></tr></table></figure>

<p>means add 1 (the value of the <code>S</code> parameter) to all tool numbers found in the remainder of the current input stream (e.g. the current file if the command is read from a file on the SD card), or until a new <code>M563</code> command of this form is executed. The purpose of this is to provide compatibility between systems in which tool numbers start at 1, and programs such as slic3r that assume tools are numbered from zero.</p>
<p>Recent versions of RepRapFirmware allow the deletion of existing tools if <code>M563</code> is called in this way:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M563 P1 D-1 H-1</span><br></pre></td></tr></table></figure>

<h4 id="M564-Limit-axes"><a href="#M564-Limit-axes" class="headerlink" title="M564: Limit axes"></a>M564: Limit axes</h4><p>Parameters</p>
<p><code>Hnnn</code> H1 &#x3D; forbid movement of axes that have not been homed, H0 &#x3D; allow movement of axes that have not been homed (RepRapFirmware 1.21 and later)</p>
<p><code>Snnn</code> S1 &#x3D; limit movement within axis boundaries, S0 &#x3D; allow movement outside boundaries</p>
<p>Example</p>
<p>M564 S0 H0</p>
<p>Allow moves outside the print volume and before homing, or not. If the S parameter is 0, then you can send G codes to drive the RepRap outside its normal working volume, and it will attempt to do so. Likewise if the H parameter is 0 you can move the head or bed along axes that have not been homed. The default behaviour is S1 H1. On some types of printer (e.g. Delta and SCARA), movement before homing is prohibited regardless of the H parameter.</p>
<h4 id="M565-Set-Z-probe-offset"><a href="#M565-Set-Z-probe-offset" class="headerlink" title="M565: Set Z probe offset"></a>M565: Set Z probe offset</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M565 X3 Y4.5 Z-2.37</span><br></pre></td></tr></table></figure>

<p>Set the offset from the extruder tip to the probe position. The <code>X</code>, <code>Y</code>, and <code>Z</code> values are the delta between the extruder and the actual trigger position of the probe. If the probe trigger point is below the extruder (typical) the Z offset will be negative. This just records the point offset; it does not actually do the probing. See <code>G32</code>.</p>
<h4 id="M566-Set-allowable-instantaneous-speed-change"><a href="#M566-Set-allowable-instantaneous-speed-change" class="headerlink" title="M566: Set allowable instantaneous speed change"></a>M566: Set allowable instantaneous speed change</h4><p>Parameters</p>
<p><code>Xnnn</code> Maximum instantaneous speed change of the X axis (mm&#x2F;min)</p>
<p><code>Ynnn</code> Maximum instantaneous speed change of the Y axis</p>
<p><code>Znnn</code> Maximum instantaneous speed change of the Z axis</p>
<p><code>Ennn</code> Maximum instantaneous speed change of the extruder drives</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M566 X20 Y20 Z2 E10</span><br></pre></td></tr></table></figure>

<p>Sets the maximum allowable speed change (sometimes called ‘jerk speed’) of each motor when changing direction.</p>
<p>The model files and gcode files used by repraps generally render circles and other curves shapes as a sequence of straight line segments. If the motors were not allowed any instantaneous speed change, they would have to come to a stop at the junction between each pair of line segments. By allowing a certain amount of instantaneous speed change, printing speed can be maintained when the angle between the two line segments is small enough.</p>
<p>If you set these <code>X</code> and <code>Y</code> values too low, then the printer will be slow at printing curves. If they are too high then the printer may be noisy when cornering and you may suffer ringing and other print artefacts, or even missed steps.</p>
<p>On very old versions of RepRapFirmware (prior to 1.09), these were also the minimum speeds of each axis.</p>
<h4 id="M567-Set-tool-mix-ratios"><a href="#M567-Set-tool-mix-ratios" class="headerlink" title="M567: Set tool mix ratios"></a>M567: Set tool mix ratios</h4><p>Parameters</p>
<p><code>Pnnn</code> Tool number</p>
<p><code>Ennn</code> Mix ratios</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M567 P2 E0.1:0.2:0.1:0.6</span><br></pre></td></tr></table></figure>

<p>This example sets the mix ratio for tool 2 (the <code>P</code> value). When mixing is then turned on (see <code>M568</code>), only single <code>E</code> values need to be sent on a <code>G1</code> command (any extra <code>E</code> values will be ignored, but are not illegal):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G1 X20 E1.3</span><br></pre></td></tr></table></figure>

<p>This will move to X&#x3D;20 extruding a total length of filament of 1.3mm. The first drive of tool 2 will extrude 0.1*1.3mm, the second 0.2*1.3mm and so on. The ratios don’t have to add up to 1.0 - the calculation done is as just described. But it is best if they do.</p>
<p>See also <code>M568</code>.</p>
<h4 id="M568-Tool-settings"><a href="#M568-Tool-settings" class="headerlink" title="M568: Tool settings"></a>M568: Tool settings</h4><p>Parameters</p>
<p><strong>Pnnn</strong> Tool number. If this parameter is not provided, the current tool is assumed.</p>
<p><strong>Rnnn</strong> Standby temperature(s)</p>
<p><strong>Snnn</strong> Active temperature(s)</p>
<p><strong>Fnnn</strong> Spindle RPM, always positive</p>
<p><strong>An</strong> Required heater state: 0 &#x3D; off, 1 &#x3D; standby temperature(s), 2 &#x3D; active temperature(s)</p>
<p>Examples</p>
<p>M568 P1 R140 S205 ; set standby and active temperatures for tool 1</p>
<p>M568 P0 F5200 ; set spindle RPM for tool 0</p>
<p>M568 P2 A1 ; set tool 2 heaters to their standby temperatures</p>
<p>RepRapFirmware will report the tool parameters if only the tool number is specified.</p>
<p>The R value is the standby temperature in °C that will be used for the tool, and the S value is its operating temperature. If you don’t want the tool to be at a different temperature when not in use, set both values the same.</p>
<p>Temperatures set with M568 do not wait for the heaters to reach temp before proceeding. In order to wait for the temp use a M116 command after the M568 to wait for temps to be reached.</p>
<h4 id="M568-Turn-off-on-tool-mix-ratios-obsolete-meaning-in-old-RepRapFirmware-versions"><a href="#M568-Turn-off-on-tool-mix-ratios-obsolete-meaning-in-old-RepRapFirmware-versions" class="headerlink" title="M568: Turn off&#x2F;on tool mix ratios (obsolete meaning in old RepRapFirmware versions)"></a>M568: Turn off&#x2F;on tool mix ratios (obsolete meaning in old RepRapFirmware versions)</h4><p>This command is obsolete. When using a tool defined as a mixing extruder, RepRapFirmware applies the mix ratio defined by M567 whenever only one E parameter is provided in G1 commands. When multiple colon-separated E values are provided in the G1 command, they will be used as the individual amounts to extrude.</p>
<h4 id="M569-Stepper-driver-control"><a href="#M569-Stepper-driver-control" class="headerlink" title="M569: Stepper driver control"></a>M569: Stepper driver control</h4><p>Parameters</p>
<p><code>Pnn</code> Motor driver number</p>
<p><code>Sn</code> Direction of movement of the motor(s) attached to this driver: 0 &#x3D; backwards, 1 &#x3D; forwards (default 1)</p>
<p><code>Rn</code> Driver enable polarity: 0 &#x3D; active low, 1 &#x3D; active high (default 0)</p>
<p><code>Tnn</code> Minimum driver step pulse width and interval in microseconds (RepRapFirmware 1.14 and later)</p>
<p><code>Taa:bb:cc:dd</code> Minimum driver step pulse width, step pulse interval, direction-to-step setup time and step-to-direction hold time, in microseconds (RepRapFirmware 1.21 and later)</p>
<p><code>Dnn</code> Stepper driver mode (RepRapFirmware 2.0 and later): 0&#x3D;constant off time, 1&#x3D;random off time, 2&#x3D;spread cycle, 3&#x3D;stealthChop, 4&#x3D;closed loop</p>
<p><code>Fnn</code> (firmware 2.02 and later) Off-time in the chopper control register, 1 to 15</p>
<p><code>Bnn</code> (firmware 2.02 and later) Blanking time (tbl) in the chopper control register, 0 to 3. See the TMC driver datasheet.</p>
<p><code>Yaa:bb</code> or <code>Yaa:bb:cc</code> (firmware 2.02 and later) Hysteresis start, end and decrement values in the chopper control register. See the TMC driver datasheet for the meaning.</p>
<p><code>Cnnn</code> Custom chopper control register value (RepRapFirmware 2.0 and later). <strong>Do not change this value without having a good understanding of the stepper driver driver chip!</strong></p>
<p><code>Hnn</code> (firmware 2.02 and later) t_high parameter for those stepper driver chips that support it (e.g. TMC2208, 2224). Send M569 P# (where # is the driver number) with no additional parameters to see how this translates into mm&#x2F;sec. See also the V parameter.</p>
<p><code>Vnnn</code> (firmware 2.02 and later) tpwmthrs parameter for those stepper driver chips that support it (e.g. TMC2208, 2224). This is the interval in clock cycles between 1&#x2F;256 microsteps below which the drivers will switch from stealthChop to to spreadCycle mode. Only applies when the driver is configured in stealthChop mode. Typical value are from 100 (high speed) to 4000 (low speed). Send M569 P# (where # is the driver number) with no additional parameters to see how this translates into axis speed in mm&#x2F;sec.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M569 P0 S0               ; reverse the direction of the motor attached to driver 0</span><br><span class="line">M569 P5 R1 T2.5:2.5:5:0  ; driver 5 requires an active high enable, 2.5us minimum step pulse, 2.5us minimum step interval, 5us DIR setup time and no hold time</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p>All parameters except P are optional. For any parameter that is not provided, the corresponding value will not be changed.</p>
<p>The T parameters are intended for use with external stepper drivers. Currently, RepRapFirmware only remembers the highest <code>T</code> parameters seen in any M569 command, and applies those values to all drivers for which any nonzero <code>T</code> parameters were specified.</p>
<p>The modes (D parameter) supported by various stepper driver chips are:</p>
<p>TMC2130, TMC2160, TMC5160: modes 0,1,2,3 (Duet 3 EXP1HCL board also supports mode 4)</p>
<p>TMC2660: modes 0,1,2</p>
<p>TMC2208&#x2F;2209&#x2F;2224: modes 2,3 (mode 3 is stealthChop2)</p>
<p>Some versions of RepRapFirmware prior to 1.14 also provided <code>X</code>, <code>Y</code>, <code>Z</code> and <code>E</code> parameters to allow the mapping from axes and extruders to stepper driver numbers to be changed. From 1.14 onward, this functionality is provided by M584 instead.</p>
<h4 id="M569-1-Stepper-driver-closed-loop-configuration"><a href="#M569-1-Stepper-driver-closed-loop-configuration" class="headerlink" title="M569.1: Stepper driver closed loop configuration"></a>M569.1: Stepper driver closed loop configuration</h4><p>Parameters</p>
<p><code>Pn</code> or <code>Pn.n</code> Motor driver number, or board address and driver number</p>
<p><code>Sn</code> Mode: 0&#x3D;open loop (default), 1&#x3D;closed loop (requires an encoder to be selected, see the T parameter)</p>
<p><code>Tn</code> Encoder type: 0&#x3D;none, 1&#x3D;linear quadrature encoder on axis, 2&#x3D;quadrature encoder on motor shaft, 3&#x3D;AS5047D encoder on motor shaft, 4&#x3D;TLI5012B encoder on motor shaft</p>
<p><code>En.n</code> Encoder counts per mm (linear encoder) or per rotation (rotary encoder). Only used if the encoder type is 1 or 2.</p>
<p><code>Rn.n</code> Proportional constant</p>
<p><code>In.n</code> Integral constant</p>
<p><code>Dn.n</code> Derivative constant</p>
<p><code>Hn</code> Minimum holding current as a percentage of the configured current when operating in closed loop mode</p>
<p>Supported by RepRapFirmware on boards using closed loop drivers. Switching between open loop and closed loop modes is done using M569.</p>
<h4 id="M569-2-Read-or-write-any-stepper-driver-register"><a href="#M569-2-Read-or-write-any-stepper-driver-register" class="headerlink" title="M569.2: Read or write any stepper driver register"></a>M569.2: Read or write any stepper driver register</h4><p>Parameters</p>
<p><code>Pnn</code> Motor driver number</p>
<p><code>Rnn</code> Register number, 0-127</p>
<p><code>Vnnnn</code> Value to write (optional)</p>
<p>Example</p>
<p><code>M569.2 P1 R0</code></p>
<p>If the V parameter is not provided, this command reads the specified register and returns the value of that register. If the V parameter is provided, that value is written to the specified register.</p>
<p>WARNING! Use of M569.2 to write stepper driver registers may result in damage to the stepper drivers, for example from excessive motor current or insufficient blanking time.</p>
<h4 id="M569-3-Read-Motor-Driver-Encoder"><a href="#M569-3-Read-Motor-Driver-Encoder" class="headerlink" title="M569.3: Read Motor Driver Encoder"></a>M569.3: Read Motor Driver Encoder</h4><p>This causes the RepRap machine to report its current motor encoder positions to the host in units of arc degrees (1&#x2F;360’ths of turns), relative to some reference position that you set with the <code>S</code> parameter.</p>
<p>Before the first call with the <code>S</code> parameter, the reference is unknown and arbitrary.</p>
<p>Parameters</p>
<p><code>Pn</code> or <code>Pn.n</code> Motor driver number, or board address and driver number. Several (remote) drivers may be specified, separated by colon. No more than number of visible axes, as specified by <code>M584 P</code> parameter, are allowed.</p>
<p><code>S</code> Sets an encoder reference point. Current and subsequent <code>M569.3 Pn.n</code> calls returns numbers that are relative to the <code>M569.3 Pn.n S</code> call.</p>
<p>If <code>P</code> is not supplied, an error is returned.</p>
<p>A maximum of four CAN-connected drivers can be reached with <code>M569.3</code> counting from machine boot. CAN addresses that fail to respond don’t count towards this maximum.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3</span><br></pre></td></tr></table></figure>

<p>Error: M569: missing parameter ‘P’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3 P54.0</span><br></pre></td></tr></table></figure>

<p>Error: M569.3: Message not received</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3 P40.0:41.0:42.0:43.0</span><br></pre></td></tr></table></figure>

<p>[-155.28, -4089.60, 6842.04, 0.00, ],</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3 P43.0:41.0:42.0:40.0</span><br></pre></td></tr></table></figure>

<p>[0.00, -4089.60, 6842.04, -155.28, ],</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3 P40.0:41.0:42.0:43.0 S</span><br></pre></td></tr></table></figure>

<p>[0.00, 0.00, 0.00, 0.00, ],</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.3 P49.0</span><br></pre></td></tr></table></figure>

<p>Error: M569.3: Max CAN addresses we can reference is 4. Can’t reference board 49.</p>
<p>Notes</p>
<p><sup>1</sup> Planned for RepRapFirmware 3.4.</p>
<h4 id="M569-4-Set-Motor-Driver-Torque-Mode"><a href="#M569-4-Set-Motor-Driver-Torque-Mode" class="headerlink" title="M569.4: Set Motor Driver Torque Mode"></a>M569.4: Set Motor Driver Torque Mode</h4><p>Tell one or more motor drivers to apply a specified torque regardless of position.</p>
<p>Parameters</p>
<p><code>Pn</code> or <code>Pn.n</code> Motor driver number, or board address and driver number. Can also be a colon separated list of driver numbers.</p>
<p><code>Tn</code> Where n is the mode&#x2F;torque to apply in units of Nm. Newer Hangprinters might use units of N.</p>
<p>If <code>P</code> or <code>T</code> parameter is missing, then no action is taken. The driver is put back into position mode by requesting a torque smaller than 0.0001 Nm.</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.4</span><br></pre></td></tr></table></figure>

<p>Error: M569: missing parameter ‘P’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.4 P40.0:41.0</span><br></pre></td></tr></table></figure>

<p>Error: M569: missing parameter ‘T’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.4 P40.0 T0.001</span><br></pre></td></tr></table></figure>

<p>0.001000 Nm,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M569.4 P40.0:41.0 T0</span><br></pre></td></tr></table></figure>

<p>pos_mode, pos_mode,</p>
<p>Notes</p>
<p>Hangprinter’s “torque mode” is implemented as a ReprapFirmware macro that depends on M569.4.</p>
<p>Practical torques for tightening lines in daily use tend to lie between 0.1 Nm and 0.001 Nm for a Hangprinter.</p>
<p><sup>1</sup> Planned for RepRapFirmware 3.4.</p>
<h4 id="M569-5-Collect-Data-from-Closed-loop-Driver"><a href="#M569-5-Collect-Data-from-Closed-loop-Driver" class="headerlink" title="M569.5: Collect Data from Closed-loop Driver"></a>M569.5: Collect Data from Closed-loop Driver</h4><p>Parameters</p>
<p><code>Pn.n</code> Motor CAN board address and driver number</p>
<p>Remaining details TBD.</p>
<h4 id="M569-6-Execute-Closed-loop-Driver-Tuning-Move"><a href="#M569-6-Execute-Closed-loop-Driver-Tuning-Move" class="headerlink" title="M569.6: Execute Closed-loop Driver Tuning Move"></a>M569.6: Execute Closed-loop Driver Tuning Move</h4><p>Parameters</p>
<p><code>Pn.n</code> Motor CAN board address and driver number</p>
<p>Remaining details TBD.</p>
<h4 id="M569-7-Configure-motor-brake-port"><a href="#M569-7-Configure-motor-brake-port" class="headerlink" title="M569.7: Configure motor brake port"></a>M569.7: Configure motor brake port</h4><p>Parameters</p>
<p><code>Pn.n</code> Motor CAN board address (if applicable) and driver number</p>
<p><code>C&quot;port&quot;</code> Port name of the brake control port. The port must be on the same CAN board as the driver. The CAN address does not need to be specified in the port name, but if it is then it must be the same as the driver address.</p>
<p>Example</p>
<p><code>M569.7 P40.0 C&quot;out2&quot;    ; driver 0 on board 40 uses port out1 on board 40 to control the brake</code></p>
<p>When the motor driver is enabled, the specified output port will be turned on at the same time to release the brake. When the motor driver is disabled, the output port will be turned off. Idle current mode does not count as disabled.</p>
<h4 id="M569-8-Read-Axis-Force"><a href="#M569-8-Read-Axis-Force" class="headerlink" title="M569.8: Read Axis Force"></a>M569.8: Read Axis Force</h4><p>Parameters</p>
<p><code>Pn</code> or <code>Pn.n</code> Motor driver number, or board address and driver number. Can also be a colon separated list of driver numbers.</p>
<p>The readouts are in units of Newtons.</p>
<p>Example</p>
<p>M569.8 P40.0:41.0:42.0:43.0 [3.52, -0.60, 7.24, -5.84, ],</p>
<h4 id="M569-9-Sets-the-driver-sense-resistor-and-maximum-current"><a href="#M569-9-Sets-the-driver-sense-resistor-and-maximum-current" class="headerlink" title="M569.9: Sets the driver sense resistor and maximum current"></a>M569.9: Sets the driver sense resistor and maximum current</h4><p>Parameters</p>
<p><code>Pnn</code> or <code>Pnn.n</code> Motor driver number.</p>
<p><code>Rnnnn</code> Driver sense resistor value in Ohms.</p>
<p><code>Snnnn</code> Driver max current value in Amps.</p>
<p>Example</p>
<p><code>M569.9 R0.047 S4    ; driver 0 uses a 47mOhm sense resistor and 4 Amps maximum driver output</code></p>
<h4 id="M570-Configure-heater-fault-detection"><a href="#M570-Configure-heater-fault-detection" class="headerlink" title="M570: Configure heater fault detection"></a>M570: Configure heater fault detection</h4><p>Parameters for RepRapFirmware 1.14 and earlier</p>
<p><code>Snnn</code> Heater timeout (in seconds)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M570 S120</span><br></pre></td></tr></table></figure>

<p>After a heater has been switched on, wait 120 seconds for it to get close to the set temperature. If it takes longer than this, raise a heater fault.</p>
<p>Parameters for RepRapFirmware 1.15e and later</p>
<p><code>Hnnn</code> Heater number</p>
<p><code>Pnnn</code> Time in seconds for which a temperature anomaly must persist on this heater before raising a heater fault (default 5 seconds)</p>
<p><code>Tnnn</code> Permitted temperature excursion from the setpoint for this heater (default 10C)</p>
<p><code>Snnn</code> Time in seconds after a heater fault is raised after which the print will be abandoned, default 10 minutes (RepRapFirmware 1.20 and later)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M570 H1 P4 T15</span><br></pre></td></tr></table></figure>

<p><strong>Warning!</strong> Heating fault detection is provided to reduce the risk of starting a fire if a dangerous fault occurs, for example if the heater cartridge or thermistor falls out of the heater block. You should not increase the detection time or permitted temperature excursion without good reason, because doing so will reduce the protection.</p>
<h4 id="M571-Set-output-on-extrude"><a href="#M571-Set-output-on-extrude" class="headerlink" title="M571: Set output on extrude"></a>M571: Set output on extrude</h4><p>Parameters</p>
<p><code>Snnn</code> Output value</p>
<p><code>Fnnn</code> Output PWM frequency (RepRapFirmware 1.17 and later)</p>
<p><code>Pnnn</code> Logical pin number (RepRapFirmware 1.17 and later), defaults to the FAN0 output until <code>M571</code> with a <code>P</code> parameter has been seen</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M571 P3 F200</span><br><span class="line">M571 S0.5</span><br></pre></td></tr></table></figure>

<p>This turns the controlled pin output on whenever extrusion is being done, and turns it off when the extrusion is finished. The output could control a fan or a stirrer or anything else that needs to work just when extrusion is happening. It also can be used to control a laser beam. The <code>S</code> parameter sets the value of the PWM to the output. 0.0 is off; 1.0 is fully on.</p>
<p>In RepRapFirmware 1.17 and later you can use the <code>P</code> parameter to change the pin used and you can also set the PWM frequency. Pin numbers are the same as in the M42 and <code>M280</code> commands. The pin you specify must not be in use for anything else, so if it is normally used as a heater you must disable the heater first using <code>M307</code>, or if it is used for a fan you must disable the fan using M106 with the I-1 parameter.</p>
<h4 id="M572-Set-or-report-extruder-pressure-advance"><a href="#M572-Set-or-report-extruder-pressure-advance" class="headerlink" title="M572: Set or report extruder pressure advance"></a>M572: Set or report extruder pressure advance</h4><p>Prusa Buddy firmware specific<sup>1</sup></p>
<p>Parameters</p>
<p><code>Dnnn</code> Extruder number</p>
<p><code>Tnnn</code> Extruder number (not supported yet)<sup>1</sup></p>
<p><code>Snnn</code> Pressure advance amount (in seconds)</p>
<p><code>Snnn</code> Set the pressure advance value. Range is 0. to 1.0 seconds. If zero the pressure advance is disabled.<sup>1</sup></p>
<p><code>Wnnn</code> Set a time range in seconds used for calculating the average extruder velocity for pressure advance. Range between 0. and 0.2 Default value is 0.04.<sup>1</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M572 D0 S0.1</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M572 S0.05 1</span><br></pre></td></tr></table></figure>

<p>This sets the pressure advance coefficient (<code>S</code> parameter) for the specified extruder (<code>D</code> parameter).</p>
<p>Pressure advance causes the extruder drive position to be advanced or retarded during printing moves by an additional amount proportional to the rate of extrusion. At the end of a move when the extrusion rate is decreasing, this may result in the extruder drive moving backwards (i.e. retracting). Therefore, if you enable this feature, you may need to reduce the amount of retraction you use in your slicing program to avoid over-retraction.</p>
<p>With Bowden extruders, an <code>S</code> value between 0.1 and 0.5 usually gives the best print quality. Direct drive extruders typically work best with lower values such as 0.05.</p>
<p>Older versions of RepRapFirmware used the <code>P</code> parameter to specify the drive number, instead of using D to specify the extruder number.</p>
<h4 id="M573-Report-heater-PWM"><a href="#M573-Report-heater-PWM" class="headerlink" title="M573: Report heater PWM"></a>M573: Report heater PWM</h4><p>Parameters</p>
<p><code>Pnnn</code> Heater number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M573 P1</span><br></pre></td></tr></table></figure>

<p>This gives a running average (usually taken over about five seconds) of the PWM to the heater specified by the P field. If you know the voltage of the supply and the resistance of the heater this allows you to work out the power going to the heater. Scale: 0 to 1.</p>
<p>In RepRapFirmware 3.3.0 and later the heater PWM can be queried from the Object Model instead.</p>
<h4 id="M574-Set-endstop-configuration"><a href="#M574-Set-endstop-configuration" class="headerlink" title="M574: Set endstop configuration"></a>M574: Set endstop configuration</h4><p>Parameters</p>
<p><strong>Xnnn</strong> Switch position for X axis</p>
<p><strong>Ynnn</strong> Switch position for Y axis</p>
<p><strong>Znnn</strong> Switch position for Z axis</p>
<p><strong>Snnn</strong> Endstop type: 0 &#x3D; active low endstop input, 1 &#x3D; active high endstop input, 2 &#x3D; Z probe, 3 &#x3D; motor load detection</p>
<p>Example</p>
<p>M574 X1 Y2 Z0 S1  ; X endstop at low end, Y endstop at high end, no Z endstop, all active high</p>
<p>This defines the position of <a target="_blank" rel="noopener" href="https://reprap.org/mediawiki/index.php?title=Glossary_of_Terms&action=edit&redlink=1" title="Glossary of Terms (page does not exist)">endstop</a> sensor that the printer has for each axis: 0 &#x3D; none, 1 &#x3D; low end, 2 &#x3D; high end. The optional S parameter defines whether the endstop input is active high (S1, the default), low (S0), or the axes listed use the Z probe for homing that axis (S2), or motor stall detection (S3). A normally-closed endstop switch wired in the usual way produces an active high output (S1). If different axes use different types of endstop sensing, you can use more than one M574 command.</p>
<p>On delta printers the XYZ parameters refer to the towers, and the endstops should normally all be high end (i.e. at the top of the towers).</p>
<p>The S2 and S3 options are supported in RepRapFirmware 1.20 and later.</p>
<p>In RepRapFirmware 1.16 and earlier, the M574 command with E parameter was used to specify whether a Z probe connected to the E0 endstop input produces an active high (S1) or active low (S0) output. In RepRapFirmware 1.17 and later, use the I parameter of the M558 command instead.</p>
<h4 id="M575-Set-serial-comms-parameters"><a href="#M575-Set-serial-comms-parameters" class="headerlink" title="M575: Set serial comms parameters"></a>M575: Set serial comms parameters</h4><p>Parameters</p>
<p><code>Pnnn</code> Serial channel number</p>
<p><code>Bnnn</code> Baud rate (optional)</p>
<p><code>Snnn</code> Protocol (optional)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M575 P1 B57600 S1</span><br></pre></td></tr></table></figure>

<p>This sets the communications parameters of the serial comms channel specified by the <code>P</code> parameter. <code>P0</code> specifies the main serial interface (typically a USB port, or serial-over-USB), while <code>P1</code> specifies an auxiliary serial port (for example, the port used to connect a PanelDue) and P2 specifies a second auxiliary port if there is one.</p>
<p>The <code>B</code> parameter is the required baud rate (this parameter is typically ignored if the port is a true USB port).</p>
<p>The <code>S</code> parameter is a bitmap of protocol features. Bit 0 if set specifies that only commands that include a valid checksum or CRC should be accepted from this comms channel. Bit 1 if set specifies that responses should be sent in raw mode (default is to send them as JSON). Bit 2 if set specifies that only commands with a valid CRC should be accepted (this overrides bit 0).</p>
<p>If either the B or the S parameter is missing, the previous value will be retained, or a default used if the port has not previously been configured using M575. If both are missing then the existing values are reported.</p>
<h4 id="M576-Set-SPI-comms-parameters"><a href="#M576-Set-SPI-comms-parameters" class="headerlink" title="M576: Set SPI comms parameters"></a>M576: Set SPI comms parameters</h4><p>Parameters</p>
<p><code>Snnn</code> Maximum delay between full SPI transfers (in ms, defaults to 25ms)</p>
<p><code>Fnnn</code> Maximum delay between full SPI transfers when a file is open (in ms, defaults to 5ms)</p>
<p><code>Pnnn</code> Number of events required to skip the delay (defaults to 4)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M576 S10 ; set data exchange interval to 10ms</span><br></pre></td></tr></table></figure>

<p>This sets the communications parameters of the SPI channel. Supported in RRF 3.4 and later in SBC mode.</p>
<h4 id="M577-Wait-until-endstop-is-triggered"><a href="#M577-Wait-until-endstop-is-triggered" class="headerlink" title="M577: Wait until endstop is triggered"></a>M577: Wait until endstop is triggered</h4><p>Parameters</p>
<p><code>Snnn</code> Desired endstop level</p>
<p><code>Xnnn</code> Select X axis endstop</p>
<p><code>Ynnn</code> Select Y axis endstop</p>
<p><code>Znnn</code> Select Z axis endstop</p>
<p><code>Ennn</code> Select extruder drive endstop</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M577 E0 S1</span><br></pre></td></tr></table></figure>

<p>Wait for an endstop switch to be pressed. The example above will wait until the first extruder endstop is triggered.</p>
<p>The following trigger types may be used using the ‘S’ parameter:</p>
<p>0: Endstop not hit 1: Low endstop hit 2: High endstop hit 3: Near endstop (only Z probe)</p>
<h4 id="M578-Fire-inkjet-bits"><a href="#M578-Fire-inkjet-bits" class="headerlink" title="M578: Fire inkjet bits"></a>M578: Fire inkjet bits</h4><p>Parameters</p>
<p><code>Pnnn</code> Inkjet head number</p>
<p><code>Snnn</code> Bit pattern</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M578 P3 S5</span><br></pre></td></tr></table></figure>

<p>This fires inkjet head 3 (the P field) using the bit pattern specified by the S field. The example shown would fire bits 101. If the <code>P</code> parameter is ommitted inkjet 0 is assumed.</p>
<p>This is a version of the M700 command used by the <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Inkshield" title="Inkshield">Inkshield</a>, but unfortunately M700 is already taken so cannot be used for that in the standard.</p>
<h4 id="M579-Scale-Cartesian-axes"><a href="#M579-Scale-Cartesian-axes" class="headerlink" title="M579: Scale Cartesian axes"></a>M579: Scale Cartesian axes</h4><p>Parameters</p>
<p><code>Xnnn</code> Scale factor for X axis</p>
<p><code>Ynnn</code> Scale factor for Y axis</p>
<p><code>Znnn</code> Scale factor for Z axis</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M579 X1.0127 Y0.998</span><br></pre></td></tr></table></figure>

<p>On a Cartesian RepRap you can get prints exactly the right size by tweaking the axis steps&#x2F;mm using the M92 G Code above. But this does not work so easily for Delta and other RepRaps for which there is cross-talk between the axes. This command allows you to adjust the X, Y, and Z axis scales directly. So, if you print a part for which the Y length should be 100mm and measure it and find that it is 100.3mm long then you set Y0.997 (&#x3D; 100&#x2F;100.3).</p>
<h4 id="M580-Select-Roland"><a href="#M580-Select-Roland" class="headerlink" title="M580: Select Roland"></a>M580: Select Roland</h4><p>Parameters</p>
<p><code>Rnnn</code> Whether Roland mode should be activated</p>
<p><code>Pnnn</code> Initial text to send to the Roland controller</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M580 R1 PVS4;!VZ2;!MC1;</span><br></pre></td></tr></table></figure>

<p>This is not really anything to do with RepRap, but it is convenient. The <a target="_blank" rel="noopener" href="http://www.rolanddg.com/product/3d/3d/mdx-20_15/mdx-20_15.html">little Roland mills</a> are very widely available in hackerspaces and maker groups, but annoyingly they don’t speak G Codes. As all RepRap firmware includes a G-Code interpreter, it is often easy to add functions to convert G Codes to <a target="_blank" rel="noopener" href="http://altlab.org/d/content/m/pangelo/ideas/rml_command_guide_en_v100.pdf">Roland RML language</a>. M580 selects a Roland device for output if the R field is 1, and returns to native mode if the <code>R</code> field is 0. The optional <code>P</code> string is sent to the Roland if <code>R</code> is 1. It is permissible to call this repeatedly with <code>R</code> set to 1 and different strings in the <code>P</code> field to communicate directly with a Roland.</p>
<h4 id="M581-Configure-external-trigger"><a href="#M581-Configure-external-trigger" class="headerlink" title="M581: Configure external trigger"></a>M581: Configure external trigger</h4><p>Parameters</p>
<p><code>Tnn</code> Logical trigger number to associate the endstop input(s) with, from zero up to a firmware-specific maximum (e.g. 9 for RepRapFirmware)</p>
<p><code>X, Y, Z, E</code> Selects endstop input(s) to monitor</p>
<p><code>P</code> Reserved, may be used in future to allow general I&#x2F;O pins to cause triggers</p>
<p><code>S</code> Whether trigger occurs on a rising edge of that input (S1, default), falling edge (S0), or ignores that input (S-1). By default, all triggers ignore all inputs.</p>
<p><code>C</code> Condition: whether to trigger at any time (C0, default) or only when printing a file from SD card (C1)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M581 E1:2 S1 T2 C1   ; invoke trigger 2 when a rising edge is detected on the E1 or E2 endstop input and a file is being printed from SD card</span><br></pre></td></tr></table></figure>

<p>When <code>M581</code> is executed, if the <code>T</code> parameter is present but the other parameters are omitted, the trigger inputs and edge polarities for that trigger number are reported. Otherwise, the specified inputs and their polarities are added to the conditions that cause that trigger. Using <code>S-1</code> with no <code>X</code>, <code>Y</code>, <code>Z</code> or <code>E</code> parameters sets the trigger back to ignoring all inputs.</p>
<p>In RepRapFirmware, trigger number 0 causes a full (emergency) stop as if <code>M112</code> had been received. Trigger number 1 causes the print to be paused as if <code>M25</code> had been received. Any trigger number # greater then 1 causes the macro file <code>sys/trigger#.g</code> to be executed. Polling for further trigger conditions is suspended until the trigger macro file has been completed. RepRapFirmware does not wait for all queued moves to be completed before executing the macro, so you may wish to use the <code>M400</code> command at the start of your macro file. If several triggers are pending, the one with the lowest trigger number takes priority.</p>
<h4 id="M582-Check-external-trigger"><a href="#M582-Check-external-trigger" class="headerlink" title="M582: Check external trigger"></a>M582: Check external trigger</h4><p>Parameters</p>
<p>T Trigger number to poll</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M582 T2 ; check levels of inputs that give rise to trigger #2</span><br></pre></td></tr></table></figure>

<p>Triggers set up by the M581 command are normally activated only when the specified inputs change state. This command provides a way of causing the trigger to be executed if the input is at a certain level. For each of the inputs associated with the trigger, the trigger condition will be checked as if the input had just changed from the opposite state to the current state.</p>
<p>For example, if you use M581 to support an out-of-filament sensor, then M582 allows you to check for out-of-filament just before starting a print.</p>
<h4 id="M584-Set-drive-mapping"><a href="#M584-Set-drive-mapping" class="headerlink" title="M584: Set drive mapping"></a>M584: Set drive mapping</h4><p>Parameters</p>
<p><code>Xnnn</code> Driver number(s) for X motor(s)</p>
<p><code>Ynnn</code> Driver number(s) for Y motor(s)</p>
<p><code>Znnn</code> Driver number(s) for Z motor(s)</p>
<p><code>U,V,W, A, B, Cnnn</code> Driver number(s) for additional axes U, V, W, A, B and C (UVW RepRapFirmware 1.16 and later; ABC RepRapFirmware 1.19 and later)</p>
<p><code>Ennn</code> Driver number(s) for E motor(s)</p>
<p><code>Pnnn</code> Number of visible axes, defaults to the total number of axes configured.</p>
<p>Example</p>
<p>M584 X0 Y1 Z2:3 E4:5:6 ; Driver 0 controls the X motor, 1 controls Y, 2 and 3 control Z motors, 4 and 5 control E motors</p>
<p>Assigning a drive using <code>M584</code> does not remove its old assignment. Therefore, if you assign a drive that defaults to being an extruder drive, you should also assign the extruder drives explicitly as in the above example. Failure to do so may result in unexpected behaviour.</p>
<p>You can use <code>M584</code> to create additional axes - for example, to represent additional carriages on a machine with multiple independent X carriages. Additional axes must be created in the order UVWABC. You can hide some of the last axes you create using the P parameter. Hidden axes have no homing buttons or jog controls in the user interface.</p>
<p>On the Duet WiFi and Duet Ethernet, if you configure multiple drivers for an axis, either all of them must be TMC2660 drivers on the Duet or a Duet expansion board, or none of them must be. This is to facilitate dynamic microstepping and other features of the TMC2660.</p>
<h4 id="M585-Probe-Tool"><a href="#M585-Probe-Tool" class="headerlink" title="M585: Probe Tool"></a>M585: Probe Tool</h4><p>In machines with a tool probe this probes the currently selected tool against it and corrects the offsets set by the G10 command (q.v.).</p>
<p>Parameter must be only one of</p>
<p><code>Xnnn</code></p>
<p><code>Y-nnn</code></p>
<p><code>Znnn</code></p>
<p>Where the absolute value of <code>nnn</code> is the radius of the tool plus the radius of the probe in that direction. So <code>M585 X1.5</code> will set the X offset of a 1mm diameter tool against a 2mm diameter probe, etc. If the value of <code>nnn</code> is positive the tool is moved in the positive direction towards the probe until it touches. If it is negative, the tool moves the other way.</p>
<p>So the process should be:</p>
<p>Set the values as closely as known in the <code>G10</code> command.</p>
<p>Move to a position slightly offset from the probe then execute <code>M585</code>s in X, Y and Z in the tool selection macro to set them precisely.</p>
<p>After this, the <code>G10</code> command on its own can be used to report the values.</p>
<h4 id="M586-Configure-network-protocols"><a href="#M586-Configure-network-protocols" class="headerlink" title="M586: Configure network protocols"></a>M586: Configure network protocols</h4><p>Parameters</p>
<p><code>Pnn</code> Protocol: 0 &#x3D; HTTP or HTTPS, 1 &#x3D; FTP or SFTP, 2 &#x3D; Telnet or SSH, 3 - multicast discovery protocol (RepRapFirmware 3.4 and later), 4 &#x3D; MQTT (RepRapFirmware 3.5 and later) (where two choices are given, which one depends on the <code>T</code> parameter)</p>
<p><code>Snn</code> 0 &#x3D; disable this protocol, 1 &#x3D; enable this protocol</p>
<p><code>Rnn</code> TCP port number to use for the specified protocol. Ignored unless S &#x3D; 1. If this parameter is not provided then the default port for that protocol and TLS setting is used.</p>
<p><code>Tnn</code> 0 &#x3D; don’t use TLS, 1 &#x3D; use TLS. Ignored unless <code>S</code> &#x3D; 1. If this parameter is not provided, then TLS will be used if the firmware supports it and a security certificate has been configured. If <code>T1</code> is given but the firmware does not support TLS or no certificate is available, then the protocol will not be enabled and an error message will be returned.</p>
<p><code>C&quot;site&quot;</code> Set or reset allowed site for cross-orgin HTTP requests (RRF &gt; 3.2-b4.1)</p>
<p>M586 with no <code>S</code> parameter reports the current support for the available protocols.</p>
<p>RepRapFirmware 1.18 and later enable only HTTP (or HTTPS if supported) protocol by default. If you wish to enable FTP and&#x2F;or Telnet, enable them using this command once or twice in config.g.</p>
<h4 id="M586-4-Configure-MQTT-server"><a href="#M586-4-Configure-MQTT-server" class="headerlink" title="M586.4: Configure MQTT server"></a>M586.4: Configure MQTT server</h4><p>Parameters</p>
<p><strong>U”username”</strong> The name to use when logging on to the MQTT server</p>
<p><strong>K”password”</strong> The password to use when logging on to the MQTT server (only valid if the U parameter is also present)</p>
<p><strong>C”client-id”</strong> The client ID to use</p>
<p><strong>W”will-message”</strong> The will-message to use</p>
<p><strong>T”topic”</strong> The topic name to use (only processed if the W parameter is also present)</p>
<p><strong>S”subscription”</strong> The subscription name to use</p>
<p><strong>Qnn</strong> The quality of service to use, 0 to 2 (only processed if the S parameter is also present)</p>
<p><strong>P”publish”</strong> Publish the topic if this is set</p>
<p><strong>Rn</strong> 1 &#x3D; retain, 0 &#x3D; do not retain (only processed if the P parameter is used)</p>
<p><strong>Dn</strong> 1 &#x3D; duplicate, 0 &#x3D; don’t duplicate (only processed if the P parameter is used)</p>
<p>[To be completed]</p>
<h4 id="M587-Store-WiFi-host-network-in-list-or-list-stored-networks"><a href="#M587-Store-WiFi-host-network-in-list-or-list-stored-networks" class="headerlink" title="M587: Store WiFi host network in list, or list stored networks"></a>M587: Store WiFi host network in list, or list stored networks</h4><p>Parameters</p>
<p><code>Sccc</code> Network SSID</p>
<p><code>Pccc</code> Network password</p>
<p><code>Inn.nn.nn.nn</code> (optional) IP address to use when connected to this network. If zero or not specified then an IP address will be acquired via DHCP.</p>
<p><code>Jnn.nn.nn.nn</code> (optional) Gateway IP address to use when connected to this network.</p>
<p><code>Knn.nn.nn.nn</code> (optional) Netmask to use when connected to this network</p>
<p><code>Lnn.nn.nn.nn</code> (optional, supported only by DuetPi + DSF v3.3 or newer) DNS server to use</p>
<p><code>Cnnn</code> (supported only by DuetPi + DSF v3.3 or newer) Country code for the WiFi adapter, only required if not set before</p>
<p>If a password or SSID includes space or semicolon characters then it must be enclosed in double quotation marks. For security, do not use this command in the config.g file, or if you do then remove it after running it once so that the network password is not visible in the file.</p>
<p><code>M587</code> with no parameters lists all stored SSIDs, but not the stored passwords.</p>
<h4 id="M588-Forget-WiFi-host-network"><a href="#M588-Forget-WiFi-host-network" class="headerlink" title="M588: Forget WiFi host network"></a>M588: Forget WiFi host network</h4><p>Parameters</p>
<p><code>Sccc</code> SSID to remove from the networks list</p>
<p>The specified SSID will be removed from the networks list and the associated password cleared out of EEPROM. If the SSID is given as * then all stored networks will be forgotten.</p>
<h4 id="M589-Configure-access-point-parameters"><a href="#M589-Configure-access-point-parameters" class="headerlink" title="M589: Configure access point parameters"></a>M589: Configure access point parameters</h4><p>Parameters</p>
<p><code>Sccc</code> The SSID that the WiFi interface should use when it is commanded to run as an access point</p>
<p><code>Pccc</code> The WiFi password</p>
<p><code>Inn.nn.nn.nn</code> The IP address to use</p>
<p>Note: WPA2 security will be used by default.</p>
<h4 id="M590-Report-current-tool-type-and-index"><a href="#M590-Report-current-tool-type-and-index" class="headerlink" title="M590: Report current tool type and index"></a>M590: Report current tool type and index</h4><p>Report the current tool type, which may be “Extruder,” “Picker,” “Laser,” “Foam Cutter,” “Milling,” or any others implemented by the machine. Also report the tool index, such as “0x01” for the second extruder.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; M590</span><br><span class="line">&gt; echo: Extruder 0x00</span><br></pre></td></tr></table></figure>

<h4 id="M591-Configure-filament-monitoring"><a href="#M591-Configure-filament-monitoring" class="headerlink" title="M591: Configure filament monitoring"></a>M591: Configure filament monitoring</h4><p>This configures filament sensing for the specified extruder. The sensor may be a simple filament presence detector, or a device that measures movement of filament, or both. The action on detecting a filament error is firmware-dependent, but would typically be to run a macro and&#x2F;or to pause the print and display a message.</p>
<p>Parameters</p>
<p><strong>Cnn</strong> Which input the filament sensor is connected to. On Duet electronics: 0&#x3D;X endstop input, 1&#x3D;Y endstop input, 2&#x3D;Z endstop input, 3&#x3D;E0 endstop input etc.</p>
<p><strong>Dnn</strong> Extruder drive number (0, 1, 2…),</p>
<p><strong>Pnn</strong> Type of sensor: 0&#x3D;none, 1&#x3D;simple sensor (low signal when filament present), 2&#x3D;simple sensor (high signal when filament present), 3&#x3D;Duet3D rotating magnet sensor, 4&#x3D;Duet3D rotating magnet sensor with microswitch, :<strong>Snn</strong> S0 &#x3D; disable filament monitoring, S1 &#x3D; enable filament monitoring. Calibration data may be collected while printing even when filament monitoring is disabled.</p>
<p>5&#x3D;Duet3D laser filament monitor, 6&#x3D;Duet3D laser filament monitor with microswitch, 7&#x3D;pulse-generating sensor</p>
<p>Additional parameters for Duet3D laser filament monitor</p>
<p><strong>Raa:bb</strong> Allow the filament movement reported by the sensor to be between aa% and bb% of the commanded values; if it is outside these values and filament monitoring is enabled, the print will be paused</p>
<p><strong>Enn</strong> minimum extrusion length before a commanded&#x2F;measured comparison is done, default 3mm</p>
<p>Additional parameters for Duet3D rotating magnet filament monitor</p>
<p><strong>Lnn</strong> Filament movement per complete rotation of the sense wheel, in mm</p>
<p><strong>R, E</strong> As for Duet3D laser filament monitor</p>
<p>Additional parameters for a pulse generating filament monitor</p>
<p><strong>Lnn</strong> Filament movement per pulse in mm</p>
<p><strong>R, E</strong> As for Duet3D laser filament monitor</p>
<p>Examples</p>
<p>M591 D0 C3 P5 S1 R70:130 L24.8 E6.0  ; Duet3D laser sensor for extruder drive 0 is connected to E0 endstop input, 24.8mm&#x2F;rev, 70% to 130% tolerance, 6mm detection length</p>
<p>M591 D1  ; display filament sensor parameters for extruder drive 1</p>
<p>Note: RepRapFirmware 1.19 and 1.20 also supported filament monitors via M591, but some of the parameters were different.</p>
<h4 id="M592-Configure-nonlinear-extrusion"><a href="#M592-Configure-nonlinear-extrusion" class="headerlink" title="M592: Configure nonlinear extrusion"></a>M592: Configure nonlinear extrusion</h4><p>Parameters</p>
<p><strong>Dnn</strong> Extruder drive number (0, 1, 2…)</p>
<p><strong>A</strong>nnn A coefficient in the extrusion formula, default zero</p>
<p><strong>B</strong>nnn B coefficient in the extrusion formula, default zero</p>
<p><strong>L</strong>nnn Upper limit of the nonlinear extrusion compensation, default 0.2</p>
<p><strong>T</strong> nnn Reserved for future use, for the temperature at which these values are valid</p>
<p>Example</p>
<p>M592 D0 A0.01 B0.0005 ; set parameters for extruder drive 0</p>
<p>M592 D0 ; report parameters for drive 0</p>
<p>Most extruder drives use toothed shafts to grip the filament and drive it through the hot end. As the extrusion speed increases, so does the back pressure from the hot end, and the increased back pressure causes the amount of filament extruded per step taken by the extruder stepper motor to reduce. This may be because at high back pressures, each tooth compresses and skates over the surface of the filament for longer before it manages to bite. See forum post <a target="_blank" rel="noopener" href="http://forums.reprap.org/read.php?262,802277">http://forums.reprap.org/read.php?262,802277</a> and the graph at <a target="_blank" rel="noopener" href="http://forums.reprap.org/file.php?262,file=100851,filename=graph.JPG">http://forums.reprap.org/file.php?262,file=100851,filename=graph.JPG</a> for an example.</p>
<p>Nonlinear extrusion compensates for this effect. The amount of extrusion requested is multiplied by (1 + MIN(L, A*v + B*v^2)) where v is the requested extrusion speed (calculated from the actual speed at which the move will take place) in mm&#x2F;sec.</p>
<p>Nonlinear extrusion is not applied to extruder-only movements such as retractions and filament loading.</p>
<h4 id="M593-Configure-Input-Shaping"><a href="#M593-Configure-Input-Shaping" class="headerlink" title="M593: Configure Input Shaping"></a>M593: Configure Input Shaping</h4><p>Note: RepRapFirmware 2.02 thru 3.2 implemented a primitive form of input shaping called Dynamic Acceleration Adjustment, supporting just the F parameter. This support has been replaced in RRF 3.4 and later by the more sophisticated forms of input shaping described here.</p>
<p>Parameters</p>
<p><strong>P”type”</strong> Type of input shaping to use, not case sensitive. RRF 3.4 supports “none”, “zvd”, “zvdd”, “zvddd”, “mzv”, “ei2”, “ei3” and “custom”. RRF 3.3 supports “none” or “daa”, and if no P parameter is given but the F parameter is given then “daa” is assumed for compatibility with previous releases.</p>
<p><strong>Fnnn</strong> Centre frequency of ringing to cancel in Hz</p>
<p><strong>Snnn</strong> (optional) Damping factor of ringing to be cancelled, default 0.1.</p>
<p><strong>Lnnn</strong> (optional) Minimum acceleration allowed, default 10mm&#x2F;sec^2. Input shaping will not be applied if it requires the average acceleration to be reduced below this value.</p>
<p><strong>Hnn:nn…</strong> Amplitudes of each impulse except the last, normally below 1.0. Only used with P”custom” parameter.</p>
<p><strong>Tnn:nn</strong> Durations of each impulse except the last. Only used with P”custom” parameter.</p>
<p>Prusa-Buddy Parameters<sup>1</sup></p>
<p><strong>X</strong> Set the input shaper parameters only for the X axis. Also in Marlin 2.x<sup>2</sup></p>
<p><strong>Y</strong> Set the input shaper parameters only for the Y axis. Also in Marlin 2.x<sup>2</sup></p>
<p><strong>W</strong> Write current input shaper settings to EEPROM.</p>
<p><strong>Dnnn</strong> Set damping ratio. Range 0 to 1. Also in Marlin 2.x<sup>2</sup></p>
<p><strong>Fnnn</strong> Set frequency. Greater or equal to 0. Also in Marlin 2.x<sup>2</sup></p>
<p><strong>Tn</strong> Set type. Range 0 to 5.</p>
<p><strong>Rnnn</strong> Set vibration reduction. Greater than 0.</p>
<p>Examples (RRF 3.4 and later)</p>
<p>M593 P”zvd” F40.5 ; use ZVD input shaping to cancel ringing at 40.5Hz</p>
<p>M593 P”none”  ; disable input shaping</p>
<p>M593 P”custom” H0.4:0.7 T0.0135:0.0135 ; use custom input shaping</p>
<p>Examples (RRF 3.3)</p>
<p>M593 P”daa” F40.5 ; use DAA to cancel ringing at 40.5Hz</p>
<p>M593 P”none”  ; disable DAA</p>
<p>Examples (Prusa-Buddy)</p>
<p>M593 X T2 F50.7</p>
<p>M593 Y T2 F40.6</p>
<p>Input shaping is most useful to avoid exciting low-frequency ringing, for which S-curve acceleration is ineffective and may make the ringing worse. High-frequency ringing would be better countered by using S-curve acceleration; however, low-frequency ringing is more of a problem in most 3D printers.</p>
<p>The ringing frequencies are best measured using an accelerometer, for which support is provided in RRF 3.3 and later. Alternatively, take a print that exhibits ringing on the perimeters (for example a cube), preferably printed single-wall or external-perimeters-first. Divide the speed at which the outer perimeter was printed (in mm&#x2F;sec) by the distance between adjacent ringing peaks (in mm). When measuring the distance between peaks, ignore peaks close to the corner where the ringing started (these peaks will be spaced more closely because the print head will have been accelerating in that area).</p>
<p>Cartesian and CoreXY printers will typically have different frequencies of ringing for the X and Y axes. Note that X axis ringing causes artefacts predominantly on the Y face of the test cube, and vice versa. The more advanced forms of input shaping reduce ringing over a wide range of frequencies (for example EI3 covers a range of about 3:1) so that for printers that exhibit significant ringing on both X and Y axes, it is normally possible to choose a shaper that cancels both.</p>
<p>High X and Y jerk values reduce the effectiveness of input shaping; therefore you should set the X and Y jerk limits only as high as necessary to allow curves to be printed smoothly.</p>
<h4 id="M594-Enter-Leave-Height-Following-mode"><a href="#M594-Enter-Leave-Height-Following-mode" class="headerlink" title="M594: Enter&#x2F;Leave Height Following mode"></a>M594: Enter&#x2F;Leave Height Following mode</h4><p>Parameters</p>
<p><strong>Pn</strong> P1 &#x3D; enter height following mode, P0 &#x3D; leave height following mode</p>
<p>Height following mode allows the Z position of the tool to be controlled by a PID controller using feedback from a sensor. See also M951.</p>
<p>If a movement command (e.g. G1) explicitly mentions the Z axis while height following mode is active, existing moves in the pipeline will be allowed to complete and the machine allowed to come to a standstill. Then height following mode will be terminated and the new move executed.</p>
<h4 id="M595-Set-movement-queue-length"><a href="#M595-Set-movement-queue-length" class="headerlink" title="M595: Set movement queue length"></a>M595: Set movement queue length</h4><p>Parameters</p>
<p><strong>Pnn</strong> Maximum number of moves held in the movement queue. RepRapFirmware uses this value to determine how many DDA objects to allocate.</p>
<p><strong>Snn</strong> (optional) Number of pre-allocated per-motor movement objects. If the number of pre-allocated objects is insufficient, RepRapFirmware will attempt to allocate additional omnes dynamically when they are needed.</p>
<p>Different features of motion control firmware may have competing demands on microcontroller RAM. In particular, operations that use many short segments (e.g. laser rastering) need longer movement queues than typical 3D printing, but have fewer motors to control. This command allows the movement queue parameters to be adjusted so that the queue can be lengthened if necessary, or kept short if a long movement queue is not needed and there are other demands on RAM.</p>
<p>M595 without any parameters reports the length of the movement queue and the number of per-motor movement objects allocated.</p>
<h4 id="M596-Select-movement-queue-number"><a href="#M596-Select-movement-queue-number" class="headerlink" title="M596: Select movement queue number"></a>M596: Select movement queue number</h4><p>Parameters</p>
<p><strong>Pnn</strong> Movement queue number. Queues are numbered 0 (the default queue), 1, …</p>
<p>This command is supported in RepRapFirmware builds that can execute moves on different axis systems asynchronously, for example for concurrent printing of two or more different objects. It specifies that subsequent GCode commands from this input channel should be routed to the specified movement queue and the tool associated with that queue.</p>
<p>The number of available queues is firmware-dependent but will typically be 2. Before using a movement queue other than queue 0 it may be necessary to use M595 to increase the length of that queue, because the default length of movement queues other than the primary one may be quite short.</p>
<p>At the start of a file print, queue 0 is selected automatically.</p>
<p>If M596 is used without the P parameter, it reports the current motion system number for the input channel that the command was received on.</p>
<h4 id="M597-Collision-avoidance"><a href="#M597-Collision-avoidance" class="headerlink" title="M597: Collision avoidance"></a>M597: Collision avoidance</h4><p>Parameters</p>
<p><strong>X,Y…aaa</strong> First axis identifier and value</p>
<p><strong>U,V…bbb</strong> Second axis identifier and value</p>
<p>Example</p>
<p>M597 V0 Y23.5</p>
<p>This configuration command is intended for use in systems having multiple tool heads that can be moved independently and asynchronously. The axis letters must be different from each other, so must the values of <em>aaa</em> and <em>bbb</em>. Normally, <em>aaa</em> will be zero and <em>bbb</em> will be positive. The command specifies that the machine position of the axis with the higher value must always be at least the difference in values greater than the position of the other axis. In the above example, the position of the Y axis must always be at least 23.5mm greater than the position of the V axis.</p>
<p>When Y and V are driven by independent motion systems and executing moves independently, in any block of GCode between synchronisation points, using this example the minimum of all Y coordinates inside the block (including the initial Y coordinate) must be at least 23.5mm greater than the maximum of the all V coordinates inside the block. If this is not the case, the job will be aborted prior to starting the first move that would cause the conflict.</p>
<h4 id="M598-Sync-motion-systems"><a href="#M598-Sync-motion-systems" class="headerlink" title="M598: Sync motion systems"></a>M598: Sync motion systems</h4><p>This command has no parameters. It is for systems having multiple motion systems that can be moved independently and asynchronously. It is only valid within a job file. It causes the file reader for each motion system to wait at this instruction until all the file readers have reached it and all moves queued for any motion system have been completed.</p>
<p>Example</p>
<p>M598  ; wait until all motion systems have finished working on this layer</p>
<p>G1 Z0.8  ; change Z for next layer</p>
<h4 id="M599-Define-keepout-zone"><a href="#M599-Define-keepout-zone" class="headerlink" title="M599: Define keepout zone"></a>M599: Define keepout zone</h4><p>Parameters</p>
<p><strong>Pn</strong> Keepout zone number, default 0</p>
<p><strong>Sn</strong> (optional) S1 &#x3D; activate keepout zone (default if any axes are specified), S0 &#x3D; deactivate keepout zone</p>
<p><strong>X,Y…aaa:bbb</strong> Axis identifier and limits for that axis</p>
<p>Example</p>
<p>M599 X10:25 Y0:20</p>
<p>This command establishes a “no entry” zone for the toolhead reference point. If any G0&#x2F;G1&#x2F;G2&#x2F;G3 move attempts to move the toolhead reference point inside the no entry zone, the job will be aborted with an error message.</p>
<p>You may specify any number of axes, up to the number that the machine has. If no axes are specified and the S parameter is not provided then the parameters and enabled&#x2F;disabled state of the existing keepout zone will be reported.</p>
<p>Movement commands (G0, G1, G2 and G3) will normally be checked before starting the move.</p>
<p>The number of keepout zones supported is implementation dependent. It may be just one.</p>
<h4 id="M600-Set-line-cross-section"><a href="#M600-Set-line-cross-section" class="headerlink" title="M600: Set line cross section"></a>M600: Set line cross section</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M600 P0.061</span><br></pre></td></tr></table></figure>

<p>Sets the cross section for a line to extrude in velocity extrusion mode. When the extruder is enabled and movement is executed the amount of extruded filament will be calculated to match the specified line cross section.</p>
<h4 id="M600-Filament-change-pause"><a href="#M600-Filament-change-pause" class="headerlink" title="M600: Filament change pause"></a>M600: Filament change pause</h4><p>Pause for filament change.</p>
<p>Parameters</p>
<p><code>X[pos]</code></p>
<p><code>Y[pos]</code></p>
<p><code>Z[relative lift]</code></p>
<p><code>E[initial retract]</code></p>
<p><code>L[later retract distance for removal]</code></p>
<p><code>AUTO</code> Automatically (only Prusa Firmware with MMU connected)<sup>1</sup></p>
<p><code>N</code> (no return) Don’t return to the previous position after filament change</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M600</span><br></pre></td></tr></table></figure>

<p>In SmoothieWare:</p>
<p>The variable “after_suspend_gcode” is run after <code>M600</code>.</p>
<p>For example:</p>
<p>after_suspend_gcode G91_G0E-5_G0Z10_G90_G0X-50Y-50 # gcode to run after suspend, retract then get head out of way</p>
<p>In RepRapFirmware, <code>M600</code> causes macro file filament-change.g to be run if it exists, otherwise it falls back to pause.g. The parameters in the <code>M600</code> command are ignored.</p>
<p>Notes</p>
<p>In Prusa Firmware this command is also used when the Filament Runout Sensor triggers. To prevent filament blobs it will raise to 25 mm if it has been triggered below 25 mm layer height. Default are X&#x3D;211 mm, Y&#x3D;0 mm, Z&#x3D;2 mm, E&#x3D;-2 mm, L&#x3D;-80 mm<sup>1</sup></p>
<h4 id="M601-Pause-print"><a href="#M601-Pause-print" class="headerlink" title="M601: Pause print"></a>M601: Pause print</h4><p>Without any parameters it will park the extruder to default or last set position. The default pause position will be set during power up and a reset, the new pause positions aren’t permanent.</p>
<p>Usage</p>
<p><code>M601 [ X | Y | Z | S ]</code> <sup>2</sup></p>
<p>Parameters</p>
<p><code>X</code> X position to park <sup>2</sup></p>
<p><code>Y</code> Y position to park <sup>2</sup></p>
<p><code>Z</code> Z raise before park <sup>2</sup></p>
<p><code>S</code> Set values [S0 &#x3D; set to default values | S1 &#x3D; set values] without pausing <sup>2</sup></p>
<p><sup>2</sup>Prusa Firmware equivalent to M25 and M125</p>
<h4 id="M602-Resume-print"><a href="#M602-Resume-print" class="headerlink" title="M602: Resume print"></a>M602: Resume print</h4><p>Resumes print on Prusa i3 MK2&#x2F;s,MK2.5&#x2F;s,MK3&#x2F;s.</p>
<h4 id="M603-Stop-print-Prusa-i3"><a href="#M603-Stop-print-Prusa-i3" class="headerlink" title="M603: Stop print (Prusa i3)"></a>M603: Stop print (Prusa i3)</h4><p>Stop print on Prusa i3 MK2&#x2F;s, MK2.5&#x2F;s, and MK3&#x2F;s.</p>
<h4 id="M603-Configure-Filament-Change"><a href="#M603-Configure-Filament-Change" class="headerlink" title="M603: Configure Filament Change"></a>M603: Configure Filament Change</h4><p>This command configures Filament Change behavior in Marlin Firmware and in Prusa mini firmware under development.</p>
<p>Parameters</p>
<p><code>T[toolhead]</code> Select extruder to configure, active extruder if not specified (not used yet)</p>
<p><code>U[distance]</code> Retract distance for removal, for the specified extruder.</p>
<p><code>L[distance]</code> Extrude distance for insertion, for the specified extruder.</p>
<h4 id="M605-Set-dual-x-carriage-movement-mode"><a href="#M605-Set-dual-x-carriage-movement-mode" class="headerlink" title="M605: Set dual x-carriage movement mode"></a>M605: Set dual x-carriage movement mode</h4><p>Set Dual X-Carriage movement mode.</p>
<p>Parameters</p>
<p><code>S[mode]</code> Mode (see below)</p>
<p><code>X[duplication x-offset]</code> Optional X offset for Mode 2</p>
<p><code>R[duplication temp offset]</code> Optional temperature difference for Mode 2</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M605 S1 ; Set mode to auto-park</span><br></pre></td></tr></table></figure>

<p><code>M605 S0</code>: Full control mode. The slicer has full control over x-carriage movement <code>M605 S1</code>: Auto-park mode. The inactive head will auto park&#x2F;unpark without slicer involvement <code>M605 S2 [Xnnn] [Rmmm]</code>: Duplication mode. The second extruder will duplicate the first with nnn millimeters x-offset and an optional differential hotend temperature of <code>mmm</code> degrees. E.g., with “<code>M605 S2 X100 R2</code>“ the second extruder will duplicate the first with a spacing of 100mm in the x direction and 2 degrees hotter.</p>
<p>RepRapFirmware does not implement M605 because it supports dual carriage mode, duplication mode, auto park, different temperatures etc. using the <code>M563</code> tool definition command and the tool change macro files.</p>
<h4 id="M606-Fork-input-file-reader"><a href="#M606-Fork-input-file-reader" class="headerlink" title="M606: Fork input file reader"></a>M606: Fork input file reader</h4><p>Parameters</p>
<p><code>S[mode]</code> Mode, must be 1 (other values are reserved for future use).</p>
<p>Example</p>
<p>M606 S1 ; Fork input reader</p>
<p>This command is only supported on firmware configurations that support two or more motion systems that execute asynchronously with respect to each other.</p>
<p>If the S1 parameter is present and the command occurs within a job from SD card or other storage media, it causes the input stream to be forked. From that point on, each motion system can read and execute commands from the job file independently of other motion systems. In consequence, when the movement queue of one motion system becomes full, or one motion system is waiting for a tool change or other action to complete, the other motion system(s) can still read and execute commands. In the event that this command is executed from a job file when the input stream has already been forked, it is ignored.</p>
<p>If the S1 parameter is present and the command is used from an input channel other than a file stream then a warning is issued but it is otherwise ignored.</p>
<p>If this command is run without the S parameter then the firmware just reports whether a job is being run from storage media, and if so whether the input stream for that media has been forked.</p>
<p>See also the M596 command that selects a motion system, and the M598 command which is used to synchronise forked input streams at particular point in the file.</p>
<h4 id="M650-Set-peel-move-parameters"><a href="#M650-Set-peel-move-parameters" class="headerlink" title="M650: Set peel move parameters"></a>M650: Set peel move parameters</h4><p>This command is sent by nanoDLP to set the parameters for the peel move used after curing a layer. RepRapFirmware 2.02 ignores it. If using RepRapFirmware 2.03 or later you can create a empty file M650.g to cause it to be ignored.</p>
<h4 id="M651-Execute-peel-move"><a href="#M651-Execute-peel-move" class="headerlink" title="M651: Execute peel move"></a>M651: Execute peel move</h4><p>This command is sent by nanoDLP to execute a peel move after curing a layer. RepRapFirmware 2.02 executes macro &#x2F;sys&#x2F;peel-move.g in response to this command. For RepRapFirmware 2.03 and later, create a macro file M651.g containing the commands required to execute the peel move.</p>
<h4 id="M655-Send-request-to-custom-CAN-connected-expansion-board"><a href="#M655-Send-request-to-custom-CAN-connected-expansion-board" class="headerlink" title="M655: Send request to custom CAN-connected expansion board"></a>M655: Send request to custom CAN-connected expansion board</h4><p>Parameters</p>
<p><code>Bnn</code> CAN address of target board</p>
<p><code>C&quot;nn.string&quot;</code> Reduced string parameter, for example CAN address and port name</p>
<p><code>A&quot;string&quot;</code> Normal string parameter</p>
<p><code>Pnnn</code> Unsigned integer parameter, maximum 65535</p>
<p><code>R, S</code> Signed integer parameters</p>
<p><code>E, F</code> Floating point parameters</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M655 B10 C&quot;hello world&quot; P1 R-4 E0.123</span><br><span class="line">M655 C&quot;10:pump&quot; P0 S22 F42.1</span><br></pre></td></tr></table></figure>

<p>This command allows standard main board firmware builds to control features on custom CAN-connected expansion boards in situations where standard commands such as M950 and M42 are not suitable, for example because they do not provide sufficient parameters. The main board firmware expects to receive a standard reply to it.</p>
<p>All parameters are optional, except that exactly one of B or C must be present. The C parameter if present must start with the CAN address of the target board followed by a period. It will be “reduced” by removing this prefix and any underscores or hyphens and converting all characters to lowercase before sending the request to the target board.</p>
<p>The total number of bytes occupied by the parameters provided, excluding the B parameter and after reducing the C parameter, must not exceed 60. The number of bytes in a string parameter is the number of bytes in the UTF8-encoded string plus 1. The P parameter occupies 2 bytes and the signed integer and float parameters occupy 4 bytes each.</p>
<h4 id="M665-Set-delta-configuration"><a href="#M665-Set-delta-configuration" class="headerlink" title="M665: Set delta configuration"></a>M665: Set delta configuration</h4><p>Parameters</p>
<p><code>Lnnn</code> Diagonal rod length</p>
<p><code>Rnnn</code> Delta radius</p>
<p><code>Snnn</code> Segments per second<sup>1</sup></p>
<p><code>Bnnn</code> Safe probing radius<sup>2,3</sup></p>
<p><code>Hnnn</code> Delta height defined as nozzle height above the bed when homed after allowing for endstop corrections <sup>2</sup></p>
<p><code>Xnnn</code> X tower position correction<sup>2,4</sup></p>
<p><code>Ynnn</code> Y tower position correction<sup>2,4</sup></p>
<p><code>Znnn</code> Z tower position correction<sup>2,4</sup></p>
<p><code>Annn</code> X tower diagonal rod trim.<sup>1</sup> (Marlin 2.0.6+)</p>
<p><code>Bnnn</code> Y tower diagonal rod trim.<sup>1</sup> (Marlin 2.0.6+)</p>
<p><code>Cnnn</code> Z tower diagonal rod trim.<sup>1</sup> (Marlin 2.0.6+)</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M665 L250 R160 S200 ; (Marlin)</span><br><span class="line">M665 L250 R160 B80 H240 X0 Y0 Z0 ; (RepRapFirmware and Marlin 1.1.0)</span><br></pre></td></tr></table></figure>

<p>Set the delta calibration variables. (See the discussion page for notes on this implementation.)</p>
<p>Notes</p>
<p><sup>1</sup>Only supported on Marlin.</p>
<p><sup>2</sup>Only supported in RepRapFirmware and Marlin 1.1.0.</p>
<p><sup>3</sup> In Marlin 1.1.0 sets the radius on which the probe points are taken for the delta auto calibration routine G33 as well as for the manual LCD calibration menu.</p>
<p><sup>4</sup>X, Y and Z tower angular offsets from the ideal (i.e. equilateral triangle) positions, in degrees, measured anti-clockwise looking down on the printer. In Marlin 1.1.0 X,Y and Z tower angular offsets will be rotated so the Z tower angular offset is zero.</p>
<h4 id="M666-Set-delta-endstop-adjustment"><a href="#M666-Set-delta-endstop-adjustment" class="headerlink" title="M666: Set delta endstop adjustment"></a>M666: Set delta endstop adjustment</h4><p>Parameters</p>
<p><code>Xnnn</code> X axis endstop adjustment</p>
<p><code>Ynnn</code> Y axis endstop adjustment</p>
<p><code>Znnn</code> Z axis endstop adjustment</p>
<p><code>Annn</code> X bed tilt in percent<sup>1</sup></p>
<p><code>Bnnn</code> Y bed tilt in percent<sup>1</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M666 X-0.1 Y+0.2 Z0</span><br></pre></td></tr></table></figure>

<p>Sets delta endstops adjustments.</p>
<p>In RepRapFirmware and Repetier, positive endstop adjustments move the head closer to the bed when it is near the corresponding tower. In Marlin and Smoothieware, negative endstop corrections move the head closer to the bed when it is near the corresponding tower.</p>
<p>In Marlin, only negative endstop corrections are allowed. From version 1.1.0 onward positive endstops are allowed to be entered but the endstops will be normalized to zero or negative and the residue will be subtracted from the delta height defined in M665.</p>
<p>In Repetier the endstop corrections are expressed in motor steps. In other firmwares they are expressed in mm.</p>
<p><sup>1</sup>RepRapFirmware 1.16 and later.</p>
<h4 id="M667-Select-CoreXY-mode"><a href="#M667-Select-CoreXY-mode" class="headerlink" title="M667: Select CoreXY mode"></a>M667: Select CoreXY mode</h4><p>Parameters</p>
<p><code>Snnn</code> CoreXY mode</p>
<p><code>Xnnn</code> X axis scale factor (RepRapFirmware 2.02 and earlier)</p>
<p><code>Ynnn</code> Y axis scale factor (RepRapFirmware 2.02 and earlier)</p>
<p><code>Znnn</code> Z axis scale factor (RepRapFirmware 2.02 and earlier)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M667 S1</span><br></pre></td></tr></table></figure>

<p><code>M667 S0</code> selects Cartesian mode (unless the printer is configured as a delta using the <code>M665</code> command). Forward motion of the X motor moves the head in the +X direction. Similarly for the Y motor and Y axis, and the Z motor and Z axis. This is the default state of the firmware on power up.</p>
<p><code>M667 S1</code> selects CoreXY mode. Forward movement of the X motor moves the head in the +X and +Y directions. Forward movement of the Y motor moves the head in the -X and +Y directions.</p>
<p><code>M667 S2</code> selects CoreXZ mode. Forward movement of the X motor moves the head in the +X and +Z directions. Forward movement of the Z motor moves the head in the -X and +Z directions.</p>
<p>RepRapFirmware 2.03 and earlier support additional parameters X, Y and Z may be given to specify factors to scale the motor movements by for the corresponding axes. For example, to specify a CoreXZ machine in which the Z axis moves 1&#x2F;3 of the distance of the X axis for the same motor movement, use M667 S2 Z3. The default scaling factor after power up is 1.0 for all axes. In RepRapFirmware 2.03 and later, this functionality is moved to the movement matrix that you can define or alter using the M669 command.</p>
<p>To change the motor directions, see the M569 command.</p>
<h4 id="M668-Set-Z-offset-compensations-polynomial"><a href="#M668-Set-Z-offset-compensations-polynomial" class="headerlink" title="M668: Set Z-offset compensations polynomial"></a>M668: Set Z-offset compensations polynomial</h4><p>Polynomial compensation is an experimental method to compensate for geometric distortion of a delta machine Z-plane. After the bed is compensated with the set of G30 points, there remains error. This method fits a 6th degree polynomial with independent origins for each order to the residual error data (using a simulated annealing technique on the host). The polynomial is communicated and controlled through <code>M668</code>. Because the polynomial takes many floating point operations to compute each point, the firmware builds a grid of values, and used bi-linear interpolation to adjust the actual Z-axis offset error estimate.</p>
<p>For the polynomial used, 40 parameters are specified. The <code>I</code> parameter allows the coefficients to be loaded a few at a time, which limits the size of the G-code string. The index starts with 1, not with 0.</p>
<p><code>M668 Ix S[list of values]</code> sets the polynomial parameters starting at index x, if index present and !&#x3D; 0.</p>
<p><code>M668 R</code> recomputes the grid based on the current parameters.</p>
<p><code>M668 P[0|1]</code> turns off or on the polynomial compensation.</p>
<p>Typical usage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M668 I1 S4.882E-17:0.0</span><br><span class="line">M668 I3 ...</span><br><span class="line">...</span><br><span class="line">M668 R P1</span><br></pre></td></tr></table></figure>

<p>Which sets the list, computes the interpolation grid, and then enables compensation.</p>
<h4 id="M669-Set-kinematics-type-and-kinematics-parameters"><a href="#M669-Set-kinematics-type-and-kinematics-parameters" class="headerlink" title="M669: Set kinematics type and kinematics parameters"></a>M669: Set kinematics type and kinematics parameters</h4><p>Parameters</p>
<p><strong>Knnn</strong> Kinematics type: 0 &#x3D; Cartesian, 1 &#x3D; CoreXY, 2 &#x3D; CoreXZ, 3 &#x3D; linear delta, 4 &#x3D; serial SCARA, 5 &#x3D; CoreXYU, 6 &#x3D; Hangprinter, 7 &#x3D; polar, 8 &#x3D; CoreXYUV, 9 &#x3D; linear delta + Z axis, 10 &#x3D; rotary delta, 11 &#x3D; MarkForged, 12 &#x3D; reserved for Collinear Tripteron</p>
<p>Selects the specified kinematics, then uses the other parameters to configure it. If the K parameter is missing then the other parameters are used to update the configuration data for the current kinematics. If no parameters are given then the current kinematics and configuration parameters are reported</p>
<p>Parameters for generalised Cartesian kinematics (including CoreXY, CoreXZ, MarkForged, CoreXYU etc.)</p>
<p><strong>Xnnn</strong>, <strong>Ynnn</strong>, <strong>Znnn</strong>, <strong>Unnn</strong> etc. (optional) Movement matrix coefficients. For example. <code>X1:-1:0</code> tells the firmware that to move the X axis one unit, the first motor must be moved 1 unit in the forwards direction, the second motor 1 unit in the reverse direction, and the third motor not at all. Using these coefficients, you can specify the kinematics equations for any printer with up to 10 axes for which the movement of each axis is a linear combination of the movements of the individual motors. If these parameters are omitted, the defaults for the specified kinematics (K parameter) will be used.</p>
<p>Parameters for serial SCARA kinematics</p>
<p><strong>Pnnn</strong> Proximal arm length (mm)</p>
<p><strong>Dnnn</strong> Distal arm length (mm)</p>
<p><strong>Annn:nnn</strong> Proximal arm joint movement minimum and maximum angles, in degrees anticlockwise seen from above relative to the X axis</p>
<p><strong>Bnnn:nnn</strong> Proximal-to-distal arm joint movement minimum and maximum angles, in degrees anticlockwise seen from above relative to both arms in line</p>
<p><strong>Cnnn:nnn:nnn</strong> Crosstalk factors. The first component is the proximal motor steps to equivalent distal steps factor, the second is the proximal motor steps to equivalent Z motor steps factor, and the third component is the distal motor steps to equivalent Z motor steps factor.</p>
<p><strong>Snnn</strong> Segments per second if smooth XY motion is approximated by means of segmentation</p>
<p><strong>Tnnn</strong> Minimum segment length (mm) if smooth XY motion is approximated by means of segmentation</p>
<p><strong>Xnnn</strong> X offset of bed origin from proximal joint</p>
<p><strong>Ynnn</strong> Y offset of bed origin from proximal joint</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M669 K4 P300 D250 A-90:90 B-135:135 C0:0:0 S200 X300 Y0</span><br></pre></td></tr></table></figure>

<p>The minimum and maximum arm angles are also the arm angles assumed by the firmware when the homing switches are triggered. The P, D, A and B parameters are mandatory. The C and F parameters default to zero, and the segmentation parameters default to firmware-dependent values.</p>
<p>Parameters for Polar kinematics</p>
<p><strong>Raaa:bbb</strong> Minimum and maximum radius in mm. If only one value it given it will be used as the maximum radius, and the minimum radius will be assumed to be zero.  </p>
<p><strong>Hnnn</strong> Radius in mm at which the homing switch is triggered during a homing move. If this parameter is not present, the homing switch is assumed to trigger at the minimum radius.  </p>
<p><strong>Fnnn</strong> Maximum turntable speed in degrees per second</p>
<p><strong>Annn</strong> Maximum turntable acceleration in degrees per second per second</p>
<p><strong>Snnn</strong>, <strong>Tnnn</strong> As for serial SCARA kinematics</p>
<h4 id="M670-Set-IO-port-bit-mapping"><a href="#M670-Set-IO-port-bit-mapping" class="headerlink" title="M670: Set IO port bit mapping"></a>M670: Set IO port bit mapping</h4><p>Parameters</p>
<p><strong>Pnn:nn:nn…</strong> List of logical port numbers that bits 0, 1, 2… control</p>
<p><strong>Tnnn</strong> port switching time advance in milliseconds</p>
<p>RepRapFirmware 1.19 and later provides an optional P parameter on the G1 command to allow I&#x2F;O ports to be set to specified states for the duration of the move. The argument to the P parameter is a bitmap giving the required state of each port. The M669 command specifies the mapping between the bits of that argument and logical port numbers. Optionally, the T parameter can be used to advance the I&#x2F;O port switching a short time before the corresponding move begins.</p>
<h4 id="M671-Define-positions-of-Z-leadscrews-or-bed-leveling-screws"><a href="#M671-Define-positions-of-Z-leadscrews-or-bed-leveling-screws" class="headerlink" title="M671: Define positions of Z leadscrews or bed leveling screws"></a>M671: Define positions of Z leadscrews or bed leveling screws</h4><p>Parameters</p>
<p><strong>Xnn:nn:nn…</strong> List of between 2 and 4 X coordinates of the leadscrews that drive the Z axis or the bed leveling screws</p>
<p><strong>Ynn:nn:nn…</strong> List of between 2 and 4 Y coordinates of the leadscrews that drive the Z axis or the bed leveling screws</p>
<p><strong>Snn</strong> Maximum correction to apply to each leadscrew in mm (optional, default 1.0)</p>
<p><strong>Pnnn</strong> Pitch of the bed leveling screws (not used when bed leveling using independently-driven leadscrews). Defaults to 0.5mm which is correct for M3 bed leveling screws.</p>
<p>Example</p>
<p>M671 X-15.0:100.0:215.0 Y220.0:-20.0:220.0  ; Z leadscrews are at (-15,220), (100,-20) and (215,220)</p>
<p>Informs the firmware of the positions of the leadscrews used to raise&#x2F;lower the bed or gantry. The numbers of X and Y coordinates must both be equal to the number of drivers used for the Z axis (see the M584 command). This allows the firmware to perform bed leveling by adjusting the leadscrew motors individually after bed probing.</p>
<p>For machines without multiple independently-driven Z leadscrews, this command can be used to define the positions of the bed leveling screws instead. Then bed probing can be used to calculate and display the adjustment required to each screw to level the bed. The thread pitch (P parameter) is used to translate the height adjustment needed to the number of turns of the leveling screws.</p>
<h4 id="M672-Program-Z-probe"><a href="#M672-Program-Z-probe" class="headerlink" title="M672: Program Z probe"></a>M672: Program Z probe</h4><p>Parameters</p>
<p><strong>Snn:nn:nn…</strong> Sequence of 8-bit unsigned values to send to the currently-selected Z probe</p>
<p>Example</p>
<p>M671 S50:205</p>
<p>This command is for sending configuration data to programmable Z probes such as the Duet3D delta effector. The specified command bytes are sent to the probe. The Duet3D probe stores the configuration data in non-volatile memory, so there is no need to send this command every time the probe is used.</p>
<h4 id="M673-Align-plane-on-rotary-axis"><a href="#M673-Align-plane-on-rotary-axis" class="headerlink" title="M673: Align plane on rotary axis"></a>M673: Align plane on rotary axis</h4><p>Parameters</p>
<p><strong>U,V,W,A,B,C</strong> Rotary axis letter on which the plane is mounted</p>
<p><strong>Pnnn</strong> Factor to multiply the correction angle (degrees) with (defaults to 1)</p>
<p>Example</p>
<p>M673 A</p>
<p>This code is intended to align a plane that is mounted on a rotary axis. To make use of this code it is required to take two probe points via G30 P first. Supported in RepRapFirmware 2.02 and later.</p>
<h4 id="M674-Set-Z-to-center-point"><a href="#M674-Set-Z-to-center-point" class="headerlink" title="M674: Set Z to center point"></a>M674: Set Z to center point</h4><p>This code is intended to determine the Z center point of a stash that is mounted on a rotary axis. This code is yet to be implemented.</p>
<h4 id="M675-Find-center-of-cavity"><a href="#M675-Find-center-of-cavity" class="headerlink" title="M675: Find center of cavity"></a>M675: Find center of cavity</h4><p>Parameters</p>
<p><strong>X,Y,Z</strong> Axis to probe on</p>
<p><strong>Fnnnn</strong> Probing feedrate</p>
<p><strong>Rnnn</strong> Distance to move away from the lower endstop before the next probing move starts</p>
<p>Example</p>
<p>M675 X R2 F1200</p>
<p>This code is intended to find the center of a cavity that can be measured using the configured axis endstop. If using a Z probe for this purpose, make sure the endstop type for the corresponding axis is updated before this code is run. Once this code starts, RepRapFirmware will move to the lower end looking for an endstop to be triggered. Once it is triggered, the lower position is saved and the axis maximum is probed. As soon as both triggers have been hit, the center point is calculated and the machine moves to the calculated point.</p>
<h4 id="M700-Level-plate"><a href="#M700-Level-plate" class="headerlink" title="M700: Level plate"></a>M700: Level plate</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M700</span><br></pre></td></tr></table></figure>

<p>Script to adjust the plate level.</p>
<h4 id="M701-Load-filament"><a href="#M701-Load-filament" class="headerlink" title="M701: Load filament"></a>M701: Load filament</h4><p>Initiate a filament load. <em>This command can be used without any additional parameters.</em></p>
<p>Parameters</p>
<p><code>Snn</code> Filament to load (RepRapFirmware)</p>
<p><code>Tnn</code> Tool to load (Marlin)</p>
<p><code>Lnn</code> Length to use for load (Marlin)</p>
<p><code>Znn</code> Z raise to perform (Marlin)</p>
<p>With no parameters</p>
<ul>
<li>RepRapFirmware will report the name of the loaded filament (if any).</li>
<li>Marlin Firmware initiates a Filament Load.</li>
</ul>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M701</span><br><span class="line">M701 S&quot;PLA&quot; ; Only in RepRapFirmware</span><br><span class="line">M701 T0     ; Only in Marlin.</span><br></pre></td></tr></table></figure>

<p>RepRapFirmware 1.19 and later implement a filament management mechanism to load and unload different materials. This code may be used to load a material for the active tool, however be aware that this code will work only for tools that have exactly one extruder assigned. When called RepRapFirmware will…</p>
<ol>
<li>Run the macro file “load.g” in the subdirectory of the given material (e.g. &#x2F;filaments&#x2F;PLA&#x2F;load.g)</li>
<li>Change the filament name of the associated tool, so it can be reported back to Duet Web Control</li>
</ol>
<h4 id="M702-Unload-filament"><a href="#M702-Unload-filament" class="headerlink" title="M702: Unload filament"></a>M702: Unload filament</h4><p>Initiate a filament unload. <em>This command can be used without any additional parameters.</em> In contrast to <code>M701</code> this code is intended to unload the previously loaded filament from the selected tool.</p>
<p>Parameters</p>
<p><code>Tnn</code> Tool to load (Marlin)</p>
<p><code>Unn</code> Length to use for unload (Marlin &amp; Prusa Firmware)</p>
<p><code>Znn</code> Z raise to perform (Marlin &amp; Prusa Firmware)</p>
<p><code>Cnn</code> Unload the (current) filament only if the MMU is used in Prusa Firmware till version 3.12.2</p>
<p>In response to <code>M702</code> RepRapFirmware will do the following:</p>
<ol>
<li>Run the macro file “unload.g” in the subdirectory of the given material (e.g. <code>/filaments/PLA/unload.g</code>)</li>
<li>Change the filament name of the current tool, so it can be reported back to Duet Web Control</li>
</ol>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M702         ; Unload filament as previously configured</span><br><span class="line">M702 U420 Z2 ; Unload 420mm (Marlin &amp; Prusa Firmware) with a Z raise of 2mm</span><br></pre></td></tr></table></figure>

<h4 id="M703-Configure-Filament"><a href="#M703-Configure-Filament" class="headerlink" title="M703: Configure Filament"></a>M703: Configure Filament</h4><ol>
<li>In RepRapFirmware this code is used to apply the configuration of a previously loaded filament (see M701). All it does is run <code>/filaments/&lt;loaded filament&gt;/config.g</code> which may contain codes to set parameters like extrusion factor, retraction distances and temperatures. If no filament is assigned to the current tool, this code will not generate a warning.</li>
</ol>
<p>If the filaments feature is used, it is recommended to put this code into <code>tpost*.g</code> to ensure the right filament parameters are set. Supported in RepRapFirmware 2.02 and newer.</p>
<h4 id="M704-Preload-to-MMU"><a href="#M704-Preload-to-MMU" class="headerlink" title="M704: Preload_to_MMU"></a>M704: Preload_to_MMU</h4><p>Preload filament to MMU can be used to manually load the filament into the MMU.</p>
<p>The MMU will engage the slot and turn the MMU idler pulley until the filament is pushed to the FINDA.</p>
<p>A second unload&#x2F;load check ensures that the filament is preloaded correctly to the MMU.</p>
<p>Usage</p>
<p><code> M704 [P]</code></p>
<p>Parameters</p>
<p><code>Pnn</code> Index of slot (zero based from 0 to 4)</p>
<p>With no parameters</p>
<p>Does nothing if the <code>P</code> parameter is not present or if MMU is not enabled.</p>
<p>Examples</p>
<p><code>M704 P0</code>  ;Start preload procedure at slot 0</p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Support for MK4 with MMU TBA<sup>2</sup></p>
<h4 id="M705-Eject-filament"><a href="#M705-Eject-filament" class="headerlink" title="M705: Eject filament"></a>M705: Eject filament</h4><p>Eject filament on MMU moves the selector away from the selected slot and pushes some mm of filament towards the front. This is useful to inspect the filament for indents and other issues.</p>
<p><strong>Attention: User interaction is needed to confirm on LCD or MMU button that the inspection, maintenance, … is done! Printer WILL NOT accept any other gcode.</strong></p>
<p>Usage</p>
<p><code> M705 [P]</code></p>
<p>Parameters</p>
<p><code>Pnn</code> Index of slot (zero based from 0 to 4)</p>
<p>With no parameters</p>
<p>Does nothing if the <code>P</code> parameter is not present or if MMU is not enabled.</p>
<p>Examples</p>
<p><code>M705 P0</code>  ;Eject filament at slot 0</p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Support for MK4 with MMU TBA<sup>2</sup></p>
<h4 id="M706-Cut-filament"><a href="#M706-Cut-filament" class="headerlink" title="M706: Cut filament"></a>M706: Cut filament</h4><p>Preload filament to MMU can be used to manually load the filament into the MMU.</p>
<p>The MMU will engage the slot and turn the MMU Idler pulley until the filament is pushed to the FINDA.</p>
<p>A second unload&#x2F;load check ensures that the filament is preloaded correctly to the MMU.</p>
<p>Usage</p>
<p><code> M706 [P]</code></p>
<p>Parameters</p>
<p><code>Pnn</code> Index of slot (zero based from 0 to 4)</p>
<p>With no parameters</p>
<p>Does nothing if the <code>P</code> parameter is not present or if MMU is not enabled.</p>
<p>Examples</p>
<p><code>M706 P0</code>  ;Cut filament at slot 0</p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Support for MK4 with MMU TBA<sup>2</sup></p>
<h4 id="M707-Read-from-MMU-register"><a href="#M707-Read-from-MMU-register" class="headerlink" title="M707: Read from MMU register"></a>M707: Read from MMU register</h4><p>Reads the MMU register.</p>
<p>Usage</p>
<p><code> M707 [A]</code></p>
<p>Parameters</p>
<p><code>A0xnn</code> Address of register in hexadecimal.</p>
<p>With no parameters</p>
<p>Does nothing if the <code>A</code> parameter is not present or if MMU is not enabled.</p>
<p>Examples</p>
<p><code>M707 A0x1b</code>  ;Read a 8bit integer from register 0x1b and prints the result onto the serial line.</p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Support for MK4 with MMU TBA<sup>2</sup></p>
<h4 id="M708-Write-to-MMU-register"><a href="#M708-Write-to-MMU-register" class="headerlink" title="M708: Write to MMU register"></a>M708: Write to MMU register</h4><p>Write to the MMU register.</p>
<p>Usage</p>
<p><code> M708 [A | X]</code></p>
<p>Parameters</p>
<p><code>A0xnn</code> Address of register in hexadecimal.</p>
<p><code>Xnnnn</code> Data to write (16-bit integer). Default value 0.</p>
<p>With no parameters</p>
<p>Does nothing if the <code>A</code> parameter is not present or if MMU is not enabled.</p>
<p>Examples</p>
<p><code>M708 A0x1b X05</code>  ;Write to register 0x1b the value 05.</p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Support for MK4 with MMU TBA<sup>2</sup></p>
<h4 id="M709-MMU-power-reset"><a href="#M709-MMU-power-reset" class="headerlink" title="M709: MMU power &amp; reset"></a>M709: MMU power &amp; reset</h4><p>The MK3S cannot not power off the MMU, but we can en- and disable the MMU and will be also stored in EEPROM.</p>
<p>The new state of the MMU is stored in printer’s EEPROM - i.e. if you disable the MMU via M709, it will not be activated after the printer resets.</p>
<p>Usage</p>
<p><code> M709 [S|X]</code></p>
<p>Parameters</p>
<p><code>Xnnnn</code> Reset MMU (0:soft reset | 1:hardware reset | 42: erase MMU eeprom)</p>
<p><code>Snnnn</code> En-&#x2F;disable the MMU (0:off | 1:on)</p>
<p>Examples</p>
<p><code>M709 X0</code>  ;issue an X0 command via communication into the MMU (soft reset)</p>
<p><code>M709 X1</code>  ;toggle the MMU’s reset pin (hardware reset)</p>
<p><code>M709 X42</code>  ;erase MMU EEPROM</p>
<p><code>M709 S1</code>  ;enable MMU</p>
<p><code>M709 S0</code>  ;disable MMU</p>
<p><code>M709</code>  ;Serial message if en- or disabled <sup>1</sup></p>
<p>Supported on Prusa MK3S+ from firmware version 3.13.0 with MMU firmware 2.1.9 and newer. <sup>1</sup></p>
<p>Supported on Prusa MK4 from firmware version 5.1.0 with MMU firmware 3.0.1 and newer. <sup>2</sup></p>
<h4 id="M710-Firmware-dependent"><a href="#M710-Firmware-dependent" class="headerlink" title="M710: Firmware dependent"></a>M710: Firmware dependent</h4><h5 id="M710-Controller-Fan-settings"><a href="#M710-Controller-Fan-settings" class="headerlink" title="M710: Controller Fan settings"></a>M710: Controller Fan settings</h5><p>Parameters</p>
<p><em>With no parameters, report current settings.</em></p>
<p><code>A[bool]</code> Turn Auto Mode on or off.</p>
<p><code>Snnn</code> Set the Active Speed (0-255) used when motors are enabled.</p>
<p><code>Innn</code> Set the Idle Speed (0-255) used when motors are disabled.</p>
<p><code>Dnnn</code> Set the Idle Duration (seconds) to keep the fan running after motors are disabled.</p>
<p><code>R</code> Reset to defaults.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M710 S200 ; Set &quot;active&quot; fan speed to 200</span><br></pre></td></tr></table></figure>

<h5 id="M710-Erase-the-EEPROM-and-reset-the-board"><a href="#M710-Erase-the-EEPROM-and-reset-the-board" class="headerlink" title="M710: Erase the EEPROM and reset the board"></a>M710: Erase the EEPROM and reset the board</h5><p>This command only exists in a defunct bq fork of Marlin Firmware.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M710</span><br></pre></td></tr></table></figure>

<h4 id="M711-Calibrate-pressure-advance"><a href="#M711-Calibrate-pressure-advance" class="headerlink" title="M711: Calibrate pressure advance"></a>M711: Calibrate pressure advance</h4><h4 id="M750-Enable-3D-scanner-extension"><a href="#M750-Enable-3D-scanner-extension" class="headerlink" title="M750: Enable 3D scanner extension"></a>M750: Enable 3D scanner extension</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M750</span><br></pre></td></tr></table></figure>

<p>This code may be used as an OEM extension to enable scanner functionality in the firmware. After a regular start of RepRapFirmware, the 3D scan extension is disabled by default, but if additional scanner components are attached, this code may be used to enable certain OEM functions.</p>
<h4 id="M751-Register-3D-scanner-extension-over-USB"><a href="#M751-Register-3D-scanner-extension-over-USB" class="headerlink" title="M751: Register 3D scanner extension over USB"></a>M751: Register 3D scanner extension over USB</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M751</span><br></pre></td></tr></table></figure>

<p>When a 3D scanner board is attached to the USB port, this code is used to turn on communication between the 3D printing and the scanner board. If the USB connection is removed while the 3D scanner configuration is active, the firmware will disable it again and restore the default communication parameters.</p>
<h4 id="M752-Start-3D-scan"><a href="#M752-Start-3D-scan" class="headerlink" title="M752: Start 3D scan"></a>M752: Start 3D scan</h4><p>Parameters</p>
<p><code>Snnn</code>: Length&#x2F;degrees of the scan</p>
<p><code>Rnnn</code>: Resolution (new in RRF 2.0) [optional, defaults to 100]</p>
<p><code>Nnnn</code>: Scanner mode (new in RRF 2.0) [optional, 0&#x3D;Linear (default), 1&#x3D;Rotary]</p>
<p><code>Pnnn</code>: Filename for the scan</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M752 S300 Pmyscan</span><br></pre></td></tr></table></figure>

<p>Instruct the attached 3D scanner to initiate a new 3D scan and to upload it to the board’s SD card (i.e. in the “scans” directory). Before the SCAN command is sent to the scanner, the macro file “scan_pre.g” is executed and when the scan has finished, the macro file “scan_post.g” is run. Be aware that both files must exist to avoid error messages.</p>
<h4 id="M753-Cancel-current-3D-scanner-action"><a href="#M753-Cancel-current-3D-scanner-action" class="headerlink" title="M753: Cancel current 3D scanner action"></a>M753: Cancel current 3D scanner action</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M753</span><br></pre></td></tr></table></figure>

<p>Instruct the attached 3D scanner to cancel the current operation. Cancelling uploads is not supported.</p>
<h4 id="M754-Calibrate-3D-scanner"><a href="#M754-Calibrate-3D-scanner" class="headerlink" title="M754: Calibrate 3D scanner"></a>M754: Calibrate 3D scanner</h4><p>Parameters</p>
<p><strong>Nnnn</strong> Calibration mode (0&#x3D;linear [default], 1&#x3D;rotary)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M754</span><br></pre></td></tr></table></figure>

<p>Calibrates the attached 3D scanner. Before the calibration is performed by the external scanner, “calibrate_pre.g” is run and when it is complete, “calibrate_post.g” is executed.</p>
<h4 id="M755-Set-alignment-mode-for-3D-scanner"><a href="#M755-Set-alignment-mode-for-3D-scanner" class="headerlink" title="M755: Set alignment mode for 3D scanner"></a>M755: Set alignment mode for 3D scanner</h4><p>Parameters</p>
<p><code>Pnnn</code> Whether to turn on (&gt; 0) or off (&lt;&#x3D; 0) the alignment feature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M755 P1</span><br><span class="line">M755 P0</span><br></pre></td></tr></table></figure>

<p>Sends the ALIGN ON&#x2F;OFF command the attached 3D scanner. Some devices turn on a laser when this command is received. If the ‘P’ parameter is missing, equal to, or less than 0, the alignment feature is turned off. Depending on whether the alignment is turned on or off, either align_on.g or align_off.g is executed before the ALIGN command is sent to the scanner.</p>
<h4 id="M756-Shutdown-3D-scanner"><a href="#M756-Shutdown-3D-scanner" class="headerlink" title="M756: Shutdown 3D scanner"></a>M756: Shutdown 3D scanner</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M756</span><br></pre></td></tr></table></figure>

<p>Sends the SHUTDOWN command the attached 3D scanner.</p>
<h4 id="M800-Fire-start-print-procedure"><a href="#M800-Fire-start-print-procedure" class="headerlink" title="M800: Fire start print procedure"></a>M800: Fire start print procedure</h4><p><sup>1</sup> only in bq-Marlin Firmware</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M800</span><br></pre></td></tr></table></figure>

<h4 id="M801-Fire-end-print-procedure"><a href="#M801-Fire-end-print-procedure" class="headerlink" title="M801: Fire end print procedure"></a>M801: Fire end print procedure</h4><p><sup>1</sup> only in bq-Marlin Firmware</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M801</span><br></pre></td></tr></table></figure>

<h4 id="M808-Set-or-Goto-Repeat-Marker"><a href="#M808-Set-or-Goto-Repeat-Marker" class="headerlink" title="M808: Set or Goto Repeat Marker"></a>M808: Set or Goto Repeat Marker</h4><p>The <code>M808 L[count]</code> command is used in a G-code file to set a Repeat Marker beginning at the start of the following line. For an SD print, the firmware will save a marker with the file’s byte position and the count given by the <code>L</code> parameter. To set an infinite loop use <code>L0</code>. To terminate an infinite loop from the host, <code>M808 K</code> will cancel all current loops.</p>
<p>The <code>M808</code> command (no parameters) will cause G-code processing to loop back to the previous Repeat Marker as many times as specified. Ideally, each instance of <code>M808 L</code> should have a corresponding <code>M808</code>.</p>
<p>The number of nested <code>M808 L</code> commands is limited to the depth set in the firmware. To enable this feature in Marlin, define <code>GCODE_REPEAT_MARKERS</code>. Hosts should look for <code>Cap:REPEAT</code>. At this time the feature only applies to printing direct from media and otherwise <code>M808</code> is ignored, so host developers are free to come up with their own approach to these codes with no nesting limit and make it work with any old firmware.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">M808 L10        ; Set Marker to repeat 10 times</span><br><span class="line">M300 P100 S440  ; Beep!</span><br><span class="line">M300 P10 S0     ; Silence</span><br><span class="line">M808            ; End Marker</span><br></pre></td></tr></table></figure>

<p>RepRapFirmware processes M808 as follows:</p>
<p>- <strong>M808 S{<em>ccc</em>}</strong> translates into <strong>while <em>ccc</em></strong> followed by block begin. <em>ccc</em> must yield <em>true</em> or <em>false</em>. For more on while-loops and expressions in RepRapFirmware, see <a target="_blank" rel="noopener" href="https://duet3d.dozuki.com/Wiki/GCode_Meta_Commands">https://duet3d.dozuki.com/Wiki/GCode_Meta_Commands</a>.</p>
<p>- <strong>M808 L<em>nn</em></strong> is equivalent to <strong>M808 S{<em>nn</em> &#x3D;&#x3D; 0 || iterations &lt; <em>nn</em>}</strong>.</p>
<p>- <strong>M808</strong> without S or L parameter ends the block.</p>
<p>- As usual, predefined constant <em>iterations</em> reports the number of completed iterations of the innermost loop.</p>
<p>- <strong>M808</strong> without S or L parameter when not inside a loop, or any M808 command in an input stream other than a SD print file, gives rise to an error message.</p>
<h5 id="M808-in-Marlin-2-0-8"><a href="#M808-in-Marlin-2-0-8" class="headerlink" title="M808 in Marlin 2.0.8"></a>M808 in Marlin 2.0.8</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M808 L         ; Set marker to repeat infinitely</span><br><span class="line">M300 P100 S440 ; Beep!</span><br><span class="line">M300 P10 S0    ; Silence</span><br><span class="line">M808           ; End marker</span><br><span class="line">M808 K         ; Sent from host to cancel the loop</span><br></pre></td></tr></table></figure>

<h4 id="M810-M819-Temporary-G-code-macros"><a href="#M810-M819-Temporary-G-code-macros" class="headerlink" title="M810-M819: Temporary G-code macros"></a>M810-M819: Temporary G-code macros</h4><p>Use the <code>M810</code>-<code>M819</code> commands to set and execute 10 distinct G-code “macros.” Any G-code following the command defines the macro. To run the macro just send <code>M810</code>-<code>M819</code> by itself. Multiple commands must be separated by the pipe character (‘|’). To run a defined macro type <code>M810</code>-<code>M819</code> with no comments.</p>
<p>These macros do not persist after shutdown. They are intended to be defined and used within a print session.</p>
<p>Define the <code>M815</code> macro to do some moves and make a beep:</p>
<p>Example</p>
<p><code>M815 G0 X0 Y0|G0 Z10|M300 S440 P50</code></p>
<p>Running the macro</p>
<p><code>M815</code></p>
<h4 id="M820-Report-Temporary-G-code-macros"><a href="#M820-Report-Temporary-G-code-macros" class="headerlink" title="M820: Report Temporary G-code macros"></a>M820: Report Temporary G-code macros</h4><p>Send <code>M820</code> to get a report of the macros defined by <code>M810</code>-<code>M819</code>.</p>
<h4 id="M850-Sheet-parameters"><a href="#M850-Sheet-parameters" class="headerlink" title="M850: Sheet parameters"></a>M850: Sheet parameters</h4><p>Get and Set Sheet parameters</p>
<p>Usage</p>
<p><code>M850 [ S | Z | L | B | P | A ]</code></p>
<p>Parameters</p>
<p><code>S</code> Sheet id [0-7]</p>
<p><code>Z</code> Z offset</p>
<p><code>L</code> Label [aA-zZ, 0-9 max 7 chars]</p>
<p><code>B</code> Bed temp</p>
<p><code>P</code> PINDA temp</p>
<p><code>A</code> Active [0|1]</p>
<h4 id="M851-Set-Z-Probe-Offset"><a href="#M851-Set-Z-Probe-Offset" class="headerlink" title="M851: Set Z-Probe Offset"></a>M851: Set Z-Probe Offset</h4><p>Sets the Z-probe Z offset. This offset is used to determine the actual Z position of the nozzle when using a probe to home Z with <code>G28</code>. This value may also be used by <code>G29</code> to apply correction to the Z position.</p>
<p>This value represents the distance from nozzle to the bed surface at the point where the probe is triggered. This value will be negative for typical switch probes, inductive probes, and setups where the nozzle makes a circuit with a raised metal contact. This setting will be greater than zero on machines where the nozzle itself is used as the probe, pressing down on the bed to press a switch (this is a common setup on Delta machines).</p>
<p>This setting is saved in the EEPROM by M500 and restored by <code>M501</code>. The default (as reset by <code>M502</code>) is set by the <code>Z_PROBE_OFFSET_FROM_EXTRUDER</code> setting in Configuration.h.</p>
<p>Note that in Marlin 1.1.0 and later <code>M851</code> sets the value literally as given, while Marlin 1.0.2 negates the absolute value.</p>
<p>The examples below will set the Z-probe Z offset to -4 mm (below the nozzle):</p>
<h5 id="M851-in-Marlin-1-0-2"><a href="#M851-in-Marlin-1-0-2" class="headerlink" title="M851 in Marlin 1.0.2"></a>M851 in Marlin 1.0.2</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M851 Z4 ; Set the Z probe offset to -4</span><br></pre></td></tr></table></figure>

<h5 id="M851-in-Marlin-1-1-0"><a href="#M851-in-Marlin-1-1-0" class="headerlink" title="M851 in Marlin 1.1.0"></a>M851 in Marlin 1.1.0</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M851 Z-4 ; Set the Z probe offset to -4</span><br></pre></td></tr></table></figure>

<h5 id="M851-in-Marlin-2-0-0"><a href="#M851-in-Marlin-2-0-0" class="headerlink" title="M851 in Marlin 2.0.0"></a>M851 in Marlin 2.0.0</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M851 X-22 Y3 Z-4 ; Set the probe XYZ offsets</span><br></pre></td></tr></table></figure>

<h5 id="M851-in-MK4duo-4-3-25"><a href="#M851-in-MK4duo-4-3-25" class="headerlink" title="M851 in MK4duo 4.3.25"></a>M851 in MK4duo 4.3.25</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M851 X2 Y-5 Z-4 ; Set the probe offset to X=2, Y=-5 and Z=-4</span><br></pre></td></tr></table></figure>

<h5 id="M851-in-RepRapFirmware-2-02-and-later"><a href="#M851-in-RepRapFirmware-2-02-and-later" class="headerlink" title="M851 in RepRapFirmware 2.02 and later"></a>M851 in RepRapFirmware 2.02 and later</h5><p>M851 Znn is implemented for backwards compatibility with other firmwares. It sets the Z probe trigger in the same way as G31 Z-nn (note the sign reversal). It also flags the Z-probe G31 parameters as to be saved in config-override.g if the M500 command is used.</p>
<h4 id="M855-Set-Axis-Length"><a href="#M855-Set-Axis-Length" class="headerlink" title="M855 Set Axis Length"></a>M855 Set Axis Length</h4><p>Parameters</p>
<p><code>Xnnnn</code> Sets X axis length</p>
<p><code>Ynnnn</code> Sets Y axis length</p>
<p><code>Znnnn</code> Sets Z axis length</p>
<h4 id="M860-Wait-for-Probe-Temperature"><a href="#M860-Wait-for-Probe-Temperature" class="headerlink" title="M860 Wait for Probe Temperature"></a>M860 Wait for Probe Temperature</h4><p>Parameters</p>
<p><code>Snnnn</code> Target temperature</p>
<p>Notes</p>
<p>In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Prusa_Firmware" title="Prusa Firmware">Prusa Firmware</a> this command will wait for the PINDA thermistor to reach a target temperature.</p>
<h4 id="M861-Set-Probe-Thermal-Compensation"><a href="#M861-Set-Probe-Thermal-Compensation" class="headerlink" title="M861 Set Probe Thermal Compensation"></a>M861 Set Probe Thermal Compensation</h4><p>Parameters</p>
<p><code>?</code> Print current EEPROM offset values</p>
<p><code>!</code> Set factory default values</p>
<p><code>Z</code> Set all values to 0 (effectively disabling PINDA temperature compensation)</p>
<p><code>S</code> Microsteps</p>
<p><code>I</code> Table index</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M861 ?</span><br></pre></td></tr></table></figure>

<p>Results</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PINDA cal status: 1</span><br><span class="line">index, temp, ustep, um</span><br><span class="line">n/a, 35, 0, 0.00</span><br><span class="line">0, 40, 0, 0.00</span><br><span class="line">1, 45, 0, 0.00</span><br><span class="line">2, 50, 0, 0.00</span><br><span class="line">3, 55, 0, 0.00</span><br><span class="line">4, 60, 0, 0.00</span><br></pre></td></tr></table></figure>

<p>Notes</p>
<p>In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Prusa_Firmware" title="Prusa Firmware">Prusa Firmware</a> this command will set &#x2F; read the PINDA temperature compensation offsets.</p>
<h4 id="M862-Print-checking"><a href="#M862-Print-checking" class="headerlink" title="M862: Print checking"></a>M862: Print checking</h4><p>Checks the parameters of the printer and gcode and performs compatibility check</p>
<h5 id="M862-1-Check-nozzle-diameter"><a href="#M862-1-Check-nozzle-diameter" class="headerlink" title="M862.1: Check nozzle diameter"></a>M862.1: Check nozzle diameter</h5><p>Parameters</p>
<p><code>Pnnnn</code> nnnn &#x3D; Nozzle diameter 0.25 &#x2F;0.40 &#x2F;0.60</p>
<p><code>Q</code> Current nozzle diameter</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>Example messages</p>
<p><code>warn</code> <em>Printer nozzle diameter differs from the G-code. Continue?</em></p>
<p><code>strict</code> <em>Printer nozzle diameter differs from the G-code. Please check the value in settings. Print cancelled.</em></p>
<h5 id="M862-2-Check-model-code"><a href="#M862-2-Check-model-code" class="headerlink" title="M862.2: Check model code"></a>M862.2: Check model code</h5><p>Parameters</p>
<p><code>Pnnnn</code> nnnn &#x3D; Prusa model</p>
<p><code>Q</code> Current model</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>Accepted printer type identifiers and their numeric counterparts:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- MK1         (100)</span><br><span class="line">- MK2         (200)       </span><br><span class="line">- MK2MM       (201)     </span><br><span class="line">- MK2S        (202)      </span><br><span class="line">- MK2SMM      (203)    </span><br><span class="line">- MK2.5       (250)     </span><br><span class="line">- MK2.5MMU2   (20250) </span><br><span class="line">- MK2.5S      (252)    </span><br><span class="line">- MK2.5SMMU2S (20252)</span><br><span class="line">- MK3         (300)</span><br><span class="line">- MK3MMU2     (20300)</span><br><span class="line">- MK3S        (302)</span><br><span class="line">- MK3SMMU2S   (20302)</span><br></pre></td></tr></table></figure>

<p>Example messages</p>
<p><code>warn</code> <em>G-code sliced for a different printer type. Continue?</em></p>
<p><code>strict</code> <em>G-code sliced for a different printer type. Please re-slice the model again. Print cancelled.</em></p>
<h5 id="M862-3-Model-name"><a href="#M862-3-Model-name" class="headerlink" title="M862.3: Model name"></a>M862.3: Model name</h5><p>Parameters</p>
<p><code>P&quot;nnnn&quot;</code> nnnn &#x3D; Prusa model name</p>
<p><code>Q</code> Current model name</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>It accepts text identifiers of printer types too. The syntax of M862.3 is (note the quotes around the type):</p>
<p><code>M862.3 P &quot;MK3S&quot;</code></p>
<p>Example messages</p>
<p><code>warn</code> <em>G-code sliced for a different printer type. Continue?</em></p>
<p><code>strict</code> <em>G-code sliced for a different printer type. Please re-slice the model again. Print cancelled.</em></p>
<h5 id="M862-4-Firmware-version"><a href="#M862-4-Firmware-version" class="headerlink" title="M862.4: Firmware version"></a>M862.4: Firmware version</h5><p>Parameters</p>
<p><code>Pnnnn</code> nnnn &#x3D; Prusa firmware version</p>
<p><code>Q</code> Current firmware version</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>Example messages</p>
<p><code>warn</code> <em>G-code sliced for a newer firmware. Continue?</em></p>
<p><code>strict</code> <em>G-code sliced for a newer firmware. Please update the firmware. Print cancelled.</em></p>
<h5 id="M862-5-Gcode-level"><a href="#M862-5-Gcode-level" class="headerlink" title="M862.5: Gcode level"></a>M862.5: Gcode level</h5><p>Parameters</p>
<p><code>Pnnnn</code> nnnn &#x3D; Gcode level</p>
<p><code>Q</code> Current Gcode level</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>Example messages</p>
<p><code>warn</code> <em>G-code sliced for a different level. Continue?</em></p>
<p><code>strict</code> <em>G-code sliced for a different level. Please re-slice the model again. Print cancelled.</em></p>
<h5 id="M862-6-Firmware-features"><a href="#M862-6-Firmware-features" class="headerlink" title="M862.6: Firmware features"></a>M862.6: Firmware features</h5><p>Parameters</p>
<p><code>P&quot;cccc&quot;</code> cccc &#x3D; Firmware Features</p>
<p><code>Q</code> Current Firmware Features</p>
<p>When run with P&lt;&gt; argument, the check is performed against the input value. When run with Q argument, the current value is shown.</p>
<p>Example messages</p>
<p><code>always</code> <em>G-code isn’t fully compatible. misssing requested features: Input shaper Abort.</em></p>
<h4 id="M871-PTC-Configuration"><a href="#M871-PTC-Configuration" class="headerlink" title="M871: PTC Configuration"></a>M871: PTC Configuration</h4><p><code>M871</code> allows you to modify the Z adjustments corresponding to temperatures.</p>
<p>Parameters</p>
<p><code>B</code> Set the Z adjustment for bed temperature</p>
<p><code>P</code> Set the Z adjustment for probe temperature</p>
<p><code>E</code> Set the Z adjustment for extruder temperature</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M871 B V0.1 I3  ; Set Z adjustment for bed temp index 3 to 0.1</span><br><span class="line">M871 E V-1 I2   ; Set Z adjustment for extruder temp index 3 to -1</span><br></pre></td></tr></table></figure>

<h4 id="M876-Dialog-handling"><a href="#M876-Dialog-handling" class="headerlink" title="M876: Dialog handling"></a>M876: Dialog handling</h4><p>Parameters</p>
<p><code>Pnnn</code> signal support for dialog creation on the host &#x3D; 1, disable &#x3D; 0</p>
<p><code>Snnn</code> select dialog option nnn (0 based)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M876 P1</span><br><span class="line">M876 S1</span><br></pre></td></tr></table></figure>

<p><code>M876 S&lt;n&gt;</code> allows selecting an option of a prompt on a connected host created by the firmware through the corresponding action commands, see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-code#Action_commands" title="G-code">G-code#Action_commands</a>. The S parameter is the 0-based index of the chosen option - 0 for the first option provided by the firmware, 1 for the second and so on.</p>
<p>Example: A prompt with three options defined via the firmware and completed by the host by selecting the second option (“Home X&#x2F;Y and pause print”)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt; //action:prompt_begin Filament runout detected. Please choose how to proceed:</span><br><span class="line">&lt;&lt;&lt; //action:prompt_choice Swap filament</span><br><span class="line">&lt;&lt;&lt; //action:prompt_choice Home X/Y and pause print</span><br><span class="line">&lt;&lt;&lt; //action:prompt_choice Abort print</span><br><span class="line">&lt;&lt;&lt; //action:prompt_show</span><br><span class="line">&gt;&gt;&gt; M876 S1</span><br></pre></td></tr></table></figure>

<p>To indicate the availability of this function, <code>M115</code> will add an extra line:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cap:PROMPT_SUPPORT:1</span><br></pre></td></tr></table></figure>

<p>so hosts know about the presence of the function.</p>
<h4 id="M890-Run-User-Gcode"><a href="#M890-Run-User-Gcode" class="headerlink" title="M890 Run User Gcode"></a>M890 Run User Gcode</h4><p>Parameters</p>
<p><code>Snnn</code> select 1 - 5 User Gcode defined in configuration.</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M890 S2  ; Start User Gcode 2</span><br></pre></td></tr></table></figure>

<h4 id="M900-Set-Linear-Advance-Scaling-Factors"><a href="#M900-Set-Linear-Advance-Scaling-Factors" class="headerlink" title="M900: Set Linear Advance Scaling Factors"></a>M900: Set Linear Advance Scaling Factors</h4><p>Sets the advance extrusion factors for Linear Advance. If any of the <code>R</code>, <code>W</code>, <code>H</code>, or <code>D</code> parameters are set to zero the ratio will be computed dynamically during printing.</p>
<p>Parameters</p>
<p><code>K[factor]</code> Advance K factor</p>
<p><code>R[ratio]</code> Set ratio directly (overrides WH&#x2F;D)</p>
<p><code>W[width]</code> <code>H[height]</code> <code>D[diam]</code> Set ratio from WH&#x2F;D</p>
<p>Examples</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M900 K0.7 W0.4 H0.1 D1.75 ; Set K and WH/D ratio</span><br><span class="line">M900 R0.025   ; Set the WH/D ratio directly</span><br><span class="line">M900 R0 ; Set to &quot;auto ratio&quot;</span><br></pre></td></tr></table></figure>

<p>Requires enabling the <code>LIN_ADVANCE</code> feature in Marlin 1.1.</p>
<p>The K factor in the M900 command supported by early versions of Marlin is related to the S factor in the long-established M572 command supported by RepRapFirmware by the following formula:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">K = S * extruder_steps_per_mm</span><br></pre></td></tr></table></figure>

<p>More recent versions of Marlin appear to have removed the steps&#x2F;mm dependency, so now K &#x3D; S.</p>
<h4 id="M905-Set-local-date-and-time"><a href="#M905-Set-local-date-and-time" class="headerlink" title="M905: Set local date and time"></a>M905: Set local date and time</h4><p>Parameters</p>
<p><code>Pnnn</code> Set current date in the format YYYY-MM-DD</p>
<p><code>Snnn</code> Set current time in the format HH:MM:SS</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M905 P2016-10-26 S00:23:12  </span><br></pre></td></tr></table></figure>

<p>Updates the machine’s local date and time or reports them if no parameters are specified. The time should be specified in 24-hours format as in “13:45” instead of 1:45PM.</p>
<p>Note<sup>1</sup> in Druid Firmware</p>
<p>minor differences in parameters:</p>
<p><code>M905 Snnn</code> Current time in the format HH:MM:SS or HH:MM (Seconds can be omitted)</p>
<p><code>M905 R</code> Reset the printer to UPTIME (time since power up) and date to DEFAULT 2000-01-01</p>
<p>When Druid Firmware is used with Repetier Server, the date and time are set automatically at each connection.</p>
<h4 id="M906-Set-motor-currents"><a href="#M906-Set-motor-currents" class="headerlink" title="M906: Set motor currents"></a>M906: Set motor currents</h4><p>Parameters</p>
<p><code>Xnnn</code> X drive motor current</p>
<p><code>Ynnn</code> Y drive motor current</p>
<p><code>Znnn</code> Z drive motor current</p>
<p><code>Ennn</code> E drive(s) motor current(s)</p>
<p><code>Innn</code> Motor idle current in percent (0..100)</p>
<p>In Marlin <code>X</code>, <code>Y</code>, <code>Z</code> are the same as above, in addition to the following Parameters</p>
<p><code>In</code> to specify index for additional motors, such as <code>I2</code> to set current for <code>X2</code>,<code>Y2</code>,<code>Z2</code></p>
<p><code>Tn</code> to set tool number for the E axis</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M906 X300 Y500 Z200 E350:350</span><br></pre></td></tr></table></figure>

<p>Sets the currents to send to the stepper motors for each axis. The values are the peak current per phase in milliamps.</p>
<p>The <code>I</code> parameter is the percentage of normal that the motor currents should be reduced to when the printer becomes idle but the motors have not been switched off. The default value is 30%. On delta printers in particular you may need to increase it to e.g. 60% to prevent the carriages from dropping when the current is reduced to the idle value.</p>
<h4 id="M907-Set-digital-trimpot-motor-current"><a href="#M907-Set-digital-trimpot-motor-current" class="headerlink" title="M907: Set digital trimpot motor current"></a>M907: Set digital trimpot motor current</h4><p>Set digital trimpot motor current using axis codes (<code>X</code>, <code>Y</code>, <code>Z</code>, <code>E</code>, <code>B</code>, <code>S</code>). In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Repetier">Repetier</a>, it sets the current in Percent. In <a target="_blank" rel="noopener" href="https://bitbucket.org/intelligentagent/redeem/src/6153607ded91c100fb4e41e936e6d045e19eda29/redeem/gcodes/M907.py?at=slave_stepper">Redeem</a>, it sets the current in Amps (whereas <code>M906</code> uses milliamps).</p>
<hr>
<p><em>Differences with Druid Firmware</em><sup>1</sup></p>
<p>Parameters</p>
<p><code>M907 Xnnn</code> Set X stepper current</p>
<p><code>M907 Ynnn</code> Set Y stepper current</p>
<p><code>M907 Znnn</code> Set Z stepper current</p>
<p><code>M907 Annn</code> Set E0 stepper current</p>
<p><code>M907 Bnnn</code> Set E1 stepper current</p>
<p><code>M907 Innn</code> Set Idle current % (see note <sup>2</sup>)</p>
<p><code>M907 S</code> Reset all values to Firmware default</p>
<p><code>M907</code> Report all values (X,Y,Z,A,B) in mA, and idle (I) as %</p>
<p><em>- When setting X,Y,Z,A,B current,</em> The range in which, the values provided are, will automatically determine their UNITS (Amps, % or mA) as follow: Values between…</p>
<p><code> 0.10 ... 2.50 </code> –&gt; Unit is Amps (0.10 A … 2.50 A)</p>
<p><code>  20  ... 200  </code> –&gt; Unit is Percentage (20 % … 200 %) of nominal values set in Druid Firmware</p>
<p><code> 250  ... 2500 </code> –&gt; Unit is milliamps (250 mA … 2500 mA)</p>
<p><em>- Any values outside those ranges, will be ignored.</em></p>
<p>Exemple</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M907 X800 Y800 A600     ;values are processed as mA</span><br><span class="line">M907 X80 Y80 A120       ;values are processed as % of firmware default</span><br><span class="line">M907 X0.75 Y0.75 Z0.5   ;values are processed as Amps </span><br><span class="line">M907                    ;Report all values (X,Y,Z,A,B) in mA, and idle (I) as %</span><br><span class="line">M907 S                  ;reset all values to Firmware default</span><br></pre></td></tr></table></figure>

<p>Note<sup>2</sup></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The percentage parameter &quot;I&quot;, is used to lower the current, when the printer is idle, but motors are not switched off. </span><br><span class="line">It Allows positions to be held without heating up the coils. (default is 50%, range is 10% ... 90%)</span><br></pre></td></tr></table></figure>

<h4 id="M908-Control-digital-trimpot-directly"><a href="#M908-Control-digital-trimpot-directly" class="headerlink" title="M908: Control digital trimpot directly"></a>M908: Control digital trimpot directly</h4><p>M908 P<pin> S<current></p>
<p>Notes</p>
<p>In Prusa Firmware this G-code is deactivated by default, must be turned on in the source code.<sup>1</sup></p>
<h4 id="M909-Set-microstepping"><a href="#M909-Set-microstepping" class="headerlink" title="M909: Set microstepping"></a>M909: Set microstepping</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M909 X3 Y5 Z2 E3</span><br></pre></td></tr></table></figure>

<p>Set the microstepping value for each of the steppers. In <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Redeem" title="Redeem">Redeem</a> this is implemented as powers of 2 so…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M909 X2 ; set microstepping on X-axis to 2^2 = 4</span><br><span class="line">M909 Y3 ; set microstepping on Y-axis to 2^3 = 8 etc.</span><br></pre></td></tr></table></figure>

<h4 id="M910-Set-decay-mode"><a href="#M910-Set-decay-mode" class="headerlink" title="M910: Set decay mode"></a>M910: Set decay mode</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M910 X3 Y5 Z2 E3</span><br></pre></td></tr></table></figure>

<p>Set the decay mode for each stepper controller The decay mode controls how the current is reduced and recycled by the H-bridge in the stepper motor controller. It varies how the implementations are done in silicone between controllers. Typically you have an on phase where the current flows in the target current, then an off phase where the current is reversed and then a slow decay phase where the current is recycled.</p>
<h4 id="M910-TMC2130-init"><a href="#M910-TMC2130-init" class="headerlink" title="M910: TMC2130 init"></a>M910: TMC2130 init</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M911-Configure-auto-save-on-loss-of-power-“power-panic”"><a href="#M911-Configure-auto-save-on-loss-of-power-“power-panic”" class="headerlink" title="M911: Configure auto save on loss of power (“power panic”)"></a>M911: Configure auto save on loss of power (“power panic”)</h4><p>Parameters</p>
<p><code>Saaa</code> Auto save threshold in volts. The print will be stopped automatically and resume parameters saved if the voltage falls below this value. Set to around 1V to 2V lower than the voltage that appears at the Duet VIN terminals at full load. A negative or zero value disables auto save.</p>
<p><code>Raaa</code> Resume threshold in volts. Must be greater than the auto save voltage. Set to a high value to disable auto resume.</p>
<p><code>P&quot;command string&quot;</code> G-Code commands to run when the print is stopped.</p>
<p>Example</p>
<p>M911 S19.8 R22.0 P”M913 X0 Y0 G91 M83 G1 Z3 E-5 F1000”</p>
<p>When the supply voltage falls below the auto save threshold while a print from SD card is in progress, all heaters will be turned off, printing will be stopped immediately (probably in the middle of a move), the position saved, and the specified command string executed. You should typically do the following in the command string:</p>
<ul>
<li>If possible, use M913 to reduce the motor current in order to conserve power. For example, on most printers except deltas you can probably set the X and Y motor currents to zero.</li>
<li>Retract a little filament and raise the head a little. Ideally the retraction should happen first, but depending on the power reserve when low voltage is detected, it may be best to do both simultaneously.</li>
</ul>
<p>M911 with no parameters displays the current enable&#x2F;disable state, and the threshold voltages if enabled.</p>
<p>Note: RepRapFirmware 1.19 used different parameters. You are recommended to upgrade to version 1.20 or later if you wish to use this “power panic” functionality.</p>
<h4 id="M911-Set-TMC2130-holding-currents"><a href="#M911-Set-TMC2130-holding-currents" class="headerlink" title="M911: Set TMC2130 holding currents"></a>M911: Set TMC2130 holding currents</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M912-Set-electronics-temperature-monitor-adjustment"><a href="#M912-Set-electronics-temperature-monitor-adjustment" class="headerlink" title="M912: Set electronics temperature monitor adjustment"></a>M912: Set electronics temperature monitor adjustment</h4><p>Parameters</p>
<p><code>Pnnn</code> Temperature monitor channel, default 0</p>
<p><code>Snnn</code> Value to be added to the temperature reading in degC</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M912 P0 S10.5</span><br></pre></td></tr></table></figure>

<p>Many microcontrollers used to control 3D printers have built-in temperature monitors, but they normally need to be calibrated for temperature reading offset. The <code>S</code> parameter specifies the value that should be added to the raw temperature reading to provide a more accurate result.</p>
<h4 id="M912-Set-TMC2130-running-currents"><a href="#M912-Set-TMC2130-running-currents" class="headerlink" title="M912: Set TMC2130 running currents"></a>M912: Set TMC2130 running currents</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M913-Set-motor-percentage-of-normal-current"><a href="#M913-Set-motor-percentage-of-normal-current" class="headerlink" title="M913: Set motor percentage of normal current"></a>M913: Set motor percentage of normal current</h4><p>Parameters</p>
<p><code>X, Y, Z, E</code> Percentage of normal current to use for the specified axis or extruder motor(s)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M913 X50 Y50 Z50 ; set X Y Z motors to 50% of their normal current</span><br><span class="line">M913 E30:30 ; set extruders 0 and 1 to 30% of their normal current</span><br></pre></td></tr></table></figure>

<p>This allows motor currents to be set to a specified percentage of their normal values as set by <code>M906</code>. It can be used (for example) to reduce motor current during course homing, to make homing quieter or to reduce the risk of damage to endstops, to reduce motor current when using sensorless endstops (motor stall detection), and to reduce current while loading filament to guard against the possibility of feeding too much filament. Use <code>M913</code> again with the appropriate parameters set to 100 to restore the normal currents.</p>
<h4 id="M913-Print-TMC2130-currents"><a href="#M913-Print-TMC2130-currents" class="headerlink" title="M913: Print TMC2130 currents"></a>M913: Print TMC2130 currents</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M914-Set-Get-Expansion-Voltage-Level-Translator"><a href="#M914-Set-Get-Expansion-Voltage-Level-Translator" class="headerlink" title="M914: Set&#x2F;Get Expansion Voltage Level Translator"></a>M914: Set&#x2F;Get Expansion Voltage Level Translator</h4><p>Parameters</p>
<p><code>S</code> Expansion voltage signal level, must be 3 or 5</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M914 S5 ; set expansion signal level to 5V</span><br><span class="line">M913 ; report expansion signal voltage level</span><br></pre></td></tr></table></figure>

<h4 id="M914-Set-TMC2130-normal-mode"><a href="#M914-Set-TMC2130-normal-mode" class="headerlink" title="M914: Set TMC2130 normal mode"></a>M914: Set TMC2130 normal mode</h4><p>Updates EEPROM only if “P” is given, otherwise temporary (lasts until reset or motor idle timeout)</p>
<p>Usage</p>
<p><code>M914 [ P | R | Q ]</code></p>
<p>Parameters</p>
<p><code>P</code> Make the mode change permanent (write to EEPROM)</p>
<p><code>R</code> Revert to EEPROM value</p>
<p><code>Q</code> Print effective silent&#x2F;normal status. (Does not report override)</p>
<h4 id="M915-Configure-motor-stall-detection"><a href="#M915-Configure-motor-stall-detection" class="headerlink" title="M915: Configure motor stall detection"></a>M915: Configure motor stall detection</h4><p>Parameters</p>
<p><strong>Pnnn:nnn:…</strong> Drive number(s) to configure</p>
<p><strong>X,Y,Z,U,V,W,A,B,C</strong> Axes to configure (alternative to using the P parameter)</p>
<p><strong>Snnn</strong> Stall detection threshold (-64 to +63, values below -10 not recommended)</p>
<p><strong>Fn</strong> Stall detection filter mode, 1 &#x3D; filtered (one reading per 4 full steps), 0 &#x3D; unfiltered (default, 1 reading per full step)</p>
<p><strong>Hnnn</strong> (optional) Minimum motor full steps per second for stall detection to be considered reliable, default 200</p>
<p><strong>Tnnn</strong> (optional) Coolstep control register, 16-bit unsigned integer</p>
<p><strong>Rn</strong> Action to take on detecting a stall from any of these drivers: 0 &#x3D; no action (default), 1 &#x3D; just log it, 2 &#x3D; pause print, 3 &#x3D; pause print, execute macro file <strong>&#x2F;sys&#x2F;rehome.g</strong>, and resume print</p>
<p>Examples</p>
<p>M915 P0:2:3 S10 F1 R0</p>
<p>M915 X Y S5 R2</p>
<p>This sets the stall detection parameters and optionally the low-load current reduction parameters for TMC2660, TMC2130 or similar driver chips. Use either the P parameter to specify which driver number(s) you want to configure, or the axis names of the axes that those motors drive (the parameters will then be applied to all the drivers associated with any of those axes).</p>
<p>If any of the S, F, T and R parameters are absent, the previous values for those parameters associated with the specified drivers will continue to be used. If all the parameters are absent, the existing settings for the specified drives will be reported.</p>
<p>See the Trinamic TMC2660 and TMC2130 datasheets for more information about the operation and limitations of motor stall detection.</p>
<h4 id="M915-Set-TMC2130-silent-mode"><a href="#M915-Set-TMC2130-silent-mode" class="headerlink" title="M915: Set TMC2130 silent mode"></a>M915: Set TMC2130 silent mode</h4><p>Updates EEPROM only if “P” is given, otherwise temporary (lasts until reset or motor idle timeout)</p>
<p>Usage</p>
<p><code>M915 [ P | R | Q ]</code></p>
<p>Parameters</p>
<p><code>P</code> Make the mode change permanent (write to EEPROM)</p>
<p><code>R</code> Revert to EEPROM value</p>
<p><code>P</code> Print effective silent&#x2F;normal status. (Does not report override)</p>
<h4 id="M916-Resume-print-after-power-failure"><a href="#M916-Resume-print-after-power-failure" class="headerlink" title="M916: Resume print after power failure"></a>M916: Resume print after power failure</h4><p>Parameters</p>
<p>none</p>
<p>Example</p>
<p>M916</p>
<p>If the last print was not completed and resume information has been saved (either because the print was paused or because of a power failure), then the heater temperatures, tool selection, head position, mix ratio, mesh bed compensation height map etc. are restored from the saved values and printing is resumed.</p>
<p>RepRapFirmware also requires macro file <strong>&#x2F;sys&#x2F;resurrect-prologue.g</strong> to be present on the SD card before you can use M915. This file is executed after the heater temperatures have been set, but before waiting for them to reach the assigned temperatures. You should put commands in this file to home the printer as best as you can without disturbing the print on the bed. To wait for the heaters to reach operating temperature first, use command M116 at the start of the file.</p>
<h4 id="M916-Set-TMC2130-Stallguard-sensitivity-threshold"><a href="#M916-Set-TMC2130-Stallguard-sensitivity-threshold" class="headerlink" title="M916: Set TMC2130 Stallguard sensitivity threshold"></a>M916: Set TMC2130 Stallguard sensitivity threshold</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M917-Set-motor-standstill-current-reduction"><a href="#M917-Set-motor-standstill-current-reduction" class="headerlink" title="M917: Set motor standstill current reduction"></a>M917: Set motor standstill current reduction</h4><p>Parameters</p>
<p><strong>X,Y,Z,E</strong> Percentage of normal current to use when the motor is standing still or moving slowly, default 100</p>
<p>Example</p>
<p>M917 X70 Y70 Z80 E70:70</p>
<p>Some motor drivers (e.g. TMC2660) allow higher motor currents to be used while the motor is moving than when it is at standstill. This command sets the percentage of the current set by M906 that is to be used when the motor is stationary but not idle, or moving very slowly.</p>
<p>Standstill current reduction is not the same as idle current reduction. The standstill current must be high enough to produce accurate motion at low speeds; whereas the idle current (set using the I parameter in the M906 command) needs only to be high enough to hold the motor position sufficiently so that when the current is restored to normal, the position is the same as it was before the current was reduced to idle.</p>
<h4 id="M917-Set-TMC2130-PWM-amplitude-offset-pwm-ampl"><a href="#M917-Set-TMC2130-PWM-amplitude-offset-pwm-ampl" class="headerlink" title="M917: Set TMC2130 PWM amplitude offset (pwm_ampl)"></a>M917: Set TMC2130 PWM amplitude offset (pwm_ampl)</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M918-Configure-direct-connect-display"><a href="#M918-Configure-direct-connect-display" class="headerlink" title="M918: Configure direct-connect display"></a>M918: Configure direct-connect display</h4><p>This command is used to tell RepRapFirmware about a directly-connected dumb LCD or similar display.</p>
<p>Parameters</p>
<p><strong>P</strong> Directly-connected display type: 0 &#x3D; none (default), 1 &#x3D; 128x64 pixel mono graphics display using ST7920 controller, 2 &#x3D; 128x64 mono display using ST7567 controller</p>
<p><strong>E</strong> The number of pulses generated by the rotary encoder per detent. Typical values are 2 and 4. Negative values (e.g. -2 and -4) reverse the encoder direction.</p>
<p><strong>F</strong> (optional, supported in RRF 2.03 and later) SPI clock frequency in Hz, default 2000000 (i.e. 2MHz)</p>
<p><strong>C</strong> (optional, supported in RRF 3.2 and later) Display contrast, in range 0 to 100. Only used with ST7567-based displays. ST7920-based displays usually have a contrast potentiometer instead.</p>
<p><strong>R</strong> (optional, supported in RRF 3.2 and later) Display resistor ratio, in range 1 to 7. Only used with ST7567-based displays. The default value of 6 is suitable for the Fysetc Mini 12864 display. Some other displays need 3.</p>
<p>Example</p>
<p>M918 P1 E2</p>
<h4 id="M918-Set-TMC2130-PWM-amplitude-gradient-pwm-grad"><a href="#M918-Set-TMC2130-PWM-amplitude-gradient-pwm-grad" class="headerlink" title="M918: Set TMC2130 PWM amplitude gradient (pwm_grad)"></a>M918: Set TMC2130 PWM amplitude gradient (pwm_grad)</h4><p>Not active in default, only if TMC2130_SERVICE_CODES_M910_M918 is defined in source code.</p>
<h4 id="M928-Start-SD-logging"><a href="#M928-Start-SD-logging" class="headerlink" title="M928: Start SD logging"></a>M928: Start SD logging</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M928 filename.g</span><br></pre></td></tr></table></figure>

<p>Stop SD logging with <code>M29</code>.</p>
<h4 id="M929-Start-stop-event-logging-to-SD-card"><a href="#M929-Start-stop-event-logging-to-SD-card" class="headerlink" title="M929: Start&#x2F;stop event logging to SD card"></a>M929: Start&#x2F;stop event logging to SD card</h4><p>Parameters</p>
<p><strong>P”filename”</strong> The name of the file to log to. Only used if the S1 parameter is used. A default filename will be used if this parameter is missing.</p>
<p><strong>Sn</strong> S1 &#x3D; start logging, S0 &#x3D; stop logging</p>
<p>Example</p>
<p>M929 P”eventlog.txt” S1  ; start logging to file eventlog.txt</p>
<p>M929 S0  ; stop logging</p>
<p>When event logging is enabled, important events such as power up, start&#x2F;finish printing, most error messages and (if possible) power down will be logged to the SD card. Each log entry is a single line of text, starting with the date and time if available, or the elapsed time since power up if not. If the log file already exists, new log entries will be appended to the existing file.</p>
<h4 id="M950-Create-heater-fan-or-GPIO-servo-device"><a href="#M950-Create-heater-fan-or-GPIO-servo-device" class="headerlink" title="M950: Create heater, fan or GPIO&#x2F;servo device"></a>M950: Create heater, fan or GPIO&#x2F;servo device</h4><p>Parameters</p>
<p><strong>Dn</strong> SD card slot number (RRF 3.4 on Duet 3 MB6HC only - the only value supported is 1)</p>
<p><strong>Enn</strong> LED strip number (RRF 3.5 and later)</p>
<p><strong>Fnn</strong> Fan number</p>
<p><strong>Hnn</strong> Heater number</p>
<p><strong>Jnn</strong> GP input number</p>
<p><strong>Pnn or Snn</strong> GPIO or Servo number (the only difference is the default PWM frequency)</p>
<p><strong>Rnn</strong> Spindle number *RRF 3.3 and later)</p>
<p><strong>C”name”</strong> Pin name(s) and optional inversion status. Pin name “nil” frees up the pin. A leading ‘!’ character inverts the output. A leading ‘^’ character enables the pullup resistor. The ‘^’ and ‘!’ characters may be placed in either order.</p>
<p><strong>Qnn</strong> (optional) For fans and heaters: PWM frequency in Hz. For LED strips: clock frequency in Hz.</p>
<p><strong>Tnn</strong> Temperature sensor number, required when creating a heater; or LED strip type when creating an LED port</p>
<p><strong>Kaaa:bbb:ccc</strong> (optional, for spindles only, RRF 3.5 and later) Optional PWM values (0..1) for spindle control (max [aaa] - or - min, max [aaa:bbb] - or - min, max, idle [aaa:bbb:ccc])</p>
<p>Examples</p>
<p>M950 H1 C”out1” Q100 T1 ; create heater 1 using temperature sensor 1</p>
<p>M950 H2 C”nil” ; disable heater 2 and free up the associated pin</p>
<p>M950 H2 C”1.out0” T2 ; create heater 2 using pin out0 on expansion board 1 and temperature sensor 2</p>
<p>M950 F3 C”heater2” Q100 ; Fan 3 is connected to heater 2 pin, PWM at 100Hz</p>
<p>M950 P0 C”exp.heater3” ; create GPIO port 0 attached to heater 3 pin on expansion connector</p>
<p>M950 F2 C”!fan2+^pb6” ; Fan 2 uses the Fan2 output, but we are using a PWM fan so the output needs to be inverted, also we are using PB6 as a tacho input with pullup resistor enabled</p>
<p>M950 D1 C”spi.cs0+spi.cs2” ; on Duet 3 MB6HC support external SD card using pins spi.cs0 and spi.cs2 for the CS and Card Detect pins respectively</p>
<p>M950 is used to create heaters, fans, LED strip ports and GP in and out ports and to assign pins to them. Each M950 command assigns a pin or pins to a single device. So every M950 command must have exactly one of the D, E, F, H, J, P or S parameters.</p>
<p>If a M950 command has C and&#x2F;or Q parameters, then the pin allocation and&#x2F;or frequency of any existing device will be changed accordingly. Otherwise, the current configuration will be reported.</p>
<p>When using M950 to create a heater, you must first use M308 to define a temperature sensor to control that heater, and specify its number in the T parameter of the M950 command.</p>
<h4 id="M951-Set-height-following-mode-parameters"><a href="#M951-Set-height-following-mode-parameters" class="headerlink" title="M951: Set height following mode parameters"></a>M951: Set height following mode parameters</h4><p>Parameters</p>
<p><strong>Snn or Hnn</strong> Sensor number</p>
<p><strong>Pnn.n</strong> Proportional factor, in mm per sensor unit</p>
<p><strong>Inn.n</strong> Integral factor, in mm per sensor unit per second</p>
<p><strong>Dnn.n</strong> Derivative factor, in mm per rate of change of sensor units (change in sensor unit per second)</p>
<p><strong>Fnn.n</strong> (optional) Sample and correction frequency (Hz), default 5Hz</p>
<p><strong>Znn.n:nn.n</strong> Minimum and maximum permitted Z values</p>
<p>Height following mode allows the Z position of the tool to be controlled by a PID controller using feedback from a sensor. See also M594.</p>
<p>If commanding the motors to increase Z causes the sensor value to increase, then all of P, I and D must be positive. If commanding the motors to increase Z causes the sensor value to decrease, then all of P, I and D must be negative.</p>
<h4 id="M952-Set-CAN-expansion-board-address-and-or-normal-data-rate"><a href="#M952-Set-CAN-expansion-board-address-and-or-normal-data-rate" class="headerlink" title="M952: Set CAN expansion board address and&#x2F;or normal data rate"></a>M952: Set CAN expansion board address and&#x2F;or normal data rate</h4><p>Parameters</p>
<p><strong>Bn</strong> Existing CAN address of expansion board to be changed, 1 to 125.</p>
<p><strong>An</strong> New CAN address of that expansion board, 1 to 125.</p>
<p><strong>Sn.n</strong> Requested bit rate in Kbits&#x2F;second (1K &#x3D; 1000)</p>
<p><strong>T0.n</strong> Fraction of the bit time between the bit start and the sample point (optional)</p>
<p><strong>J0.n</strong> Maximum jump time as a fraction of the bit time (optional)</p>
<p>Example</p>
<p>M952 B120 A11  ; change the CAN address of expansion board 101 to 11</p>
<p>M952 B11 S500  ; change the CAN bit rate or expansion board 11 to 500kbps</p>
<p>Some CAN-connected expansion boards are too small to carry address selection switches. Such boards default to a standard address, which can be changed using this command.</p>
<p>This command can also be used to change the normal data rate, for example if the printer has CAN bus cables that are too long to support the standard data rate (1Mbits&#x2F;sec in RepRapFirmware). All boards in the system on the same CAN bus must use the same CAN data rate. The procedure for changing the data rate is:</p>
<ul>
<li>Use M952 to change the data rate on all the expansion boards, one at a time. After changing the data rate on each expansion board, you will no longer be able to communicate with it, and you may need to power it down or disconnect it from the CAN bus to prevent it interfering with subsequent CAN communications.</li>
<li>Change the data rate of the main board last. Then the main board should be able to communicate with all the expansion boards again.</li>
</ul>
<h4 id="M953-Set-CAN-FD-bus-fast-data-rate"><a href="#M953-Set-CAN-FD-bus-fast-data-rate" class="headerlink" title="M953: Set CAN-FD bus fast data rate"></a>M953: Set CAN-FD bus fast data rate</h4><p>Parameters</p>
<p><strong>Sn.n</strong> Requested bit rate in Kbits&#x2F;second (1K &#x3D; 1000). Ignored if it is lower than the bit rate for the negotiation phase.</p>
<p><strong>T0.n</strong> Fraction of the bit time between the bit start and the sample point (optional)</p>
<p><strong>J0.n</strong> Maximum jump time as a fraction of the bit time (optional)</p>
<p><strong>Caa:bb</strong> Transceiver delay compensation offset and minimum, in nanoseconds (optional)</p>
<p>Example</p>
<p>M953 S4000 T0.6 J0.2</p>
<p>This command allows the bandwidth of the CAN bus to be optimised, by increasing the data rate during transmission of CAN-FD data packets using the BRS (bit rate switch) feature. The maximum speed supported by CAN-FD is 8Mbits&#x2F;sec but the practical limit depends on the cable length, cable quality, number of devices on the bus and CAN interface hardware used. The rate specified will be rounded down to the nearest achievable rate.</p>
<p>The optional C parameter allows fine-tuning of the transmitter delay compensation. The first parameter is the offset added to the measured transmitter delay. The optional second value, which must be greater than the first, is the minimum delay compensation applied. Glitches seen by the receiver while the transceiver delay is being measured will be ignored if they would result in a transceiver delay compensation lower than this value. When CAN is implemented on Microchip SAME5x and SAMC21 processors, these values are converted from nanoseconds into time quanta and stored in the TDCO and TDCF fields of the transceiver delay compensation register.</p>
<h4 id="M954-Configure-as-CAN-expansion-board"><a href="#M954-Configure-as-CAN-expansion-board" class="headerlink" title="M954: Configure as CAN expansion board"></a>M954: Configure as CAN expansion board</h4><p>Parameters</p>
<p><strong>Ann</strong> CAN address to use (required)</p>
<p>This command is used to reconfigure the board it is executed on as a CAN-connected expansion board. It would typically be the only command in the config.g file. When it is executed, the board changes its CAN address to the one specified in the A parameter, stops sending CAN time sync messages, and responds to requests received via CAN just like a regular expansion board. A few GCode commands can still be executed locally for diagnostic purposes, for example M111 and M122.</p>
<h4 id="M955-Configure-Accelerometer"><a href="#M955-Configure-Accelerometer" class="headerlink" title="M955: Configure Accelerometer"></a>M955: Configure Accelerometer</h4><p>Parameters (provisional)</p>
<p><strong>Pnn</strong> or <strong>Pbb.nn</strong> Accelerometer to use (required)</p>
<p><strong>Inn</strong> Accelerometer orientation</p>
<p><strong>Snnn</strong> Sample rate (Hz)</p>
<p><strong>Rnn</strong> Resolution (bits), typically 8, 10 or 12</p>
<p>This command configures an accelerometer.</p>
<p>The P parameter selects which accelerometer to use and is mandatory. To use an accelerometer on a CAN-connected expansion board, use the form <strong>P</strong><em>board-address</em>.<em>device-number</em> for example <strong>P22.0</strong>.</p>
<p>If none of the other parameters are provided, the current configuration of the specified accelerometer is reported. Otherwise the configuration of that accelerometer is adjusted according to the I, S, and R parameters. These configuration settings persist until they are changed.</p>
<p>The I (orientation) parameter tells the firmware which of the 24 possible orientations the accelerometer chip is in relative to the printer axes. It is expressed as a 2-digit number. The first digit specifies which machine direction the Z axis of the accelerometer chip (usually the top face of the chip) faces, as follows: 0 &#x3D; +X, 1 &#x3D; +Y, 2 &#x3D; +Z, 4 &#x3D; -X, 5 &#x3D; -Y, 6 &#x3D; -Z. The second digit expresses which direction the X axis of the accelerometer chip faces, using the same code. If the accelerometer chip axes line up with the machine axis, the orientation is 20. This is the default orientation if no orientation has been specified.</p>
<p>The S and R parameters control how the accelerometer is programmed. The R parameter is ignored unless the S parameter is also provided. If S is provided but R is missing, a default resolution is used. The sensor resolution will be adjusted to be no greater than the value of the R parameter (or the minimum supported resolution if greater), then the sensor sampling rate will be adjusted to a value supported at that resolution that is close to the S parameter. The actual rate and resolution selected can be found by using M955 with just the P parameter.</p>
<h4 id="M956-Collect-accelerometer-data-and-write-to-file"><a href="#M956-Collect-accelerometer-data-and-write-to-file" class="headerlink" title="M956: Collect accelerometer data and write to file"></a>M956: Collect accelerometer data and write to file</h4><p>Parameters</p>
<p><strong>Pnn</strong> or <strong>Pbb.nn</strong> Accelerometer to use (required)</p>
<p><strong>Snnn</strong> Number of samples to collect (required)</p>
<p><strong>X</strong> and&#x2F;or <strong>Y</strong> and&#x2F;or <strong>Z</strong> Machine axes to collect data for. If no axes are specified, data is collected for all three axes.</p>
<p><strong>An</strong> (required) 0 &#x3D; activate immediately, 1 &#x3D; activate just before the start of the next move, 2 &#x3D; activate just before the start of the deceleration segment of the next move</p>
<p><strong>Kn</strong> (optional, default 0) Skip the specified number of moves before activating (use with A1 or A2)</p>
<p>This command causes the specified number of accelerometer samples to be collected and saved to a .csv file on the SD card.</p>
<p>The P parameter selects which accelerometer to use and is mandatory. To use an accelerometer on a CAN-connected expansion board, use the form <strong>P</strong><em>board-address</em>.<em>device-number</em> for example <strong>P22.0</strong>.</p>
<h4 id="M957-Raise-event"><a href="#M957-Raise-event" class="headerlink" title="M957: Raise event"></a>M957: Raise event</h4><p>Parameters</p>
<p><strong>E”type”</strong> Event type name</p>
<p><strong>Dnn</strong> Device number to which the event relates, optionally including the CAN address of the board concerned</p>
<p><strong>Pnn</strong> (optional) additional data about the event (unsigned integer)</p>
<p><strong>Bnn</strong> (optional) CAN address that the event should appear to originate from</p>
<p><strong>S”text”</strong> (optional) Short text string to be appended to the event message</p>
<p>This command is used to raise an event internally as if the event had actually occurred, and execute any related handler macro for that event. Its main use is to test event handler macros.</p>
<p>The event type names are firmware-dependent. In RepRapFirmware they are: heater_fault, driver_error, filament_error, driver_warning, driver_stall and mcu_temperature_warning.</p>
<p>The meaning of the device number depends on the event type. For a driver error it is the local driver number. For a heater fault it is the heater number. For a filament error it is the extruder number.</p>
<p>The meaning of the optional additional parameter also depends on the event type. For example, for a driver error it is the driver status.</p>
<h4 id="M958-Excite-harmonic-vibration"><a href="#M958-Excite-harmonic-vibration" class="headerlink" title="M958: Excite harmonic vibration"></a>M958: Excite harmonic vibration</h4><p>Parameters (provisional)</p>
<p><strong>X</strong> or <strong>Y</strong> or <strong>Z</strong> Machine axis</p>
<p><strong>Fnnn</strong> Frequency (Hz)</p>
<p><strong>Annn</strong> Acceleration (mm&#x2F;s<sup>2</sup>)</p>
<p><strong>Snnn</strong> Duration (s)</p>
<h4 id="M970-Enable-Disable-Phase-Stepping"><a href="#M970-Enable-Disable-Phase-Stepping" class="headerlink" title="M970: Enable&#x2F;Disable Phase Stepping"></a>M970: Enable&#x2F;Disable Phase Stepping</h4><p>Parameters</p>
<p><code>Xn</code> 0 &#x3D; disable, 1 &#x3D; enable</p>
<p><code>Yn</code> 0 &#x3D; disable, 1 &#x3D; enable</p>
<p><code>&#123;Axis letter&#125;n</code> (RRF) 0 &#x3D; disable, 1 &#x3D; enable</p>
<h4 id="M970-1-Configure-Phase-Stepping-Velocity-Constant"><a href="#M970-1-Configure-Phase-Stepping-Velocity-Constant" class="headerlink" title="M970.1: Configure Phase Stepping Velocity Constant"></a>M970.1: Configure Phase Stepping Velocity Constant</h4><p>Parameters</p>
<p><code>&#123;Axis letter&#125;nnn</code>(RRF 3.6 onwards) velocity constant</p>
<p>Configure the velocity constant used to scale the motor current in phase stepping.</p>
<h4 id="M970-2-Configure-Phase-Stepping-Acceleration-Constant"><a href="#M970-2-Configure-Phase-Stepping-Acceleration-Constant" class="headerlink" title="M970.2: Configure Phase Stepping Acceleration Constant"></a>M970.2: Configure Phase Stepping Acceleration Constant</h4><p>Parameters</p>
<p><code>&#123;Axis letter&#125;nnn</code>(RRF 3.6 onwards) acceleration constant</p>
<p>Configure the acceleration constant used to scale the motor current in phase stepping.</p>
<h4 id="M972-Retrieve-Current-Correction"><a href="#M972-Retrieve-Current-Correction" class="headerlink" title="M972: Retrieve Current Correction"></a>M972: Retrieve Current Correction</h4><p>Outputs the current correction table in format: `<axis>, <direction>, <index>, <mag>, <pha>` per line. Multiple axes can be specified.</p>
<h4 id="M973-Set-Single-Entry-in-Current-Correction-Table"><a href="#M973-Set-Single-Entry-in-Current-Correction-Table" class="headerlink" title="M973: Set Single Entry in Current Correction Table"></a>M973: Set Single Entry in Current Correction Table</h4><p>Parameters</p>
<p><strong>String argument in format: &lt;X&#x2F;Y&gt;&lt;F&#x2F;B&gt;&lt;list of mag,phase pairs separated by space&gt;</strong></p>
<h4 id="M974-Measure-Print-Head-Resonance"><a href="#M974-Measure-Print-Head-Resonance" class="headerlink" title="M974: Measure Print Head Resonance"></a>M974: Measure Print Head Resonance</h4><p>Parameters</p>
<p><strong>X&#x2F;Y</strong> choose motor to use</p>
<p><strong>F</strong> motion speed in rev&#x2F;sec</p>
<p><strong>R</strong> number of revolutions</p>
<p>Outputs raw accelerometer sample <seq>, <X>, <Y>, <Z> per line and real sampling frequency of the accelerometer as “sample freq: <freq>“.</p>
<h4 id="M975-Measure-Dwarf-Accelerometer-Sampling-Frequency"><a href="#M975-Measure-Dwarf-Accelerometer-Sampling-Frequency" class="headerlink" title="M975: Measure Dwarf Accelerometer Sampling Frequency"></a>M975: Measure Dwarf Accelerometer Sampling Frequency</h4><p>Outputs sampling frequency of the accelerometer as “sample freq: <freq>“.</p>
<h4 id="M976-Measure-Print-Head-Resonance"><a href="#M976-Measure-Print-Head-Resonance" class="headerlink" title="M976: Measure Print Head Resonance"></a>M976: Measure Print Head Resonance</h4><p>Parameters</p>
<p><strong>X&#x2F;Y</strong> choose motor to use</p>
<p><strong>F</strong> motion speed in rev&#x2F;sec</p>
<p><strong>R</strong> number of revolutions</p>
<p>Outputs frequency response</p>
<h4 id="M977-Calibrate-Motor"><a href="#M977-Calibrate-Motor" class="headerlink" title="M977: Calibrate Motor"></a>M977: Calibrate Motor</h4><p>Parameters</p>
<p><strong>X&#x2F;Y</strong> choose motor to use</p>
<p>Calibrates given motor and sets the newly found compensation.</p>
<h4 id="M995-Calibrate-Touch-Screen"><a href="#M995-Calibrate-Touch-Screen" class="headerlink" title="M995: Calibrate Touch Screen"></a>M995: Calibrate Touch Screen</h4><h4 id="M997-Perform-in-application-firmware-update"><a href="#M997-Perform-in-application-firmware-update" class="headerlink" title="M997: Perform in-application firmware update"></a>M997: Perform in-application firmware update</h4><p>Parameters</p>
<p><code>Snnn</code> Firmware module number(s), default 0</p>
<p><code>Bnnn</code> Expansion board address, default 0 (i.e. main controller board)</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M997 S0:1 ; update firmware modules 0 and 1 on the main controller board</span><br><span class="line">M997 B3 ; update firmware module 0 on the expansion board with address 3</span><br></pre></td></tr></table></figure>

<p>This command triggers a firmware update if the necessary files are present on the SD card. In RepRapFirmware on the Duet series, module numbers are as follows:</p>
<p>0 - main firmware. The firmware filename depends on the controller electronics, e.g.sys&#x2F;RepRapFirmware.bin (Duet 06&#x2F;085), sys&#x2F;Duet2CombinedFirmware (Duet WiFi&#x2F;Ethernet), sys&#x2F;DuetMaestroFirmware.bin (Duet Maestro). File sys&#x2F;iap.bin (Duet), sys&#x2F;iap4e.bin (Duet WiFi&#x2F;Ethernet) or sys&#x2F;iap4s.bin (Duet Maestro) must also be present.</p>
<p>1 - WiFi module firmware, filename sys&#x2F;DuetWiFiServer.bin</p>
<p>2 - Reserved (on Duet WiFi running RepRapFirmware 1.18 and earlier, was web server file system)</p>
<p>3 - Duet WiFi main boards: put the WiFi module into bootloader mode so that firmware can be uploaded directly via its serial port. Duet 3 expansion boards: update the bootloader (RepRapFirmware 3.2 and later).</p>
<p>4 - Updates the firmware on an attached PanelDue v3 or later touch screen (supported in RRF 3.2 and later)</p>
<p>In marlin, <code>M997</code> will trigger a firmware update after the update file has been uploaded to the SD card, on the following platforms: LPC176x, STM32, STM32F1</p>
<h4 id="M998-Request-resend-of-line"><a href="#M998-Request-resend-of-line" class="headerlink" title="M998: Request resend of line"></a>M998: Request resend of line</h4><p>Parameters</p>
<p><code>Pnnn</code> Line number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M998 P34</span><br></pre></td></tr></table></figure>

<p>Request a resend of line 34. In some implementations the input-handling code overwrites the incoming G Code with this when it detects, for example, a checksum error. Then it leaves it up to the G-code interpreter to request the resend.</p>
<h4 id="M999-Restart-after-being-stopped-by-error"><a href="#M999-Restart-after-being-stopped-by-error" class="headerlink" title="M999: Restart after being stopped by error"></a>M999: Restart after being stopped by error</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Pnnn</code> Reset flags<sup>1</sup></p>
<p><code>Bnnn</code> CAN address of the board to reset (RRF only)<sup>2</sup></p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M999</span><br></pre></td></tr></table></figure>

<p>Restarts the firmware using a software reset.</p>
<p>Notes</p>
<p><sup>1</sup>The dc42 fork of RepRapFirmware not only resets the board but also puts the board into firmware upload mode if parameter PERASE is present. <sup>2</sup>Starting from RRF 3.3 this parameter may be set to -1 to reboot the attached SBC (DuetPi + SBC)</p>
<h2 id="Other-commands"><a href="#Other-commands" class="headerlink" title="Other commands"></a>Other commands</h2><h4 id="G-List-all-G-codes"><a href="#G-List-all-G-codes" class="headerlink" title="G: List all G-codes"></a>G: List all G-codes</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G</span><br></pre></td></tr></table></figure>

<p>Print a list of all implemented G-codes in the firmware with description to the host.<br>(Note: this has been implemented in <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Redeem" title="Redeem">Redeem</a>, and so is only a proposal.)</p>
<h4 id="M-List-all-M-codes"><a href="#M-List-all-M-codes" class="headerlink" title="M: List all M-codes"></a>M: List all M-codes</h4><p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M</span><br></pre></td></tr></table></figure>

<p>Print a list of all implemented M-codes in the firmware with description to the host.<br>(Note: this has been implemented in <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Redeem" title="Redeem">Redeem</a>, and so is only a proposition)</p>
<h4 id="T-Select-Tool"><a href="#T-Select-Tool" class="headerlink" title="T: Select Tool"></a>T: Select Tool</h4><p>Parameters</p>
<p><em>This command can be used without any additional parameters.</em></p>
<p><code>Pnnn</code>: Bitmap of all the macros to be run (only RRF 1.17b or later)</p>
<p>Tool number</p>
<p>Example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T1</span><br></pre></td></tr></table></figure>

<p>Select tool (or in older implementations extruder) number 1 to build with.</p>
<p>The sequence followed is:</p>
<ol>
<li>Set the current tool to its standby temperatures specified by <code>G10</code> (see above),</li>
<li>Set the new tool to its operating temperatures specified by <code>G10</code> and wait for <strong>all</strong> temperatures to stabilise,</li>
<li>Apply any X, Y, Z offset for the new tool specified by <code>G10</code>,</li>
<li>Use the new tool.</li>
</ol>
<p>Selecting a non-existent tool (100, say) just does Step 1 above<sup>1</sup>. That is to say it leaves all tools in their standby state. You can, of course, use the <code>G10</code> command beforehand to set that standby temperature to anything you like.</p>
<p>Note that you may wish to move to a parking position <em>before</em> executing a T command in order to allow the new extruder to reach temperature while not in contact with the print. It is acceptable for the firmware to apply a small offset [by convention (-1mm x tool-number) in Y] to the current position when the above sequence is entered to allow temperature changes to take effect just away from the parking position. Any such offset must, of course, be undone when the procedure finishes.</p>
<p>If the Z value changes in the offsets and the tool moves up, then the Z move is made before the X and Y moves. If Z moves down, X and Y are done first.</p>
<p>Some firmware (Such as Prusa i3 Printers with MMU) also support the <code>Tx</code> (recommended) and <code>T?</code>(depricated)<sup>2</sup> commands to prompt the user to select a tool (or a filament in the case of the MultiMaterial Unit) on the printer’s menu. Then the <code>Tc</code> command actually loads the selected filament.</p>
<p>Some implementations (e.g. RepRapFirmware) allow you to specify tool-change G Code macros<sup>3</sup>. There are normally three specified (any of which can contain no commands if desired) that execute in this order:</p>
<ol>
<li>Actions to do with the old tool before it is released - macro name: <code>tfreeN.g</code> where N is the tool number;</li>
<li>(Old tool is released);</li>
<li>Actions to do with the new tool before it is selected - macro name: <code>tpreN.g</code> where N is the tool number;</li>
<li>(New tool is selected); and</li>
<li>Actions to do with the new tool after it is selected - macro name: <code>tpostN.g</code> where N is the tool number.</li>
</ol>
<p>With such implementations there is no wait for temperature stabilisation. That can be achieved by an <code>M116</code> in any of the macros, of course. However be aware that recent RepRapFirmware versions does NOT run any tool change macros if the axes are not homed.</p>
<p>After a reset tools will not start heating until they are selected. You can either put them all at their standby temperature by selecting them in turn, or leave them off so they only come on if&#x2F;when you first use them. The <code>M0</code>, <code>M1</code>, and <code>M112</code> commands turn them all off. You can, of course, turn them all off with the <code>M1</code> command, then turn some back on again. Don’t forget also to turn on the heated bed (if any) if you use that trick.</p>
<p>Tool numbering may start at 0 or 1, depending on the implementation. Some implementations (those that use the <code>M563</code> command to define tools) allow the user to specify tool numbers, so with them you can have tools 17, 99 and 203 if you want. Negative numbers are not allowed.</p>
<p>Notes</p>
<p><sup>1</sup> For RepRapFirmware, selecting a non-existent tool also removes any X&#x2F;Y&#x2F;Z offset applied for the old tool.</p>
<p><sup>2</sup> <code>T?</code> was the original form of the command, but it was changed to <code>Tx</code> when it was realized that the question mark character caused problems when printing through octoprint. This change was implemented in Prusa firmware 3.5.0.</p>
<p><sup>3</sup> Under special circumstances, the execution of those macro files may not be desired. RepRapFirmware 1.17b or later supports an optional <code>P</code> parameter to specify which macros shall be run. If absent then all the above macros will be run. Otherwise pass a bitmap of all the macros to be executed. The bitmap of this value consists of tfree&#x3D;1, tpre&#x3D;2 and tpost&#x3D;4.</p>
<h4 id="D-Debug-codes"><a href="#D-Debug-codes" class="headerlink" title="D: Debug codes"></a>D: Debug codes</h4><p>NOTE: These D codes are not compatible with the Gcode spec ( NIST Gcode spec, initially written for CNC, which Reprap initially messed up, after what the CNC side of Reprap has spent years trying to get Reprap back to respecting it ), and will make life hell for those building machines that do more than just 3D printing, or controllers that support this, as well as possibly cause other issues. I see this is from Prusa, and I know these guys are really cool about Open-Source, so I’m sure they care a lot about respecting standards and other projects as well, so I’m certain they’ll fix this as soon as they see there is an issue. Thankfully this is very easy to fix, just change from D1 to Mxxx D1, where you find a Mxxx Gcode that is currently free and start using it. In Gcode, only M, G and T are keywords, D is a parameter, you can’t make it a keyword without messing everything up. I’m sure for your subset of using Gcode, that’s probably just fine, but it’s not for the rest of us, and the whole point of adding things to this page, is for others to use it if they want&#x2F;can&#x2F;need, and the way it currently is ( breaking a standard ), this can’t be used by others. Links:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/G-code">https://en.wikipedia.org/wiki/G-code</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nist.gov/publications/nist-rs274ngc-interpreter-version-3">https://www.nist.gov/publications/nist-rs274ngc-interpreter-version-3</a></li>
</ul>
<p>This note by: – <a href="mailto:&#x77;&#111;&#108;&#x66;&#46;&#97;&#x72;&#x74;&#104;&#x75;&#x72;&#64;&#103;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;">&#x77;&#111;&#108;&#x66;&#46;&#97;&#x72;&#x74;&#104;&#x75;&#x72;&#64;&#103;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;</a></p>
<p>Debug codes are not active by defalut and must be defined in source code.</p>
<h5 id="D-1-Endless-Loop"><a href="#D-1-Endless-Loop" class="headerlink" title="D-1: Endless Loop"></a>D-1: Endless Loop</h5><p><em>-–</em></p>
<h5 id="D0-Reset"><a href="#D0-Reset" class="headerlink" title="D0: Reset"></a>D0: Reset</h5><p><em>This command will reset the board</em></p>
<p><code>B</code>: Bootloader</p>
<h5 id="D1-Clear-EEPROM-and-RESET"><a href="#D1-Clear-EEPROM-and-RESET" class="headerlink" title="D1: Clear EEPROM and RESET"></a>D1: Clear EEPROM and RESET</h5><p><em>This command will clear the EEPROM and reset the board</em></p>
<h5 id="D2-Read-Write-RAM"><a href="#D2-Read-Write-RAM" class="headerlink" title="D2: Read&#x2F;Write RAM"></a>D2: Read&#x2F;Write RAM</h5><p>Parameters</p>
<p><em>This command can be used without any additional parameters. It will read the entire RAM.</em></p>
<p><code>Annnn</code>: Address (x0000-x1fff)</p>
<p><code>Cnnnn</code>: Count (1-8192)</p>
<p><code>Xnnnn</code>: Data (hex)</p>
<p>Notes</p>
<p>The hex address needs to be lowercase without the 0 before the x</p>
<p>Count is decimal</p>
<p>The hex data needs to be lowercase</p>
<h5 id="D3-Read-Write-EEPROM"><a href="#D3-Read-Write-EEPROM" class="headerlink" title="D3: Read&#x2F;Write EEPROM"></a>D3: Read&#x2F;Write EEPROM</h5><p>Parameters</p>
<p><em>This command can be used without any additional parameters. It will read the entire EEPROM.</em></p>
<p><code>Annnn</code>: Address (x0000-x0fff)</p>
<p><code>Cnnnn</code>: Count (1-4096)</p>
<p><code>Xnnnn</code>: Data (hex)</p>
<p>Notes</p>
<p>The hex address needs to be lowercase without the 0 before the x</p>
<p>Count is decimal</p>
<p>The hex data needs to be lowercase</p>
<h5 id="D4-Read-Write-PIN"><a href="#D4-Read-Write-PIN" class="headerlink" title="D4: Read&#x2F;Write PIN"></a>D4: Read&#x2F;Write PIN</h5><p><em>To read the digital value of a pin you need only to define the pin number.</em></p>
<p>Parameters</p>
<p><code>Pnnn</code>: Pin (0-255)</p>
<p><code>Fn</code>: Function in&#x2F;out (0&#x2F;1)</p>
<p><code>Vn</code>: Value (0&#x2F;1)</p>
<h5 id="D5-Read-Write-FLASH"><a href="#D5-Read-Write-FLASH" class="headerlink" title="D5: Read&#x2F;Write FLASH"></a>D5: Read&#x2F;Write FLASH</h5><p>Parameters</p>
<p><em>This command can be used without any additional parameters. It will read the 1kb FLASH.</em></p>
<p><code>Annnn</code>: Address (x00000-x3ffff)</p>
<p><code>Cnnnn</code>: Count (1-8192)</p>
<p><code>Xnnnn</code>: Data (hex)</p>
<p><code>E</code>: Erase</p>
<p>Notes</p>
<p>The hex address needs to be lowercase without the 0 before the x</p>
<p>Count is decimal</p>
<p>The hex data needs to be lowercase</p>
<h5 id="D6-Read-Write-external-FLASH"><a href="#D6-Read-Write-external-FLASH" class="headerlink" title="D6: Read&#x2F;Write external FLASH"></a>D6: Read&#x2F;Write external FLASH</h5><p>Reserved</p>
<h5 id="D7-Read-Write-Bootloader"><a href="#D7-Read-Write-Bootloader" class="headerlink" title="D7: Read&#x2F;Write Bootloader"></a>D7: Read&#x2F;Write Bootloader</h5><p>Reserved</p>
<h5 id="D8-Read-Write-PINDA"><a href="#D8-Read-Write-PINDA" class="headerlink" title="D8: Read&#x2F;Write PINDA"></a>D8: Read&#x2F;Write PINDA</h5><p>Parameters</p>
<p><code>?</code>: Read PINDA temperature shift values</p>
<p><code>!</code>: Reset PINDA temperature shift values to default</p>
<p><code>Pnnn</code>: Pinda temperature [C]</p>
<p><code>Znnnn</code>: Z Offset [mm]</p>
<h5 id="D9-Read-Write-ADC"><a href="#D9-Read-Write-ADC" class="headerlink" title="D9: Read&#x2F;Write ADC"></a>D9: Read&#x2F;Write ADC</h5><p>Parameters</p>
<p><code>I(index)</code>: ADC channel index</p>
<p><code>I0</code>: Heater 0 temperature</p>
<p><code>I1</code>: Heater 1 temperature</p>
<p><code>I2</code>: Bed temperature</p>
<p><code>I3</code>: PINDA temperature</p>
<p><code>I4</code>: PWR voltage</p>
<p><code>I5</code>: Ambient temperature</p>
<p><code>I6</code>: BED voltage</p>
<p><code>V</code>: Value to be written as simulated</p>
<h5 id="D10-Set-XYZ-calibration-OK"><a href="#D10-Set-XYZ-calibration-OK" class="headerlink" title="D10: Set XYZ calibration &#x3D; OK"></a>D10: Set XYZ calibration &#x3D; OK</h5><h5 id="D12-Time"><a href="#D12-Time" class="headerlink" title="D12: Time"></a>D12: Time</h5><p><em>Writes current time in the log file.</em></p>
<h5 id="D20-Generate-an-offline-crash-dump"><a href="#D20-Generate-an-offline-crash-dump" class="headerlink" title="D20: Generate an offline crash dump"></a>D20: Generate an offline crash dump</h5><p><em>Generate a crash dump for later retrival.</em></p>
<p>Usage</p>
<p><code>D20 [E]</code></p>
<p>Parameters</p>
<p><code>E</code>: Perform an emergency crash dump (resets the printer).</p>
<p>Notes</p>
<p>A crash dump can be later recovered with D21, or cleared with D22.</p>
<p>An emergency crash dump includes register data, but will cause the printer to reset after the dump is completed.</p>
<h5 id="D21-Print-crash-dump-to-serial"><a href="#D21-Print-crash-dump-to-serial" class="headerlink" title="D21: Print crash dump to serial"></a>D21: Print crash dump to serial</h5><p><em>Output the complete crash dump (if present) to the serial.</em></p>
<p>Usage</p>
<p><code>D21</code></p>
<p>Notes</p>
<p>The starting address can vary between builds, but it’s always at the beginning of the data section.</p>
<h5 id="D22-Clear-crash-dump-state"><a href="#D22-Clear-crash-dump-state" class="headerlink" title="D22: Clear crash dump state"></a>D22: Clear crash dump state</h5><p><em>Clear an existing internal crash dump.</em></p>
<p>Usage</p>
<p><code>D22</code></p>
<h5 id="D23-Request-emergency-dump-on-serial"><a href="#D23-Request-emergency-dump-on-serial" class="headerlink" title="D23: Request emergency dump on serial"></a>D23: Request emergency dump on serial</h5><p><em>On boards without offline dump support, request online dumps to the serial port on firmware faults.</em></p>
<p><em>When online dumps are enabled, the FW will dump memory on the serial before resetting.</em></p>
<p>Usage</p>
<p><code>D23 [E] [R]</code></p>
<p>Parameters</p>
<p><code>E</code>: Perform an emergency crash dump (resets the printer).</p>
<p><code>R</code>: Disable online dumps.</p>
<h5 id="D80-Bed-check"><a href="#D80-Bed-check" class="headerlink" title="D80: Bed check"></a>D80: Bed check</h5><p><em>This command will log data to SD card file “mesh.txt”.</em></p>
<p>Parameters</p>
<p><code>E</code>: Dimension X (default 40)</p>
<p><code>F</code>: Dimension Y (default 40)</p>
<p><code>G</code>: Points X (default 40)</p>
<p><code>H</code>: Points Y (default 40)</p>
<p><code>I</code>: Offset X (default 74)</p>
<p><code>J</code>: Offset Y (default 34)</p>
<h5 id="D81-Bed-analysis"><a href="#D81-Bed-analysis" class="headerlink" title="D81: Bed analysis"></a>D81: Bed analysis</h5><p><em>This command will log data to SD card file “wldsd.txt”.</em></p>
<p>Parameters</p>
<p><code>E</code>: Dimension X (default 40)</p>
<p><code>F</code>: Dimension Y (default 40)</p>
<p><code>G</code>: Points X (default 40)</p>
<p><code>H</code>: Points Y (default 40)</p>
<p><code>I</code>: Offset X (default 74)</p>
<p><code>J</code>: Offset Y (default 34)</p>
<h5 id="D106-Print-measured-fan-speed-for-different-pwm-values"><a href="#D106-Print-measured-fan-speed-for-different-pwm-values" class="headerlink" title="D106: Print measured fan speed for different pwm values"></a>D106: Print measured fan speed for different pwm values</h5><h5 id="D2130-Trinamic-stepper-controller"><a href="#D2130-Trinamic-stepper-controller" class="headerlink" title="D2130: Trinamic stepper controller"></a>D2130: Trinamic stepper controller</h5><p>Reserved</p>
<h5 id="D9125-PAT9125-filament-sensor"><a href="#D9125-PAT9125-filament-sensor" class="headerlink" title="D9125: PAT9125 filament sensor"></a>D9125: PAT9125 filament sensor</h5><p><em>This command can be used without any additional parameters. It will read the PAT9125 values.</em></p>
<p>Parameters</p>
<p><code>?</code>: Print values</p>
<p><code>!</code>: Print values</p>
<p><code>R</code>: Resolution. Not active in code</p>
<p><code>X</code>: X values</p>
<p><code>Y</code>: Y values</p>
<p><code>L</code>: Activate filament sensor log</p>
<h2 id="Proposed-EEPROM-configuration-codes"><a href="#Proposed-EEPROM-configuration-codes" class="headerlink" title="Proposed EEPROM configuration codes"></a>Proposed EEPROM configuration codes</h2><p><strong>Background:</strong> Every 3D printer has parameters that need to be persistent but also easily tunable, such as extrusion steps-per-mm and various planner values. Some of these parameters are hardcoded in firmware so that a user has to modify, recompile, and re-flash the firmware for certain adjustments, while others can be modified with an M-code and stored to the EEPROM or other persistent storage.</p>
<p><strong>Current implementations:</strong></p>
<p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Marlin" title="Marlin">Marlin</a> and <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Sprinter" title="Sprinter">Sprinter</a> use G-codes <code>M500</code>-<code>M503</code> to save, load, reset, and report the settings mirrored in EEPROM. Note that the <code>M503</code> command reports settings that may not have been saved to EEPROM yet.</p>
<p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/Teacup" title="Teacup">Teacup</a> uses G-codes <code>M130</code>-<code>M136</code> to set, read, and save PID values.</p>
<p><a target="_blank" rel="noopener" href="https://reprap.org/mediawiki/index.php?title=Repetier_Firmware&action=edit&redlink=1" title="Repetier Firmware (page does not exist)">Repetier Firmware</a> uses <code>M206</code> to set a stored value (using an ID number) and <code>M205</code> to report settings.</p>
<p><a target="_blank" rel="noopener" href="https://reprap.org/wiki/RepRapFirmware" title="RepRapFirmware">RepRapFirmware</a> uses the <code>config-override.g</code> file on the SD card for settings storage. <code>M500</code> saves some values to that file, <code>M501</code> re-loads settings from this file, and <code>M502</code> loads the “factory settings” values from <code>config.g</code>, ignoring <code>config-override.g</code>.</p>
<p><em>Please see the RFC <a target="_blank" rel="noopener" href="https://reprap.org/wiki/M-codes_for_EEPROM_config" title="M-codes for EEPROM config">M-codes for EEPROM config</a> proposed by <a target="_blank" rel="noopener" href="https://reprap.org/wiki/User:AlexRa" title="User:AlexRa">AlexRa</a> in March of 2011. There is currently no working implementation of the proposed commands.</em></p>
<p>All communication is in printable ASCII characters.</p>
<p>Messages sent back to the host computer are terminated by a newline.</p>
<p>The basic protocol responses look like this:</p>
<p><strong>xx [line number to resend] [T:93.2 B:22.9] [C: X:9.2 Y:125.4 Z:3.7 E:1902.5] [Some debugging or other information may be here]</strong></p>
<p><code>xx</code> can be one of:</p>
<ul>
<li><code>ok</code> - The RepRap machine is ready to receive the next line from the host.</li>
<li><code>rs</code> or <code>Resend</code> - There was a communication error and the RepRap machine is requesting a resend of the line in question. The line is specified either as <code>N&lt;linenumber&gt;</code> or <code>N:&lt;linenumber&gt;</code>. Examples: <code>Resend: 123</code>, <code>Resend: N123</code>, <code>rs:123</code></li>
<li><code>!!</code> or <code>Error:</code> or <code>fatal:</code> (Repetier Firmware) - There was an error. Common communication errors such as <code>checksum mismatch, Last Line: &lt;number&gt;</code> or <code>Wrong checksum</code>, <code>No Checksum with line number, Last Line: &lt;number&gt;</code> or <code>Missing checksum</code>, <code>Line Number is not Last Line Number+1, Last Line: &lt;number&gt;</code> or <code>expected line &lt;number1&gt; got &lt;number2&gt;</code> are recoverable and should immediately be followed by a resend. Other non-fatal errors commonly include <code>Unknown command: &quot;&lt;command&gt;&quot;</code> and several SD related errors such as <code>Cannot open subdir &lt;dir&gt;</code>, <code>SD init fail</code>, <code>volume.init failed</code>, <code>openRoot failed</code>, <code>workDir open failed</code>, <code>open failed, File: &lt;name&gt;</code>, <code>error writing to file</code>, <code>Cannot enter subdir: &lt;dir&gt;</code> and <code>SD read error</code>. Any other errors indicate a hardware fault that will make the RepRap machine shut down immediately after it has sent this message. They should be considered fatal by hosts.</li>
<li><code>wait</code> - The RepRap machine’s command buffers are empty and it is waiting for the next line from the host.</li>
<li><code>busy:&lt;reason&gt;</code> - The RepRap machine is busy for some reason and currently cannot receive or process commands through the serial interface from a connected host. Possible reasons are: `processing` (the RepRap machine is busy with processing some lengthy command, like homing, heatup or auto leveling), <code>paused for user</code> (the RepRap machine is paused and awaiting an action by the user via its built in controller unit, e.g. clicking the button), <code>paused for input</code> (the RepRap machine is paused and waiting for input from the user via its built in controller unit, e.g. selecting a menu option). Examples: <code>busy: processing</code>, <code>busy: paused for user</code>.</li>
</ul>
<p>The <strong>T:</strong> and <strong>B:</strong> values are the temperature of the currently-selected extruder and the bed respectively, and are only sent in response to <code>M105</code>. If such temperatures don’t exist (for example for an extruder that works at room temperature and doesn’t have a sensor) then a value below absolute zero (-273<sup>o</sup>C) is returned.</p>
<p><strong>C:</strong> means that coordinates follow. Those are the <strong>X: Y:</strong> etc values. These are only sent in response to <code>M114</code> and <code>M117</code>.</p>
<p>The RepRap machine may also send lines that look like this:</p>
<p><strong>&#x2F;&#x2F; This is some debugging or other information on a line on its own. It may be sent at any time.</strong></p>
<p>Such lines will always be preceded by <strong>&#x2F;&#x2F;</strong>.</p>
<p>The most common response is simply:</p>
<p><code>ok</code></p>
<p>When the machine boots up it sends the string</p>
<p><code>start</code></p>
<p>once to the host before sending anything else. This should not be replaced or augmented by version numbers and the like. <code>M115</code> (see above) requests those.</p>
<p>Originally, every line sent by RepRap to the host computer except the start line was supposed to have a two-character prefix (one of <code>ok</code>, <code>rs</code>, <code>!!</code> or <code>//</code>). The machine should never send a line without such a prefix. These days, firmwares generally do not adhere to this rule and thus it should be considered obsolete.</p>
<h3 id="Example-of-a-communication-error-with-resend-request"><a href="#Example-of-a-communication-error-with-resend-request" class="headerlink" title="Example of a communication error with resend request"></a>Example of a communication error with resend request</h3><p><code>&gt;&gt;&gt;</code> are lines sent from the host to the RepRap machine, <code>&lt;&lt;&lt;</code> are lines sent from the RepRap machine to the host.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; N66555 G1 X131.338 Y133.349 E0.0091*91</span><br><span class="line">&lt;&lt;&lt; ok</span><br><span class="line">&gt;&gt;&gt; N66556 G1 X131.574 Y133.428 E0.0046*42</span><br><span class="line">&lt;&lt;&lt; Error:checksum mismatch, Last Line: 66555</span><br><span class="line">&lt;&lt;&lt; Resend: 66556</span><br><span class="line">&lt;&lt;&lt; ok</span><br><span class="line">&gt;&gt;&gt; N66556 G1 X131.574 Y133.428 E0.0046*92</span><br><span class="line">&lt;&lt;&lt; ok</span><br></pre></td></tr></table></figure>

<h3 id="Action-commands"><a href="#Action-commands" class="headerlink" title="Action commands"></a>Action commands</h3><p>The current versions of Pronterface and OctoPrint can interpret special commands sent by the firmware of the form:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//action:&lt;command&gt;</span><br></pre></td></tr></table></figure>

<p>Other hosts simply ignore or echo this output from the firmware.</p>
<p>The available Host Action Commands are:</p>
<ul>
<li><code>start</code>: Tell the host to start the currently selected print job. (OctoPrint 1.5.0+)</li>
<li><code>pause</code>: Tell the host to pause the print job.</li>
<li><code>resume</code>: Tell the host to resume the print job.</li>
<li><code>disconnect</code>: Tell the host to disconnect from the printer.</li>
<li><code>cancel</code>: Tell the host to abort the current job.</li>
<li><code>out_of_filament T&lt;extruder_id&gt;</code>: Tell the host that an extruder’s filament is out or jammed. Host should issue a pause and can offer better help to the user. For backwards-compatibility it should be followed by the <code>pause</code> action.</li>
<li><code>paused</code>: Tell the host that a printer-controlled print job was paused. (OctoPrint 1.3.9+)</li>
<li><code>resumed</code>: Tell the host that a printer-controlled print job was resumed. (OctoPrint 1.3.9+)</li>
<li><code>probe_rewipe</code>: Display a “<code>G29</code> Probing Retrying” alert. (Lulzbot Cura 3.6+)</li>
<li><code>probe_failed</code>: Cancel the print job and display a “<code>G29</code> Probing Failed” alert. (Lulzbot Cura 3.6+)</li>
<li><code>sd_inserted</code>: The SD card was inserted. Hosts should update internal state as needed. (OctoPrint 1.6.0+)</li>
<li><code>sd_ejected</code>: The SD card was ejected. Hosts should update internal state as needed. (OctoPrint 1.6.0+)</li>
<li><code>sd_updated</code>: The SD card was updated. Hosts should update internal state as needed. (OctoPrint 1.6.0+)</li>
</ul>
<p>Action commands can also be sent by the firmware to have the host show alerts and prompts for user feedback. The following commands are supported by OctoPrint 1.3.9 or later with the “Action Command Prompt support” plugin enabled.</p>
<ul>
<li><code>prompt_begin &lt;message&gt;</code>: Start a user prompt dialog that displays <code>&lt;message&gt;</code> to the user.</li>
<li><code>prompt_choice &lt;text&gt;</code>: Define a dialog choice with the associated <code>&lt;text&gt;</code>.</li>
<li><code>prompt_button &lt;text&gt;</code>: Same as <code>prompt_choice</code>.</li>
<li><code>prompt_show</code>: Tell the host to prompt the user with the defined dialog.</li>
<li><code>prompt_end</code>: Tell the host to close the dialog (e.g., the choice was made from the printer’s own UI).</li>
</ul>
<p>After showing a user dialog the host should wait for feedback and send the user’s selection back to the firmware with <code>M876 Snnn</code> as described in <a target="_blank" rel="noopener" href="https://reprap.org/wiki/G-Code#M876:_Dialog_handling" title="G-Code">G-Code#M876:_Dialog_handling</a>. On connection (or whenever the functionality is enabled in the host) the host can tell the firmware that it supports host dialogs by sending <code>M876 P1</code>.</p>
<p>For more detailed examples of <code>prompt_*</code> action command dialogs, see <a target="_blank" rel="noopener" href="http://docs.octoprint.org/en/master/bundledplugins/action_command_prompt.html">OctoPrint’s documentation</a>.</p>
<h3 id="Further-notes"><a href="#Further-notes" class="headerlink" title="Further notes"></a>Further notes</h3><p>RepRapFirmware responds to some commands with a reply string in JSON format, terminated by a newline. This allows later firmware revisions to include additional information without confusing clients (e.g. PanelDue) that do not expect it, and to make responses self-describing so that the client will not be confused if responses are delayed or lost. The commands affected are:</p>
<ul>
<li><code>M105 S2</code> (now deprecated in favor of <code>M408</code> and <code>M409</code>)</li>
<li><code>M105 S3</code> (now deprecated in favor of <code>M408</code> and <code>M409</code>)</li>
<li><code>M20 S2</code></li>
<li><code>M36</code></li>
<li><code>M408</code></li>
<li><code>M409</code></li>
</ul>
<p>It is also possible to generate GCODE by using ChatGPT prompts such as following source <a target="_blank" rel="noopener" href="https://addithive.com/2023/03/20/generating-gcode-for-3d-printing-with-chat-gpt-4/">additive blog</a> :</p>
<p>“write the gcode of 10cm * 10cm * 10cm cube with 50% infill for an open source reprap design 3d printer”</p>
<h2 id="Proposal-for-sending-multiple-lines-of-G-code"><a href="#Proposal-for-sending-multiple-lines-of-G-code" class="headerlink" title="Proposal for sending multiple lines of G-code"></a>Proposal for sending multiple lines of G-code</h2><p>So far, this is a proposal, open for discussion.</p>
<h4 id="Problem-to-solve"><a href="#Problem-to-solve" class="headerlink" title="Problem to solve"></a>Problem to solve</h4><p>When using Marlin firmware or emulating Marlin, each line of G-code sent from the host to the controller is answered with an <code>ok</code> before the next line can be sent without locking communications up. This slows down communication and limits the number of commands-per-second that can be sent to the control board, and the USB stack on the host and the serial interface driver on the Arduino also add their own latencies (up to 10 milliseconds). This is not a problem for other controller electronics using native USB such as the Duet, because the standard serial-over-USB drivers provide flow control, so the host software can be configured not to wait for the <code>ok</code>.</p>
<p>For more details on this proposal, some suggested solutions and comments, please see <a target="_blank" rel="noopener" href="https://reprap.org/wiki/GCODE_buffer_multiline_proposal" title="GCODE buffer multiline proposal">GCODE_buffer_multiline_proposal</a></p>
<h2 id="Alternatives-to-G-code"><a href="#Alternatives-to-G-code" class="headerlink" title="Alternatives to G-code"></a>Alternatives to G-code</h2><p><em>Main article: <a target="_blank" rel="noopener" href="https://reprap.org/wiki/Firmware/Alternative#alternatives_to_G-code" title="Firmware/Alternative">Firmware&#x2F;Alternative#alternatives to G-code</a></em></p>
<p>Several people have suggested using STEP-NC or some other control language; or perhaps designing a completely new control language.</p>
</article>
<div class="article-footer">
    <section id="license">
      <div class="header"><span>License</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    

</div>

<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">Newer</div><a href="/2025/02/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-%E7%BB%93%E6%9E%84%E7%AE%97%E6%B3%95-%E9%93%BE%E8%A1%A8%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%8F%96%E6%96%B9%E5%BC%8F/">链表和数组的数据存取方式</a></div><div class="item" id="next"><div class="note">Older</div><a href="/2025/02/24/4-Others-3D%E6%89%93%E5%8D%B0-%E5%A6%82%E4%BD%95%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%843D%E6%89%93%E5%8D%B0%E6%9C%BA%E4%B8%8A%E4%BD%8D%E6%9C%BA%EF%BC%9F%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E4%BA%86%E8%A7%A3%E4%B8%80%E4%B8%8B%EF%BC%81-%E8%85%BE%E8%AE%AF%E4%BA%91%E5%BC%80%E5%8F%91%E8%80%85%E7%A4%BE%E5%8C%BA-%E8%85%BE%E8%AE%AF%E4%BA%91/">如何打造属于自己的3D打印机上位机？这篇文章带你了解一下！-腾讯云开发者社区-腾讯云</a></div></section></div>




  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>快来参与讨论吧~</p>

    </section>
    <section class='body cmt-body utterances'>
      

<svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg>

<div id="utterances" repo="luhuaCyan/luhuaCyan.github.io" issue-term="title" theme="preferred-color-scheme" label="comment"></div>

    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="sitemap" style="column-count:4;"><div class="sitemap-group"><span class="fs15">博客</span><a href="/">近期发布</a><a href="/blog/categories/">分类</a><a href="/blog/tags/">标签</a><a href="/blog/archives/">归档</a></div><div class="sitemap-group"><span class="fs15">项目</span><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a></div><div class="sitemap-group"><span class="fs15">社交</span><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a></div><div class="sitemap-group"><span class="fs15">关于</span><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a><a href="/">xxx</a></div></div><div class="text"><p>本站为个人学习笔记记录和整理，所有内容仅用于个人知识梳理、复习回顾及学习交流。<br>声明：本站所有资源收集整理于网络,本站不参与制作,用于互联网爱好者学习和研究,如不慎侵犯了您的权利,请及时联系站长处理删除。敬请谅解！</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">On This Page</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fields"><span class="toc-text">Fields</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Case-sensitivity"><span class="toc-text">Case sensitivity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quoted-strings"><span class="toc-text">Quoted strings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-expressions-in-parameters"><span class="toc-text">Using expressions in parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Special-fields"><span class="toc-text">Special fields</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#N-Line-number"><span class="toc-text">N: Line number</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Checksum"><span class="toc-text">*: Checksum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CRC"><span class="toc-text">*: CRC</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Checking"><span class="toc-text">Checking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conditional-Execution-and-Loops"><span class="toc-text">Conditional Execution and Loops</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffering"><span class="toc-text">Buffering</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#G-commands"><span class="toc-text">G-commands</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#G0-G1-Move"><span class="toc-text">G0 &amp; G1: Move</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G2-G3-Controlled-Arc-Move"><span class="toc-text">G2 &amp; G3: Controlled Arc Move</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G4-Dwell"><span class="toc-text">G4: Dwell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G6-External-Motion-Control-Marlin"><span class="toc-text">G6: External Motion Control (Marlin)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G6-Direct-Stepper-Move-Druid"><span class="toc-text">G6: Direct Stepper Move (Druid)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G10-Set-tool-Offset-and-or-workplace-coordinates-and-or-tool-temperatures"><span class="toc-text">G10: Set tool Offset and&#x2F;or workplace coordinates and&#x2F;or tool temperatures</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G10-Retract"><span class="toc-text">G10: Retract</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G11-Unretract"><span class="toc-text">G11: Unretract</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G12-Clean-Tool"><span class="toc-text">G12: Clean Tool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G17-19-Plane-Selection-CNC-specific"><span class="toc-text">G17..19: Plane Selection (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G20-Set-Units-to-Inches"><span class="toc-text">G20: Set Units to Inches</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G21-Set-Units-to-Millimeters"><span class="toc-text">G21: Set Units to Millimeters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G22-Firmware-Retract"><span class="toc-text">G22: Firmware Retract</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G23-Firmware-Recover"><span class="toc-text">G23: Firmware Recover</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G26-Mesh-Validation-Pattern"><span class="toc-text">G26: Mesh Validation Pattern</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G27-Park-toolhead"><span class="toc-text">G27: Park toolhead</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G28-Move-to-Origin-Home"><span class="toc-text">G28: Move to Origin (Home)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G29-Detailed-Z-Probe"><span class="toc-text">G29: Detailed Z-Probe</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#G29-Auto-Bed-Leveling-Marlin-MK4duo"><span class="toc-text">G29 Auto Bed Leveling (Marlin - MK4duo)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G29-Unified-Bed-Leveling-Marlin-MK4duo"><span class="toc-text">G29 Unified Bed Leveling (Marlin - MK4duo)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G29-Manual-Bed-Leveling-Marlin-MK4duo"><span class="toc-text">G29 Manual Bed Leveling (Marlin - MK4duo)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G29-Auto-Bed-Leveling-Repetier-Firmware"><span class="toc-text">G29 Auto Bed Leveling (Repetier-Firmware)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G29-Mesh-Bed-Compensation-RepRapFirmware"><span class="toc-text">G29 Mesh Bed Compensation (RepRapFirmware)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G29-1-Set-Z-probe-head-offset"><span class="toc-text">G29.1: Set Z probe head offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G29-2-Set-Z-probe-head-offset-calculated-from-toolhead-position"><span class="toc-text">G29.2: Set Z probe head offset calculated from toolhead position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G30-Single-Z-Probe"><span class="toc-text">G30: Single Z-Probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G31-Set-or-Report-Current-Probe-status"><span class="toc-text">G31: Set or Report Current Probe status</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G31-Dock-Z-Probe-sled"><span class="toc-text">G31: Dock Z Probe sled</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G32-Probe-Z-and-calculate-Z-plane"><span class="toc-text">G32: Probe Z and calculate Z plane</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Probe-and-calculate-in-Reprapfirmware"><span class="toc-text">Probe and calculate in Reprapfirmware</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Probe-and-calculate-in-Repetier-firmware"><span class="toc-text">Probe and calculate in Repetier firmware</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G32-Undock-Z-Probe-sled"><span class="toc-text">G32: Undock Z Probe sled</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G33-Firmware-dependent"><span class="toc-text">G33: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#G33-Measure-List-Adjust-Distortion-Matrix-Repetier-Redeem"><span class="toc-text">G33: Measure&#x2F;List&#x2F;Adjust Distortion Matrix (Repetier - Redeem)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G33-Delta-Auto-Calibration-Marlin-1-1-x-MK4duo"><span class="toc-text">G33: Delta Auto Calibration (Marlin 1.1.x - MK4duo)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G34-Z-Stepper-Auto-Align"><span class="toc-text">G34: Z Stepper Auto-Align</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G34-Calculate-Delta-Height-from-toolhead-position-DELTA"><span class="toc-text">G34: Calculate Delta Height from toolhead position (DELTA)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G38-x-Straight-Probe-CNC-specific"><span class="toc-text">G38.x Straight Probe (CNC specific)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#G38-2-probe-toward-workpiece-stop-on-contact-signal-error-if-failure"><span class="toc-text">G38.2 probe toward workpiece, stop on contact, signal error if failure</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G38-3-probe-toward-workpiece-stop-on-contact"><span class="toc-text">G38.3 probe toward workpiece, stop on contact</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G38-4-probe-away-from-workpiece-stop-on-loss-of-contact-signal-error-if-failure"><span class="toc-text">G38.4 probe away from workpiece, stop on loss of contact, signal error if failure</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#G38-5-probe-away-from-workpiece-stop-on-loss-of-contact"><span class="toc-text">G38.5 probe away from workpiece, stop on loss of contact</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G40-Compensation-Off-CNC-specific"><span class="toc-text">G40: Compensation Off (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G42-Move-to-Grid-Point"><span class="toc-text">G42: Move to Grid Point</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G53-59-Coordinate-System-Select-CNC-specific"><span class="toc-text">G53..59: Coordinate System Select (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G60-Save-Restore-position"><span class="toc-text">G60: Save &#x2F; Restore position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G61-Restore-saved-position"><span class="toc-text">G61: Restore saved position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G68-Coordinate-rotation"><span class="toc-text">G68: Coordinate rotation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G69-Cancel-coordinate-rotation"><span class="toc-text">G69: Cancel coordinate rotation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G75-Print-temperature-interpolation"><span class="toc-text">G75: Print temperature interpolation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G76-PINDA-probe-temperature-calibration"><span class="toc-text">G76: PINDA probe temperature calibration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G80-Cancel-Canned-Cycle-CNC-specific"><span class="toc-text">G80: Cancel Canned Cycle (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G80-Mesh-based-Z-probe"><span class="toc-text">G80: Mesh-based Z probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G81-Mesh-bed-leveling-status"><span class="toc-text">G81: Mesh bed leveling status</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G82-Single-Z-probe-at-current-location"><span class="toc-text">G82: Single Z probe at current location</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G83-Babystep-in-Z-and-store-to-EEPROM"><span class="toc-text">G83: Babystep in Z and store to EEPROM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G84-UNDO-Babystep-Z-move-Z-axis-back"><span class="toc-text">G84: UNDO Babystep Z (move Z axis back)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G85-Pick-best-babystep"><span class="toc-text">G85: Pick best babystep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G86-Disable-babystep-correction-after-home"><span class="toc-text">G86: Disable babystep correction after home</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G87-Enable-babystep-correction-after-home"><span class="toc-text">G87: Enable babystep correction after home</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G88-Reserved"><span class="toc-text">G88: Reserved</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G90-Set-to-Absolute-Positioning"><span class="toc-text">G90: Set to Absolute Positioning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G91-Set-to-Relative-Positioning"><span class="toc-text">G91: Set to Relative Positioning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G92-Set-Position"><span class="toc-text">G92: Set Position</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#G92-x-Reset-Coordinate-System-Offsets-CNC-specific"><span class="toc-text">G92.x: Reset Coordinate System Offsets (CNC specific)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G93-Feed-Rate-Mode-Inverse-Time-Mode-CNC-specific"><span class="toc-text">G93: Feed Rate Mode (Inverse Time Mode) (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G94-Feed-Rate-Mode-Units-per-Minute-CNC-specific"><span class="toc-text">G94: Feed Rate Mode (Units per Minute) (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G98-Activate-farm-mode"><span class="toc-text">G98: Activate farm mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G99-Deactivate-farm-mode"><span class="toc-text">G99: Deactivate farm mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G100-Calibrate-floor-or-rod-radius"><span class="toc-text">G100: Calibrate floor or rod radius</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G130-Set-digital-potentiometer-value"><span class="toc-text">G130: Set digital potentiometer value</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G131-Remove-offset"><span class="toc-text">G131: Remove offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G132-Calibrate-endstop-offsets"><span class="toc-text">G132: Calibrate endstop offsets</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G133-Measure-steps-to-top"><span class="toc-text">G133: Measure steps to top</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G161-Home-axes-to-minimum"><span class="toc-text">G161: Home axes to minimum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G162-Home-axes-to-maximum"><span class="toc-text">G162: Home axes to maximum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#G425-Perform-auto-calibration-with-calibration-cube"><span class="toc-text">G425: Perform auto-calibration with calibration cube</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#M-commands"><span class="toc-text">M-commands</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#M0-Stop-or-Unconditional-stop"><span class="toc-text">M0: Stop or Unconditional stop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M1-Sleep-or-Conditional-stop"><span class="toc-text">M1: Sleep or Conditional stop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M2-Program-End"><span class="toc-text">M2: Program End</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M3-Spindle-On-Clockwise-CNC-specific"><span class="toc-text">M3: Spindle On, Clockwise (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M4-Spindle-On-Counter-Clockwise-CNC-specific"><span class="toc-text">M4: Spindle On, Counter-Clockwise (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M5-Spindle-Off-CNC-specific"><span class="toc-text">M5: Spindle Off (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M6-Tool-change"><span class="toc-text">M6: Tool change</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M7-Mist-Coolant-On-CNC-specific"><span class="toc-text">M7: Mist Coolant On (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M8-Flood-Coolant-On-CNC-specific"><span class="toc-text">M8: Flood Coolant On (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M9-Coolant-Off-CNC-specific"><span class="toc-text">M9: Coolant Off (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M10-Vacuum-On-CNC-specific"><span class="toc-text">M10: Vacuum On (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M11-Vacuum-Off-CNC-specific"><span class="toc-text">M11: Vacuum Off (CNC specific)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M13-Spindle-on-clockwise-rotation-and-coolant-on-flood"><span class="toc-text">M13: Spindle on (clockwise rotation) and coolant on (flood)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M16-Expected-Printer-Check"><span class="toc-text">M16: Expected Printer Check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M17-Enable-Power-all-stepper-motors"><span class="toc-text">M17: Enable&#x2F;Power all stepper motors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M18-Disable-all-stepper-motors"><span class="toc-text">M18: Disable all stepper motors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M20-List-SD-card"><span class="toc-text">M20: List SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M21-Initialize-SD-card"><span class="toc-text">M21: Initialize SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M22-Release-SD-card"><span class="toc-text">M22: Release SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M23-Select-SD-file"><span class="toc-text">M23: Select SD file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M24-Start-resume-SD-print"><span class="toc-text">M24: Start&#x2F;resume SD print</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M25-Pause-SD-print"><span class="toc-text">M25: Pause SD print</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M26-Set-SD-position"><span class="toc-text">M26: Set SD position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M28-Begin-write-to-SD-card"><span class="toc-text">M28: Begin write to SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M29-Stop-writing-to-SD-card"><span class="toc-text">M29: Stop writing to SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M30-Delete-a-file-on-the-SD-card"><span class="toc-text">M30: Delete a file on the SD card</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M30-Program-Stop"><span class="toc-text">M30: Program Stop</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M31-Output-time-since-last-M109-or-SD-card-start-to-serial"><span class="toc-text">M31: Output time since last M109 or SD card start to serial</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M32-Select-file-and-start-SD-print"><span class="toc-text">M32: Select file and start SD print</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M33-Get-the-long-name-for-an-SD-card-file-or-folder"><span class="toc-text">M33: Get the long name for an SD card file or folder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M33-Stop-and-Close-File-and-save-restart-gcode"><span class="toc-text">M33: Stop and Close File and save restart.gcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M34-Set-SD-file-sorting-options"><span class="toc-text">M34: Set SD file sorting options</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M35-Upload-firmware-NEXTION-from-SD"><span class="toc-text">M35: Upload firmware NEXTION from SD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M36-Return-file-information"><span class="toc-text">M36: Return file information</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M36-1-Return-embedded-thumbnail-data"><span class="toc-text">M36.1: Return embedded thumbnail data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M37-Simulation-mode"><span class="toc-text">M37: Simulation mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M38-Compute-SHA1-hash-of-target-file"><span class="toc-text">M38 Compute SHA1 hash of target file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M39-Report-SD-card-information"><span class="toc-text">M39 Report SD card information</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M40-Eject"><span class="toc-text">M40: Eject</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M41-Loop"><span class="toc-text">M41: Loop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M42-Switch-I-O-pin"><span class="toc-text">M42: Switch I&#x2F;O pin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M43-Stand-by-on-material-exhausted"><span class="toc-text">M43: Stand by on material exhausted</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M43-Pin-report-and-debug"><span class="toc-text">M43: Pin report and debug</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M44-Codes-debug-report-codes-available"><span class="toc-text">M44: Codes debug - report codes available</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M44-Reset-the-bed-skew-and-offset-calibration"><span class="toc-text">M44: Reset the bed skew and offset calibration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M45-Bed-skew-and-offset-with-manual-Z-up"><span class="toc-text">M45: Bed skew and offset with manual Z up</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M46-Show-the-assigned-IP-address"><span class="toc-text">M46: Show the assigned IP address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M47-Show-end-stops-dialog-on-the-display"><span class="toc-text">M47: Show end stops dialog on the display</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M48-Measure-Z-Probe-repeatability"><span class="toc-text">M48: Measure Z-Probe repeatability</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M49-Set-G26-debug-flag"><span class="toc-text">M49: Set G26 debug flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M70-Display-message"><span class="toc-text">M70: Display message</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M72-Firmware-dependent"><span class="toc-text">M72: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M72-Play-a-tone-or-song"><span class="toc-text">M72: Play a tone or song</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M72-Set-get-Printer-State"><span class="toc-text">M72: Set&#x2F;get Printer State</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M73-Set-Get-build-percentage"><span class="toc-text">M73: Set&#x2F;Get build percentage</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M74-Set-weight-on-print-bed"><span class="toc-text">M74: Set weight on print bed</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M75-Start-the-print-job-timer"><span class="toc-text">M75: Start the print job timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M76-Pause-the-print-job-timer"><span class="toc-text">M76: Pause the print job timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M77-Stop-the-print-job-timer"><span class="toc-text">M77: Stop the print job timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M78-Show-statistical-information-about-the-print-jobs"><span class="toc-text">M78: Show statistical information about the print jobs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M79-Start-host-timer"><span class="toc-text">M79: Start host timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M80-ATX-Power-On"><span class="toc-text">M80: ATX Power On</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M81-ATX-Power-Off"><span class="toc-text">M81: ATX Power Off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M82-Set-extruder-to-absolute-mode"><span class="toc-text">M82: Set extruder to absolute mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M83-Set-extruder-to-relative-mode"><span class="toc-text">M83: Set extruder to relative mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M84-Stop-idle-hold"><span class="toc-text">M84: Stop idle hold</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M85-Set-Inactivity-Shutdown-Timer"><span class="toc-text">M85: Set Inactivity Shutdown Timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M86-Set-Safety-Timeout"><span class="toc-text">M86: Set Safety Timeout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M87-Cancel-Safety-Timer"><span class="toc-text">M87: Cancel Safety Timer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M92-Set-axis-steps-per-unit"><span class="toc-text">M92: Set axis_steps_per_unit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M93-Send-axis-steps-per-unit"><span class="toc-text">M93: Send axis_steps_per_unit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M98-Call-Macro-Subprogram"><span class="toc-text">M98: Call Macro&#x2F;Subprogram</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M99-Return-from-Macro-Subprogram"><span class="toc-text">M99: Return from Macro&#x2F;Subprogram</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M101-Turn-extruder-1-on-Forward-Undo-Retraction"><span class="toc-text">M101: Turn extruder 1 on (Forward), Undo Retraction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M102-Turn-extruder-1-on-Reverse"><span class="toc-text">M102: Turn extruder 1 on (Reverse)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M102-Configure-Distance-Sensor"><span class="toc-text">M102: Configure Distance Sensor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M103-Turn-all-extruders-off-Extruder-Retraction"><span class="toc-text">M103: Turn all extruders off, Extruder Retraction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M104-Set-Extruder-Temperature"><span class="toc-text">M104: Set Extruder Temperature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M104-in-Marlin-Firmware"><span class="toc-text">M104 in Marlin Firmware</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M104-in-Teacup-Firmware"><span class="toc-text">M104 in Teacup Firmware</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M104-in-RepRapFirmware-and-Klipper"><span class="toc-text">M104 in RepRapFirmware and Klipper</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M105-Get-Extruder-Temperature"><span class="toc-text">M105: Get Extruder Temperature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M106-Fan-On"><span class="toc-text">M106: Fan On</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M106-in-RepRapFirmware"><span class="toc-text">M106 in RepRapFirmware</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M106-in-Teacup-Firmware"><span class="toc-text">M106 in Teacup Firmware</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M107-Fan-Off"><span class="toc-text">M107: Fan Off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M108-Cancel-Heating"><span class="toc-text">M108: Cancel Heating</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M108-Set-Extruder-Speed-BFB"><span class="toc-text">M108: Set Extruder Speed (BFB)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M109-Set-Extruder-Temperature-and-Wait"><span class="toc-text">M109: Set Extruder Temperature and Wait</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M109-in-Teacup"><span class="toc-text">M109 in Teacup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M109-in-Marlin-MK4duo-Sprinter-ATmega-port-RepRapFirmware-Prusa"><span class="toc-text">M109 in Marlin, MK4duo, Sprinter (ATmega port), RepRapFirmware, Prusa</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M109-in-Sprinter-4pi-port"><span class="toc-text">M109 in Sprinter (4pi port)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M109-in-MakerBot"><span class="toc-text">M109 in MakerBot</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M109-in-Klipper"><span class="toc-text">M109 in Klipper</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M110-Set-Current-Line-Number"><span class="toc-text">M110: Set Current Line Number</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M111-Set-Debug-Level"><span class="toc-text">M111: Set Debug Level</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M111-in-RepRapFirmware"><span class="toc-text">M111 in RepRapFirmware</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M111-in-Repetier"><span class="toc-text">M111 in Repetier</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M112-Full-Emergency-Stop"><span class="toc-text">M112: Full (Emergency) Stop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M113-Set-Extruder-PWM"><span class="toc-text">M113: Set Extruder PWM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M113-Host-Keepalive"><span class="toc-text">M113: Host Keepalive</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M114-Get-Current-Position"><span class="toc-text">M114: Get Current Position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M115-Get-Firmware-Version-and-Capabilities"><span class="toc-text">M115: Get Firmware Version and Capabilities</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M116-Wait"><span class="toc-text">M116: Wait</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M117-Get-Zero-Position"><span class="toc-text">M117: Get Zero Position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M117-Display-Message"><span class="toc-text">M117: Display Message</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M118-Echo-message-on-host"><span class="toc-text">M118: Echo message on host</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M118-Negotiate-Features"><span class="toc-text">M118: Negotiate Features</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M119-Get-Endstop-Status"><span class="toc-text">M119: Get Endstop Status</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M120-Push"><span class="toc-text">M120: Push</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M121-Pop"><span class="toc-text">M121: Pop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M120-Enable-endstop-detection"><span class="toc-text">M120: Enable endstop detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M121-Disable-endstop-detection"><span class="toc-text">M121: Disable endstop detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M122-Firmware-dependent"><span class="toc-text">M122: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M122-Diagnose-RepRapFirmware"><span class="toc-text">M122: Diagnose (RepRapFirmware)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M122-Set-Software-Endstop-MK4duo"><span class="toc-text">M122: Set Software Endstop (MK4duo)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M122-Debug-Stepper-drivers-Marlin"><span class="toc-text">M122: Debug Stepper drivers (Marlin)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M123-Firmware-dependent"><span class="toc-text">M123: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M123-Tachometer-value-RepRap-Prusa-Marlin"><span class="toc-text">M123: Tachometer value (RepRap, Prusa &amp; Marlin)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M123-Endstop-Logic-MK4duo"><span class="toc-text">M123: Endstop Logic (MK4duo)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M124-Firmware-dependent"><span class="toc-text">M124: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M124-Immediate-motor-stop"><span class="toc-text">M124: Immediate motor stop</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M124-Set-Endstop-Pullup"><span class="toc-text">M124: Set Endstop Pullup</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M125-Firmware-dependent"><span class="toc-text">M125: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M125-Park-Head"><span class="toc-text">M125: Park Head</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M125-Pause-print"><span class="toc-text">M125: Pause print</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M126-Open-Valve"><span class="toc-text">M126: Open Valve</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M126-in-MakerBot"><span class="toc-text">M126 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M127-Close-Valve"><span class="toc-text">M127: Close Valve</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M127-in-MakerBot"><span class="toc-text">M127 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M128-Extruder-Pressure-PWM"><span class="toc-text">M128: Extruder Pressure PWM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M129-Extruder-pressure-off"><span class="toc-text">M129: Extruder pressure off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M130-Set-PID-P-value"><span class="toc-text">M130: Set PID P value</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M131-Set-PID-I-value"><span class="toc-text">M131: Set PID I value</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M132-Set-PID-D-value"><span class="toc-text">M132: Set PID D value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M132-in-MakerBot"><span class="toc-text">M132 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M133-Set-PID-I-limit-value"><span class="toc-text">M133: Set PID I limit value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M133-in-MakerBot"><span class="toc-text">M133 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M134-Write-PID-values-to-EEPROM"><span class="toc-text">M134: Write PID values to EEPROM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M134-in-MakerBot"><span class="toc-text">M134 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M135-Set-PID-sample-interval"><span class="toc-text">M135: Set PID sample interval</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M135-in-MakerBot"><span class="toc-text">M135 in MakerBot</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M136-Print-PID-settings-to-host"><span class="toc-text">M136: Print PID settings to host</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M140-Set-Bed-Temperature-Fast"><span class="toc-text">M140: Set Bed Temperature (Fast)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M141-Set-Chamber-Temperature-Fast"><span class="toc-text">M141: Set Chamber Temperature (Fast)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M142-Firmware-dependent"><span class="toc-text">M142: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M142-Holding-Pressure"><span class="toc-text">M142: Holding Pressure</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M142-Set-Cooler-Temperature-Fast"><span class="toc-text">M142: Set Cooler Temperature (Fast)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M143-Firmware-dependent"><span class="toc-text">M143: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M143-Set-Laser-Cooler-Temperature-Fast"><span class="toc-text">M143: Set Laser Cooler Temperature (Fast)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M143-Maximum-heater-temperature"><span class="toc-text">M143: Maximum heater temperature</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M144-Bed-Standby"><span class="toc-text">M144: Bed Standby</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M146-Set-Chamber-Humidity"><span class="toc-text">M146: Set Chamber Humidity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M149-Set-temperature-units"><span class="toc-text">M149: Set temperature units</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M150-Set-LED-color"><span class="toc-text">M150: Set LED color</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M154-Auto-Report-Position"><span class="toc-text">M154: Auto Report Position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M155-Automatically-send-temperatures"><span class="toc-text">M155: Automatically send temperatures</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M160-Number-of-mixed-materials"><span class="toc-text">M160: Number of mixed materials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M163-Set-weight-of-mixed-material"><span class="toc-text">M163: Set weight of mixed material</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M164-Store-weights"><span class="toc-text">M164: Store weights</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M165-Set-multiple-mix-weights"><span class="toc-text">M165: Set multiple mix weights</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M190-Wait-for-bed-temperature-to-reach-target-temp"><span class="toc-text">M190: Wait for bed temperature to reach target temp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M191-Wait-for-chamber-temperature-to-reach-target-temp"><span class="toc-text">M191: Wait for chamber temperature to reach target temp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M192-Wait-for-Probe-Temperature"><span class="toc-text">M192: Wait for Probe Temperature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M193-Set-Laser-Cooler-Temperature"><span class="toc-text">M193: Set Laser Cooler Temperature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M200-Set-filament-diameter"><span class="toc-text">M200: Set filament diameter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M201-Set-max-acceleration"><span class="toc-text">M201: Set max acceleration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M201-1-Set-reduced-acceleration-for-special-move-types"><span class="toc-text">M201.1: Set reduced acceleration for special move types</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M202-Set-max-travel-acceleration"><span class="toc-text">M202: Set max travel acceleration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M203-Firmware-dependent"><span class="toc-text">M203: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M203-Set-maximum-feedrate"><span class="toc-text">M203: Set maximum feedrate</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M203-Repetier-Set-temperature-monitor"><span class="toc-text">M203 (Repetier): Set temperature monitor</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M204-Firmware-dependent"><span class="toc-text">M204: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M204-Set-default-acceleration"><span class="toc-text">M204: Set default acceleration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M204-Set-PID-values"><span class="toc-text">M204: Set PID values</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M205-Firmware-dependent"><span class="toc-text">M205: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M205-Advanced-settings"><span class="toc-text">M205: Advanced settings</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M205-EEPROM-Report"><span class="toc-text">M205: EEPROM Report</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M206-Firmware-dependent"><span class="toc-text">M206: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M206-Offset-axes"><span class="toc-text">M206: Offset axes</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M206-Set-EEPROM-value"><span class="toc-text">M206: Set EEPROM value</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M207-Firmware-dependent"><span class="toc-text">M207: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M207-Set-retract-length"><span class="toc-text">M207: Set retract length</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M207-Calibrate-Z-axis-with-Z-max-endstop"><span class="toc-text">M207 Calibrate Z axis with Z max endstop</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M207-Repetier-Set-jerk-without-saving-to-EEPROM"><span class="toc-text">M207 (Repetier): Set jerk without saving to EEPROM</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M208-Firmware-dependent"><span class="toc-text">M208: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M208-Set-unretract-length"><span class="toc-text">M208: Set unretract length</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M208-RepRapFirmware-Set-axis-max-travel"><span class="toc-text">M208 (RepRapFirmware): Set axis max travel</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M209-Enable-automatic-retract"><span class="toc-text">M209: Enable automatic retract</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M210-Set-homing-feedrates"><span class="toc-text">M210: Set homing feedrates</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M211-Disable-Enable-software-endstops"><span class="toc-text">M211: Disable&#x2F;Enable software endstops</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M212-Set-Bed-Level-Sensor-Offset"><span class="toc-text">M212: Set Bed Level Sensor Offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M214-Set-Arc-configuration-values"><span class="toc-text">M214: Set Arc configuration values</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M217-Toolchange-Parameters"><span class="toc-text">M217: Toolchange Parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M218-Set-Hotend-Offset"><span class="toc-text">M218: Set Hotend Offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M220-Set-speed-factor-override-percentage"><span class="toc-text">M220: Set speed factor override percentage</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M221-Set-extrude-factor-override-percentage"><span class="toc-text">M221: Set extrude factor override percentage</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M220-Turn-off-AUX-V1-0-5"><span class="toc-text">M220: Turn off AUX V1.0.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M221-Turn-on-AUX-V1-0-5"><span class="toc-text">M221: Turn on AUX V1.0.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M222-Set-speed-of-fast-XY-moves"><span class="toc-text">M222: Set speed of fast XY moves</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M223-Set-speed-of-fast-Z-moves"><span class="toc-text">M223: Set speed of fast Z moves</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M224-Enable-extruder-during-fast-moves"><span class="toc-text">M224: Enable extruder during fast moves</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M225-Disable-on-extruder-during-fast-moves"><span class="toc-text">M225: Disable on extruder during fast moves</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M226-G-code-Initiated-Pause"><span class="toc-text">M226: G-code Initiated Pause</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M226-Wait-for-pin-state"><span class="toc-text">M226: Wait for pin state</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M227-Enable-Automatic-Reverse-and-Prime"><span class="toc-text">M227: Enable Automatic Reverse and Prime</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M228-Disable-Automatic-Reverse-and-Prime"><span class="toc-text">M228: Disable Automatic Reverse and Prime</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M229-Enable-Automatic-Reverse-and-Prime"><span class="toc-text">M229: Enable Automatic Reverse and Prime</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M230-Disable-Enable-Wait-for-Temperature-Change"><span class="toc-text">M230: Disable &#x2F; Enable Wait for Temperature Change</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M231-Set-OPS-parameter"><span class="toc-text">M231: Set OPS parameter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M232-Read-and-reset-max-advance-values"><span class="toc-text">M232: Read and reset max. advance values</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M240-Trigger-camera"><span class="toc-text">M240: Trigger camera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M240-Start-conveyor-belt-motor-Echo-off"><span class="toc-text">M240: Start conveyor belt motor &#x2F; Echo off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M241-Stop-conveyor-belt-motor-echo-on"><span class="toc-text">M241: Stop conveyor belt motor &#x2F; echo on</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M245-Start-cooler"><span class="toc-text">M245: Start cooler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M246-Stop-cooler"><span class="toc-text">M246: Stop cooler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M250-Set-LCD-contrast"><span class="toc-text">M250: Set LCD contrast</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M256-Set-LCD-brightness"><span class="toc-text">M256: Set LCD brightness</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M251-Measure-Z-steps-from-homing-stop-Delta-printers"><span class="toc-text">M251: Measure Z steps from homing stop (Delta printers)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M260-i2c-Send-Data"><span class="toc-text">M260: i2c Send Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M260-1-Modbus-Write-register-s"><span class="toc-text">M260.1: Modbus Write register(s)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M261-i2c-Request-Data"><span class="toc-text">M261: i2c Request Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M261-1-Modbus-Read-Input-Registers"><span class="toc-text">M261.1: Modbus Read Input Registers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M280-Set-servo-position"><span class="toc-text">M280: Set servo position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M281-Set-Servo-Angles"><span class="toc-text">M281: Set Servo Angles</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M282-Detach-Servo"><span class="toc-text">M282: Detach Servo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M290-Babystepping"><span class="toc-text">M290: Babystepping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M291-Display-message-and-optionally-wait-for-response"><span class="toc-text">M291: Display message and optionally wait for response</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M292-Acknowledge-message"><span class="toc-text">M292: Acknowledge message</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M293-Babystep-Z"><span class="toc-text">M293: Babystep Z+</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M294-Babystep-Z"><span class="toc-text">M294: Babystep Z-</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M300-Play-beep-sound"><span class="toc-text">M300: Play beep sound</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M301-Set-PID-parameters"><span class="toc-text">M301: Set PID parameters</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MK4duo"><span class="toc-text">MK4duo</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Marlin"><span class="toc-text">Marlin</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RepRapFirmware-1-15-onwards"><span class="toc-text">RepRapFirmware 1.15 onwards</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RepRapFirmware-1-09-to-1-14-inclusive"><span class="toc-text">RepRapFirmware 1.09 to 1.14 inclusive</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Smoothie"><span class="toc-text">Smoothie</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Other-implementations"><span class="toc-text">Other implementations</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Teacup"><span class="toc-text">Teacup</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M302-Allow-cold-extrudes"><span class="toc-text">M302: Allow cold extrudes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M303-Run-PID-tuning"><span class="toc-text">M303: Run PID tuning</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M304-Set-PID-parameters-Bed"><span class="toc-text">M304: Set PID parameters - Bed</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M304-in-RepRapPro-version-of-Marlin-Set-thermistor-values"><span class="toc-text">M304 in RepRapPro version of Marlin: Set thermistor values</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M305-Set-thermistor-and-ADC-parameters"><span class="toc-text">M305: Set thermistor and ADC parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M306-Set-home-offset-calculated-from-toolhead-position"><span class="toc-text">M306: Set home offset calculated from toolhead position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M307-Set-or-report-heating-process-parameters"><span class="toc-text">M307: Set or report heating process parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M308-Set-or-report-sensor-parameters"><span class="toc-text">M308: Set or report sensor parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M309-Set-or-report-heater-feedforward"><span class="toc-text">M309: Set or report heater feedforward</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M310-Temperature-model-settings"><span class="toc-text">M310: Temperature model settings</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M320-Activate-autolevel-Repetier"><span class="toc-text">M320: Activate autolevel (Repetier)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M321-Deactivate-autolevel-Repetier"><span class="toc-text">M321: Deactivate autolevel (Repetier)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M322-Reset-autolevel-matrix-Repetier"><span class="toc-text">M322: Reset autolevel matrix (Repetier)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M323-Distortion-correction-on-off-Repetier"><span class="toc-text">M323: Distortion correction on&#x2F;off (Repetier)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M340-Control-the-servos"><span class="toc-text">M340: Control the servos</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M350-Set-microstepping-mode"><span class="toc-text">M350: Set microstepping mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M351-Toggle-MS1-MS2-pins-directly"><span class="toc-text">M351: Toggle MS1 MS2 pins directly</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M355-Turn-case-lights-on-off"><span class="toc-text">M355: Turn case lights on&#x2F;off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M360-Report-firmware-configuration"><span class="toc-text">M360: Report firmware configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SCARA-calibration-codes-Morgan"><span class="toc-text">SCARA calibration codes (Morgan)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M360-Move-to-Theta-0-degree-position"><span class="toc-text">M360: Move to Theta 0 degree position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M361-Move-to-Theta-90-degree-position"><span class="toc-text">M361: Move to Theta 90 degree position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M362-Move-to-Psi-0-degree-position"><span class="toc-text">M362: Move to Psi 0 degree position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M363-Move-to-Psi-90-degree-position"><span class="toc-text">M363: Move to Psi 90 degree position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M364-Move-to-Psi-Theta-90-degree-position"><span class="toc-text">M364: Move to Psi + Theta 90 degree position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M365-SCARA-scaling-factor"><span class="toc-text">M365: SCARA scaling factor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M366-SCARA-convert-trim"><span class="toc-text">M366: SCARA convert trim</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M370-Morgan-manual-bed-level-clear-map"><span class="toc-text">M370: Morgan manual bed level - clear map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M371-Move-to-next-calibration-position"><span class="toc-text">M371: Move to next calibration position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M372-Record-calibration-value-and-move-to-next-position"><span class="toc-text">M372: Record calibration value, and move to next position</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M373-End-bed-level-calibration-mode"><span class="toc-text">M373: End bed level calibration mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M374-Save-calibration-grid"><span class="toc-text">M374: Save calibration grid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M375-Display-matrix-Load-Matrix"><span class="toc-text">M375: Display matrix &#x2F; Load Matrix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M376-Set-bed-compensation-taper"><span class="toc-text">M376: Set bed compensation taper</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M380-Activate-solenoid"><span class="toc-text">M380: Activate solenoid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M381-Disable-all-solenoids"><span class="toc-text">M381: Disable all solenoids</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M400-Wait-for-current-moves-to-finish"><span class="toc-text">M400: Wait for current moves to finish</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M401-Deploy-Z-Probe"><span class="toc-text">M401: Deploy Z Probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M402-Stow-Z-Probe"><span class="toc-text">M402: Stow Z Probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M403-Set-filament-type-material-for-particular-extruder-and-notify-the-MMU"><span class="toc-text">M403: Set filament type (material) for particular extruder and notify the MMU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M404-Filament-diameter"><span class="toc-text">M404: Filament diameter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M405-Filament-Sensor-on"><span class="toc-text">M405: Filament Sensor on</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M406-Filament-Sensor-off"><span class="toc-text">M406: Filament Sensor off</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M407-Display-filament-diameter"><span class="toc-text">M407: Display filament diameter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M408-Report-JSON-style-response"><span class="toc-text">M408: Report JSON-style response</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M409-Query-object-model"><span class="toc-text">M409: Query object model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M410-Quick-Stop"><span class="toc-text">M410: Quick-Stop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M412-Disable-Filament-Runout-Detection"><span class="toc-text">M412: Disable Filament Runout Detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M413-Power-Loss-Recovery"><span class="toc-text">M413: Power-Loss Recovery</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M415-Host-Rescue"><span class="toc-text">M415: Host Rescue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M416-Power-loss"><span class="toc-text">M416: Power loss</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M420-Firmware-dependent"><span class="toc-text">M420: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M420-Set-RGB-Colors-as-PWM-MachineKit"><span class="toc-text">M420: Set RGB Colors as PWM (MachineKit)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M420-Leveling-On-Off-Fade-Marlin"><span class="toc-text">M420: Leveling On&#x2F;Off&#x2F;Fade (Marlin)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M420-Mesh-bed-leveling-status"><span class="toc-text">M420: Mesh bed leveling status</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M421-Set-a-Mesh-Bed-Leveling-Z-coordinate"><span class="toc-text">M421: Set a Mesh Bed Leveling Z coordinate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M422-Set-a-G34-Point"><span class="toc-text">M422: Set a G34 Point</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M423-X-Axis-Twist-Compensation"><span class="toc-text">M423: X-Axis Twist Compensation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M424-Global-Z-Offset"><span class="toc-text">M424: Global Z Offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M425-Backlash-Correction"><span class="toc-text">M425: Backlash Correction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M450-Report-Printer-Mode"><span class="toc-text">M450: Report Printer Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M451-Select-FFF-Printer-Mode"><span class="toc-text">M451: Select FFF Printer Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M452-Select-Laser-Printer-Mode"><span class="toc-text">M452: Select Laser Printer Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M453-Select-CNC-Printer-Mode"><span class="toc-text">M453: Select CNC Printer Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M460-Define-temperature-range-for-thermistor-controlled-fan"><span class="toc-text">M460: Define temperature range for thermistor-controlled fan</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M470-Create-Directory-on-SD-Card"><span class="toc-text">M470: Create Directory on SD-Card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M471-Rename-File-Directory-on-SD-Card"><span class="toc-text">M471: Rename File&#x2F;Directory on SD-Card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M472-Delete-File-Directory-on-SD-Card"><span class="toc-text">M472: Delete File&#x2F;Directory on SD-Card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M486-Cancel-Object"><span class="toc-text">M486: Cancel Object</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M493-Fixed-Time-Motion-Control"><span class="toc-text">M493: Fixed-Time Motion Control</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M500-Store-parameters-in-non-volatile-storage"><span class="toc-text">M500: Store parameters in non-volatile storage</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M501-Read-parameters-from-EEPROM"><span class="toc-text">M501: Read parameters from EEPROM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M502-Restore-Default-Settings"><span class="toc-text">M502: Restore Default Settings</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M503-Report-Current-Settings"><span class="toc-text">M503: Report Current Settings</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M504-Validate-EEPROM"><span class="toc-text">M504: Validate EEPROM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M505-Firmware-dependent"><span class="toc-text">M505: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M505-Clear-EEPROM-and-RESET-Printer"><span class="toc-text">M505: Clear EEPROM and RESET Printer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M505-Set-configuration-file-folder"><span class="toc-text">M505: Set configuration file folder</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M505-Set-a-named-EEPROM-value"><span class="toc-text">M505: Set a named EEPROM value</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M509-Force-language-selection"><span class="toc-text">M509: Force language selection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M510-Lock-Machine"><span class="toc-text">M510: Lock Machine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M511-Unlock-Machine-with-Passcode"><span class="toc-text">M511: Unlock Machine with Passcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M512-Set-Passcode"><span class="toc-text">M512: Set Passcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M513-Remove-Password"><span class="toc-text">M513: Remove Password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M524-Abort-SD-Printing"><span class="toc-text">M524: Abort SD Printing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M530-Enable-printing-mode"><span class="toc-text">M530: Enable printing mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M531-Set-print-name"><span class="toc-text">M531: Set print name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M532-Set-print-progress"><span class="toc-text">M532: Set print progress</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M540-Set-MAC-address"><span class="toc-text">M540: Set MAC address</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M540-in-Marlin-Druid-MK4duo-Enable-Disable-%E2%80%9CStop-SD-Print-on-Endstop-Hit%E2%80%9D"><span class="toc-text">M540 in Marlin&#x2F;Druid&#x2F;MK4duo: Enable&#x2F;Disable “Stop SD Print on Endstop Hit”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M544-Gcode-Parser-Options"><span class="toc-text">M544: Gcode Parser Options</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M550-Set-Name"><span class="toc-text">M550: Set Name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M551-Set-Password"><span class="toc-text">M551: Set Password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M552-Set-IP-address-enable-disable-network-interface"><span class="toc-text">M552: Set IP address, enable&#x2F;disable network interface</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M553-Set-Netmask"><span class="toc-text">M553: Set Netmask</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M554-Set-Gateway-and-or-DNS-server"><span class="toc-text">M554: Set Gateway and&#x2F;or DNS server</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M555-Set-compatibility"><span class="toc-text">M555: Set compatibility</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M555-Set-Bounding-Box"><span class="toc-text">M555: Set Bounding Box</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M556-Axis-compensation"><span class="toc-text">M556: Axis compensation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M557-Set-Z-probe-point-or-define-probing-grid"><span class="toc-text">M557: Set Z probe point or define probing grid</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M558-Set-Z-probe-type"><span class="toc-text">M558: Set Z probe type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M558-1-Calibrate-height-vs-reading-for-analog-Z-probe"><span class="toc-text">M558.1: Calibrate height vs. reading for analog Z probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M558-2-Set-report-or-calibrate-drive-current-for-analog-Z-probe"><span class="toc-text">M558.2: Set, report or calibrate drive current for analog Z probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M558-3-Set-touch-mode-parameters-for-analog-Z-probe"><span class="toc-text">M558.3: Set touch mode parameters for analog Z probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M559-Upload-configuration-file"><span class="toc-text">M559: Upload configuration file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M560-Upload-web-page-file"><span class="toc-text">M560: Upload web page file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M561-Set-Identity-Transform"><span class="toc-text">M561: Set Identity Transform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M562-Reset-temperature-fault"><span class="toc-text">M562: Reset temperature fault</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M563-Define-or-remove-a-tool"><span class="toc-text">M563: Define or remove a tool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M564-Limit-axes"><span class="toc-text">M564: Limit axes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M565-Set-Z-probe-offset"><span class="toc-text">M565: Set Z probe offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M566-Set-allowable-instantaneous-speed-change"><span class="toc-text">M566: Set allowable instantaneous speed change</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M567-Set-tool-mix-ratios"><span class="toc-text">M567: Set tool mix ratios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M568-Tool-settings"><span class="toc-text">M568: Tool settings</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M568-Turn-off-on-tool-mix-ratios-obsolete-meaning-in-old-RepRapFirmware-versions"><span class="toc-text">M568: Turn off&#x2F;on tool mix ratios (obsolete meaning in old RepRapFirmware versions)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-Stepper-driver-control"><span class="toc-text">M569: Stepper driver control</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-1-Stepper-driver-closed-loop-configuration"><span class="toc-text">M569.1: Stepper driver closed loop configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-2-Read-or-write-any-stepper-driver-register"><span class="toc-text">M569.2: Read or write any stepper driver register</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-3-Read-Motor-Driver-Encoder"><span class="toc-text">M569.3: Read Motor Driver Encoder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-4-Set-Motor-Driver-Torque-Mode"><span class="toc-text">M569.4: Set Motor Driver Torque Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-5-Collect-Data-from-Closed-loop-Driver"><span class="toc-text">M569.5: Collect Data from Closed-loop Driver</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-6-Execute-Closed-loop-Driver-Tuning-Move"><span class="toc-text">M569.6: Execute Closed-loop Driver Tuning Move</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-7-Configure-motor-brake-port"><span class="toc-text">M569.7: Configure motor brake port</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-8-Read-Axis-Force"><span class="toc-text">M569.8: Read Axis Force</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M569-9-Sets-the-driver-sense-resistor-and-maximum-current"><span class="toc-text">M569.9: Sets the driver sense resistor and maximum current</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M570-Configure-heater-fault-detection"><span class="toc-text">M570: Configure heater fault detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M571-Set-output-on-extrude"><span class="toc-text">M571: Set output on extrude</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M572-Set-or-report-extruder-pressure-advance"><span class="toc-text">M572: Set or report extruder pressure advance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M573-Report-heater-PWM"><span class="toc-text">M573: Report heater PWM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M574-Set-endstop-configuration"><span class="toc-text">M574: Set endstop configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M575-Set-serial-comms-parameters"><span class="toc-text">M575: Set serial comms parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M576-Set-SPI-comms-parameters"><span class="toc-text">M576: Set SPI comms parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M577-Wait-until-endstop-is-triggered"><span class="toc-text">M577: Wait until endstop is triggered</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M578-Fire-inkjet-bits"><span class="toc-text">M578: Fire inkjet bits</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M579-Scale-Cartesian-axes"><span class="toc-text">M579: Scale Cartesian axes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M580-Select-Roland"><span class="toc-text">M580: Select Roland</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M581-Configure-external-trigger"><span class="toc-text">M581: Configure external trigger</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M582-Check-external-trigger"><span class="toc-text">M582: Check external trigger</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M584-Set-drive-mapping"><span class="toc-text">M584: Set drive mapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M585-Probe-Tool"><span class="toc-text">M585: Probe Tool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M586-Configure-network-protocols"><span class="toc-text">M586: Configure network protocols</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M586-4-Configure-MQTT-server"><span class="toc-text">M586.4: Configure MQTT server</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M587-Store-WiFi-host-network-in-list-or-list-stored-networks"><span class="toc-text">M587: Store WiFi host network in list, or list stored networks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M588-Forget-WiFi-host-network"><span class="toc-text">M588: Forget WiFi host network</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M589-Configure-access-point-parameters"><span class="toc-text">M589: Configure access point parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M590-Report-current-tool-type-and-index"><span class="toc-text">M590: Report current tool type and index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M591-Configure-filament-monitoring"><span class="toc-text">M591: Configure filament monitoring</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M592-Configure-nonlinear-extrusion"><span class="toc-text">M592: Configure nonlinear extrusion</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M593-Configure-Input-Shaping"><span class="toc-text">M593: Configure Input Shaping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M594-Enter-Leave-Height-Following-mode"><span class="toc-text">M594: Enter&#x2F;Leave Height Following mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M595-Set-movement-queue-length"><span class="toc-text">M595: Set movement queue length</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M596-Select-movement-queue-number"><span class="toc-text">M596: Select movement queue number</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M597-Collision-avoidance"><span class="toc-text">M597: Collision avoidance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M598-Sync-motion-systems"><span class="toc-text">M598: Sync motion systems</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M599-Define-keepout-zone"><span class="toc-text">M599: Define keepout zone</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M600-Set-line-cross-section"><span class="toc-text">M600: Set line cross section</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M600-Filament-change-pause"><span class="toc-text">M600: Filament change pause</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M601-Pause-print"><span class="toc-text">M601: Pause print</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M602-Resume-print"><span class="toc-text">M602: Resume print</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M603-Stop-print-Prusa-i3"><span class="toc-text">M603: Stop print (Prusa i3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M603-Configure-Filament-Change"><span class="toc-text">M603: Configure Filament Change</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M605-Set-dual-x-carriage-movement-mode"><span class="toc-text">M605: Set dual x-carriage movement mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M606-Fork-input-file-reader"><span class="toc-text">M606: Fork input file reader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M650-Set-peel-move-parameters"><span class="toc-text">M650: Set peel move parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M651-Execute-peel-move"><span class="toc-text">M651: Execute peel move</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M655-Send-request-to-custom-CAN-connected-expansion-board"><span class="toc-text">M655: Send request to custom CAN-connected expansion board</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M665-Set-delta-configuration"><span class="toc-text">M665: Set delta configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M666-Set-delta-endstop-adjustment"><span class="toc-text">M666: Set delta endstop adjustment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M667-Select-CoreXY-mode"><span class="toc-text">M667: Select CoreXY mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M668-Set-Z-offset-compensations-polynomial"><span class="toc-text">M668: Set Z-offset compensations polynomial</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M669-Set-kinematics-type-and-kinematics-parameters"><span class="toc-text">M669: Set kinematics type and kinematics parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M670-Set-IO-port-bit-mapping"><span class="toc-text">M670: Set IO port bit mapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M671-Define-positions-of-Z-leadscrews-or-bed-leveling-screws"><span class="toc-text">M671: Define positions of Z leadscrews or bed leveling screws</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M672-Program-Z-probe"><span class="toc-text">M672: Program Z probe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M673-Align-plane-on-rotary-axis"><span class="toc-text">M673: Align plane on rotary axis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M674-Set-Z-to-center-point"><span class="toc-text">M674: Set Z to center point</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M675-Find-center-of-cavity"><span class="toc-text">M675: Find center of cavity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M700-Level-plate"><span class="toc-text">M700: Level plate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M701-Load-filament"><span class="toc-text">M701: Load filament</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M702-Unload-filament"><span class="toc-text">M702: Unload filament</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M703-Configure-Filament"><span class="toc-text">M703: Configure Filament</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M704-Preload-to-MMU"><span class="toc-text">M704: Preload_to_MMU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M705-Eject-filament"><span class="toc-text">M705: Eject filament</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M706-Cut-filament"><span class="toc-text">M706: Cut filament</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M707-Read-from-MMU-register"><span class="toc-text">M707: Read from MMU register</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M708-Write-to-MMU-register"><span class="toc-text">M708: Write to MMU register</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M709-MMU-power-reset"><span class="toc-text">M709: MMU power &amp; reset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M710-Firmware-dependent"><span class="toc-text">M710: Firmware dependent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M710-Controller-Fan-settings"><span class="toc-text">M710: Controller Fan settings</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M710-Erase-the-EEPROM-and-reset-the-board"><span class="toc-text">M710: Erase the EEPROM and reset the board</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M711-Calibrate-pressure-advance"><span class="toc-text">M711: Calibrate pressure advance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M750-Enable-3D-scanner-extension"><span class="toc-text">M750: Enable 3D scanner extension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M751-Register-3D-scanner-extension-over-USB"><span class="toc-text">M751: Register 3D scanner extension over USB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M752-Start-3D-scan"><span class="toc-text">M752: Start 3D scan</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M753-Cancel-current-3D-scanner-action"><span class="toc-text">M753: Cancel current 3D scanner action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M754-Calibrate-3D-scanner"><span class="toc-text">M754: Calibrate 3D scanner</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M755-Set-alignment-mode-for-3D-scanner"><span class="toc-text">M755: Set alignment mode for 3D scanner</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M756-Shutdown-3D-scanner"><span class="toc-text">M756: Shutdown 3D scanner</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M800-Fire-start-print-procedure"><span class="toc-text">M800: Fire start print procedure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M801-Fire-end-print-procedure"><span class="toc-text">M801: Fire end print procedure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M808-Set-or-Goto-Repeat-Marker"><span class="toc-text">M808: Set or Goto Repeat Marker</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M808-in-Marlin-2-0-8"><span class="toc-text">M808 in Marlin 2.0.8</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M810-M819-Temporary-G-code-macros"><span class="toc-text">M810-M819: Temporary G-code macros</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M820-Report-Temporary-G-code-macros"><span class="toc-text">M820: Report Temporary G-code macros</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M850-Sheet-parameters"><span class="toc-text">M850: Sheet parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M851-Set-Z-Probe-Offset"><span class="toc-text">M851: Set Z-Probe Offset</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M851-in-Marlin-1-0-2"><span class="toc-text">M851 in Marlin 1.0.2</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M851-in-Marlin-1-1-0"><span class="toc-text">M851 in Marlin 1.1.0</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M851-in-Marlin-2-0-0"><span class="toc-text">M851 in Marlin 2.0.0</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M851-in-MK4duo-4-3-25"><span class="toc-text">M851 in MK4duo 4.3.25</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M851-in-RepRapFirmware-2-02-and-later"><span class="toc-text">M851 in RepRapFirmware 2.02 and later</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M855-Set-Axis-Length"><span class="toc-text">M855 Set Axis Length</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M860-Wait-for-Probe-Temperature"><span class="toc-text">M860 Wait for Probe Temperature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M861-Set-Probe-Thermal-Compensation"><span class="toc-text">M861 Set Probe Thermal Compensation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M862-Print-checking"><span class="toc-text">M862: Print checking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-1-Check-nozzle-diameter"><span class="toc-text">M862.1: Check nozzle diameter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-2-Check-model-code"><span class="toc-text">M862.2: Check model code</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-3-Model-name"><span class="toc-text">M862.3: Model name</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-4-Firmware-version"><span class="toc-text">M862.4: Firmware version</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-5-Gcode-level"><span class="toc-text">M862.5: Gcode level</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#M862-6-Firmware-features"><span class="toc-text">M862.6: Firmware features</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M871-PTC-Configuration"><span class="toc-text">M871: PTC Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M876-Dialog-handling"><span class="toc-text">M876: Dialog handling</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M890-Run-User-Gcode"><span class="toc-text">M890 Run User Gcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M900-Set-Linear-Advance-Scaling-Factors"><span class="toc-text">M900: Set Linear Advance Scaling Factors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M905-Set-local-date-and-time"><span class="toc-text">M905: Set local date and time</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M906-Set-motor-currents"><span class="toc-text">M906: Set motor currents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M907-Set-digital-trimpot-motor-current"><span class="toc-text">M907: Set digital trimpot motor current</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M908-Control-digital-trimpot-directly"><span class="toc-text">M908: Control digital trimpot directly</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M909-Set-microstepping"><span class="toc-text">M909: Set microstepping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M910-Set-decay-mode"><span class="toc-text">M910: Set decay mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M910-TMC2130-init"><span class="toc-text">M910: TMC2130 init</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M911-Configure-auto-save-on-loss-of-power-%E2%80%9Cpower-panic%E2%80%9D"><span class="toc-text">M911: Configure auto save on loss of power (“power panic”)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M911-Set-TMC2130-holding-currents"><span class="toc-text">M911: Set TMC2130 holding currents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M912-Set-electronics-temperature-monitor-adjustment"><span class="toc-text">M912: Set electronics temperature monitor adjustment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M912-Set-TMC2130-running-currents"><span class="toc-text">M912: Set TMC2130 running currents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M913-Set-motor-percentage-of-normal-current"><span class="toc-text">M913: Set motor percentage of normal current</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M913-Print-TMC2130-currents"><span class="toc-text">M913: Print TMC2130 currents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M914-Set-Get-Expansion-Voltage-Level-Translator"><span class="toc-text">M914: Set&#x2F;Get Expansion Voltage Level Translator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M914-Set-TMC2130-normal-mode"><span class="toc-text">M914: Set TMC2130 normal mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M915-Configure-motor-stall-detection"><span class="toc-text">M915: Configure motor stall detection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M915-Set-TMC2130-silent-mode"><span class="toc-text">M915: Set TMC2130 silent mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M916-Resume-print-after-power-failure"><span class="toc-text">M916: Resume print after power failure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M916-Set-TMC2130-Stallguard-sensitivity-threshold"><span class="toc-text">M916: Set TMC2130 Stallguard sensitivity threshold</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M917-Set-motor-standstill-current-reduction"><span class="toc-text">M917: Set motor standstill current reduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M917-Set-TMC2130-PWM-amplitude-offset-pwm-ampl"><span class="toc-text">M917: Set TMC2130 PWM amplitude offset (pwm_ampl)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M918-Configure-direct-connect-display"><span class="toc-text">M918: Configure direct-connect display</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M918-Set-TMC2130-PWM-amplitude-gradient-pwm-grad"><span class="toc-text">M918: Set TMC2130 PWM amplitude gradient (pwm_grad)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M928-Start-SD-logging"><span class="toc-text">M928: Start SD logging</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M929-Start-stop-event-logging-to-SD-card"><span class="toc-text">M929: Start&#x2F;stop event logging to SD card</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M950-Create-heater-fan-or-GPIO-servo-device"><span class="toc-text">M950: Create heater, fan or GPIO&#x2F;servo device</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M951-Set-height-following-mode-parameters"><span class="toc-text">M951: Set height following mode parameters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M952-Set-CAN-expansion-board-address-and-or-normal-data-rate"><span class="toc-text">M952: Set CAN expansion board address and&#x2F;or normal data rate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M953-Set-CAN-FD-bus-fast-data-rate"><span class="toc-text">M953: Set CAN-FD bus fast data rate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M954-Configure-as-CAN-expansion-board"><span class="toc-text">M954: Configure as CAN expansion board</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M955-Configure-Accelerometer"><span class="toc-text">M955: Configure Accelerometer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M956-Collect-accelerometer-data-and-write-to-file"><span class="toc-text">M956: Collect accelerometer data and write to file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M957-Raise-event"><span class="toc-text">M957: Raise event</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M958-Excite-harmonic-vibration"><span class="toc-text">M958: Excite harmonic vibration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M970-Enable-Disable-Phase-Stepping"><span class="toc-text">M970: Enable&#x2F;Disable Phase Stepping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M970-1-Configure-Phase-Stepping-Velocity-Constant"><span class="toc-text">M970.1: Configure Phase Stepping Velocity Constant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M970-2-Configure-Phase-Stepping-Acceleration-Constant"><span class="toc-text">M970.2: Configure Phase Stepping Acceleration Constant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M972-Retrieve-Current-Correction"><span class="toc-text">M972: Retrieve Current Correction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M973-Set-Single-Entry-in-Current-Correction-Table"><span class="toc-text">M973: Set Single Entry in Current Correction Table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M974-Measure-Print-Head-Resonance"><span class="toc-text">M974: Measure Print Head Resonance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M975-Measure-Dwarf-Accelerometer-Sampling-Frequency"><span class="toc-text">M975: Measure Dwarf Accelerometer Sampling Frequency</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M976-Measure-Print-Head-Resonance"><span class="toc-text">M976: Measure Print Head Resonance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M977-Calibrate-Motor"><span class="toc-text">M977: Calibrate Motor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M995-Calibrate-Touch-Screen"><span class="toc-text">M995: Calibrate Touch Screen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M997-Perform-in-application-firmware-update"><span class="toc-text">M997: Perform in-application firmware update</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M998-Request-resend-of-line"><span class="toc-text">M998: Request resend of line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M999-Restart-after-being-stopped-by-error"><span class="toc-text">M999: Restart after being stopped by error</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Other-commands"><span class="toc-text">Other commands</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#G-List-all-G-codes"><span class="toc-text">G: List all G-codes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#M-List-all-M-codes"><span class="toc-text">M: List all M-codes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#T-Select-Tool"><span class="toc-text">T: Select Tool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-Debug-codes"><span class="toc-text">D: Debug codes</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#D-1-Endless-Loop"><span class="toc-text">D-1: Endless Loop</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D0-Reset"><span class="toc-text">D0: Reset</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D1-Clear-EEPROM-and-RESET"><span class="toc-text">D1: Clear EEPROM and RESET</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D2-Read-Write-RAM"><span class="toc-text">D2: Read&#x2F;Write RAM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D3-Read-Write-EEPROM"><span class="toc-text">D3: Read&#x2F;Write EEPROM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D4-Read-Write-PIN"><span class="toc-text">D4: Read&#x2F;Write PIN</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D5-Read-Write-FLASH"><span class="toc-text">D5: Read&#x2F;Write FLASH</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D6-Read-Write-external-FLASH"><span class="toc-text">D6: Read&#x2F;Write external FLASH</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D7-Read-Write-Bootloader"><span class="toc-text">D7: Read&#x2F;Write Bootloader</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D8-Read-Write-PINDA"><span class="toc-text">D8: Read&#x2F;Write PINDA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D9-Read-Write-ADC"><span class="toc-text">D9: Read&#x2F;Write ADC</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D10-Set-XYZ-calibration-OK"><span class="toc-text">D10: Set XYZ calibration &#x3D; OK</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D12-Time"><span class="toc-text">D12: Time</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D20-Generate-an-offline-crash-dump"><span class="toc-text">D20: Generate an offline crash dump</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D21-Print-crash-dump-to-serial"><span class="toc-text">D21: Print crash dump to serial</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D22-Clear-crash-dump-state"><span class="toc-text">D22: Clear crash dump state</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D23-Request-emergency-dump-on-serial"><span class="toc-text">D23: Request emergency dump on serial</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D80-Bed-check"><span class="toc-text">D80: Bed check</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D81-Bed-analysis"><span class="toc-text">D81: Bed analysis</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D106-Print-measured-fan-speed-for-different-pwm-values"><span class="toc-text">D106: Print measured fan speed for different pwm values</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D2130-Trinamic-stepper-controller"><span class="toc-text">D2130: Trinamic stepper controller</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D9125-PAT9125-filament-sensor"><span class="toc-text">D9125: PAT9125 filament sensor</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proposed-EEPROM-configuration-codes"><span class="toc-text">Proposed EEPROM configuration codes</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-of-a-communication-error-with-resend-request"><span class="toc-text">Example of a communication error with resend request</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Action-commands"><span class="toc-text">Action commands</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Further-notes"><span class="toc-text">Further notes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proposal-for-sending-multiple-lines-of-G-code"><span class="toc-text">Proposal for sending multiple lines of G-code</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Problem-to-solve"><span class="toc-text">Problem to solve</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alternatives-to-G-code"><span class="toc-text">Alternatives to G-code</span></a></li></ol></div><div class="widget-footer"><a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Solar by 480 Design - https://creativecommons.org/licenses/by/4.0/ --><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/><path d="M7 3.338A9.95 9.95 0 0 1 12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12c0-1.821.487-3.53 1.338-5"/></g></svg><span>Scroll to Top</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Solar by 480 Design - https://creativecommons.org/licenses/by/4.0/ --><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M8 10.5h8M8 14h5.5M17 3.338A9.95 9.95 0 0 0 12 2C6.477 2 2 6.477 2 12c0 1.6.376 3.112 1.043 4.453c.178.356.237.763.134 1.148l-.595 2.226a1.3 1.3 0 0 0 1.591 1.592l2.226-.596a1.63 1.63 0 0 1 1.149.133A9.96 9.96 0 0 0 12 22c5.523 0 10-4.477 10-10c0-1.821-.487-3.53-1.338-5"/></svg><span>Join Discussion</span></a></div></widget>
</div></aside><div class='float-panel'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">


<script type="text/javascript">
  window.canonical = {"originalHost":null,"officialHosts":["localhost"],"encoded":""};
  window.canonical["param"] = {"permalink":"https://lemoncyan.github.io/2025/02/24/4-Others-3D%E6%89%93%E5%8D%B0-G-code-RepRap/","checklink":"/js/plugins/video.js"};
  const ctx = {
    date_suffix: {
      just: `Just`,
      min: `minutes ago`,
      hour: `hours ago`,
      day: `days ago`,
    },
    root : `/`,
    tag_plugins: {
      chat: Object.assign({"api":"https://siteinfo.listentothewind.cn/api/v1"}),
    }
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"skip_search":null,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
    loading: `https://api.iconify.design/eos-icons:three-dots-loading.svg?color=%231cd0fd`,
  };
  const deps = {
    jquery: `https://gcore.jsdelivr.net/npm/jquery@3.7/dist/jquery.min.js`,
    marked: `https://gcore.jsdelivr.net/npm/marked@13.0/lib/marked.umd.min.js`,
    lazyload: `/%5Bobject%20Object%5D`
  }
  

</script>

<script type="text/javascript">
  
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = () => {
          utils.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) => {
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index, 1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }

  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')) {
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function () {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },

    onLoading: (el) => {
      if (el) {
        if ($(el).find('.loading-wrap').length == 0){
          $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
        }
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      const maxRetry = 3;
      let retryCount = 0;

      return new Promise((resolve, reject) => {
        const load = () => {
          utils.onLoading?.(el);

          let timedOut = false;
          const timeout = setTimeout(() => {
            timedOut = true;
            console.warn('[request] 超时:', url);

            if (++retryCount >= maxRetry) {
              utils.onLoadFailure?.(el);
              onFailure?.();
              reject('请求超时');
            } else {
              setTimeout(load, 1000);
            }
          }, 5000);

          fetch(url).then(resp => {
            if (timedOut) return;
            clearTimeout(timeout);

            if (!resp.ok) throw new Error('响应失败');
            return resp;
          }).then(data => {
            if (timedOut) return;
            utils.onLoadSuccess?.(el);
            callback(data);
            resolve(data);
          }).catch(err => {
            clearTimeout(timeout);
            console.warn('[request] 错误:', err);

            if (++retryCount >= maxRetry) {
              utils.onLoadFailure?.(el);
              onFailure?.();
              reject(err);
            } else {
              setTimeout(load, 1000);
            }
          });
        };

        load();
      });
    },
    requestWithoutLoading: (url, options = {}, maxRetry = 2, timeout = 5000) => {
      return new Promise((resolve, reject) => {
        let retryCount = 0;

        const tryRequest = () => {
          let timedOut = false;
          const timer = setTimeout(() => {
            timedOut = true;
            if (++retryCount > maxRetry) reject('timeout');
            else tryRequest();
          }, timeout);

          fetch(url, options)
            .then(resp => {
              clearTimeout(timer);
              if (!resp.ok) throw new Error('bad response');
              resolve(resp);
            })
            .catch(err => {
              clearTimeout(timer);
              if (++retryCount > maxRetry) reject(err);
              else setTimeout(tryRequest, 500);
            });
        };

        tryRequest();
      });
    },
    /********************** requestAnimationFrame ********************************/
    // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
    // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
    requestAnimationFrame: (fn) => {
      if (!window.requestAnimationFrame) {
        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
      }
      window.requestAnimationFrame(fn)
    },
    dark: {},
  };

  // utils.dark.mode 当前模式 dark or light
  // utils.dark.toggle() 暗黑模式触发器
  // utils.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  utils.dark.method = {
    toggle: new RunItem(),
  };
  utils.dark = Object.assign(utils.dark, {
    push: utils.dark.method.toggle.push,
  });
</script>
<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>
<script type="text/javascript">
  (() => {
    const tagSwitchers = document.querySelectorAll('.tag-subtree.parent-tag > a > .tag-switcher-wrapper')
    for (const tagSwitcher of tagSwitchers) {
      tagSwitcher.addEventListener('click', (e) => {
        const parent = e.target.closest('.tag-subtree.parent-tag')
        parent.classList.toggle('expanded')
        e.preventDefault()
      })
    }

    // Get active tag from query string, then activate it.
    const urlParams = new URLSearchParams(window.location.search)
    const activeTag = urlParams.get('tag')
    if (activeTag) {
      let tag = document.querySelector(`.tag-subtree[data-tag="${activeTag}"]`)
      if (tag) {
        tag.querySelector('a').classList.add('active')
        
        while (tag) {
          tag.classList.add('expanded')
          tag = tag.parentElement.closest('.tag-subtree.parent-tag')
        }
      }
    }
  })()
</script>

<script async src="https://gcore.jsdelivr.net/npm/vanilla-lazyload@19.1/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
    callback_loaded: (el) => {
      el.classList.add('loaded');
      const wrapper = el.closest('.lazy-box');
      const icon = wrapper?.querySelector('.lazy-icon');
      if (icon) icon.remove();
    }
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });

  window.wrapLazyloadImages = (container) => {
    if (typeof container === 'string') {
      container = document.querySelector(container);
    }
    if (!container) return;
    
    const images = container.querySelectorAll('img');
    images.forEach((img) => {
      if (img.classList.contains('lazy')) return;

      const src = img.getAttribute('src');
      if (!src) return;

      const wrapper = document.createElement('div');
      wrapper.className = 'lazy-box';

      const newImg = img.cloneNode();
      newImg.removeAttribute('src');
      newImg.setAttribute('data-src', src);
      newImg.classList.add('lazy');

      const icon = document.createElement('div');
      icon.className = 'lazy-icon';
      if (def.loading) {
        icon.style.backgroundImage = `url("${def.loading}")`;
      }

      wrapper.appendChild(newImg);
      wrapper.appendChild(icon);

      img.replaceWith(wrapper);
    });

    // 通知 LazyLoad 更新
    if (window.lazyLoadInstance?.update) {
      window.lazyLoadInstance.update();
    }
  }
  
</script>

<!-- required -->
<script src="/js/main.js?v=1.33.1" defer></script>

<script type="text/javascript">
  const applyTheme = (theme) => {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme')
    } else {
      document.documentElement.setAttribute('data-theme', theme)
    }

    // applyThemeToGiscus(theme)
  }

  // FIXME: 这会导致无法使用 preferred_color_scheme 以外的主题
  const applyThemeToGiscus = (theme) => {
    // theme = theme === 'auto' ? 'preferred_color_scheme' : theme
    const cmt = document.getElementById('giscus')
    if (cmt) {
      // This works before giscus load.
      cmt.setAttribute('data-theme', theme)
    }

    const iframe = document.querySelector('#comments > section.giscus > iframe')
    if (iframe) {
      // This works after giscus loaded.
      const src = iframe.src
      const newSrc = src.replace(/theme=[\w]+/, `theme=${theme}`)
      iframe.src = newSrc
    }
  }

  const switchTheme = () => {
    // light -> dark -> auto -> light -> ...
    const currentTheme = document.documentElement.getAttribute('data-theme')
    let newTheme;
    switch (currentTheme) {
      case 'light':
        newTheme = 'dark'
        break
      case 'dark':
        newTheme = 'auto'
        break
      default:
        newTheme = 'light'
    }
    applyTheme(newTheme)
    window.localStorage.setItem('Stellar.theme', newTheme)
    utils.dark.mode = newTheme === 'auto' ? (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light") : newTheme;
    utils.dark.method.toggle.start();

    const messages = {
      light: `Switched to Light Mode`,
      dark: `Switched to Dark Mode`,
      auto: `Switched to Auto Mode`,
    }
    hud?.toast?.(messages[newTheme])
  }

  (() => {
    // Apply user's preferred theme, if any.
    const theme = window.localStorage.getItem('Stellar.theme')
    if (theme !== null) {
      applyTheme(theme)
    } else {
      utils.dark.mode = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    }
    utils.dark.method.toggle.start();
  })()
</script>


<!-- optional -->

  <script type="module">
  const el = document.querySelector("#comments #utterances");
  util.viewportLazyload(el, load_utterances, true);

  function load_utterances() {
    if (!el) return;
    try {
      el.innerHTML = '';
    } catch (error) {
      console.error(error);
    }
    const script = document.createElement('script');
    script.src = 'https://utteranc.es/client.js';
    script.async = true;
    for (const key of Object.keys(el.attributes)) {
      const attr = el.attributes[key];
      if (['class', 'id'].includes(attr.name) === false) {
        script.setAttribute(attr.name, attr.value);
      }
    }
    el.appendChild(script);
  }
</script>




<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"rating":{"js":"/js/services/rating.js","api":"https://star-vote.xaox.cc/api/rating"},"vote":{"js":"/js/services/vote.js","api":"https://star-vote.xaox.cc/api/vote"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"friends_and_posts":{"js":"/js/services/friends_and_posts.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"},"voice":{"js":"/js/plugins/voice.js"},"video":{"js":"/js/plugins/video.js"},"download-file":{"js":"/js/plugins/download-file.js"},"twikoo":{"js":"/js/services/twikoo_latest_comment.js"},"waline":{"js":"/js/services/waline_latest_comment.js"},"artalk":{"js":"/js/services/artalk_latest_comment.js"},"giscus":{"js":"/js/services/giscus_latest_comment.js"},"contributors":{"edit_this_page":{"_posts/":null,"wiki/stellar/":"https://github.com/xaoxuu/hexo-theme-stellar-docs/blob/main/"},"js":"/js/services/contributors.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else if (id == 'voice') {
        ctx.voiceAudios = document.querySelectorAll('.voice>audio');
        if (ctx.voiceAudios?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            createVoiceDom(ctx.voiceAudios);
          });
        }
      } else if (id == 'video') {
        ctx.videos = document.querySelectorAll('.video>video');
        if (ctx.videos?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            videoEvents(ctx.videos);
          });
        }
      } else if (id == 'download-file') {
        ctx.files = document.querySelectorAll('.chat-file');
        if (ctx.files?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            downloadFileEvent(ctx.files);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }

    // chat iphone time
    let phoneTimes = document.querySelectorAll('.chat .status-bar .time');

    if (phoneTimes.length > 0) {
      NowTime();
      var date = new Date();
      var sec = date.getSeconds();
      var firstAdjustInterval = setInterval(firstAdjustTime, 1000 * (60 - sec));
    }

    function firstAdjustTime() {
      NowTime();
      clearInterval(firstAdjustInterval);
      setInterval(NowTime, 1000 * 60);
    }

    function NowTime() {
      for (let i = 0; i < phoneTimes.length; ++i) {
        var timeSpan = phoneTimes[i];
        var date = new Date();
        var hour = date.getHours();
        var min = date.getMinutes();
        timeSpan.innerHTML = check(hour) + ":" + check(min);
      }
    };

    function check(val) {
      if (val < 10) {
        return ("0" + val);
      }
      return (val);
    }

    // chat quote
    const chat_quote_obverser = new IntersectionObserver((entries, observer) => {
      entries.filter((entry) => { return entry.isIntersecting }).sort((a, b) => a.intersectionRect.y !== b.intersectionRect.y ? a.intersectionRect.y - b.intersectionRect.y : a.intersectionRect.x - b.intersectionRect.x).forEach((entry, index) => {
          observer.unobserve(entry.target);
          setTimeout(() => {
            entry.target.classList.add('quote-blink');
            setTimeout(() => {
              entry.target.classList.remove('quote-blink');
            }, 1000);
          }, Math.max(100, 16) * (index + 1));
        });
    });

    var chatQuotes = document.querySelectorAll(".chat .talk .quote");
    chatQuotes.forEach((quote) => {
      quote.addEventListener('click', function () {
        var chatCellDom = document.getElementById("quote-" + quote.getAttribute("quotedCellTag"));
        if (chatCellDom) {
          var chatDiv = chatCellDom.parentElement;
          var mid = chatDiv.clientHeight / 2;
          var offsetTop = chatCellDom.offsetTop;
          if (offsetTop > mid - chatCellDom.clientHeight / 2) {
            chatDiv.scrollTo({
              top: chatCellDom.offsetTop - mid + chatCellDom.clientHeight / 2,
              behavior: "smooth"
            });
          } else {
            chatDiv.scrollTo({
              top: 0,
              behavior: "smooth"
            });
          }
          chat_quote_obverser.observe(chatCellDom);
        }
      });
    });
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://gcore.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css`,
    js: `https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js`
  };
  var selector = '[data-fancybox]:not(.error), .with-fancybox .atk-content img:not([atk-emoticon])';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const memos = document.getElementsByClassName('ds-memos');
    if (memos != undefined && memos.length > 0) {
      needFancybox = true;
    }
    const fancybox = document.getElementsByClassName('with-fancybox');
    if (fancybox != undefined && fancybox.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
