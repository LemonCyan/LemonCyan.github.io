
<!DOCTYPE html><html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.33.1" theme-name="Stellar" theme-version="1.33.1">
  
  
  <meta name="generator" content="Hexo 7.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  <meta name="theme-color" content="#f9fafb">
  <title>字节序与位序详解-CSDN博客 - WhiteLemonade</title>

  
    <meta name="description" content="Endianness字节序大家见得比较多，网络上论述也比较多。这里简要介绍：书写十六进制数据时，我们习惯上 MSB 在左，而 LSB 在右。  LSB: least significant byte MSB: most significant byte   大端：Big-endian数据在内存中(地址由低到高)的存放顺序和书写顺序是一致的。记忆方法：低地址放的是数据的 MSB，所以称作大端。低地址">
<meta property="og:type" content="article">
<meta property="og:title" content="字节序与位序详解-CSDN博客">
<meta property="og:url" content="http://liuluhua.github.io/2025/01/16/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-C%E8%AF%AD%E8%A8%80-%E4%BD%8D%E8%BF%90%E7%AE%97-%E5%AD%97%E8%8A%82%E5%BA%8F%E4%B8%8E%E4%BD%8D%E5%BA%8F%E8%AF%A6%E8%A7%A3-CSDN%E5%8D%9A%E5%AE%A2/">
<meta property="og:site_name" content="WhiteLemonade">
<meta property="og:description" content="Endianness字节序大家见得比较多，网络上论述也比较多。这里简要介绍：书写十六进制数据时，我们习惯上 MSB 在左，而 LSB 在右。  LSB: least significant byte MSB: most significant byte   大端：Big-endian数据在内存中(地址由低到高)的存放顺序和书写顺序是一致的。记忆方法：低地址放的是数据的 MSB，所以称作大端。低地址">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ecf2236c6a3748a7dc0e9b34e8099691.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/14b04457eda94f3c673f48e92011fe21.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/614dec76a8c050b4c636fa96b3bc623e.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/fd0194c5d55e89ff9c62159e259ea903.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/cc6e93aa08e0d07424e20802789150c7.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/585822dd5ffe728c8a3a325e1744ac62.png">
<meta property="article:published_time" content="2025-01-16T00:00:00.000Z">
<meta property="article:modified_time" content="2025-01-16T00:00:00.000Z">
<meta property="article:author" content="liuluhua">
<meta property="article:tag" content="clippings">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i-blog.csdnimg.cn/blog_migrate/ecf2236c6a3748a7dc0e9b34e8099691.png">
  
  
  
  <meta name="keywords" content="clippings">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.33.1">


  

  

  <script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"liuluhua","sameAs":[]},"dateCreated":"2025-01-16T00:00:00+00:00","dateModified":"2025-01-16T00:00:00+00:00","datePublished":"2025-01-16T00:00:00+00:00","description":"","headline":"字节序与位序详解-CSDN博客","mainEntityOfPage":{"@type":"WebPage","@id":"http://liuluhua.github.io/2025/01/16/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-C%E8%AF%AD%E8%A8%80-%E4%BD%8D%E8%BF%90%E7%AE%97-%E5%AD%97%E8%8A%82%E5%BA%8F%E4%B8%8E%E4%BD%8D%E5%BA%8F%E8%AF%A6%E8%A7%A3-CSDN%E5%8D%9A%E5%AE%A2/"},"publisher":{"@type":"Organization","name":"liuluhua","sameAs":[]},"url":"http://liuluhua.github.io/2025/01/16/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-C%E8%AF%AD%E8%A8%80-%E4%BD%8D%E8%BF%90%E7%AE%97-%E5%AD%97%E8%8A%82%E5%BA%8F%E4%B8%8E%E4%BD%8D%E5%BA%8F%E8%AF%A6%E8%A7%A3-CSDN%E5%8D%9A%E5%AE%A2/","keywords":"clippings","image":[]}</script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/satouriko/LxgwWenKai_Webfonts@v1.101/dist/LXGWWenKaiMono-Bold.css" />
</head>
<body>

<div class="l_body content" id="start" layout="post" type="tech" ><aside class="l_left"><div class="sidebg"></div><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="undefined" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main">WhiteLemonade</div><div class="sub cap">WhiteLemonade的充电站</div></a></div></header>

<div class="nav-area">

<nav class="menu dis-select"></nav>
</div>
<div class="widgets">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="Search"></form><div id="search-result"></div><div class="search-no-result">No Results!</div></div>



<widget class="widget-wrapper recent post-list"><div class="widget-header dis-select"><span class="name">Recent Update</span></div><div class="widget-body fs14"><a class="item title" href="/2024/04/18/1-%E5%B9%B3%E5%8F%B0-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%8D%9A%E5%AE%A2-Hexo-GithubPages-%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2/"><span class="title">Hexo+GithubPages 部署博客</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-Qt5-4-2%E7%A7%BB%E6%A4%8D%E5%88%B0ARM%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8A/"><span class="title">Qt5.4.2移植到ARM开发板上</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-Qt-C-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90get%E5%92%8Cset%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E5%B1%9E%E6%80%A7/"><span class="title">Qt/C++ 自动生成get和set方法以及属性</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-Qt%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%90%8EARM%E6%9D%BF%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE/"><span class="title">Qt交叉编译后ARM板启动配置</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-QT%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F-%E4%B8%80-%EF%BC%9A%E7%95%8C%E9%9D%A2%E5%92%8C%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%88%86%E7%A6%BB/"><span class="title">QT开发模式(一)：界面和业务逻辑分离</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-Qt-Creator-%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B003%EF%BC%8C%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E5%B7%A5%E7%A8%8B/"><span class="title">Qt Creator 源码学习笔记03，大型项目如何管理工程</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-Qt-Qt-Creator-%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B004%EF%BC%8C%E5%A4%9A%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/"><span class="title">Qt Creator 源码学习笔记04，多插件实现原理分析</span></a><a class="item title" href="/2025/07/24/3-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE-CAN-CANaerospace-Wikipedia/"><span class="title">CANaerospace - Wikipedia</span></a><a class="item title" href="/2025/07/24/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-OpenCV-%E3%80%90%E5%A4%9A%E4%BC%A0%E6%84%9F%E8%9E%8D%E5%90%88%E3%80%91%E4%BC%98%E8%BE%BE%E5%AD%A6%E5%9F%8E%E5%A4%9A%E4%BC%A0%E6%84%9F%E8%9E%8D%E5%90%88%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89%E2%80%94%E2%80%94%E5%B0%86%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE3D%E7%82%B9%E4%BA%91%E6%98%A0%E5%B0%84%E5%88%B0%E7%9B%B8%E6%9C%BA%E5%9B%BE%E5%83%8F%EF%BC%88%E4%B8%8B%EF%BC%89-kitti%E6%BF%80%E5%85%89%E9%9B%B7%E8%BE%BE%E5%92%8C%E7%9B%B8%E6%9C%BA%E6%98%A0%E5%B0%84-CSDN%E5%8D%9A%E5%AE%A2/"><span class="title">【多传感融合】优达学城多传感融合学习笔记（四）——将激光雷达3D点云映射到相机图像（下）_kitti激光雷达和相机映射-CSDN博客</span></a><a class="item title" href="/2025/07/23/1-%E5%B9%B3%E5%8F%B0-%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%8D%9A%E5%AE%A2-%E4%BE%9D%E8%B5%96%E7%9A%84package/"><span class="title">依赖的package</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">Home</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">Blog</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6/">2.语言和框架</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6/C%E8%AF%AD%E8%A8%80/">C语言</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6/C%E8%AF%AD%E8%A8%80/%E4%BD%8D%E8%BF%90%E7%AE%97/">位运算</a></div>
<div class="flex-row" id="post-meta"><span class="text created">Posted on: <time datetime="2025-01-16T00:00:00.000Z">2025-01-16</time></span><span class="sep updated"></span><span class="text updated">Updated on: <time datetime="2025-01-16T00:00:00.000Z">2025-01-16</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>字节序与位序详解-CSDN博客</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h3 id="Endianness"><a href="#Endianness" class="headerlink" title="Endianness"></a>Endianness</h3><p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E8%8A%82%E5%BA%8F&spm=1001.2101.3001.7020">字节序</a>大家见得比较多，网络上论述也比较多。这里简要介绍：<br>书写十六进制数据时，我们习惯上 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=MSB&spm=1001.2101.3001.7020">MSB</a> 在左，而 LSB 在右。</p>
<ol>
<li>LSB: least significant byte</li>
<li>MSB: most significant byte</li>
</ol>
<ul>
<li>大端：Big-endian<br><img src="https://i-blog.csdnimg.cn/blog_migrate/ecf2236c6a3748a7dc0e9b34e8099691.png" alt="大端"><br>数据在内存中(地址由低到高)的存放顺序和书写顺序是一致的。<br>记忆方法：低地址放的是数据的 MSB，所以称作大端。<br>低地址存 MSB，高地址存 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=LSB&spm=1001.2101.3001.7020">LSB</a>。</li>
<li>小端：Litthle-endian<br><img src="https://i-blog.csdnimg.cn/blog_migrate/14b04457eda94f3c673f48e92011fe21.png" alt="小端"><br>数据在内存中(地址由低到高)的存放顺序和书写顺序是相反的。<br>记忆方法：低地址放的是数据的 LSB，所以称作小端。即“高高低低”。<br>低地址存 LSB，高地址存 MSB。</li>
</ul>
<h3 id="如何写出兼容大小端的代码"><a href="#如何写出兼容大小端的代码" class="headerlink" title="如何写出兼容大小端的代码"></a>如何写出兼容大小端的代码</h3><p>编码时如果不注意大小端的问题，容易在可移植性上打折扣，并且出问题时不容易定位。特别是指针操作，常见的问题如下：</p>
<ul>
<li>将长类型数据强转成短类型的指针进行操作</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="type">long</span> val = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">((<span class="type">int</span> *)&amp;val)</span></span>;</span><br><span class="line">...</span><br><span class="line"><span class="built_in">check</span>(val);</span><br><span class="line"></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p>上面的代码在大端情况下就容易出问题。例如 func 里将 &amp;val 处赋值 <code>int</code> 类型的数据 <code>0x1122,3344</code>。check(val) 时，由于 val 为 8 字节的数据，此时实际读取到的值为 <code>0x1122,3344,0000,0000</code>。小端场景则无此问题，读者可以自己思考一下为什么。</p>
<h3 id="Bit-numbering"><a href="#Bit-numbering" class="headerlink" title="Bit numbering"></a>Bit numbering</h3><p>我们知道一个字节有 8 个比特位。从第 0 位到第 7 位共 8 位。位序描述比特位在字节中的存放顺序。<br>可参阅 <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Bit_numbering">维基百科中关于位序的描述</a>。</p>
<p>这里的 LSB 及 MSB 的用词代表的是：</p>
<ol>
<li>LSB是指 least significant bit</li>
<li>MSB是指 most significant bit</li>
</ol>
<p>位序分为两种：</p>
<ul>
<li>LSB 0<br>字节的第 0 位存放数据的 <code>least significant bit</code>，即我们的数据的最低位存放在字节的第 0 位。<br>以十进制150为例，<code>0b10010110</code>。在LSB 0方式下存放形式为：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| <span class="number">7</span>                           <span class="number">0</span> |</span><br><span class="line">---------------------------------</span><br><span class="line">| <span class="number">1</span> | <span class="number">0</span> | <span class="number">0</span> | <span class="number">1</span> | <span class="number">0</span> | <span class="number">1</span> | <span class="number">1</span> | <span class="number">0</span> |</span><br><span class="line">---------------------------------</span><br><span class="line"></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/614dec76a8c050b4c636fa96b3bc623e.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>Least Significant Bit First means that the least significant bit will arrive first.</p>
</blockquote>
<p>数据流从 bit0 开始传送，故数据流出现的顺序是 <code>01101001</code>。</p>
<ul>
<li>MSB 0<br>字节的第 0 位存放数据的 <code>most significant bit</code>，即我们的数据的最高位存放在字节的第 0 位。<br>以十进制150为例，<code>0b10010110</code>。在MSB 0方式下存放形式为：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| <span class="number">7</span>                           <span class="number">0</span> |</span><br><span class="line">---------------------------------</span><br><span class="line">| <span class="number">0</span> | <span class="number">1</span> | <span class="number">1</span> | <span class="number">0</span> | <span class="number">1</span> | <span class="number">0</span> | <span class="number">0</span> | <span class="number">1</span> |</span><br><span class="line">---------------------------------</span><br><span class="line"></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/blog_migrate/fd0194c5d55e89ff9c62159e259ea903.png" alt="在这里插入图片描述"></p>
<blockquote>
<p>Most Significant Bit First means that the most significant bit will arrive first.</p>
</blockquote>
<p>也就是说数据流出现的顺序是 <code>10010110</code>。</p>
<h3 id="实际机器类型"><a href="#实际机器类型" class="headerlink" title="实际机器类型"></a>实际机器类型</h3><p>字节序是小端的 CPU 通常其位序为 LSB 0。数据不仅在内存中是“高高低低”存放，其位序也是“高高低低”放置的，即 msb 放在 bit7 位置上，lsb 放置在 bit0 位置上。值得注意的是，字节序是大端的 CPU 采用的位序却不是那么统一，既有 MSB 0，也要 LSB 0 的机器。</p>
<blockquote>
<p>Bit order usually follows the same endianness as the byte order for a given computer system. That is, in a big endian system the most significant bit is stored at the lowest bit address; in a little endian system, the least significant bit is stored at the lowest bit address.</p>
</blockquote>
<p>如果我们要表示一个整数 <code>0xabcd</code>。</p>
<p>Write Integer for Big Endian System</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">byte  addr       <span class="number">0</span>         <span class="number">1</span>       <span class="number">2</span>        <span class="number">3</span></span><br><span class="line">bit  offset  <span class="number">01234567</span> <span class="number">01234567</span> <span class="number">01234567</span> <span class="number">01234567</span></span><br><span class="line">     binary  <span class="number">00001010</span> <span class="number">00001011</span> <span class="number">00001100</span> <span class="number">00001101</span></span><br><span class="line">        hex     <span class="number">0</span>a       <span class="number">0b</span>      <span class="number">0</span>c        <span class="number">0</span>d</span><br><span class="line"></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p>Write Integer for Little Endian System</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">byte  addr      <span class="number">3</span>         <span class="number">2</span>       <span class="number">1</span>        <span class="number">0</span></span><br><span class="line">bit  offset  <span class="number">76543210</span> <span class="number">76543210</span> <span class="number">76543210</span> <span class="number">76543210</span></span><br><span class="line">     binary  <span class="number">00001010</span> <span class="number">00001011</span> <span class="number">00001100</span> <span class="number">00001101</span></span><br><span class="line">        hex     <span class="number">0</span>a       <span class="number">0b</span>      <span class="number">0</span>c        <span class="number">0</span>d</span><br><span class="line"></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<h3 id="位域-Bit-Fields"><a href="#位域-Bit-Fields" class="headerlink" title="位域 Bit Fields"></a>位域 Bit Fields</h3><blockquote>
<p>For big-endian mode, bit fields are packed into registers from most significant bit (MSB) to least significant bit (LSB) in the order in which they are defined. Bit fields are packed in memory from most significant byte (MSbyte) to least significant byte (LSbyte).<br>For little-endian mode, bit fields are packed into registers from the LSB to the MSB in the order in which they are defined, and packed in memory from LSbyte to MSbyte.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://mjfrazer.org/mjfrazer/bitfields/">大小端对位域打包方式的影响</a></p>
<p>大端场景下根据定义的顺序，从 MSB 开始排布到 LSB。<br>小端场景下根据定义的顺序，从 LSB 开始排布到 MSB。</p>
<ul>
<li>位域的类型可以是 unsigned &#x2F; signed</li>
<li>包含位域的结构体的大小和对齐值取决于定义位域所使用的数据类型<br>如 struct st { int a:4 }; 该结构体的大小为4，对齐值为4。</li>
<li>无名位域会影响结构体或联合体的大小和对齐值<br>如 struct st { char a:4; int :22; }; 该结构体的大小为4，对齐值为4。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="type">int</span> A:<span class="number">7</span>;</span><br><span class="line">	<span class="type">int</span> B:<span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> C:<span class="number">3</span>;</span><br><span class="line">	<span class="type">int</span> D:<span class="number">2</span>;</span><br><span class="line">	<span class="type">int</span> E:<span class="number">9</span>;</span><br><span class="line">&#125; x;</span><br><span class="line"></span><br><span class="line"><span class="number">1234567</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">LEGEND: X = not used, MS = most significant, LS = least significant</span><br><span class="line"></span><br><span class="line">Big-endian <span class="keyword">register</span>																								</span><br><span class="line">MS														      LS</span><br><span class="line">A A	A A	A A	A B	B B	B B	B B	B B	B C	C C	D D	E E	E E	E E	E E	E X</span><br><span class="line"><span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">2</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> X</span><br><span class="line"><span class="number">31</span>															  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">Big-endian memory																								</span><br><span class="line">Byte <span class="number">0</span>	        Byte <span class="number">1</span>	        Byte <span class="number">2</span>	        Byte <span class="number">3</span></span><br><span class="line">A A	A A A A A B B B B B B B B B B C C C D D E E E E	E E	E E	E X</span><br><span class="line"><span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">9</span>	<span class="number">8</span> <span class="number">7</span>	<span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">2</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">8</span> <span class="number">7</span>	<span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> X</span><br><span class="line"></span><br><span class="line">Little-endian <span class="keyword">register</span>																								</span><br><span class="line">MS												             LS</span><br><span class="line">X E	E E	E E	E E	E E	D D	C C	C B	B B	B B	B B	B B	B A	A A	A A	A A</span><br><span class="line">X <span class="number">8</span>	<span class="number">7</span> <span class="number">6</span>	<span class="number">5</span> <span class="number">4</span>	<span class="number">3</span> <span class="number">2</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">9</span>	<span class="number">8</span> <span class="number">7</span>	<span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">6</span>	<span class="number">5</span> <span class="number">4</span>	<span class="number">3</span> <span class="number">2</span>	<span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">31</span>															  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">Little-endian memory																								</span><br><span class="line">Byte <span class="number">0</span>	        Byte <span class="number">1</span>	        Byte <span class="number">2</span>	        Byte <span class="number">3</span></span><br><span class="line">B A	A A	A A	A A	B B	B B	B B	B B	E E	D D	C C	C B	X E	E E	E E	E E</span><br><span class="line"><span class="number">0</span> <span class="number">6</span>	<span class="number">5</span> <span class="number">4</span>	<span class="number">3</span> <span class="number">2</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">8</span> <span class="number">7</span>	<span class="number">6</span> <span class="number">5</span>	<span class="number">4</span> <span class="number">3</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">1</span> <span class="number">0</span>	<span class="number">2</span> <span class="number">1</span>	<span class="number">0</span> <span class="number">9</span>	X <span class="number">8</span>	<span class="number">7</span> <span class="number">6</span>	<span class="number">5</span> <span class="number">4</span>	<span class="number">3</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">1234567891011121314151617181920212223</span></span><br></pre></td></tr></table></figure>

<p>以下面的数据类型为例。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">short</span> value;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> byte[<span class="number">2</span>];</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> one   : <span class="number">1</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> two   : <span class="number">2</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> three : <span class="number">3</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> four  : <span class="number">4</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> five  : <span class="number">5</span>;</span><br><span class="line">	&#125; field;</span><br><span class="line">&#125; u;</span><br><span class="line"></span><br><span class="line"><span class="number">1234567891011</span></span><br></pre></td></tr></table></figure>

<p>其排布为：<br>大端场景<br><img src="https://i-blog.csdnimg.cn/blog_migrate/cc6e93aa08e0d07424e20802789150c7.png" alt="在这里插入图片描述"></p>
<p>小端场景<br><img src="https://i-blog.csdnimg.cn/blog_migrate/585822dd5ffe728c8a3a325e1744ac62.png" alt="在这里插入图片描述"></p>
<p>可以通过下面的程序来验证一下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">		<span class="type">unsigned</span> <span class="type">short</span> value;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> byte[<span class="number">2</span>];</span><br><span class="line">		<span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> one   : <span class="number">1</span>;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> two   : <span class="number">2</span>;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> three : <span class="number">3</span>;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> four  : <span class="number">4</span>;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> five  : <span class="number">5</span>;</span><br><span class="line">		&#125; field;</span><br><span class="line">	&#125; u;</span><br><span class="line"></span><br><span class="line">	u.value = <span class="number">0</span>;</span><br><span class="line">	u.field.one   = <span class="number">1</span>;</span><br><span class="line">	u.field.two   = <span class="number">2</span>;</span><br><span class="line">	u.field.three = <span class="number">3</span>;</span><br><span class="line">	u.field.four  = <span class="number">4</span>;</span><br><span class="line">	u.field.five  = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The fields are 1, 2, 3, 4, 5.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The entire hex value is 0x%04x\n&quot;</span>, u.value);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The first byte is 0x%02x\n&quot;</span>, u.byte[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The second byte is 0x%02x\n&quot;</span>, u.byte[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829</span></span><br></pre></td></tr></table></figure>

<p>在 x86 小端，arm，aarch64 大小端场景下的测试结果如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// x86 小端</span><br><span class="line">The fields are 1, 2, 3, 4, 5.</span><br><span class="line">The entire hex value is 0x151d</span><br><span class="line">The first byte is 0x1d</span><br><span class="line">The second byte is 0x15</span><br><span class="line"></span><br><span class="line">// aarch64_be</span><br><span class="line">The fields are 1, 2, 3, 4, 5.</span><br><span class="line">The entire hex value is 0xcd0a</span><br><span class="line">The first byte is 0xcd</span><br><span class="line">The second byte is 0x0a</span><br><span class="line"></span><br><span class="line">// armeb</span><br><span class="line">The fields are 1, 2, 3, 4, 5.</span><br><span class="line">The entire hex value is 0xcd0a</span><br><span class="line">The first byte is 0xcd</span><br><span class="line">The second byte is 0x0a</span><br><span class="line"></span><br><span class="line">// arm</span><br><span class="line">The fields are 1, 2, 3, 4, 5.</span><br><span class="line">The entire hex value is 0x151d</span><br><span class="line">The first byte is 0x1d</span><br><span class="line">The second byte is 0x15</span><br><span class="line"></span><br><span class="line">// aarch64</span><br><span class="line">The fields are 1, 2, 3, 4, 5.</span><br><span class="line">The entire hex value is 0x151d</span><br><span class="line">The first byte is 0x1d</span><br><span class="line">The second byte is 0x15</span><br><span class="line"></span><br><span class="line">123456789101112131415161718192021222324252627282930</span><br></pre></td></tr></table></figure>

<h3 id="字节序测试"><a href="#字节序测试" class="headerlink" title="字节序测试"></a>字节序测试</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">union</span> &#123;</span><br><span class="line">                <span class="type">char</span> c;</span><br><span class="line">                <span class="type">int</span> i;</span><br><span class="line">        &#125; u;</span><br><span class="line">        u.i = <span class="number">0x11223344</span>;</span><br><span class="line">        <span class="keyword">if</span>(u.c == <span class="number">0x44</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;little-endian\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (u.c == <span class="number">0x11</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;big-endian\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;unknown\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718</span></span><br></pre></td></tr></table></figure>

<h3 id="位序测试"><a href="#位序测试" class="headerlink" title="位序测试"></a>位序测试</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> &#123;</span><br><span class="line">	<span class="keyword">struct</span> &#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> a1:<span class="number">2</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> a2:<span class="number">3</span>;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> a3:<span class="number">3</span>;</span><br><span class="line">	&#125; x;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> b;</span><br><span class="line">&#125; d;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	d.b = <span class="number">150</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;0x%x\n0x%x\n0x%x\n&quot;</span>, d.x.a1, d.x.a2, d.x.a3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415</span></span><br></pre></td></tr></table></figure>

<p>结果如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 150 == 0b1001 0110</span></span><br><span class="line"></span><br><span class="line">arm, aarch64</span><br><span class="line"><span class="comment">/* bit numbering: lsb 0</span></span><br><span class="line"><span class="comment"> * 0x2 （== 10）</span></span><br><span class="line"><span class="comment"> * 0x5 （== 101）</span></span><br><span class="line"><span class="comment"> * 0x4 （== 110）</span></span><br><span class="line"><span class="comment"> * /</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">armeb, aarch64_be</span></span><br><span class="line"><span class="comment">/* bit numbering: lsb 0</span></span><br><span class="line"><span class="comment"> * 0x2 （== 10）</span></span><br><span class="line"><span class="comment"> * 0x2 （== 010）</span></span><br><span class="line"><span class="comment"> * 0x6 （== 100）</span></span><br><span class="line"><span class="comment"> * /</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">123456789101112131415</span></span><br></pre></td></tr></table></figure></article>
<div class="article-footer">
    <section id="license">
      <div class="header"><span>License</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    

</div>

<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">Newer</div><a href="/2025/01/16/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-C%E8%AF%AD%E8%A8%80-%E4%BD%8D%E8%BF%90%E7%AE%97-%E5%AD%97%E8%8A%82%E5%BA%8F-byte-order-%E5%92%8C%E4%BD%8D%E5%BA%8F-bit-order-%E5%AD%97%E8%8A%82%E5%BA%8F%E8%B5%B7%E5%A7%8B%E4%BD%8D%E8%AE%A1%E7%AE%97-CSDN%E5%8D%9A%E5%AE%A2/">字节序(byte order)和位序(bit order)_字节序起始位计算-CSDN博客</a></div><div class="item" id="next"><div class="note">Older</div><a href="/2025/01/10/2-%E8%AF%AD%E8%A8%80%E5%92%8C%E6%A1%86%E6%9E%B6-%E7%BB%93%E6%9E%84%E7%AE%97%E6%B3%95-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/">面向对象基础</a></div></section></div>






<footer class="page-footer footnote"><hr><div class="text"><p>本站由 <a href="/">liuluhua</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.33.1">Stellar 1.33.1</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">On This Page</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Endianness"><span class="toc-text">Endianness</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%86%99%E5%87%BA%E5%85%BC%E5%AE%B9%E5%A4%A7%E5%B0%8F%E7%AB%AF%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">如何写出兼容大小端的代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bit-numbering"><span class="toc-text">Bit numbering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E6%9C%BA%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-text">实际机器类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E5%9F%9F-Bit-Fields"><span class="toc-text">位域 Bit Fields</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E5%BA%8F%E6%B5%8B%E8%AF%95"><span class="toc-text">字节序测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E5%BA%8F%E6%B5%8B%E8%AF%95"><span class="toc-text">位序测试</span></a></li></ol></div><div class="widget-footer"><a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Solar by 480 Design - https://creativecommons.org/licenses/by/4.0/ --><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/><path d="M7 3.338A9.95 9.95 0 0 1 12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12c0-1.821.487-3.53 1.338-5"/></g></svg><span>Scroll to Top</span></a></div></widget>
</div></aside><div class='float-panel'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">


<script type="text/javascript">
  window.canonical = {"originalHost":null,"officialHosts":["localhost"],"encoded":""};
  const ctx = {
    date_suffix: {
      just: `Just`,
      min: `minutes ago`,
      hour: `hours ago`,
      day: `days ago`,
    },
    root : `/`,
    tag_plugins: {
      chat: Object.assign({"api":"https://siteinfo.listentothewind.cn/api/v1"}),
    }
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"skip_search":null,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
    loading: `https://api.iconify.design/eos-icons:three-dots-loading.svg?color=%231cd0fd`,
  };
  const deps = {
    jquery: `https://gcore.jsdelivr.net/npm/jquery@3.7/dist/jquery.min.js`,
    marked: `https://gcore.jsdelivr.net/npm/marked@13.0/lib/marked.umd.min.js`,
    lazyload: `/%5Bobject%20Object%5D`
  }
  

</script>

<script type="text/javascript">
  
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = () => {
          utils.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) => {
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index, 1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }

  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')) {
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function () {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },

    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      const maxRetry = 3;
      let retryCount = 0;

      return new Promise((resolve, reject) => {
        const load = () => {
          utils.onLoading?.(el);

          let timedOut = false;
          const timeout = setTimeout(() => {
            timedOut = true;
            console.warn('[request] 超时:', url);

            if (++retryCount >= maxRetry) {
              utils.onLoadFailure?.(el);
              onFailure?.();
              reject('请求超时');
            } else {
              setTimeout(load, 1000);
            }
          }, 5000);

          fetch(url).then(resp => {
            if (timedOut) return;
            clearTimeout(timeout);

            if (!resp.ok) throw new Error('响应失败');
            return resp;
          }).then(data => {
            if (timedOut) return;
            utils.onLoadSuccess?.(el);
            callback(data);
            resolve(data);
          }).catch(err => {
            clearTimeout(timeout);
            console.warn('[request] 错误:', err);

            if (++retryCount >= maxRetry) {
              utils.onLoadFailure?.(el);
              onFailure?.();
              reject(err);
            } else {
              setTimeout(load, 1000);
            }
          });
        };

        load();
      });
    },
    requestWithoutLoading: (url, options = {}, maxRetry = 2, timeout = 5000) => {
      return new Promise((resolve, reject) => {
        let retryCount = 0;

        const tryRequest = () => {
          let timedOut = false;
          const timer = setTimeout(() => {
            timedOut = true;
            if (++retryCount > maxRetry) reject('timeout');
            else tryRequest();
          }, timeout);

          fetch(url, options)
            .then(resp => {
              clearTimeout(timer);
              if (!resp.ok) throw new Error('bad response');
              resolve(resp);
            })
            .catch(err => {
              clearTimeout(timer);
              if (++retryCount > maxRetry) reject(err);
              else setTimeout(tryRequest, 500);
            });
        };

        tryRequest();
      });
    },
    /********************** requestAnimationFrame ********************************/
    // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
    // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
    requestAnimationFrame: (fn) => {
      if (!window.requestAnimationFrame) {
        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
      }
      window.requestAnimationFrame(fn)
    },
    dark: {},
  };

  // utils.dark.mode 当前模式 dark or light
  // utils.dark.toggle() 暗黑模式触发器
  // utils.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  utils.dark.method = {
    toggle: new RunItem(),
  };
  utils.dark = Object.assign(utils.dark, {
    push: utils.dark.method.toggle.push,
  });
</script>
<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>
<script type="text/javascript">
  (() => {
    const tagSwitchers = document.querySelectorAll('.tag-subtree.parent-tag > a > .tag-switcher-wrapper')
    for (const tagSwitcher of tagSwitchers) {
      tagSwitcher.addEventListener('click', (e) => {
        const parent = e.target.closest('.tag-subtree.parent-tag')
        parent.classList.toggle('expanded')
        e.preventDefault()
      })
    }

    // Get active tag from query string, then activate it.
    const urlParams = new URLSearchParams(window.location.search)
    const activeTag = urlParams.get('tag')
    if (activeTag) {
      let tag = document.querySelector(`.tag-subtree[data-tag="${activeTag}"]`)
      if (tag) {
        tag.querySelector('a').classList.add('active')
        
        while (tag) {
          tag.classList.add('expanded')
          tag = tag.parentElement.closest('.tag-subtree.parent-tag')
        }
      }
    }
  })()
</script>

<script async src="https://gcore.jsdelivr.net/npm/vanilla-lazyload@19.1/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
    callback_loaded: (el) => {
      el.classList.add('loaded');
      const wrapper = el.closest('.lazy-box');
      const icon = wrapper?.querySelector('.lazy-icon');
      if (icon) icon.remove();
    }
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });

  window.wrapLazyloadImages = (container) => {
    if (typeof container === 'string') {
      container = document.querySelector(container);
    }
    if (!container) return;
    
    const images = container.querySelectorAll('img');
    images.forEach((img) => {
      if (img.classList.contains('lazy')) return;

      const src = img.getAttribute('src');
      if (!src) return;

      const wrapper = document.createElement('div');
      wrapper.className = 'lazy-box';

      const newImg = img.cloneNode();
      newImg.removeAttribute('src');
      newImg.setAttribute('data-src', src);
      newImg.classList.add('lazy');

      const icon = document.createElement('div');
      icon.className = 'lazy-icon';
      if (def.loading) {
        icon.style.backgroundImage = `url("${def.loading}")`;
      }

      wrapper.appendChild(newImg);
      wrapper.appendChild(icon);

      img.replaceWith(wrapper);
    });

    // 通知 LazyLoad 更新
    if (window.lazyLoadInstance?.update) {
      window.lazyLoadInstance.update();
    }
  }
  
</script>

<!-- required -->
<script src="/js/main.js?v=1.33.1" defer></script>

<script type="text/javascript">
  const applyTheme = (theme) => {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme')
    } else {
      document.documentElement.setAttribute('data-theme', theme)
    }

    // applyThemeToGiscus(theme)
  }

  // FIXME: 这会导致无法使用 preferred_color_scheme 以外的主题
  const applyThemeToGiscus = (theme) => {
    // theme = theme === 'auto' ? 'preferred_color_scheme' : theme
    const cmt = document.getElementById('giscus')
    if (cmt) {
      // This works before giscus load.
      cmt.setAttribute('data-theme', theme)
    }

    const iframe = document.querySelector('#comments > section.giscus > iframe')
    if (iframe) {
      // This works after giscus loaded.
      const src = iframe.src
      const newSrc = src.replace(/theme=[\w]+/, `theme=${theme}`)
      iframe.src = newSrc
    }
  }

  const switchTheme = () => {
    // light -> dark -> auto -> light -> ...
    const currentTheme = document.documentElement.getAttribute('data-theme')
    let newTheme;
    switch (currentTheme) {
      case 'light':
        newTheme = 'dark'
        break
      case 'dark':
        newTheme = 'auto'
        break
      default:
        newTheme = 'light'
    }
    applyTheme(newTheme)
    window.localStorage.setItem('Stellar.theme', newTheme)
    utils.dark.mode = newTheme === 'auto' ? (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light") : newTheme;
    utils.dark.method.toggle.start();

    const messages = {
      light: `Switched to Light Mode`,
      dark: `Switched to Dark Mode`,
      auto: `Switched to Auto Mode`,
    }
    hud?.toast?.(messages[newTheme])
  }

  (() => {
    // Apply user's preferred theme, if any.
    const theme = window.localStorage.getItem('Stellar.theme')
    if (theme !== null) {
      applyTheme(theme)
    } else {
      utils.dark.mode = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    }
    utils.dark.method.toggle.start();
  })()
</script>


<!-- optional -->



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"rating":{"js":"/js/services/rating.js","api":"https://star-vote.xaox.cc/api/rating"},"vote":{"js":"/js/services/vote.js","api":"https://star-vote.xaox.cc/api/vote"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"friends_and_posts":{"js":"/js/services/friends_and_posts.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"},"voice":{"js":"/js/plugins/voice.js"},"video":{"js":"/js/plugins/video.js"},"download-file":{"js":"/js/plugins/download-file.js"},"twikoo":{"js":"/js/services/twikoo_latest_comment.js"},"waline":{"js":"/js/services/waline_latest_comment.js"},"artalk":{"js":"/js/services/artalk_latest_comment.js"},"giscus":{"js":"/js/services/giscus_latest_comment.js"},"contributors":{"edit_this_page":{"_posts/":null,"wiki/stellar/":"https://github.com/xaoxuu/hexo-theme-stellar-docs/blob/main/"},"js":"/js/services/contributors.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else if (id == 'voice') {
        ctx.voiceAudios = document.querySelectorAll('.voice>audio');
        if (ctx.voiceAudios?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            createVoiceDom(ctx.voiceAudios);
          });
        }
      } else if (id == 'video') {
        ctx.videos = document.querySelectorAll('.video>video');
        if (ctx.videos?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            videoEvents(ctx.videos);
          });
        }
      } else if (id == 'download-file') {
        ctx.files = document.querySelectorAll('.file');
        if (ctx.files?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            downloadFileEvent(ctx.files);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }

    // chat iphone time
    let phoneTimes = document.querySelectorAll('.chat .status-bar .time');

    if (phoneTimes.length > 0) {
      NowTime();
      var date = new Date();
      var sec = date.getSeconds();
      var firstAdjustInterval = setInterval(firstAdjustTime, 1000 * (60 - sec));
    }

    function firstAdjustTime() {
      NowTime();
      clearInterval(firstAdjustInterval);
      setInterval(NowTime, 1000 * 60);
    }

    function NowTime() {
      for (let i = 0; i < phoneTimes.length; ++i) {
        var timeSpan = phoneTimes[i];
        var date = new Date();
        var hour = date.getHours();
        var min = date.getMinutes();
        timeSpan.innerHTML = check(hour) + ":" + check(min);
      }
    };

    function check(val) {
      if (val < 10) {
        return ("0" + val);
      }
      return (val);
    }

    // chat quote
    const chat_quote_obverser = new IntersectionObserver((entries, observer) => {
      entries.filter((entry) => { return entry.isIntersecting }).sort((a, b) => a.intersectionRect.y !== b.intersectionRect.y ? a.intersectionRect.y - b.intersectionRect.y : a.intersectionRect.x - b.intersectionRect.x).forEach((entry, index) => {
          observer.unobserve(entry.target);
          setTimeout(() => {
            entry.target.classList.add('quote-blink');
            setTimeout(() => {
              entry.target.classList.remove('quote-blink');
            }, 1000);
          }, Math.max(100, 16) * (index + 1));
        });
    });

    var chatQuotes = document.querySelectorAll(".chat .talk .quote");
    chatQuotes.forEach((quote) => {
      quote.addEventListener('click', function () {
        var chatCellDom = document.getElementById("quote-" + quote.getAttribute("quotedCellTag"));
        if (chatCellDom) {
          var chatDiv = chatCellDom.parentElement;
          var mid = chatDiv.clientHeight / 2;
          var offsetTop = chatCellDom.offsetTop;
          if (offsetTop > mid - chatCellDom.clientHeight / 2) {
            chatDiv.scrollTo({
              top: chatCellDom.offsetTop - mid + chatCellDom.clientHeight / 2,
              behavior: "smooth"
            });
          } else {
            chatDiv.scrollTo({
              top: 0,
              behavior: "smooth"
            });
          }
          chat_quote_obverser.observe(chatCellDom);
        }
      });
    });
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://gcore.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css`,
    js: `https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js`
  };
  var selector = '[data-fancybox]:not(.error), .with-fancybox .atk-content img:not([atk-emoticon])';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const memos = document.getElementsByClassName('ds-memos');
    if (memos != undefined && memos.length > 0) {
      needFancybox = true;
    }
    const fancybox = document.getElementsByClassName('with-fancybox');
    if (fancybox != undefined && fancybox.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
